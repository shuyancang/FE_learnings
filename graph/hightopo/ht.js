!function(W, G, V) {
  "use strict";
  function r(b, F) {
      if ("function" != typeof F && null !== F)
          throw new TypeError("Super expression must either be null or a function");
      b.prototype = G.create(F && F.prototype, {
          constructor: {
              value: b,
              writable: !0,
              configurable: !0
          }
      }),
      F && zq(b, F)
  }
  function k(T) {
      var u = G.prototype.toString.call(T);
      return "Array]" === u.substring(u.length - 6)
  }
  function B(A, W, k, b, z, N) {
      W = W || [],
      k = k || [],
      b = b || [];
      try {
          W.push(A);
          var G = Function.apply(0, W);
          return k[k.length] = "return " + G,
          Function.apply(0, k).apply(0, b)
      } catch (c) {
          return N && N(c),
          z
      }
  }
  function x(S) {
      var E = {};
      return {
          get: function(x) {
              if (E[x] !== V)
                  return E[x];
              var F;
              switch (x) {
              case "WEBGL_depth_texture":
                  F = S.getExtension("WEBGL_depth_texture") || S.getExtension("MOZ_WEBGL_depth_texture") || S.getExtension("WEBKIT_WEBGL_depth_texture");
                  break;
              case "EXT_texture_filter_anisotropic":
                  F = S.getExtension("EXT_texture_filter_anisotropic") || S.getExtension("MOZ_EXT_texture_filter_anisotropic") || S.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
                  break;
              case "WEBGL_compressed_texture_s3tc":
                  F = S.getExtension("WEBGL_compressed_texture_s3tc") || S.getExtension("MOZ_WEBGL_compressed_texture_s3tc") || S.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
                  break;
              case "WEBGL_compressed_texture_pvrtc":
                  F = S.getExtension("WEBGL_compressed_texture_pvrtc") || S.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");
                  break;
              case "WEBGL_compressed_texture_etc1":
                  F = S.getExtension("WEBGL_compressed_texture_etc1");
                  break;
              default:
                  F = S.getExtension(x)
              }
              return E[x] = F,
              F
          }
      }
  }
  function T(E, A, B) {
      function e() {
          if (X !== V)
              return X;
          var b = A.get("EXT_texture_filter_anisotropic");
          return X = null !== b ? E.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 0
      }
      function G(r) {
          if ("highp" === r) {
              if (E.getShaderPrecisionFormat(E.VERTEX_SHADER, E.HIGH_FLOAT).precision > 0 && E.getShaderPrecisionFormat(E.FRAGMENT_SHADER, E.HIGH_FLOAT).precision > 0)
                  return "highp";
              r = "mediump"
          }
          return "mediump" === r && E.getShaderPrecisionFormat(E.VERTEX_SHADER, E.MEDIUM_FLOAT).precision > 0 && E.getShaderPrecisionFormat(E.FRAGMENT_SHADER, E.MEDIUM_FLOAT).precision > 0 ? "mediump" : "lowp"
      }
      var X;
      B = B || {};
      var h = "undefined" != typeof WebGL2RenderingContext && E instanceof WebGL2RenderingContext
        , _ = B.precision !== V ? B.precision : "highp"
        , O = G(_);
      O !== _ && (console.warn("WebGL:", _, "not supported, using", O, "instead."),
      _ = O);
      var q = B.logarithmicDepthBuffer === !0
        , Y = E.getParameter(E.MAX_TEXTURE_IMAGE_UNITS)
        , m = E.getParameter(E.MAX_VERTEX_TEXTURE_IMAGE_UNITS)
        , v = E.getParameter(E.MAX_TEXTURE_SIZE)
        , R = E.getParameter(E.MAX_CUBE_MAP_TEXTURE_SIZE)
        , k = E.getParameter(E.MAX_VERTEX_ATTRIBS)
        , x = E.getParameter(E.MAX_VERTEX_UNIFORM_VECTORS)
        , g = E.getParameter(E.MAX_VARYING_VECTORS)
        , o = E.getParameter(E.MAX_FRAGMENT_UNIFORM_VECTORS)
        , L = m > 0
        , Q = h || !!A.get("OES_texture_float")
        , D = (h || !!A.get("OES_element_index_uint")) && "undefined" != typeof Uint32Array
        , c = L && Q
        , z = h ? E.getParameter(E.MAX_SAMPLES) : 0;
      return {
          getMaxAnisotropy: e,
          getMaxPrecision: G,
          precision: _,
          logarithmicDepthBuffer: q,
          maxTextures: Y,
          maxVertexTextures: m,
          maxTextureSize: v,
          maxCubemapSize: R,
          maxAttributes: k,
          maxVertexUniforms: x,
          maxVaryings: g,
          maxFragmentUniforms: o,
          vertexTextures: L,
          floatFragmentTextures: Q,
          elementTypeUint: D,
          floatVertexTextures: c,
          maxSamples: z
      }
  }
  function C(X, U) {
      return X.z !== U.z ? X.z - U.z : X.id - U.id
  }
  function g(P, E) {
      return P.z !== E.z ? E.z - P.z : P.id - E.id
  }
  var p = "ht";
  if (!W[p]) {
      !function() {
          Date.now && Date.prototype.getTime || (Date.now = function() {
              return (new Date).getTime()
          }
          ),
          W.performance && W.performance.now || function() {
              var E = Date.now();
              W.performance || (W.performance = {}),
              W.performance.now = function() {
                  return Date.now() - E
              }
          }();
          for (var J = Date.now(), O = 16, T = ["ms", "moz", "webkit", "o"], x = 0; x < T.length && !W.requestAnimationFrame; ++x)
              W.requestAnimationFrame = W[T[x] + "RequestAnimationFrame"],
              W.cancelAnimationFrame = W[T[x] + "CancelAnimationFrame"] || W[T[x] + "CancelRequestAnimationFrame"];
          W.requestAnimationFrame || (W.requestAnimationFrame = function(r) {
              var n = Date.now()
                , z = O + J - n;
              return 0 > z && (z = 0),
              J = n,
              W.setTimeout(function() {
                  J = Date.now(),
                  r(performance.now())
              }, z)
          }
          ),
          W.cancelAnimationFrame || (W.cancelAnimationFrame = function(t) {
              return W.clearTimeout(t)
          }
          ),
          G.assign === V && (G.assign = function(S) {
              if (S === V || null === S)
                  throw new TypeError("Cannot convert undefined or null to object");
              for (var P = G(S), i = 1; i < arguments.length; i++) {
                  var D = arguments[i];
                  if (D !== V && null !== D)
                      for (var v in D)
                          G.prototype.hasOwnProperty.call(D, v) && (P[v] = D[v])
              }
              return P
          }
          )
      }();
      var Y = W.document
        , E = null
        , n = W[p] = {}
        , $ = W[p + "config"]
        , M = n.Default = $ && $.Default || {}
        , U = n.Style = $ && $.Style || {}
        , S = n.Attr = $ && $.Attr || {}
        , I = function() {
          return !0
      }
        , Q = function(g) {
          return g
      }
        , c = function(v) {
          return !v
      }
        , l = n.Color = $ && $.Color || {}
        , d = n.IsGetter = $ && $.IsGetter || {};
      !function() {
          var A = !1;
          try {
              var h = G.defineProperty({}, "passive", {
                  get: function() {
                      return A = !0,
                      V
                  }
              });
              W.addEventListener("test", h, h),
              W.removeEventListener("test", h, h)
          } catch (S) {
              A = !1
          }
          M.passiveSupported = A
      }();
      var L, Z, f, e, j = M.passiveSupported, v = M.eventListenerOptionsFalse = j ? {
          passive: !1,
          capture: !1
      } : !1, t = M.eventListenerOptionsTrue = j ? {
          passive: !1,
          capture: !0
      } : !0, b = function(L, N, F, V) {
          L.addEventListener(N, F, V ? t : v)
      }, D = function(q, S, x, h) {
          q.removeEventListener(S, x, h ? t : v)
      }, N = Math, w = N.round, q = N.floor, z = N.ceil, O = N.sqrt, X = N.max, K = N.min, u = N.abs, P = N.cos, R = N.acos, o = N.sin, H = N.pow, i = N.asin, J = N.exp, s = N.PI, y = 2 * s, A = s / 2, h = N.tan, a = N.atan2, F = N.random, m = N.log, _ = !0, Fc = !1, $n = W.parseInt || global.parseInt, ne = "2021-12-15", Rf = W.navigator ? W.navigator.platform.indexOf("Win") > -1 : !1, Kq = function(Y) {
          return Y * Y
      }, vk = W.setTimeout, _d = W.clearTimeout, gb = W.location, wn = W.navigator ? W.navigator.userAgent.toLowerCase() : "", Gi = function(F) {
          return F.test(wn)
      }, vs = Gi(/msie/), Di = Gi(/msie/) || Gi(/trident/), We = Gi(/msie 10/), xe = Gi(/edge/), rs = Gi(/firefox/), Dc = Gi(/mac/), Ul = M.isTouchable === V ? Rf ? !1 : Y ? "ontouchend"in Y : !1 : M.isTouchable, kj = "default", nh = "single", wr = "multiple", bn = "front", zs = "back", Mb = "left", Gq = "right", Dj = "top", zg = "bottom", ef = "center", Cm = "eye", De = "middle", Tm = "east", pn = "west", me = "north", pk = "none", nc = "px", Rn = "absolute", zd = "border", Nh = "triangle", gp = "rect", Ak = "circle", jl = "cylinder", Zr = "shape", ng = "items", Tp = "normal", mc = "remove", Cn = "clear", gq = "width", Ki = "height", $k = "ingroup", jn = "check", Ig = "uncheck", ei = "radio", je = "radioOn", Do = "radioOff", $h = "points", Bh = "values", rj = "series", Qi = "body", _r = "label", lc = "label2", Up = "note", lj = "note2", Rq = "icons", Be = "labelFont", om = "labelColor", sh = "labelSelectColor", Nj = "note.expanded", $o = "note2.expanded", xl = "edge.expanded", ri = "edge.points", vj = "edge.type", Ek = "rotation", $m = "hidden", jk = "visible", tf = "tuv", iq = "no", Fm = "draw", Mk = "select", Lh = "currentSubGraph", og = "selectBackground", Yr = "autoMakeVisible", bi = "autoHideScrollBar", yq = "scrollBarColor", yl = "scrollBarSize", im = "indent", Vl = "rowHeight", gh = "columnLineColor", Lb = "rowLineColor", vq = "columnLineVisible", ic = "rowLineVisible", sq = "visibleFunc", qq = "expandIcon", jo = "collapseIcon", rh = "checkMode", Jf = "sortFunc", Ap = "editable", Ur = "batchEditable", _e = "tristate", Xe = "asc", Fd = "desc", Op = "position", Mp = "__", vl = "elevation", Ir = "children", xs = "translateX", _l = "translateY", jh = "dataModel", _c = "maxSize", yh = "enc", Vm = "state", Fi = yh + "o" + "de", _o = "shape3d", Xn = "shape3d.resolution", Qk = "shape3d.visible", so = "shape3d.from.visible", fn = "shape3d.to.visible", xb = "shape3d.top.visible", Ge = "shape3d.bottom.visible", kg = "repeat.uv.length", Bf = "serializeValue", xn = "deserializeValue", jg = "centerUniform", vc = "uniform", Pe = "rgba(255,255,255,0)", xm = "style", Tl = "attr", qf = "field", Tk = "string", Gj = "boolean", ah = "color", Fj = "int", Mc = "number", So = "ew-resize", Jk = "ns-resize", yp = "pointer", Kj = "auto", Bq = "mousedown", Ao = "mousemove", ge = "mouseup", Rd = "mouseout", ki = "touchstart", wl = "touchmove", Ci = "touchend", Pr = "keydown", js = "keyup", uc = ["DOMMouseScroll", "mousewheel"], Ho = rs ? uc[0] : uc[1], il = Mp + p + Mp + Fi, rm = [ki, wl, Ci], Fg = [Bq, Ao, ge, Rd, Ho, "wheel", "mouseenter", "mouseleave", "mouseover"], Kp = [Pr, js, "keypress", "input", "contextmenu", "compositionstart", "compositionupdate", "compositionend"], Wl = Ul ? rm.concat(Kp) : Fg.concat(Kp), vf = E, Tq = E, Lr = E, jp = ge.length, Vf = function() {
          Lr && (_d(Lr.timeout),
          Lr = E)
      }, Ei = function() {
          Lr && op(Lr.e, Lr.info)
      };
      W.addEventListener && (Ul || (b(W, Rd, function() {
          Vf()
      }),
      b(W, Ho, function() {
          Ab()
      })),
      b(W, js, function(q) {
          91 === q.keyCode ? de = {} : delete de[q.keyCode]
      }, !0),
      b(W, Pr, function(w) {
          de[w.keyCode] = !0
      }, !0),
      b(W, "blur", function() {
          de = {}
      }));
      var Jr, Ih, Dh, fj = 0, Pi = E, Oc = function(p, F) {
          var d = vk(function() {
              delete Pi[d],
              Qm(Pi) && (Pi = E),
              p()
          }, F);
          return d
      }, io = E, xc = E, jj = {}, wm = {}, Mj = {}, es = {}, Yo = {}, de = {}, Yn = {}, er = {}, cb = {}, hn = {}, Jm = /.json$/, As = /\.(json|bin)$/, ff = /^data:image\/svg\+xml/, Qh = {}, On = [], Li = {}, uj = E, Nd = E, ts = function() {}, kb = function() {
          throw "Oops!"
      }, kd = [0, 0, 0], Wk = {
          x: 0,
          y: 0,
          width: 0,
          height: 0
      }, vd = E, xq = E, Km = E, Gn = function(P, M) {
          wm[P] = M,
          M && M.comps && !M.uuid && (M.uuid = n.Math.generateUUID()),
          Ip[P] && (M.cacheRule = Ip[P],
          delete Ip[P])
      }, hg = function(M) {
          xq && !M._72O && (Km || (Km = {}),
          Km[M._72O = Pm()] = M),
          Jr != E ? Bn() < .05 && e && !Ih && (Sn = Vf) : Sn = mf
      }, lq = function($, Q, V, r) {
          xq || (xq = {});
          var k = xq[$];
          if (k) {
              if (k.url === Q)
                  return;
              k.image ? (k.image.onload = ts,
              k.image.onerror = ts) : k.request && (k.request.onload = ts,
              k.request.onerror = ts)
          }
          if (Jm.test(Q)) {
              var v = new tn;
              if (xq[$] = {
                  request: v,
                  url: Q
              },
              Q = M.beforeLoadURL(Q, $),
              Q.data) {
                  var f = M.parse(Q.data);
                  Mn($, f),
                  M.handleImageLoaded($, f)
              } else {
                  v.onload = function() {
                      if (200 === this.status || 0 === this.status) {
                          var p = M.parse(v.getResponseText());
                          Mn($, p),
                          M.handleImageLoaded($, p)
                      } else
                          Mn($, M.handleUnfoundImage($, Q) || E)
                  }
                  ,
                  v.onerror = function() {
                      Mn($, M.handleUnfoundImage($, Q) || E)
                  }
                  ;
                  var P = {};
                  P.url = encodeURI(Q),
                  P.sync = !1,
                  v.send(P)
              }
          } else {
              var f = new Image;
              xq[$] = {
                  image: f,
                  url: Q
              },
              /^data:image/.test(Q) || (Q = M.beforeLoadURL(Q, $),
              Q = M.appendTimeStamp(Q),
              Q = encodeURI(Q),
              f.crossOrigin = M.crossOrigin),
              M.convertImageSrc(Q, function(v) {
                  Di && (Q.toLowerCase().indexOf(".svg") > 0 || ff.test(Q)) ? (Y.body.appendChild(f),
                  f.style.visibility = "hidden",
                  f.onload = function() {
                      vk(function() {
                          if (V && (f.width = V),
                          r && (f.height = r),
                          !f.width || !f.height) {
                              var a = f.width || f.clientWidth
                                , P = f.height || f.clientHeight;
                              f.width = a,
                              f.height = P
                          }
                          M.handleImageLoaded($, f),
                          Mn($, f),
                          Y.body.removeChild(f),
                          f.style.visibility = ""
                      }, 180)
                  }
                  ,
                  f.onerror = function() {
                      Mn($, M.handleUnfoundImage($, Q) || E),
                      Y.body.removeChild(f),
                      f.style.visibility = ""
                  }
                  ) : (f.onload = function() {
                      V && (f.width = V),
                      r && (f.height = r),
                      M.handleImageLoaded($, f),
                      Mn($, f)
                  }
                  ,
                  f.onerror = function() {
                      Mn($, M.handleUnfoundImage($, Q) || E)
                  }
                  ),
                  f.src = v
              })
          }
      }, Mn = function(l, b) {
          if (Gn(l, b),
          delete xq[l],
          Qm(xq) && (xq = E,
          Km)) {
              for (var L in Km) {
                  var c = Km[L];
                  c._2O && c._2O[l] && (c.deleteTexture(l),
                  delete c._2O[l]),
                  c.invalidateAll && c.invalidateAll(V, "imageLoaded", l),
                  c.redraw && c.redraw(),
                  c.iv(),
                  delete c._72O
              }
              Km = E
          }
          if (b && Km)
              for (var L in Km) {
                  var c = Km[L];
                  c.invalidateAll && c.invalidateAll(V, "imageLoading", l),
                  c.redraw && c.redraw(),
                  c.iv()
              }
      }, Nr = function() {
          return m = N && Date,
          function() {
              return W.performance && W.performance.now ? W.performance.now() : Date.now()
          }
      }(), Go = function(y, F, T) {
          return {
              width: y,
              height: F,
              comps: $c(T) ? T : [T]
          }
      }, Lp = function(u, h) {
          return {
              type: Ak,
              rect: [u, h, 1.6, 1.6],
              borderWidth: 1,
              borderColor: Jp,
              gradient: ub,
              gradientColor: Pp,
              background: Jp
          }
      }, dm = function(M, W) {
          return Go(16, 16, {
              type: Nh,
              rect: [4, 4, 10, 8],
              background: M,
              rotation: W ? 1.57 : 3.14
          })
      }, mr = function(P, S) {
          return Go(16, 16, {
              type: Nh,
              rect: [4, 4, 8, 7],
              background: P,
              rotation: S ? 3.14 : 0
          })
      }, nj = function(J) {
          var h = J._orientation;
          return "horizontal" === h || "h" === h
      }, ie = function(w, n) {
          var v = E || 4
            , B = E || 1
            , H = E || 1;
          0 > v ? v = 0 : v > .25 && (v = .25);
          var a, K, F, I, A, z, h, O = .5, N = [], k = [], $ = [], d = y / H, W = y / B, c = O - v;
          for (K = 0; B >= K; K++)
              for (I = -s + K * W,
              z = P(I),
              A = o(I),
              a = 0; H >= a; a++)
                  F = a * d,
                  h = c + v * z,
                  N.push(P(F) * h, A * v, -o(F) * h),
                  (Z = [w, n]) && k.push(a / H, 1 - K / B);
          for (K = 0; B > K; K++) {
              var l = K * (H + 1)
                , r = (K + 1) * (H + 1);
              for (a = 0; H > a; a++)
                  $.push(l + a, r + a + 1, r + a, l + a, l + a + 1, r + a + 1),
                  xo.z = _j.z = [w, n]
          }
      }, xh = function(m) {
          var q = 2
            , b = 0;
          for (var F in m)
              F.length === q && $n(F, 32) === Ah && (uj = Nd = m[F]),
              b++;
          return b
      }, Ke = function(B, l, d, L) {
          return d || (d = Ul ? 5 : 3,
          d /= L || 1),
          {
              x: B - d,
              y: l - d,
              width: 2 * d,
              height: 2 * d
          }
      }, jm = function(i, E, F, C) {
          var I = this;
          E || (E = Ul ? 5 : 3,
          F = 20,
          C = 20);
          var X = {
              x: i,
              y: E,
              width: F,
              height: C
          };
          if (F)
              for (var f = 0; F > f; f++)
                  if (3 === F)
                      C = 20;
                  else
                      for (var e = 0; C > e; e++)
                          I = W ? W : F;
          var L = {
              x: s,
              y: 2 * s
          };
          if (tp(X, L)) {
              var G = Ki[0] + Dj[0] + Cn[1] + Xe.length
                , p = $m[0] + _e[0] + Cn[1] + Qi.length;
              Zb[Cm] = [I[G], I[p]],
              I[G] = zn[Cm],
              I[p] = zn[_o]
          }
      }, bc = function(m) {
          return (/ble$/.test(m) || /ed$/.test(m) || d[m] ? "is" : "get") + m.charAt(0).toUpperCase() + m.slice(1)
      }, zn = function(p) {
          return "set" + p.charAt(0).toUpperCase() + p.slice(1)
      }, Xq = function(u) {
          return typeof u === Tk || u instanceof String
      }, te = function(Z) {
          return typeof Z === Mc
      }, mf = function(E) {
          return typeof E === Gj
      }, Ql = function(F) {
          return F && "object" == typeof F
      }, Oi = function(R) {
          return "function" == typeof R
      }, $c = function(W) {
          return W instanceof Array
      }, fb = function(G) {
          return G instanceof Mh
      }, Hm = function(P) {
          return $c(P) ? new Mh(P) : P
      }, ud = function(M) {
          return M instanceof Wd
      }, ji = function(P) {
          return P instanceof Fq
      }, ks = function(v) {
          return v instanceof cg
      }, dn = function(q, l) {
          if (!(q instanceof n.Group))
              return !1;
          if (!l)
              return q.isExpanded();
          var J = l.getDataUI(q);
          return J && J._88I ? !0 : !1
      }, Np = function(t) {
          return t instanceof ch
      }, ti = function(i) {
          return i && "IFRAME" === i.tagName
      }, nq = function(d) {
          return d == E || M.numberDigits == E ? d : parseFloat(d.toFixed(M.numberDigits))
      }, ph = function(z, J, R) {
          var l, L = J.length;
          if (R)
              for (var v = 0; R > v; v++)
                  if (3 === L)
                      z.push(J[0]),
                      z.push(J[1]),
                      z.push(J[2]);
                  else
                      for (l = 0; L > l; l++)
                          z.push(J[l]);
          else if (3 === L)
              z.push(J[0]),
              z.push(J[1]),
              z.push(J[2]);
          else
              for (l = 0; L > l; l++)
                  z.push(J[l])
      }, Dg = function(l) {
          return l ? Ql(l) ? l : {} : !1
      }, rc = function(T, a, m) {
          var o, G = Ql(T) ? T : T.prototype;
          for (o in a)
              m && o in G ? G[o] === V && console.warn("class", G, "has own undefined property", o, ", keep exist!") : G[o] = a[o];
          return T
      }, Po = function(a, n) {
          if (!("wheelDelta"in n)) {
              var o = n.deltaMode;
              n.wheelDelta = o === n.DOM_DELTA_PIXEL ? -n.deltaY : o === n.DOM_DELTA_LINE ? 40 * -n.deltaY : 120 * -n.deltaY
          }
          a.handle_mousewheel(n)
      }, oj = function(u) {
          return String.fromCharCode(u)
      }, Nl = function(y) {
          for (var W, M = 0, r = ""; M < y.length; M++)
              W = y[y.length - 1 - M],
              "%" === W ? W = "'" : "a" === W ? W = '"' : "]" === W && (W = "\\"),
              r += oj(W.charCodeAt(0) - 1);
          return r
      }, Jg = function(o, b, w) {
          o.superClass.constructor.apply(b, w)
      }, Qm = function(k) {
          for (var y in k)
              return !1;
          return !0
      }, Og = function($) {
          return $ ? 0 === $.length : !0
      }, sp = function() {
          var b = "";
          return [Ig[0], Lb[0], _r[0]].forEach(function(i) {
              b += zn(i).slice(3)
          }),
          vc = Y && Y[b] || jg,
          function(e, Q) {
              return e === Q ? !0 : e.x === Q.x && e.y === Q.y && e.width === Q.width && e.height === Q.height
          }
      }(), al = function(N, z, x) {
          return z > N ? z : N > x ? x : N
      }, Mf = function(B) {
          return 0 > B ? -1 : B > 0 ? 1 : 0
      }, Bn = function() {
          var M = 1e4 * o(jp++);
          return M - q(M)
      }, Sq = function(L, y, $) {
          return Wr(L.x, L.y, y.x, y.y, $.x, $.y, $.x + $.width, $.y, !0) || Wr(L.x, L.y, y.x, y.y, $.x + $.width, $.y, $.x + $.width, $.y + $.height, !0) || Wr(L.x, L.y, y.x, y.y, $.x + $.width, $.y + $.height, $.x, $.y + $.height, !0) || Wr(L.x, L.y, y.x, y.y, $.x, $.y + $.height, $.x, $.y, !0)
      }, Wr = function(f, d, G, Q, $, F, B, S, g) {
          var H = (B - $) * (d - F) - (S - F) * (f - $)
            , Y = (S - F) * (G - f) - (B - $) * (Q - d);
          if (0 !== Y) {
              var O = H / Y
                , L = f + O * (G - f)
                , y = d + O * (Q - d);
              return g && (L + Uk < K(f, G) || L - Uk > X(f, G) || L + Uk < K($, B) || L - Uk > X($, B) || y + Uk < K(d, Q) || y - Uk > X(d, Q) || y + Uk < K(F, S) || y - Uk > X(F, S)) ? E : [L, y]
          }
          return E
      }, sj = function(u, K, B) {
          if (u && B)
              if (K) {
                  if (K === xm)
                      return u.getStyle(B);
                  if (K === Tl)
                      return u.getAttr(B);
                  if (K === qf)
                      return u[B]
              } else if (B = bc(B),
              u[B])
                  return u[B]();
          return V
      }, Hk = function(h, _, l, $) {
          if (h && l)
              if (_) {
                  if (_ === xm)
                      h.s(l, $);
                  else if (_ === Tl)
                      h.a(l, $);
                  else if (_ === qf) {
                      var H = h[l];
                      h[l] = $,
                      h.fp("f:" + l, H, $)
                  }
              } else
                  l = zn(l),
                  h[l] && h[l]($)
      }, yg = function(Y, W, P) {
          return W && "top" !== W ? "bottom" === W ? {
              x: Y.x,
              y: Y.y,
              width: Y.width,
              height: Y.height * P
          } : "right" === W ? {
              x: Y.x,
              y: Y.y,
              width: Y.width * P,
              height: Y.height
          } : "left" === W ? {
              x: Y.x + Y.width * (1 - P),
              y: Y.y,
              width: Y.width * P,
              height: Y.height
          } : void 0 : {
              x: Y.x,
              y: Y.y + Y.height * (1 - P),
              width: Y.width,
              height: Y.height * P
          }
      }, Ne = function(E, G, f, M, U) {
          G && xg(E, f, M, 1, U, G)
      }, kq = function(R, k, Q, I) {
          var y = 1 - R;
          return y * y * k + 2 * R * y * Q + R * R * I
      }, xo = function(U, C, t, Y, O) {
          var Q = 1 - U;
          return Q * Q * Q * C + 3 * Q * Q * U * t + 3 * Q * U * U * Y + U * U * U * O
      }, oo = function(r) {
          var O, A, H, F, N = 0;
          return r.forEach(function(n) {
              if (O = n.length,
              O > 0)
                  for (A = n[0],
                  F = 1; O > F; F++)
                      H = n[F],
                      N += Qf(A, H),
                      A = H
          }),
          N
      }, Qn = function(G, V, t) {
          var W = "__" + G
            , w = function(k) {
              ("mousedown" === G || "mouseup" === G || "touchstart" === G || "touchend" === G) && Xk(k),
              t.disabled || t["handle_" + G](k)
          };
          t[W] || (t[W] = w,
          b(V, G, w))
      }, qn = function(k, y, A) {
          var l = "__" + k
            , J = A[l];
          J && (D(y, k, J),
          delete A[l])
      }, Mo = function(o, Z) {
          var t = "_" + Z;
          o[bc(Z)] = function() {
              return this[t]
          }
          ,
          o[zn(Z)] = function(X) {
              var T = this[t];
              this[t] = X,
              this.fp(Z, T, X)
          }
      }, xf = function(Z) {
          return G.create(Z)
      }, ho = function(e) {
          if (!e.element) {
              var S, c;
              (S = e.textField) ? c = Hp(Vs.TextField, S) : (S = e.textArea) ? c = Hp(Vs.TextArea, S) : (S = e.button) ? c = Hp(Vs.Button, S) : (S = e.comboBox) ? c = Hp(Vs.ComboBox, S) : (S = e.checkBox) ? c = Hp(Vs.CheckBox, S) : (S = e.radioButton) ? c = Hp(Vs.RadioButton, S) : (S = e.slider) ? c = Hp(Vs.Slider, S) : (S = e.colorPicker) ? c = Hp(Vs.ColorPicker, S) : (S = e.image) && (c = Hp(Vs.Image, S)),
              c && (e.element = c)
          }
      }, Te = function(T, G) {
          var w = cf(T);
          return w._ht = G,
          w
      }, mn = W.top === W ? W.top : W || W.document, cf = function(w, a) {
          var A = Y.createElement("div")
            , i = A.style;
          return A.tabIndex = -1,
          A.onkeydown = ad,
          i.msTouchAction = pk,
          Hd(A, E, 0),
          Ul && i.setProperty("-webkit-tap-highlight-color", "rgba(0, 0, 0, 0)", E),
          w && (i.overflow = $m),
          a && Qc(a, A),
          A
      }, Jl = function(f, l) {
          var _ = Y.createElement("canvas")
            , U = _.style;
          return U.msTouchAction = pk,
          l || (U.pointerEvents = pk),
          Hd(_, E, 0),
          f && Qc(f, _),
          _
      }, Hd = function(W, S, p) {
          var Z = W.style;
          Z.border = S ? S + " solid 1px" : 0,
          Z.outline = 0,
          Z.padding = p ? "0 " + p + nc : 0,
          Kn(W)
      }, Kn = function(U) {
          var n = U.style;
          n.position = Rn,
          n.margin = 0,
          n.setProperty("box-sizing", "border-box", E),
          n.setProperty("-moz-box-sizing", "border-box", E)
      }, Uj = function(x, b, w, L) {
          L || (L = Ph),
          b != E && (x.width = b * L,
          x.style.width = b + nc),
          w != E && (x.height = w * L,
          x.style.height = w + nc)
      }, Qc = function(_, L, A) {
          _.appendChild(L),
          A && (L.style.position = Rn)
      }, Df = function(H, T) {
          T.split || (T += "");
          for (var i, g = T.split("\n"), O = 0, N = g.length, h = 0; N > h; h++) {
              var B = eh(H.font, g[h]);
              B.width > O && (O = B.width),
              i || (i = B.height)
          }
          return H.ss = g,
          {
              width: O,
              height: i * N
          }
      }, Cp = function(E, G, t, p, m, f) {
          var V = G.length;
          if (1 === V)
              bs(E, G[0], t, p, m);
          else
              for (var c = t.height / V, N = {
                  x: t.x,
                  y: t.y,
                  width: t.width,
                  height: c
              }, H = 0; H < G.length; H++)
                  f ? vh(E, G[H], p, m, N.x, N.y, N.width, N.height, f) : bs(E, G[H], N, p, m),
                  N.y += c
      }, bs = function(E, a, q, Z, u) {
          E.font = Z ? Z : Id,
          E.fillStyle = u ? u : Yg,
          E.textAlign = ef,
          E.textBaseline = De;
          var l, k;
          q ? q.width === V ? (l = q.x,
          k = q.y) : (l = q.x + q.width / 2,
          k = q.y + q.height / 2) : (l = 0,
          k = 0),
          E.fillText(a, w(l), w(k))
      }, fg = function(g) {
          g.getView && (g = g.getView());
          var O = g.offsetWidth || g.scrollWidth;
          return !O && g.style.width && (O = $n(g.style.width)),
          O
      }, dl = function(u) {
          u.getView && (u = u.getView());
          var E = u.offsetHeight || u.scrollHeight;
          return !E && u.style.height && (E = $n(u.style.height)),
          E
      }, To = function(c, p, s) {
          var U = p[0].toUpperCase() + p.substring(1, p.length);
          c["webkit" + U] = s,
          c["moz" + U] = s,
          c["ms" + U] = s,
          c["o" + U] = s,
          c[p] = s
      }, Pk = function() {
          var e = function(T) {
              ad(T),
              T.stopPropagation()
          }
            , P = function(d) {
              ad(d)
          }
            , Z = [ki, Pr, Bq];
          return function(k, i) {
              var p = cf()
                , H = p.style;
              return H.backgroundColor = M.disabledBackground,
              k && (H.backgroundImage = "url(" + k + ")",
              H.backgroundPosition = "50% 50%",
              H.backgroundRepeat = "no-repeat no-repeat"),
              i === !1 ? Z.forEach(function(T) {
                  b(p, T, P)
              }) : Z.forEach(function(d) {
                  b(p, d, e)
              }),
              p
          }
      }(), hq = function(J) {
          var X = J.getContext("2d");
          return X.save(),
          X.lineCap = Mq,
          X.lineJoin = Nn,
          X
      }, Sn = function(l, C, s, R) {
          od(l, C * Ph, s * Ph),
          R *= Ph,
          1 !== R && l.scale(R, R)
      }, od = function(c, I, o) {
          c.translate(I, o)
      }, Iq = function(w, P) {
          P && w.rotate(P)
      }, ig = function(m, M, e) {
          M === V && (M = 1),
          e === V && (e = 1),
          (1 !== M || 1 !== e) && m.scale(M, e)
      }, ys = !1, J = mn[jn[1] + xs[0]], aq = function(q) {
          var y = Y.activeElement;
          if (Y.activeElement !== q) {
              y && y.forceOnblur && y.forceOnblur();
              for (var a = [], v = q.parentNode; v; )
                  a.push([v, v.scrollLeft, v.scrollTop]),
                  v = v.parentNode;
              if (!ys) {
                  var N = []
                    , n = [];
                  try {
                      for (var A = W.parent, T = W; A !== T; )
                          N.push([A, A.scrollX, A.scrollY]),
                          T = A,
                          A = W.parent;
                      var G = W.frameElement;
                      if (G)
                          for (var Q = G.parentNode; Q; )
                              n.push([Q, Q.scrollLeft, Q.scrollTop]),
                              Q = Q.parentNode
                  } catch (l) {
                      ys = !0
                  }
              }
              if (Ul)
                  q.focus();
              else {
                  var B = $e()
                    , i = B.target;
                  q.focus(),
                  i.scrollLeft = B.left,
                  i.scrollTop = B.top
              }
              a.forEach(function(g) {
                  g[0].scrollLeft = g[1],
                  g[0].scrollTop = g[2]
              }),
              ys || (N.forEach(function($) {
                  $[0].scrollTo($[1], $[2])
              }),
              n.forEach(function(w) {
                  w[0].scrollLeft = w[1],
                  w[0].scrollTop = w[2]
              }))
          }
      }, Si = function(M) {
          return M && M.getView ? M.getView() : M
      }, ib = function(h, w, L, n, y) {
          if (2 === arguments.length && (L = w.y,
          n = w.width,
          y = w.height,
          w = w.x),
          h.isSelfViewEvent)
              h.setX(w),
              h.setY(L),
              h.setWidth(n),
              h.setHeight(y);
          else {
              var S = Si(h)
                , b = S.style;
              if ((Y.fullscreenElement || Y.mozFullScreenElement || Y.webkitFullscreenElement || Y.msFullscreenElement) !== S)
                  w !== V && (b.left = w + nc),
                  L !== V && (b.top = L + nc),
                  n !== V && (b.width = n + nc),
                  y !== V && (b.height = y + nc);
              else {
                  var R = M.getWindowInfo();
                  b.left = (w = R.left) + nc,
                  b.top = (L = R.top) + nc,
                  b.width = (n = R.width) + nc,
                  b.height = (y = R.height) + nc
              }
              h.endEditing && !Ul && h.endEditing(),
              h.redraw && h.redraw(),
              h.invalidate && h.invalidate(),
              h.onLayouted && h.onLayouted(w, L, n, y),
              h.fireViewEvent && h.fireViewEvent("layout")
          }
      }, bb = function(Q) {
          if (!Q.touches)
              return Q;
          var r = Q.touches[0];
          return r ? r : Q.changedTouches[0]
      }, tj = function(S) {
          return sg(S) ? bb(S).target : S.target
      }, sg = function(B) {
          return B && "object" == typeof B && "touches"in B
      }, fc = function(u) {
          M.popup && M.popup.close(),
          M.popup = u
      }, gd = E, zc = function(p) {
          gd.handleWindowTouchMove(p)
      }, Mr = function(S) {
          gd.handleWindowTouchEnd(S),
          D(W, wl, zc),
          D(W, Ci, Mr),
          gd = E
      }, Dn = function(J) {
          gd.handleWindowMouseMove(J)
      }, hk = function(p) {
          gd.handleWindowMouseUp(p),
          D(W, Ao, Dn),
          D(W, ge, hk),
          gd = E
      }, Re = function(O) {
          return 1 === Yp(O)
      }, ag = function(q, n) {
          return n ? n.keyCode === q : de[q]
      }, td = function(v) {
          return Tr(v) && ag(65, v)
      }, Xr = function(R) {
          return ag(46, R) || ag(8, R)
      }, to = function(h) {
          return function(j) {
              return j ? j.keyCode === h : de[h]
          }
      }, Ah = 573, fo = [65, 83, 68, 87, 37, 38, 39, 40, 32, 13, 27], mj = to(fo[0]), pi = to(fo[1]), Kd = to(fo[2]), be = to(fo[3]), Ll = to(fo[4]), yo = to(fo[5]), zp = to(fo[6]), Cf = to(fo[7]), ec = to(fo[8]), bq = to(fo[9]), pg = to(fo[10]), Jd = {
          65: 1,
          83: 1,
          68: 1,
          87: 1,
          37: 1,
          38: 1,
          39: 1,
          40: 1
      }, Hr = [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 5, 5, 5, 5, 5, 593], Xl = E, Ue = E, en = function(x, K) {
          Xl || (Xl = Jl()),
          Uj(Xl, x, K, 1);
          var v = hq(Xl);
          return v.clearRect(0, 0, x, K),
          v
      }, pf = function(A, l, C) {
          if (l && A) {
              if ("override" === C)
                  return l;
              if ("override_rgb" === C) {
                  var I = bd(l);
                  return A = Il(A),
                  "rgba(" + w(255 * I[0]) + "," + w(255 * I[1]) + "," + w(255 * I[2]) + "," + A[3] / 255 + ")"
              }
              if ("override_a" === C) {
                  var I = bd(l);
                  return A = Il(A),
                  "rgba(" + A[0] + "," + A[1] + "," + A[2] + "," + I[3] + ")"
              }
              if ("multiply_destinationAtop" === C) {
                  var V = Ej(bd(A))
                    , G = V[3]
                    , W = Ej(bd(l))
                    , Q = W[3]
                    , S = Ej(V)
                    , $ = S[3]
                    , n = V.map(function(Z, H) {
                      return Z * W[H]
                  })
                    , d = 1 - G
                    , g = 1 - Q
                    , h = g * G + Q;
                  return V = V.map(function(Z, O) {
                      return (Q * d * W[O] + Q * G * n[O] + g * G * Z) / h
                  }),
                  G = h,
                  d = 1 - G,
                  V = V.map(function(g, N) {
                      return ($ * S[N] * d + G * g * $) / $
                  }),
                  G = $,
                  "rgba(" + w(255 * V[0]) + "," + w(255 * V[1]) + "," + w(255 * V[2]) + "," + G + ")"
              }
              var I = bd(l);
              return A = Il(A),
              "rgba(" + w(A[0] * I[0]) + "," + w(A[1] * I[1]) + "," + w(A[2] * I[2]) + "," + A[3] / 255 * I[3] + ")"
          }
          return A
      }, Il = function() {
          var V, x = {};
          for (var C in W) {
              var n = wr.length;
              if (C.length == n && C[0] === wr[2] && C[1] === pk[1] && C[4] === wr[3] && C[5] === wr[4] && C.substr(n - 2) === pk[1] + pk[2]) {
                  var i = W[C];
                  for (var w in i)
                      w.length === n && w.substr(0, 3) === Gq[3] + mc[3] + Mk[0] && w.substr(n - 2) === wr[0] + Up[3] && (uc = i[w])
              }
          }
          return function(F) {
              var y, S = x[F];
              return S || (V || (V = Jl(),
              Uj(V, 1, 1, 1)),
              y = V.getContext("2d"),
              y.clearRect(0, 0, 1, 1),
              xg(y, 0, 0, 1, 1, F),
              S = y.getImageData(0, 0, 1, 1).data,
              S = x[F] = [S[0], S[1], S[2], S[3]]),
              S
          }
      }(), bd = function(Q) {
          if (!Xq(Q))
              return Q;
          var b = Il(Q);
          return b.CA || (b.CA = [b[0] / 255, b[1] / 255, b[2] / 255, b[3] / 255]),
          b.CA
      }, ci = function(d, x, o, b, X) {
          var n = Jl();
          n.width = o,
          n.height = b;
          var j = n.getContext("2d");
          j.drawImage(d, 0, 0, o, b);
          try {
              for (var q = j.getImageData(0, 0, o, b), t = q.data, k = 0, A = t.length; A > k; k += 4) {
                  var S = t[k + 0]
                    , J = t[k + 1]
                    , p = t[k + 2]
                    , P = t[k + 3];
                  "override_a" === X ? t[k + 3] = 255 * x[3] : "override_rgb" === X ? (t[k + 0] = 255 * x[0],
                  t[k + 1] = 255 * x[1],
                  t[k + 2] = 255 * x[2]) : "override" === X ? (t[k + 0] = 255 * x[0],
                  t[k + 1] = 255 * x[1],
                  t[k + 2] = 255 * x[2],
                  t[k + 3] = 255 * x[3]) : (t[k + 0] = x[0] * S,
                  t[k + 1] = x[1] * J,
                  t[k + 2] = x[2] * p,
                  t[k + 3] = x[3] * P)
              }
              j.putImageData(q, 0, 0)
          } catch (E) {
              return d
          }
          return n
      }, Zb = function(U, x, S) {
          return x && (x = "miter" === S ? 8 * x + 20 : x + 1,
          U && nk(U, x)),
          x
      }, Fl = function(v, j) {
          if (j) {
              var s = new Ck(j)
                , x = v.width / 2
                , q = v.height / 2
                , B = kr([s.tf(-x, -q), s.tf(x, -q), s.tf(x, q), s.tf(-x, q)]);
              return B.x += v.x + x,
              B.y += v.y + q,
              B
          }
          return v
      }, qh = function(m, i, e, b, Z, B, D, Y) {
          b *= Math.PI / 180;
          var S = {
              x: Math.cos(b) * (m.x - D.x) / 2 + Math.sin(b) * (m.y - D.y) / 2,
              y: -Math.sin(b) * (m.x - D.x) / 2 + Math.cos(b) * (m.y - D.y) / 2
          }
            , H = Math.pow(S.x, 2) / Math.pow(i, 2) + Math.pow(S.y, 2) / Math.pow(e, 2);
          H > 1 && (i *= Math.sqrt(H),
          e *= Math.sqrt(H));
          var k = (Z == B ? -1 : 1) * Math.sqrt((Math.pow(i, 2) * Math.pow(e, 2) - Math.pow(i, 2) * Math.pow(S.y, 2) - Math.pow(e, 2) * Math.pow(S.x, 2)) / (Math.pow(i, 2) * Math.pow(S.y, 2) + Math.pow(e, 2) * Math.pow(S.x, 2)));
          isNaN(k) && (k = 0);
          var C = {
              x: k * i * S.y / e,
              y: k * -e * S.x / i
          }
            , j = {
              x: (m.x + D.x) / 2 + Math.cos(b) * C.x - Math.sin(b) * C.y,
              y: (m.y + D.y) / 2 + Math.sin(b) * C.x + Math.cos(b) * C.y
          }
            , V = function(A) {
              return Math.sqrt(Math.pow(A[0], 2) + Math.pow(A[1], 2))
          }
            , G = function(w, n) {
              return (w[0] * n[0] + w[1] * n[1]) / (V(w) * V(n))
          }
            , T = function(p, P) {
              return (p[0] * P[1] < p[1] * P[0] ? -1 : 1) * Math.acos(G(p, P))
          }
            , v = T([1, 0], [(S.x - C.x) / i, (S.y - C.y) / e])
            , g = [(S.x - C.x) / i, (S.y - C.y) / e]
            , z = [(-S.x - C.x) / i, (-S.y - C.y) / e]
            , J = T(g, z);
          G(g, z) <= -1 && (J = Math.PI),
          G(g, z) >= 1 && (J = 0);
          var G = i > e ? i : e
            , I = i > e ? 1 : i / e
            , R = i > e ? e / i : 1;
          if (null == Y) {
              var l = {
                  x: 0,
                  y: 0,
                  width: 0,
                  height: 0
              };
              nk(l, G),
              l.x *= I,
              l.width *= I,
              l.y *= R,
              l.height *= R;
              var s = new Ck(b);
              return l = kr([s.tf(l.x, l.y), s.tf(l.x + l.width, l.y), s.tf(l.x + l.width, l.y + l.height), s.tf(l.x, l.y + l.height)]),
              l.x += j.x,
              l.y += j.y,
              [{
                  x: l.x,
                  y: l.y
              }, {
                  x: l.x + l.width,
                  y: l.y
              }, {
                  x: l.x + l.width,
                  y: l.y + l.height
              }, {
                  x: l.x,
                  y: l.y + l.height
              }]
          }
          Y.translate(j.x, j.y),
          Y.rotate(b),
          Y.scale(I, R),
          Y.arc(0, 0, G, v, v + J, 1 - B),
          Y.scale(1 / I, 1 / R),
          Y.rotate(-b),
          Y.translate(-j.x, -j.y)
      }, Om = function(I, M) {
          I && I.beginPath();
          for (var s, q, n, G = [], x = function(A) {
              for (var B, T = /(\-{0,1}[\d\.]+)/gi, I = []; B = T.exec(A); )
                  I.push(parseFloat(B[0]));
              return I
          }, z = /([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi, C = {
              x: 0,
              y: 0
          }; s = z.exec(M); ) {
              var c = s[0]
                , B = c.substr(0, 1);
              if ("M" === B || "m" === B) {
                  for (var U = x(c), k = 0; k < U.length; k += 2) {
                      var v = U[k]
                        , R = U[k + 1];
                      "m" === B && (v += C.x,
                      R += C.y),
                      I && I.moveTo(v, R),
                      G.push({
                          x: v,
                          y: R
                      }),
                      C.x = v,
                      C.y = R
                  }
                  q = n = null
              } else if ("H" === B || "h" === B) {
                  for (var U = x(c), k = 0; k < U.length; k += 1) {
                      var v = U[k];
                      "h" === B && (v += C.x),
                      I && I.lineTo(v, C.y),
                      G.push({
                          x: v,
                          y: C.y
                      }),
                      C.x = v
                  }
                  q = n = null
              } else if ("C" === B || "c" === B) {
                  for (var U = x(c), k = 0; k < U.length; k += 6) {
                      var H = U[k]
                        , e = U[k + 1]
                        , T = U[k + 2]
                        , S = U[k + 3]
                        , v = U[k + 4]
                        , R = U[k + 5];
                      "c" === B && (H += C.x,
                      e += C.y,
                      T += C.x,
                      S += C.y,
                      v += C.x,
                      R += C.y),
                      I && I.bezierCurveTo(H, e, T, S, v, R),
                      G.push({
                          x: H,
                          y: e
                      }),
                      G.push({
                          x: T,
                          y: S
                      }),
                      G.push({
                          x: v,
                          y: R
                      }),
                      C.x = v,
                      C.y = R
                  }
                  q = [H, e, T, S, v, R],
                  n = null
              } else if ("S" === B || "s" === B) {
                  for (var U = x(c), k = 0; k < U.length; k += 4) {
                      var H, e;
                      q ? (H = 2 * q[4] - q[2],
                      e = 2 * q[5] - q[3]) : (H = C.x,
                      e = C.y);
                      var T = U[k]
                        , S = U[k + 1]
                        , v = U[k + 2]
                        , R = U[k + 3];
                      "s" === B && (T += C.x,
                      S += C.y,
                      v += C.x,
                      R += C.y),
                      I && I.bezierCurveTo(H, e, T, S, v, R),
                      G.push({
                          x: H,
                          y: e
                      }),
                      G.push({
                          x: T,
                          y: S
                      }),
                      G.push({
                          x: v,
                          y: R
                      }),
                      C.x = v,
                      C.y = R
                  }
                  q = [H, e, T, S, v, R],
                  n = null
              } else if ("Q" === B || "q" === B) {
                  for (var U = x(c), k = 0; k < U.length; k += 4) {
                      var H = U[k]
                        , e = U[k + 1]
                        , v = U[k + 2]
                        , R = U[k + 3];
                      "q" === B && (H += C.x,
                      e += C.y,
                      v += C.x,
                      R += C.y),
                      I && I.quadraticCurveTo(H, e, v, R),
                      G.push({
                          x: H,
                          y: e
                      }),
                      G.push({
                          x: v,
                          y: R
                      }),
                      C.x = v,
                      C.y = R
                  }
                  q = null,
                  n = [H, e, v, R]
              } else if ("T" === B || "t" === B) {
                  for (var U = x(c), k = 0; k < U.length; k += 2) {
                      var H, e;
                      n ? (H = 2 * n[2] - n[0],
                      e = 2 * n[3] - n[1]) : (H = C.x,
                      e = C.y);
                      var v = U[k]
                        , R = U[k + 1];
                      "t" === B && (v += C.x,
                      R += C.y),
                      I && I.quadraticCurveTo(H, e, v, R),
                      G.push({
                          x: H,
                          y: e
                      }),
                      G.push({
                          x: v,
                          y: R
                      }),
                      C.x = v,
                      C.y = R
                  }
                  q = null,
                  n = [H, e, v, R]
              } else if ("V" === B || "v" === B) {
                  for (var U = x(c), k = 0; k < U.length; k += 1) {
                      var R = U[k];
                      "v" === B && (R += C.y),
                      I && I.lineTo(C.x, R),
                      G.push({
                          x: C.x,
                          y: R
                      }),
                      C.y = R
                  }
                  q = n = null
              } else if ("L" === B || "l" === B) {
                  for (var U = x(c), k = 0; k < U.length; k += 2) {
                      var v = U[k]
                        , R = U[k + 1];
                      "l" === B && (v += C.x,
                      R += C.y),
                      I && I.lineTo(v, R),
                      G.push({
                          x: v,
                          y: R
                      }),
                      C.x = v,
                      C.y = R
                  }
                  q = n = null
              } else if ("A" === B || "a" === B) {
                  for (var U = x(c), k = 0; k < U.length; k += 7) {
                      var Y = U[k]
                        , l = U[k + 1]
                        , p = U[k + 2]
                        , i = U[k + 3]
                        , E = U[k + 4]
                        , v = U[k + 5]
                        , R = U[k + 6];
                      "a" === B && (v += C.x,
                      R += C.y);
                      var u = qh(C, Y, l, p, i, E, {
                          x: v,
                          y: R
                      }, I);
                      u && (G = G.concat(u)),
                      C.x = v,
                      C.y = R
                  }
                  q = n = null
              }
              var P = c.substr(c.length - 1);
              ("z" === P || "Z" === P) && I && I.closePath()
          }
          return G
      }, Wq = function(c, g, E) {
          var H, o, n = "L" === g[0], l = g.length;
          c.save(),
          n ? (c.transform(g[5], g[6], g[7], g[8], g[9], g[10]),
          H = c.createLinearGradient(g[1], g[2], g[3], g[4]),
          o = 11) : (c.transform(g[7], g[8], g[9], g[10], g[11], g[12]),
          H = c.createRadialGradient(g[1], g[2], g[3], g[4], g[5], g[6]),
          o = 13);
          for (var S = c.compGray; l > o; ) {
              var q = g[o + 1];
              q = E(q),
              H.addColorStop(g[o], S ? M.toGrayColor(q) : q),
              o += 2
          }
          c.fillStyle = H
      }, _j = function(R, Z) {
          var O = R.s("shape.gradient.pack");
          if (O) {
              for (var _ = O.length, F = new Array(_), q = 0; _ > q; q++)
                  F[q] = O[q];
              var D, G, J, P, i, p, C, h, o, v, E, z, j, c = "L" === F[0];
              D = c ? 5 : 7,
              G = F[D],
              J = F[D + 1],
              P = F[D + 2],
              i = F[D + 3],
              p = F[D + 4],
              C = F[D + 5],
              h = Z[0],
              o = Z[1],
              v = Z[2],
              E = Z[3],
              z = Z[4],
              j = Z[5],
              F[D] = h * G + v * J,
              F[D + 1] = o * G + E * J,
              F[D + 2] = h * P + v * i,
              F[D + 3] = o * P + E * i,
              F[D + 4] = h * p + v * C + z,
              F[D + 5] = o * p + E * C + j,
              R.s("shape.gradient.pack", F)
          }
      }, Cc = function(g, p, B, i) {
          var t = !1;
          if (g.beginPath ? g.beginPath() : t = !0,
          fb(p) && (p = p._as),
          fb(B) && (B = B._as),
          B && B.length) {
              for (var J, e, q, L, R = 0, j = 0, O = B.length; O > j; j++)
                  J = B[j],
                  1 === J ? (e = p[R++],
                  g.moveTo(e.x, t ? -e.y : e.y)) : 2 === J ? (e = p[R++],
                  g.lineTo(e.x, t ? -e.y : e.y)) : 3 === J ? (e = p[R++],
                  q = p[R++],
                  g.quadraticCurveTo(e.x, t ? -e.y : e.y, q.x, t ? -q.y : q.y)) : 4 === J ? (e = p[R++],
                  q = p[R++],
                  L = p[R++],
                  g.bezierCurveTo(e.x, t ? -e.y : e.y, q.x, t ? -q.y : q.y, L.x, t ? -L.y : L.y)) : 5 === J && g.closePath();
              i && 5 !== J && g.closePath()
          } else {
              var K, Q, c, u = p.length;
              if (u > 0) {
                  for (K = p[0],
                  g.moveTo(K.x, t ? -K.y : K.y),
                  Q = 1; u > Q; Q++)
                      c = p[Q],
                      g.lineTo(c.x, t ? -c.y : c.y);
                  i && g.closePath()
              }
          }
      }, _q = function(M, f, g, Q) {
          if (fb(M) && (M = M._as),
          fb(f) && (f = f._as),
          f && f.length) {
              g = g || xi;
              for (var b, L, k, Y, F, T, x, V, J = [], W = E, B = 0, z = 0, h = f.length; h > z; z++)
                  if (b = f[z],
                  1 === b)
                      J.push(W = []),
                      W.push(M[B++]);
                  else if (2 === b)
                      W.push(M[B++]);
                  else if (3 === b) {
                      for (L = W[W.length - 1],
                      k = M[B++],
                      Y = M[B++],
                      T = 1; g > T; T++)
                          x = kq(T / g, L.x, k.x, Y.x),
                          V = kq(T / g, L.y, k.y, Y.y),
                          W.push({
                              x: x,
                              y: V,
                              b: !0
                          });
                      W.push(Y)
                  } else if (4 === b) {
                      for (L = W[W.length - 1],
                      k = M[B++],
                      Y = M[B++],
                      F = M[B++],
                      T = 1; g > T; T++)
                          x = xo(T / g, L.x, k.x, Y.x, F.x),
                          V = xo(T / g, L.y, k.y, Y.y, F.y),
                          W.push({
                              x: x,
                              y: V,
                              b: !0
                          });
                      W.push(F)
                  } else
                      5 === b && W.push(W[0]);
              return Q && 5 !== b && W && W.length > 2 && W.push(W[0]),
              J
          }
          return Q && M.length > 2 && (M = M.slice(),
          M.push(M[0])),
          M ? [M] : []
      }, Zo = function(J, P, Z, q, L, s) {
          var Q, k, r, M = Il(P), F = q, O = M[0], g = M[1], V = M[2];
          if (Z) {
              var f = Il(Z);
              Q = f[0] - O,
              k = f[1] - g,
              r = f[2] - V
          } else
              Q = 255 - O,
              k = 255 - g,
              r = 255 - V;
          for (s || (s = q > 10 ? 1 : .5,
          s = 1 > L ? K(s / L, 2) : s),
          J.save(),
          J.shadowOffsetX = 0,
          J.shadowOffsetY = 0,
          J.shadowBlur = 0,
          J.shadowColor = 0; (q -= s) > 0; ) {
              var E = 1 - q / F
                , X = O + Q * E
                , G = g + k * E
                , o = V + r * E;
              X = K(z(X), 255),
              G = K(z(G), 255),
              o = K(z(o), 255),
              J.strokeStyle = "rgb(" + X + "," + G + "," + o + ")",
              J.lineWidth = q,
              J.stroke()
          }
          J.restore()
      }, ur = function() {
          var T = {};
          return function(I, _) {
              var p = I + "-" + _
                , Y = T[p];
              if (Y)
                  return Y;
              var x, v, $, A = Il(I);
              return 0 > _ ? (_ = (100 + _) / 100,
              x = z(A[0] * _),
              v = z(A[1] * _),
              $ = z(A[2] * _)) : (_ /= 100,
              x = A[0],
              v = A[1],
              $ = A[2],
              x += (255 - x) * _,
              v += (255 - v) * _,
              $ += (255 - $) * _,
              x = K(z(x), 255),
              v = K(z(v), 255),
              $ = K(z($), 255)),
              T[p] = "rgb(" + x + "," + v + "," + $ + ")"
          }
      }(), xg = function($, q, P, i, h, r) {
          r && ($.fillStyle = r),
          $.beginPath(),
          $.rect(q, P, i, h),
          $.fill()
      }, Cr = function(r, M, d, B, k, m, E) {
          r.beginPath(),
          sc[M](r, d.x, d.y, d.width, d.height, B, k, m, E)
      }, eq = function(V, Y, g, o, s) {
          var a = sc[g];
          V.fillStyle = a ? a(V, Y, o ? o : Pp, s.x, s.y, s.width, s.height) : Y
      }, Ji = function(T, i, r, z, D, u) {
          T.fillStyle = dd(T, i, r, z, D, u)
      }, Nb = function(K, i, V, m, e, o) {
          K.strokeStyle = dd(K, i, V, m, e, o)
      }, dd = function(C, m, $, A, Q, R) {
          var d;
          try {
              if (!m.tagName && m.comps) {
                  m._cacheImage_ || (m._cacheImage_ = {});
                  var F;
                  F = "override" === A ? "colors_override" : "override_rgb" === A ? "colors_override_rgb" : "override_a" === A ? "colors_override_a" : "colors",
                  m._cacheImage_[F] || (m._cacheImage_[F] = {
                      __count__: 0
                  });
                  var O = m._cacheImage_[F][$];
                  O || (m._cacheImage_[F].__count__ > M.imageCacheThreshold && (m._cacheImage_[F] = {
                      __count__: 0
                  }),
                  O = n.Default.toCanvas(m, Aj(m), Xc(m), null, Q, R, $, null, A),
                  m._cacheImage_[F][$] = O,
                  m._cacheImage_[F].__count__++),
                  m = O
              }
              d = C.createPattern(m, "repeat")
          } catch (P) {
              d = "black"
          }
          return d
      }, ar = function(N) {
          var C, v, c = [], b = 0, E = N.length;
          for (C = 0; 65 > C; C++)
              c[C] = C;
          for (C = 0; 65 > C; C++)
              b = (b + c[C] + N.charCodeAt(C % E)) % 65,
              v = c[C],
              c[C] = c[b],
              c[b] = v;
          for (C = 0; 65 > C; C++)
              c[C] = gm[c[C]];
          return c.join("")
      }, df = function(V) {
          for (var h = 8 + rk.randomInt(8), N = gm[8 * rk.randomInt(8) + (h - 8)], R = "", S = 0; h > S; S++)
              R += gm[rk.randomInt(64)];
          var O = ar(R + p + Mp + Fi);
          return N + R + Of.encode(V, O)
      }, md = function(r) {
          var K = r[0]
            , c = gm.indexOf(K);
          if (0 > c)
              return "";
          c = 8 + (7 & c);
          var L = r.slice(1, 1 + c)
            , D = ar(L + p + Mp + Fi);
          return Of.decode(r, D, 1 + c)
      }, Xh = function($, c, d, x, v, a, u) {
          $.save(),
          $.translate(c, d),
          $.scale(1, u / a),
          $.arc(0, 0, a, x, v),
          $.restore()
      }, In = function(J, c, $, N, V, A, E, t) {
          var S, j, f, G, b, v, p, I, y, Y, T;
          if (u(V) > 2 * s && (V = 2 * s),
          b = z(u(V) / (s / 4)),
          S = V / b,
          j = -S,
          f = -N,
          b > 0) {
              v = c + P(N) * A,
              p = $ + o(-N) * E,
              t ? J.lineTo(v, p) : J.moveTo(v, p);
              for (var d = 0; b > d; d++)
                  f += j,
                  G = f - j / 2,
                  I = c + P(f) * A,
                  y = $ + o(f) * E,
                  Y = c + P(G) * (A / P(j / 2)),
                  T = $ + o(G) * (E / P(j / 2)),
                  J.quadraticCurveTo(Y, T, I, y)
          }
      }, ws = function(L, z, K, U, W, q, e, O, D) {
          6 === arguments.length && (e = q,
          O = q,
          D = q);
          var p = z + U
            , S = K + W
            , r = W > U ? 2 * U : 2 * W;
          q = r > q ? q : r,
          e = r > e ? e : r,
          O = r > O ? O : r,
          D = r > D ? D : r;
          var f = .29 * D
            , s = .58 * D;
          L.moveTo(p, S - D),
          L.quadraticCurveTo(p, S - s, p - f, S - f),
          L.quadraticCurveTo(p - s, S, p - D, S),
          f = .29 * O,
          s = .58 * O,
          L.lineTo(z + O, S),
          L.quadraticCurveTo(z + s, S, z + f, S - f),
          L.quadraticCurveTo(z, S - s, z, S - O),
          f = .29 * q,
          s = .58 * q,
          L.lineTo(z, K + q),
          L.quadraticCurveTo(z, K + s, z + f, K + f),
          L.quadraticCurveTo(z + s, K, z + q, K),
          f = .29 * e,
          s = .58 * e,
          L.lineTo(p - e, K),
          L.quadraticCurveTo(p - s, K, p - f, K + f),
          L.quadraticCurveTo(p, K + s, p, K + e),
          L.lineTo(p, S - D)
      }, Ri = function($, M, G, E, f, Y, q) {
          M && (G = w(G),
          E = w(E),
          q || (q = 1),
          $.fillStyle = M,
          $.beginPath(),
          $.rect(G, E, q, Y),
          $.rect(G, E, f, q),
          Y - q > 0 && $.rect(G, E + Y - q, f, q),
          f - q > 0 && $.rect(G + f - q, E, q, Y),
          $.fill())
      }, Kk = function(U, Z, Q, g) {
          var i = g.x
            , a = g.y
            , q = g.width
            , c = g.height;
          if (!(!Z || !Q || 0 >= q || 0 >= c)) {
              var v, s = Dd(Z), P = Oo(Z), E = Q > 0;
              1 === Q || -1 === Q ? (U.fillStyle = E ? s : P,
              U.beginPath(),
              U.rect(i, a, 1, c),
              U.rect(i, a, q, 1),
              U.fill(),
              U.fillStyle = E ? P : s,
              U.beginPath(),
              U.rect(i, a + c - 1, q, 1),
              U.rect(i + q - 1, a, 1, c),
              U.fill()) : (Q = K(u(Q), K(q / 2, c / 2)),
              v = U.createLinearGradient(i, a, i + Q, a),
              v.addColorStop(0, E ? s : P),
              v.addColorStop(1, Z),
              U.fillStyle = v,
              U.beginPath(),
              U.moveTo(i, a),
              U.lineTo(i + Q, a + Q),
              U.lineTo(i + Q, a + c - Q),
              U.lineTo(i, a + c),
              U.lineTo(i, a),
              U.fill(),
              v = U.createLinearGradient(i, a, i, a + Q),
              v.addColorStop(0, E ? s : P),
              v.addColorStop(1, Z),
              U.fillStyle = v,
              U.beginPath(),
              U.moveTo(i, a),
              U.lineTo(i + Q, a + Q),
              U.lineTo(i + q - Q, a + Q),
              U.lineTo(i + q, a),
              U.lineTo(i, a),
              U.fill(),
              v = U.createLinearGradient(i, a + c, i, a + c - Q),
              v.addColorStop(0, E ? P : s),
              v.addColorStop(1, Z),
              U.fillStyle = v,
              U.beginPath(),
              U.moveTo(i, a + c),
              U.lineTo(i + Q, a + c - Q),
              U.lineTo(i + q - Q, a + c - Q),
              U.lineTo(i + q, a + c),
              U.lineTo(i, a + c),
              U.fill(),
              v = U.createLinearGradient(i + q, a, i + q - Q, a),
              v.addColorStop(0, E ? P : s),
              v.addColorStop(1, Z),
              U.fillStyle = v,
              U.beginPath(),
              U.moveTo(i + q, a),
              U.lineTo(i + q - Q, a + Q),
              U.lineTo(i + q - Q, a + c - Q),
              U.lineTo(i + q, a + c),
              U.lineTo(i + q, a),
              U.fill())
          }
      }, mp = function(A, g, V, n, i, u, H) {
          var m = A.createLinearGradient(n, i, u, H);
          return m.addColorStop(0, V),
          m.addColorStop(1, g),
          m
      }, Cq = function(O, X, d, R, e, l, $) {
          var W = O.createLinearGradient(R, e, l, $);
          return W.addColorStop(0, X),
          W.addColorStop(.5, d),
          W.addColorStop(1, X),
          W
      }, ps = function(s, C, f, A, q, b, M) {
          var o = s.createLinearGradient(A, q, b, M);
          return o.addColorStop(0, C),
          o.addColorStop(1 / 3, f),
          o.addColorStop(2 / 3, C),
          o.addColorStop(1, f),
          o
      }, Jc = function(Y, x, m, Q, Z, I, b, P, R) {
          var B = Y.createRadialGradient(Q + I * P, Z + b * R, K(I, b) / 24, Q + I / 2, Z + b / 2, X(I, b) / 2);
          return B.addColorStop(0, m),
          B.addColorStop(1, x),
          B
      }, Uh = [0, -1, .22451398828979272, -.30901699437494734, .9510565162951535, -.30901699437494745, .3632712640026804, .11803398874989468, .5877852522924731, .8090169943749473, -1.1102230246251565e-16, .38196601125010515, -.587785252292473, .8090169943749475, -.3632712640026805, .1180339887498949, -.9510565162951536, -.3090169943749473, -.22451398828979285, -.30901699437494734], sc = {
          polygon: function($, B, Q, l, v, e) {
              (e == E || 3 > e) && (e = 6);
              for (var k, W, q = K(l, v) / 2, T = B + l / 2, m = Q + v / 2, h = 0, p = 2 * s / e, y = 0; e > y; y++)
                  k = T + P(h) * q,
                  W = m + o(h) * q,
                  0 === y ? $.moveTo(k, W) : $.lineTo(k, W),
                  h += p;
              $.closePath()
          },
          arc: function(_, I, Z, B, G, O, q, J, R) {
              O == E && (O = s),
              q == E && (q = y),
              J == E && (J = !0);
              var e = I + B / 2
                , f = Z + G / 2;
              J && _.moveTo(e, f),
              R ? Xh(_, e, f, O, q, B / 2, G / 2) : _.arc(e, f, K(B, G) / 2, O, q),
              J && _.closePath()
          },
          rect: function(R, N, W, g, i) {
              R.rect(N, W, g, i)
          },
          circle: function(f, Y, O, s, c) {
              f.arc(Y + s / 2, O + c / 2, K(s, c) / 2, 0, y, !0)
          },
          oval: function(u, s, M, e, A) {
              Xh(u, s + e / 2, M + A / 2, 0, y, e / 2, A / 2)
          },
          roundRect: function(c, p, u, O, A, C) {
              C == E && (C = K(K(O, A) / 4, 8)),
              ws(c, p, u, O, A, C)
          },
          star: function(h, V, e, d, H) {
              var N = 2 * d
                , R = 2 * H
                , t = V + d / 2
                , w = e + H / 2;
              h.moveTo(t - N / 4, w - R / 12),
              h.lineTo(V + .306 * d, e + .579 * H),
              h.lineTo(t - N / 6, w + R / 4),
              h.lineTo(V + d / 2, e + .733 * H),
              h.lineTo(t + N / 6, w + R / 4),
              h.lineTo(V + .693 * d, e + .579 * H),
              h.lineTo(t + N / 4, w - R / 12),
              h.lineTo(V + .611 * d, e + .332 * H),
              h.lineTo(t + 0, w - R / 4),
              h.lineTo(V + .388 * d, e + .332 * H),
              h.closePath()
          },
          pentagram: function(m, W, p, d, D) {
              var O = .5 * D
                , N = W + .5 * d
                , b = p + O
                , w = .5257311121191336 * d;
              w > O && (w = O);
              var G = Uh
                , F = 0;
              for (m.moveTo(N + w * G[F++], b + w * G[F++]); 20 > F; )
                  m.lineTo(N + w * G[F++], b + w * G[F++]);
              m.closePath()
          },
          triangle: function(c, w, x, Z, G) {
              c.moveTo(w + Z / 2, x),
              c.lineTo(w + Z, x + G),
              c.lineTo(w, x + G),
              c.closePath()
          },
          hexagon: function(Y, w, r, x, U) {
              Y.moveTo(w, r + U / 2),
              Y.lineTo(w + x / 4, r + U),
              Y.lineTo(w + 3 * x / 4, +r + U),
              Y.lineTo(w + x, r + U / 2),
              Y.lineTo(w + 3 * x / 4, r),
              Y.lineTo(w + x / 4, r),
              Y.closePath()
          },
          pentagon: function(f, E, T, h, W) {
              var k = 2 * h
                , m = 2 * W
                , c = E + h / 2
                , x = T + W / 2;
              f.moveTo(c - k / 4, x - m / 12),
              f.lineTo(c - k / 6, x + m / 4),
              f.lineTo(c + k / 6, x + m / 4),
              f.lineTo(c + k / 4, x - m / 12),
              f.lineTo(c + 0, x - m / 4),
              f.closePath()
          },
          diamond: function(I, Q, N, e, g) {
              I.moveTo(Q + e / 2, N),
              I.lineTo(Q, N + g / 2),
              I.lineTo(Q + e / 2, N + g),
              I.lineTo(Q + e, N + g / 2),
              I.closePath()
          },
          rightTriangle: function(s, S, q, w, V) {
              s.moveTo(S, q),
              s.lineTo(S + w, q + V),
              s.lineTo(S, q + V),
              s.closePath()
          },
          parallelogram: function(Q, E, k, Z, q) {
              var l = Z / 4;
              Q.moveTo(E + l, k),
              Q.lineTo(E + Z, k),
              Q.lineTo(E + Z - l, k + q),
              Q.lineTo(E, k + q),
              Q.closePath()
          },
          trapezoid: function(B, Z, W, p, b) {
              var n = p / 4;
              B.moveTo(Z + n, W),
              B.lineTo(Z + p - n, W),
              B.lineTo(Z + p, W + b),
              B.lineTo(Z, W + b),
              B.closePath()
          },
          "linear.southwest": function(Q, z, J, t, M, C, P) {
              return mp(Q, z, J, t, M + P, t + C, M)
          },
          "linear.southeast": function(P, w, N, b, O, B, X) {
              return mp(P, w, N, b + B, O + X, b, O)
          },
          "linear.northwest": function(C, i, x, V, m, Q, l) {
              return mp(C, i, x, V, m, V + Q, m + l)
          },
          "linear.northeast": function(O, a, s, B, u, t, R) {
              return mp(O, a, s, B + t, u, B, u + R)
          },
          "linear.north": function(k, w, i, K, B, R, b) {
              return mp(k, w, i, K, B, K, B + b)
          },
          "linear.south": function(j, M, R, W, i, C, $) {
              return mp(j, M, R, W, i + $, W, i)
          },
          "linear.west": function(O, D, b, _, l, x) {
              return mp(O, D, b, _, l, _ + x, l)
          },
          "linear.east": function(A, H, e, N, K, R) {
              return mp(A, H, e, N + R, K, N, K)
          },
          "radial.center": function(k, H, P, J, I, V, u) {
              return Jc(k, H, P, J, I, V, u, .5, .5)
          },
          "radial.southwest": function(h, Q, u, X, t, i, p) {
              return Jc(h, Q, u, X, t, i, p, .25, .75)
          },
          "radial.southeast": function(r, Z, d, y, w, L, f) {
              return Jc(r, Z, d, y, w, L, f, .75, .75)
          },
          "radial.northwest": function(K, h, E, N, D, Q, O) {
              return Jc(K, h, E, N, D, Q, O, .25, .25)
          },
          "radial.northeast": function(q, v, i, e, J, d, F) {
              return Jc(q, v, i, e, J, d, F, .75, .25)
          },
          "radial.north": function(p, f, T, Q, k, q, D) {
              return Jc(p, f, T, Q, k, q, D, .5, .25)
          },
          "radial.south": function(j, w, q, e, y, Y, M) {
              return Jc(j, w, q, e, y, Y, M, .5, .75)
          },
          "radial.west": function(Q, C, l, z, m, a, p) {
              return Jc(Q, C, l, z, m, a, p, .25, .5)
          },
          "radial.east": function(T, F, o, X, S, A, q) {
              return Jc(T, F, o, X, S, A, q, .75, .5)
          },
          "spread.horizontal": function(z, A, h, U, f, X) {
              return Cq(z, A, h, U, f, U + X, f)
          },
          "spread.vertical": function(h, R, c, H, U, r, t) {
              return Cq(h, R, c, H, U, H, U + t)
          },
          "spread.diagonal": function(K, i, g, b, M, y, z) {
              return Cq(K, i, g, b + y, M, b, M + z)
          },
          "spread.antidiagonal": function(P, y, H, R, K, t, n) {
              return Cq(P, y, H, R, K, R + t, K + n)
          },
          "spread.north": function(E, K, J, x, f, l, t) {
              return ps(E, K, J, x, f - t / 4, x, f + t + t / 4)
          },
          "spread.south": function(F, P, l, X, t, j, s) {
              return ps(F, l, P, X, t - s / 4, X, t + s + s / 4)
          },
          "spread.west": function(T, U, i, K, g, w) {
              return ps(T, U, i, K - w / 4, g, K + w + w / 4, g)
          },
          "spread.east": function(n, G, S, D, e, s) {
              return ps(n, S, G, D - s / 4, e, D + s + s / 4, e)
          }
      }, Fp = function(J, i, F) {
          return new Ck(J).tf(i, F)
      }, fd = function(r) {
          var e = r.touches[0]
            , n = r.touches[1]
            , K = e.clientX
            , S = e.clientY
            , i = n.clientX
            , h = n.clientY;
          return O((K - i) * (K - i) + (S - h) * (S - h))
      }, Rj = function(o) {
          var Z = o.touches[0]
            , l = o.touches[1]
            , H = Z.clientX
            , F = Z.clientY
            , j = l.clientX
            , A = l.clientY;
          return {
              x: (H + j) / 2,
              y: (F + A) / 2
          }
      }, kf = (function() {
          for (var H = 0, B = Fd.split(""), e = 0; e < B.length; e++)
              H = 10 * $n(B[e]) + H;
          return ie(W[Ah.toString(8 * e) + _r.substr(e) + 3], W[Ah.toString(8 * e) + _r.substr(e) + 4]),
          H
      }(),
      function(Z, r, p) {
          for (var D = 0; D < p.size(); D++) {
              var i = p.get(D);
              Z.co(i) && r.add(i)
          }
          for (D = 0; D < p.size(); D++)
              i = p.get(D),
              kf(Z, r, i._children)
      }
      ), Gc = function(I, F, J) {
          for (var L = 0; L < J.size(); L++) {
              var S = J.get(J.size() - 1 - L);
              I.co(S) && F.add(S)
          }
          for (L = 0; L < J.size(); L++)
              S = J.get(L),
              Gc(I, F, S._children)
      }, fi = function($, u, c) {
          for (var b = !1, V = 0; V < c.size(); V++) {
              var B = c.get(V);
              $.co(B) ? b && u.add(B) : b = 1
          }
          for (V = 0; V < c.size(); V++)
              B = c.get(V),
              fi($, u, B._children)
      }, ye = function(g, V, S) {
          for (var k = !1, p = 0; p < S.size(); p++) {
              var i = S.get(S.size() - 1 - p);
              g.co(i) ? k && V.add(i) : k = !0
          }
          for (p = 0; p < S.size(); p++)
              i = S.get(p),
              ye(g, V, i._children)
      }, Lc = M.moveDatas = function(h, J, e, M) {
          var b = M == E;
          if (0 !== J || 0 !== e || !b && 0 !== M) {
              var T = !0
                , L = [];
              if (h.forEach(function(U) {
                  T && (U._69O || ks(U) || Np(U)) && (T = !1)
              }),
              T)
                  L = h;
              else {
                  var H = {}
                    , y = {};
                  h.forEach(function(L) {
                      H[L._id] = !0
                  });
                  var u = {}
                    , s = function(r) {
                      var $ = r._id;
                      return H[$] ? (L.push(r),
                      u[$] = !0) : u[$] = !1
                  }
                    , P = function(N) {
                      var Y = N._id;
                      if (y[Y])
                          return s(N);
                      var K = u[Y];
                      if (K !== V)
                          return K;
                      var k = N._parent;
                      if (k && (Np(k) || ks(k)) && P(k))
                          return u[Y] = !0;
                      var x = N._host;
                      return x && (y[Y] = Y,
                      K = P(x),
                      y[Y] = V,
                      K) ? u[Y] = !0 : s(N)
                  };
                  h.forEach(function(W) {
                      P(W)
                  })
              }
              L.forEach(function(K) {
                  if (ud(K))
                      b ? K.translate(J, e) : K.translate3d(J, e, M);
                  else {
                      var p = K.s(ri);
                      if (!p || p.isEmpty())
                          return;
                      var j = new Mh;
                      p.each(function(y) {
                          y = Ej(y),
                          b ? (y.x += J,
                          y.y += e) : (y.x += J,
                          y.y += M,
                          y.e == E ? y.e = e : y.e += e),
                          j.add(y)
                      }),
                      K.s(ri, j)
                  }
              })
          }
      }
      , Fr = function() {
          function F(U, Q) {
              return Q === U.substring(0, Q.length) ? !0 : !1
          }
          function r(N) {
              return parseFloat(N) || 0
          }
          function G(K, l) {
              if (l == V && (l = new Sc),
              F(K, "matrix3d")) {
                  var U = K.substring(9, K.length - 1).split(",");
                  U = U.map(r),
                  l.fromArray(U)
              } else if (F(K, "matrix")) {
                  var U = K.substring(7, K.length - 1).split(",");
                  U = U.map(r),
                  l.el[0] = U[0],
                  l.el[1] = U[1],
                  l.el[2] = 0,
                  l.el[3] = 0,
                  l.el[4] = U[2],
                  l.el[5] = U[3],
                  l.el[6] = 0,
                  l.el[7] = 0,
                  l.el[8] = 0,
                  l.el[9] = 0,
                  l.el[10] = 1,
                  l.el[11] = 0,
                  l.el[12] = U[4],
                  l.el[13] = U[5],
                  l.el[14] = 0,
                  l.el[15] = 1
              }
              return l
          }
          function P(H, C) {
              C == V && (C = new Rh);
              var d = H.split(/\s+/);
              return d = d.map(r),
              C.set(d[0] || 0, d[1] || 0, d[2] || 0),
              C
          }
          var h, W, b, m, H, g = function(j, q) {
              h || (h = new Sc,
              W = new Rh,
              b = new Sc,
              m = new Sc,
              H = new Sc),
              q == V && (q = new Sc);
              var l = getComputedStyle(j);
              l.transform && "none" !== l.transform && (G(l.transform, h),
              P(l.transformOrigin, W),
              m.setPosition(W),
              W.negate(),
              H.setPosition(W),
              (Di || "preserve-3d" !== l.transformStyle) && (h.el[8] = 0,
              h.el[9] = 0,
              h.el[10] = 1,
              h.el[11] = 0),
              q.multiplyMatrices(H, q),
              q.multiplyMatrices(h, q),
              q.multiplyMatrices(m, q)),
              !Di && l.perspective && "none" !== l.perspective && (b.el[11] = -1 / r(l.perspective),
              P(l.perspectiveOrigin, W),
              m.setPosition(W),
              W.negate(),
              H.setPosition(W),
              q.multiplyMatrices(H, q),
              q.multiplyMatrices(b, q),
              q.multiplyMatrices(m, q));
              for (var N = j.offsetParent, F = j.offsetLeft, Z = j.offsetTop, A = j.parentElement; A && A !== N; ) {
                  var y = getComputedStyle(A);
                  if ("none" !== y.transform || "none" !== y.perspective)
                      break;
                  A = A.parentElement
              }
              return A == V && j !== j.ownerDocument.documentElement && "fixed" !== l.position && (A = j.ownerDocument.documentElement),
              N != V && N !== A && (F -= A.offsetLeft,
              Z -= A.offsetTop),
              W.set(F, Z, 0),
              m.setPosition(W),
              q.multiplyMatrices(m, q),
              A && g(A, q),
              q
          };
          return function(z, r) {
              var j = z.parentElement;
              if (j) {
                  var _ = j.updateAppendMatrix;
                  if (_) {
                      delete j.updateAppendMatrix;
                      var S = new Sc;
                      g(j, S);
                      var x = new Sc;
                      x.getInverse(S),
                      j._matrixAppend = x,
                      j._maxrixPreAppend = S
                  }
                  return r ? j._matrixAppend : j._maxrixPreAppend
              }
          }
      }(), $l = function(J, t) {
          for (; J && !J.hasOwnProperty(t); )
              J = G.getPrototypeOf(J);
          return J && G.getOwnPropertyDescriptor(J, t)
      }, qs = G.getPrototypeOf ? function(j, v, s) {
          var D = $l(v, s);
          D && G.defineProperty(j, s, D)
      }
      : function(M, F, P) {
          M[P] = F[P]
      }
      , Kl = {
          1: 29,
          2: 30,
          3: 31,
          4: 32,
          5: 33,
          6: 26,
          7: 27,
          8: 28,
          9: 21,
          10: 22,
          11: 23,
          12: 24,
          13: 25,
          14: 14,
          15: 15,
          16: 16,
          17: 17,
          18: 18,
          19: 19,
          20: 20,
          21: 9,
          22: 10,
          23: 11,
          24: 12,
          25: 13,
          26: 6,
          27: 7,
          28: 8,
          29: 1,
          30: 2,
          31: 3,
          32: 4,
          33: 5,
          34: 36,
          35: 37,
          36: 34,
          37: 35,
          38: 54,
          39: 55,
          40: 52,
          41: 53,
          42: 50,
          43: 51,
          44: 49,
          50: 42,
          51: 43,
          52: 40,
          53: 41,
          54: 38,
          55: 39
      }, Eo = function() {
          var u = {
              1: function(b, U) {
                  return {
                      x: b.x - U.width / 2,
                      y: b.y - U.height / 2
                  }
              },
              2: function(Q, M) {
                  return {
                      x: Q.x + M.width / 2,
                      y: Q.y - M.height / 2
                  }
              },
              3: function(j, Z) {
                  return {
                      x: j.x + j.width / 2,
                      y: j.y - Z.height / 2
                  }
              },
              4: function(o, A) {
                  return {
                      x: o.x + o.width - A.width / 2,
                      y: o.y - A.height / 2
                  }
              },
              5: function(p, N) {
                  return {
                      x: p.x + p.width + N.width / 2,
                      y: p.y - N.height / 2
                  }
              },
              6: function(o) {
                  return {
                      x: o.x,
                      y: o.y
                  }
              },
              7: function(S) {
                  return {
                      x: S.x + S.width / 2,
                      y: S.y
                  }
              },
              8: function(h) {
                  return {
                      x: h.x + h.width,
                      y: h.y
                  }
              },
              9: function(L, P) {
                  return {
                      x: L.x - P.width / 2,
                      y: L.y + P.height / 2
                  }
              },
              10: function($, K) {
                  return {
                      x: $.x + K.width / 2,
                      y: $.y + K.height / 2
                  }
              },
              11: function(J, r) {
                  return {
                      x: J.x + J.width / 2,
                      y: J.y + r.height / 2
                  }
              },
              12: function(j, M) {
                  return {
                      x: j.x - M.width / 2 + j.width,
                      y: j.y + M.height / 2
                  }
              },
              13: function(K, T) {
                  return {
                      x: K.x + K.width + T.width / 2,
                      y: K.y + T.height / 2
                  }
              },
              14: function(z, u) {
                  return {
                      x: z.x - u.width / 2,
                      y: z.y + z.height / 2
                  }
              },
              15: function(c) {
                  return {
                      x: c.x,
                      y: c.y + c.height / 2
                  }
              },
              16: function(k, o) {
                  return {
                      x: k.x + o.width / 2,
                      y: k.y + k.height / 2
                  }
              },
              17: function(G) {
                  return {
                      x: G.x + G.width / 2,
                      y: G.y + G.height / 2
                  }
              },
              18: function(W, L) {
                  return {
                      x: W.x + W.width - L.width / 2,
                      y: W.y + W.height / 2
                  }
              },
              19: function($) {
                  return {
                      x: $.x + $.width,
                      y: $.y + $.height / 2
                  }
              },
              20: function(w, d) {
                  return {
                      x: w.x + w.width + d.width / 2,
                      y: w.y + w.height / 2
                  }
              },
              21: function(f, z) {
                  return {
                      x: f.x - z.width / 2,
                      y: f.y + f.height - z.height / 2
                  }
              },
              22: function(x, U) {
                  return {
                      x: x.x + U.width / 2,
                      y: x.y + x.height - U.height / 2
                  }
              },
              23: function(S, n) {
                  return {
                      x: S.x + S.width / 2,
                      y: S.y + S.height - n.height / 2
                  }
              },
              24: function(p, K) {
                  return {
                      x: p.x + p.width - K.width / 2,
                      y: p.y + p.height - K.height / 2
                  }
              },
              25: function(c, V) {
                  return {
                      x: c.x + c.width + V.width / 2,
                      y: c.y + c.height - V.height / 2
                  }
              },
              26: function(I) {
                  return {
                      x: I.x,
                      y: I.y + I.height
                  }
              },
              27: function(m) {
                  return {
                      x: m.x + m.width / 2,
                      y: m.y + m.height
                  }
              },
              28: function(k) {
                  return {
                      x: k.x + k.width,
                      y: k.y + k.height
                  }
              },
              29: function(j, t) {
                  return {
                      x: j.x - t.width / 2,
                      y: j.y + j.height + t.height / 2
                  }
              },
              30: function(K, z) {
                  return {
                      x: K.x + z.width / 2,
                      y: K.y + K.height + z.height / 2
                  }
              },
              31: function(z, G) {
                  return {
                      x: z.x + z.width / 2,
                      y: z.y + z.height + G.height / 2
                  }
              },
              32: function(L, G) {
                  return {
                      x: L.x + L.width - G.width / 2,
                      y: L.y + L.height + G.height / 2
                  }
              },
              33: function(T, o) {
                  return {
                      x: T.x + T.width + o.width / 2,
                      y: T.y + T.height + o.height / 2
                  }
              },
              34: function(F, x) {
                  return {
                      x: F.x,
                      y: F.y - x.height / 2
                  }
              },
              35: function(H, F) {
                  return {
                      x: H.x + H.width,
                      y: H.y - F.height / 2
                  }
              },
              36: function(i, U) {
                  return {
                      x: i.x,
                      y: i.y + i.height + U.height / 2
                  }
              },
              37: function(h, w) {
                  return {
                      x: h.x + h.width,
                      y: h.y + h.height + w.height / 2
                  }
              },
              38: function(D, Y) {
                  return {
                      x: D.x + D.width / 4,
                      y: D.y - Y.height / 2
                  }
              },
              39: function(A, H) {
                  return {
                      x: A.x + 3 * A.width / 4,
                      y: A.y - H.height / 2
                  }
              },
              40: function(x) {
                  return {
                      x: x.x + x.width / 4,
                      y: x.y
                  }
              },
              41: function(S) {
                  return {
                      x: S.x + 3 * S.width / 4,
                      y: S.y
                  }
              },
              42: function(o, Z) {
                  return {
                      x: o.x + o.width / 4,
                      y: o.y + Z.height / 2
                  }
              },
              43: function(L, F) {
                  return {
                      x: L.x + 3 * L.width / 4,
                      y: L.y + F.height / 2
                  }
              },
              44: function(N, U) {
                  return {
                      x: N.x + N.width / 2,
                      y: N.y + N.height / 2 - U.height / 2
                  }
              },
              45: function(Q) {
                  return {
                      x: Q.x + Q.width / 4,
                      y: Q.y + Q.height / 2
                  }
              },
              46: function(v, o) {
                  return {
                      x: v.x + v.width / 2 - o.width / 2,
                      y: v.y + v.height / 2
                  }
              },
              47: function(S, F) {
                  return {
                      x: S.x + S.width / 2 + F.width / 2,
                      y: S.y + S.height / 2
                  }
              },
              48: function(L) {
                  return {
                      x: L.x + 3 * L.width / 4,
                      y: L.y + L.height / 2
                  }
              },
              49: function(r, z) {
                  return {
                      x: r.x + r.width / 2,
                      y: r.y + r.height / 2 + z.height / 2
                  }
              },
              50: function(l, I) {
                  return {
                      x: l.x + l.width / 4,
                      y: l.y + l.height - I.height / 2
                  }
              },
              51: function(j, O) {
                  return {
                      x: j.x + 3 * j.width / 4,
                      y: j.y + j.height - O.height / 2
                  }
              },
              52: function(o) {
                  return {
                      x: o.x + o.width / 4,
                      y: o.y + o.height
                  }
              },
              53: function(g) {
                  return {
                      x: g.x + 3 * g.width / 4,
                      y: g.y + g.height
                  }
              },
              54: function($, q) {
                  return {
                      x: $.x + $.width / 4,
                      y: $.y + $.height + q.height / 2
                  }
              },
              55: function(W, r) {
                  return {
                      x: W.x + 3 * W.width / 4,
                      y: W.y + W.height + r.height / 2
                  }
              }
          };
          return xh(W) ? function(p, v, X) {
              return u[p](v, X ? X : Wk)
          }
          : void 0
      }();
      rc(l, {
          highlight: "#1ABC9C",
          label: "#000",
          labelSelect: "#FFF",
          transparent: "rgba(0,0,0,0.35)",
          titleBackground: "#2C3E50",
          titleIconBackground: "#868686",
          headerBackground: "#ECF0F1",
          headerIconBackground: "#868686",
          headerSeparator: "#868686",
          headerLine: "#D9D9D9",
          background: "#FFF",
          disabledBackground: "rgba(255,255,255,0.65)",
          toolTipBackground: "#FFFFE0",
          rectSelectBorder: "#45C4F9",
          rectSelectBackground: "rgba(0,0,0,0.35)",
          editPointBorder: "#2C3E50",
          editPointBackground: "#D9D9D9",
          dash: "#2C3E50",
          groupBackground: "#ECF0F1",
          groupTitleBackground: "#2C3E50",
          gridBackground: "#D9D9D9",
          gridCellBorderColor: "#868686",
          gridBlockColor: "#868686",
          reverse: "#868686",
          contentIconBackground: "#868686",
          contentLine: "#D9D9D9",
          widgetBackground: "#ECF0F1",
          widgetBorder: "#D9D9D9",
          widgetIconBackground: "#868686",
          widgetIconBorder: "#868686",
          widgetIconGradient: "#D9D9D9",
          widgetIconHighlight: "#43AFF1",
          imageBackground: "#3498DB",
          imageGradient: "#FFF",
          chart: ["#2f7ed8", "#0d233a", "#8bbc21", "#910000", "#1aadce", "#492970", "#f28f43", "#77a1e5", "#c42525", "#a6c96a"]
      }, !0);
      var ul = l.reverse
        , sd = l.transparent
        , jd = l.rectSelectBackground
        , wj = l.dash
        , He = l.titleBackground
        , ak = l.titleIconBackground
        , uf = l.headerBackground
        , an = l.headerIconBackground
        , Rp = l.headerSeparator
        , dk = l.headerLine
        , Pg = l.contentIconBackground
        , Pb = l.contentLine
        , Rk = (l.widgetIconHighlight,
      l.widgetIconBorder)
        , Jp = (l.widgetIconGradient,
      l.imageBackground)
        , Pp = l.imageGradient
        , $p = l.highlight
        , ck = l.label
        , yd = l.labelSelect;
      if (ne && !W.shutAlert1) {
          var Wo = new Date
            , Hq = ne.split("-")
            , gn = new Date(Wo.getFullYear(),Wo.getMonth(),Wo.getDate())
            , ne = new Date($n(Hq[0], 10),$n(Hq[1], 10) - 1,$n(Hq[2], 10))
            , Zc = gn.getTime()
            , Xo = ne.getTime()
            , $i = p + "_try"
            , Ag = W.alert;
          try {
              var qb = W.localStorage;
              if (qb && Ag)
                  if (Xo > Zc && 1728e6 > Xo - Zc) {
                      var hf = (Xo - Zc) / 864e5;
                      qb && qb[$i] != hf && (qb[$i] = hf,
                      W.htWillExpire ? Ag(W.htWillExpire.replace("{{day}}", hf)) : Ag("HT for Web free trial license will expire in " + hf + " days, please apply for a new license!"))
                  } else
                      Zc >= Xo && (W.htExpired ? Ag(W.htExpired) : Ag("Your free trial of HT for Web has expired!")),
                      qb && delete qb[$i]
          } catch (lb) {}
      }
      Math.sign === V && (Math.sign = function(K) {
          return 0 > K ? -1 : K > 0 ? 1 : +K
      }
      );
      var gm = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="
        , Of = {
          encode: function(l, K) {
              var T, f, S, J, E, m, d, w = "", Y = 0;
              for (l = unescape(encodeURIComponent(l)); Y < l.length; )
                  T = l.charCodeAt(Y++),
                  f = l.charCodeAt(Y++),
                  S = l.charCodeAt(Y++),
                  J = T >> 2,
                  E = (3 & T) << 4 | f >> 4,
                  m = (15 & f) << 2 | S >> 6,
                  d = 63 & S,
                  isNaN(f) ? m = d = 64 : isNaN(S) && (d = 64),
                  w = w + K.charAt(J) + K.charAt(E) + K.charAt(m) + K.charAt(d);
              return w
          },
          decode: function(z, E, c) {
              for (var Z, R, e, X, Y, K, x, n = "", m = c || 0; m < z.length; )
                  X = E.indexOf(z.charAt(m++)),
                  Y = E.indexOf(z.charAt(m++)),
                  K = E.indexOf(z.charAt(m++)),
                  x = E.indexOf(z.charAt(m++)),
                  Z = X << 2 | Y >> 4,
                  R = (15 & Y) << 4 | K >> 2,
                  e = (3 & K) << 6 | x,
                  n += String.fromCharCode(Z),
                  64 != K && (n += String.fromCharCode(R)),
                  64 != x && (n += String.fromCharCode(e));
              return n = decodeURIComponent(escape(n))
          },
          _utf8_encode: function(l) {
              l = l.replace(/\r\n/g, "\n");
              for (var o = "", m = 0; m < l.length; m++) {
                  var i = l.charCodeAt(m);
                  128 > i ? o += String.fromCharCode(i) : i > 127 && 2048 > i ? (o += String.fromCharCode(192 | i >> 6),
                  o += String.fromCharCode(128 | 63 & i)) : (o += String.fromCharCode(224 | i >> 12),
                  o += String.fromCharCode(128 | 63 & i >> 6),
                  o += String.fromCharCode(128 | 63 & i))
              }
              return o
          },
          _utf8_decode: function(r) {
              for (var e = "", i = 0, u = 0, z = 0, t = 0; i < r.length; )
                  u = r.charCodeAt(i),
                  128 > u ? (e += String.fromCharCode(u),
                  i++) : u > 191 && 224 > u ? (z = r.charCodeAt(i + 1),
                  e += String.fromCharCode((31 & u) << 6 | 63 & z),
                  i += 2) : (z = r.charCodeAt(i + 1),
                  t = r.charCodeAt(i + 2),
                  e += String.fromCharCode((15 & u) << 12 | (63 & z) << 6 | 63 & t),
                  i += 3);
              return e
          }
      }
        , Tc = []
        , dc = []
        , rk = n.Math = {
          generateUUID: function() {
              for (var S = [], j = 0; 256 > j; j++)
                  S[j] = (16 > j ? "0" : "") + j.toString(16).toUpperCase();
              return function() {
                  var s = 0 | 4294967295 * Math.random()
                    , Y = 0 | 4294967295 * Math.random()
                    , f = 0 | 4294967295 * Math.random()
                    , P = 0 | 4294967295 * Math.random();
                  return S[255 & s] + S[255 & s >> 8] + S[255 & s >> 16] + S[255 & s >> 24] + "-" + S[255 & Y] + S[255 & Y >> 8] + "-" + S[64 | 15 & Y >> 16] + S[255 & Y >> 24] + "-" + S[128 | 63 & f] + S[255 & f >> 8] + "-" + S[255 & f >> 16] + S[255 & f >> 24] + S[255 & P] + S[255 & P >> 8] + S[255 & P >> 16] + S[255 & P >> 24]
              }
          }(),
          clamp: function(h, t, G) {
              return Math.max(t, Math.min(G, h))
          },
          generateIncreasingID: function() {
              var e = 0;
              return function() {
                  return ++e
              }
          }(),
          encodeBase64: function(H, C) {
              return Of.encode(H, C || gm)
          },
          decodeBase64: function(Q, u) {
              return Of.decode(Q, u || gm)
          },
          randomArray: function(p, N) {
              N = N || p.length;
              for (var V = N - 1; V > 0; V--) {
                  var x = Math.floor(Math.random() * (V + 1))
                    , A = p[V];
                  p[V] = p[x],
                  p[x] = A
              }
              return p
          },
          randomInt: function(l, f) {
              return f === V && (f = l,
              l = 0),
              l + Math.floor(Math.random() * (f - l))
          },
          isPOT: function(z) {
              return z > 0 && 0 === (z - 1 & z)
          },
          nearestPOT: function(u) {
              if (!u)
                  return 1;
              var c = u;
              c--,
              c |= c >> 1,
              c |= c >> 2,
              c |= c >> 4,
              c |= c >> 8,
              c |= c >> 16,
              c++;
              var j = c >> 1;
              return u - j > c - u ? c : j
          },
          requestMatrix4: function() {
              return Tc.length > 0 ? Tc.pop() : new rk.Matrix4
          },
          releaseMatrix4: function(C) {
              Tc.push(C)
          },
          requestVector3: function() {
              return dc.length > 0 ? dc.pop() : new rk.Vector3
          },
          releaseVector3: function(l) {
              dc.push(l)
          }
      }
        , Ld = n.Matrix = n.Math.Matrix2d = function(K, Q, R, M, g) {
          this.setFromTransform(K, Q, R, M, g)
      }
        , Ck = Ld;
      Ld.prototype = {},
      Ld.prototype.constructor = Ld,
      Ld.prototype.set = function(w, D, z, k, p, o) {
          return this.a = w,
          this.b = D,
          this.c = z,
          this.d = k,
          this.tx = p,
          this.ty = o,
          this
      }
      ,
      Ld.prototype.setFromTransform = function(s, J, O, x, h) {
          var r = this;
          if (s === V)
              return r.a = 1,
              r.b = 0,
              r.c = 0,
              r.d = 1,
              r.tx = 0,
              r.ty = 0,
              void 0;
          s = s || 0;
          var H = o(s)
            , z = P(s);
          return x = x || 1,
          h = h || 1,
          r.a = z * x,
          r.b = H * x,
          r.c = -H * h,
          r.d = z * h,
          r.tx = J || 0,
          r.ty = O || 0,
          r
      }
      ,
      Ld.prototype.apply = function(H, x) {
          x = x || new le;
          var f = H.x
            , U = H.y;
          return x.x = this.a * f + this.c * U + this.tx,
          x.y = this.b * f + this.d * U + this.ty,
          x
      }
      ,
      Ld.prototype.applyInverse = function(G, T) {
          T = T || new le;
          var X = 1 / (this.a * this.d + this.c * -this.b)
            , e = G.x
            , q = G.y;
          return T.x = this.d * X * e + -this.c * X * q + (this.ty * this.c - this.tx * this.d) * X,
          T.y = this.a * X * q + -this.b * X * e + (-this.ty * this.a + this.tx * this.b) * X,
          T
      }
      ,
      Ld.prototype.translate = function(w, I) {
          return this.tx += w,
          this.ty += I,
          this
      }
      ,
      Ld.prototype.scale = function(Y, J) {
          return this.a *= Y,
          this.d *= J,
          this.c *= Y,
          this.b *= J,
          this.tx *= Y,
          this.ty *= J,
          this
      }
      ,
      Ld.prototype.rotate = function(R) {
          var f = Math.cos(R)
            , x = Math.sin(R)
            , B = this.a
            , d = this.c
            , E = this.tx;
          return this.a = B * f - this.b * x,
          this.b = B * x + this.b * f,
          this.c = d * f - this.d * x,
          this.d = d * x + this.d * f,
          this.tx = E * f - this.ty * x,
          this.ty = E * x + this.ty * f,
          this
      }
      ,
      Ld.prototype.appendTranslate = function(q, F) {
          return this.tx += this.a * q + this.c * F,
          this.ty += this.b * q + this.d * F,
          this
      }
      ,
      Ld.prototype.appendScale = function(h, Q) {
          return this.a *= h,
          this.d *= Q,
          this.c *= Q,
          this.b *= h,
          this
      }
      ,
      Ld.prototype.appendRotate = function(g) {
          if (!g)
              return this;
          var i = Math.cos(g)
            , E = Math.sin(g)
            , G = this.a
            , H = this.b;
          return this.a = G * i + this.c * E,
          this.b = H * i + this.d * E,
          this.c = -G * E + this.c * i,
          this.d = -H * E + this.d * i,
          this
      }
      ,
      Ld.prototype.append = function(p) {
          var J = this.a
            , P = this.b
            , a = this.c
            , V = this.d;
          return this.a = p.a * J + p.b * a,
          this.b = p.a * P + p.b * V,
          this.c = p.c * J + p.d * a,
          this.d = p.c * P + p.d * V,
          this.tx = p.tx * J + p.ty * a + this.tx,
          this.ty = p.tx * P + p.ty * V + this.ty,
          this
      }
      ,
      Ld.prototype.setTransform = function(J, s, V, X, A, I, R, f, N) {
          var Y, j, t, U, M, z, g, b, u, v;
          return M = Math.sin(R),
          z = Math.cos(R),
          g = Math.cos(N),
          b = Math.sin(N),
          u = -Math.sin(f),
          v = Math.cos(f),
          Y = z * A,
          j = M * A,
          t = -M * I,
          U = z * I,
          this.a = g * Y + b * t,
          this.b = g * j + b * U,
          this.c = u * Y + v * t,
          this.d = u * j + v * U,
          this.tx = J + (V * Y + X * t),
          this.ty = s + (V * j + X * U),
          this
      }
      ,
      Ld.prototype.prepend = function(z) {
          var B = this.tx;
          if (1 !== z.a || 0 !== z.b || 0 !== z.c || 1 !== z.d) {
              var i = this.a
                , W = this.c;
              this.a = i * z.a + this.b * z.c,
              this.b = i * z.b + this.b * z.d,
              this.c = W * z.a + this.d * z.c,
              this.d = W * z.b + this.d * z.d
          }
          return this.tx = B * z.a + this.ty * z.c + z.tx,
          this.ty = B * z.b + this.ty * z.d + z.ty,
          this
      }
      ,
      Ld.prototype.transform = Ld.prototype.prepend,
      Ld.prototype.invert = function() {
          var Z = this.a
            , l = this.b
            , D = this.c
            , t = this.d
            , W = this.tx
            , Y = Z * t - l * D;
          return this.a = t / Y,
          this.b = -l / Y,
          this.c = -D / Y,
          this.d = Z / Y,
          this.tx = (D * this.ty - t * W) / Y,
          this.ty = -(Z * this.ty - l * W) / Y,
          this
      }
      ,
      Ld.prototype.identity = function() {
          return this.a = 1,
          this.b = 0,
          this.c = 0,
          this.d = 1,
          this.tx = 0,
          this.ty = 0,
          this
      }
      ,
      Ld.prototype.clone = function() {
          var V = new Ld;
          return V.a = this.a,
          V.b = this.b,
          V.c = this.c,
          V.d = this.d,
          V.tx = this.tx,
          V.ty = this.ty,
          V
      }
      ,
      Ld.prototype.copy = function(c) {
          return c.a = this.a,
          c.b = this.b,
          c.c = this.c,
          c.d = this.d,
          c.tx = this.tx,
          c.ty = this.ty,
          c
      }
      ,
      Ld.prototype.tf = function(y, M) {
          1 === arguments.length && (M = y.y,
          y = y.x);
          var i = this;
          return {
              x: i.a * y + i.c * M + i.tx,
              y: i.b * y + i.d * M + i.ty
          }
      }
      ,
      Ld.prototype.tfi = function(c, j) {
          1 === arguments.length && (j = c.y,
          c = c.x);
          var H = this
            , Z = 1 / (H.a * H.d + H.c * -H.b);
          return {
              x: H.d * Z * c + -H.c * Z * j + (H.ty * H.c - H.tx * H.d) * Z,
              y: H.a * Z * j + -H.b * Z * c + (-H.ty * H.a + H.tx * H.b) * Z
          }
      }
      ,
      Ld.IDENTITY = new Ld,
      Ld.TEMP_MATRIX = new Ld;
      var Qp = n.Math.Quaternion = function(A, m, Y, Z) {
          this.set(A, m, Y, Z)
      }
      ;
      G.assign(Qp.prototype, {
          set: function(O, w, R, k) {
              var g = this;
              return g._x = O || 0,
              g._y = w || 0,
              g._z = R || 0,
              g._w = k !== V ? k : 1,
              g
          },
          clone: function() {
              return new this.constructor(this._x,this._y,this._z,this._w)
          },
          copy: function(h) {
              var M = this;
              return M._x = h._x,
              M._y = h._y,
              M._z = h._z,
              M._w = h._w,
              M
          },
          inverse: function() {
              return this.conjugate()
          },
          conjugate: function() {
              return this._x *= -1,
              this._y *= -1,
              this._z *= -1,
              this
          },
          dot: function(H) {
              return this._x * H._x + this._y * H._y + this._z * H._z + this._w * H._w
          },
          lengthSq: function() {
              return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w
          },
          length: function() {
              return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w)
          },
          normalize: function() {
              var Y = this.length();
              return 0 === Y ? (this._x = 0,
              this._y = 0,
              this._z = 0,
              this._w = 1) : (Y = 1 / Y,
              this._x = this._x * Y,
              this._y = this._y * Y,
              this._z = this._z * Y,
              this._w = this._w * Y),
              this
          },
          fromArray: function(o, P) {
              P === V && (P = 0);
              var U = this;
              return U._x = o[P],
              U._y = o[P + 1],
              U._z = o[P + 2],
              U._w = o[P + 3],
              this
          },
          slerp: function(k, Y) {
              if (0 === Y)
                  return this;
              if (1 === Y)
                  return this.copy(k);
              var Z = this._x
                , a = this._y
                , p = this._z
                , t = this._w
                , m = t * k._w + Z * k._x + a * k._y + p * k._z;
              if (0 > m ? (this._w = -k._w,
              this._x = -k._x,
              this._y = -k._y,
              this._z = -k._z,
              m = -m) : this.copy(k),
              m >= 1)
                  return this._w = t,
                  this._x = Z,
                  this._y = a,
                  this._z = p,
                  this;
              var u = Math.sqrt(1 - m * m);
              if (Math.abs(u) < .001)
                  return this._w = .5 * (t + this._w),
                  this._x = .5 * (Z + this._x),
                  this._y = .5 * (a + this._y),
                  this._z = .5 * (p + this._z),
                  this;
              var B = Math.atan2(u, m)
                , f = Math.sin((1 - Y) * B) / u
                , l = Math.sin(Y * B) / u;
              return this._w = t * f + this._w * l,
              this._x = Z * f + this._x * l,
              this._y = a * f + this._y * l,
              this._z = p * f + this._z * l,
              this
          },
          setFromAxisAngle: function(M, I) {
              var Y = I / 2
                , j = Math.sin(Y);
              return this._x = M.x * j,
              this._y = M.y * j,
              this._z = M.z * j,
              this._w = Math.cos(Y),
              this
          },
          setFromEuler: function(u) {
              var f = u._x
                , Z = u._y
                , g = u._z
                , n = u._order
                , E = Math.cos
                , K = Math.sin
                , h = E(f / 2)
                , V = E(Z / 2)
                , W = E(g / 2)
                , L = K(f / 2)
                , m = K(Z / 2)
                , A = K(g / 2);
              return "XYZ" === n ? (this._x = L * V * W + h * m * A,
              this._y = h * m * W - L * V * A,
              this._z = h * V * A + L * m * W,
              this._w = h * V * W - L * m * A) : "YXZ" === n ? (this._x = L * V * W + h * m * A,
              this._y = h * m * W - L * V * A,
              this._z = h * V * A - L * m * W,
              this._w = h * V * W + L * m * A) : "ZXY" === n ? (this._x = L * V * W - h * m * A,
              this._y = h * m * W + L * V * A,
              this._z = h * V * A + L * m * W,
              this._w = h * V * W - L * m * A) : "ZYX" === n ? (this._x = L * V * W - h * m * A,
              this._y = h * m * W + L * V * A,
              this._z = h * V * A - L * m * W,
              this._w = h * V * W + L * m * A) : "YZX" === n ? (this._x = L * V * W + h * m * A,
              this._y = h * m * W + L * V * A,
              this._z = h * V * A - L * m * W,
              this._w = h * V * W - L * m * A) : "XZY" === n && (this._x = L * V * W - h * m * A,
              this._y = h * m * W - L * V * A,
              this._z = h * V * A + L * m * W,
              this._w = h * V * W + L * m * A),
              this
          },
          setFromRotationMatrix: function(E) {
              var R, b = E.el, N = b[0], I = b[4], c = b[8], r = b[1], s = b[5], i = b[9], f = b[2], t = b[6], a = b[10], Z = N + s + a;
              return Z > 0 ? (R = .5 / Math.sqrt(Z + 1),
              this._w = .25 / R,
              this._x = (t - i) * R,
              this._y = (c - f) * R,
              this._z = (r - I) * R) : N > s && N > a ? (R = 2 * Math.sqrt(1 + N - s - a),
              this._w = (t - i) / R,
              this._x = .25 * R,
              this._y = (I + r) / R,
              this._z = (c + f) / R) : s > a ? (R = 2 * Math.sqrt(1 + s - N - a),
              this._w = (c - f) / R,
              this._x = (I + r) / R,
              this._y = .25 * R,
              this._z = (i + t) / R) : (R = 2 * Math.sqrt(1 + a - N - s),
              this._w = (r - I) / R,
              this._x = (c + f) / R,
              this._y = (i + t) / R,
              this._z = .25 * R),
              this
          },
          setFromToVectors: function() {
              var U, I;
              return function(j, v) {
                  return U === V && (U = new Rh),
                  I = j.dot(v) + 1,
                  1e-7 > I ? (I = 0,
                  Math.abs(j.x) > Math.abs(j.z) ? U.set(-j.y, j.x, 0) : U.set(0, -j.z, j.y)) : U.crossVectors(j, v),
                  this._x = U.x,
                  this._y = U.y,
                  this._z = U.z,
                  this._w = I,
                  this.normalize()
              }
          }(),
          setFromUnitVectors: function() {
              var r, y, x = 1e-6;
              return function(R, I) {
                  return r === V && (r = new Rh),
                  y = R.dot(I) + 1,
                  x > y ? (y = 0,
                  Math.abs(R.x) > Math.abs(R.z) ? r.set(-R.y, R.x, 0) : r.set(0, -R.z, R.y)) : r.crossVectors(R, I),
                  this._x = r.x,
                  this._y = r.y,
                  this._z = r.z,
                  this._w = y,
                  this.normalize()
              }
          }(),
          multiply: function(P) {
              return this.multiplyQuaternions(this, P)
          },
          premultiply: function(Y) {
              return this.multiplyQuaternions(Y, this)
          },
          multiplyQuaternions: function(B, P) {
              var b = B._x
                , G = B._y
                , z = B._z
                , q = B._w
                , D = P._x
                , u = P._y
                , Z = P._z
                , r = P._w;
              return this._x = b * r + q * D + G * Z - z * u,
              this._y = G * r + q * u + z * D - b * Z,
              this._z = z * r + q * Z + b * u - G * D,
              this._w = q * r - b * D - G * u - z * Z,
              this
          }
      });
      var Sl = n.Math.Vector4 = function(U, M, Y, o) {
          this.x = U || 0,
          this.y = M || 0,
          this.z = Y || 0,
          this.w = o !== V ? o : 1
      }
      ;
      G.assign(Sl.prototype, {
          isVector4: !0,
          set: function(J, b, K, X) {
              return this.x = J,
              this.y = b,
              this.z = K,
              this.w = X,
              this
          },
          setScalar: function(H) {
              return this.x = H,
              this.y = H,
              this.z = H,
              this.w = H,
              this
          },
          setX: function(a) {
              return this.x = a,
              this
          },
          setY: function(y) {
              return this.y = y,
              this
          },
          setZ: function(x) {
              return this.z = x,
              this
          },
          setW: function(y) {
              return this.w = y,
              this
          },
          setComponent: function(J, D) {
              switch (J) {
              case 0:
                  this.x = D;
                  break;
              case 1:
                  this.y = D;
                  break;
              case 2:
                  this.z = D;
                  break;
              case 3:
                  this.w = D;
                  break;
              default:
                  throw new Error("index is out of range: " + J)
              }
              return this
          },
          getComponent: function(N) {
              switch (N) {
              case 0:
                  return this.x;
              case 1:
                  return this.y;
              case 2:
                  return this.z;
              case 3:
                  return this.w;
              default:
                  throw new Error("index is out of range: " + N)
              }
          },
          clone: function() {
              return new this.constructor(this.x,this.y,this.z,this.w)
          },
          copy: function(Y) {
              return this.x = Y.x,
              this.y = Y.y,
              this.z = Y.z,
              this.w = Y.w !== V ? Y.w : 1,
              this
          },
          add: function(o, K) {
              return K !== V ? this.addVectors(o, K) : (this.x += o.x,
              this.y += o.y,
              this.z += o.z,
              this.w += o.w,
              this)
          },
          addScalar: function(T) {
              return this.x += T,
              this.y += T,
              this.z += T,
              this.w += T,
              this
          },
          addVectors: function(c, K) {
              return this.x = c.x + K.x,
              this.y = c.y + K.y,
              this.z = c.z + K.z,
              this.w = c.w + K.w,
              this
          },
          addScaledVector: function(i, x) {
              return this.x += i.x * x,
              this.y += i.y * x,
              this.z += i.z * x,
              this.w += i.w * x,
              this
          },
          sub: function(k, U) {
              return U !== V ? this.subVectors(k, U) : (this.x -= k.x,
              this.y -= k.y,
              this.z -= k.z,
              this.w -= k.w,
              this)
          },
          subScalar: function(U) {
              return this.x -= U,
              this.y -= U,
              this.z -= U,
              this.w -= U,
              this
          },
          subVectors: function(W, L) {
              return this.x = W.x - L.x,
              this.y = W.y - L.y,
              this.z = W.z - L.z,
              this.w = W.w - L.w,
              this
          },
          multiplyScalar: function(p) {
              return this.x *= p,
              this.y *= p,
              this.z *= p,
              this.w *= p,
              this
          },
          applyMatrix4: function(q) {
              var p = this.x
                , j = this.y
                , v = this.z
                , H = this.w
                , C = q.el;
              return this.x = C[0] * p + C[4] * j + C[8] * v + C[12] * H,
              this.y = C[1] * p + C[5] * j + C[9] * v + C[13] * H,
              this.z = C[2] * p + C[6] * j + C[10] * v + C[14] * H,
              this.w = C[3] * p + C[7] * j + C[11] * v + C[15] * H,
              this
          },
          divideScalar: function(X) {
              return this.multiplyScalar(1 / X)
          },
          setAxisAngleFromQuaternion: function(w) {
              this.w = 2 * Math.acos(w.w);
              var U = Math.sqrt(1 - w.w * w.w);
              return 1e-4 > U ? (this.x = 1,
              this.y = 0,
              this.z = 0) : (this.x = w.x / U,
              this.y = w.y / U,
              this.z = w.z / U),
              this
          },
          setAxisAngleFromRotationMatrix: function(M) {
              var $, g, B, o, W = .01, R = .1, O = M.el, V = O[0], G = O[4], j = O[8], N = O[1], P = O[5], u = O[9], k = O[2], X = O[6], b = O[10];
              if (Math.abs(G - N) < W && Math.abs(j - k) < W && Math.abs(u - X) < W) {
                  if (Math.abs(G + N) < R && Math.abs(j + k) < R && Math.abs(u + X) < R && Math.abs(V + P + b - 3) < R)
                      return this.set(1, 0, 0, 0),
                      this;
                  $ = Math.PI;
                  var F = (V + 1) / 2
                    , d = (P + 1) / 2
                    , w = (b + 1) / 2
                    , i = (G + N) / 4
                    , r = (j + k) / 4
                    , e = (u + X) / 4;
                  return F > d && F > w ? W > F ? (g = 0,
                  B = .707106781,
                  o = .707106781) : (g = Math.sqrt(F),
                  B = i / g,
                  o = r / g) : d > w ? W > d ? (g = .707106781,
                  B = 0,
                  o = .707106781) : (B = Math.sqrt(d),
                  g = i / B,
                  o = e / B) : W > w ? (g = .707106781,
                  B = .707106781,
                  o = 0) : (o = Math.sqrt(w),
                  g = r / o,
                  B = e / o),
                  this.set(g, B, o, $),
                  this
              }
              var A = Math.sqrt((X - u) * (X - u) + (j - k) * (j - k) + (N - G) * (N - G));
              return Math.abs(A) < .001 && (A = 1),
              this.x = (X - u) / A,
              this.y = (j - k) / A,
              this.z = (N - G) / A,
              this.w = Math.acos((V + P + b - 1) / 2),
              this
          },
          min: function(b) {
              return this.x = Math.min(this.x, b.x),
              this.y = Math.min(this.y, b.y),
              this.z = Math.min(this.z, b.z),
              this.w = Math.min(this.w, b.w),
              this
          },
          max: function(a) {
              return this.x = Math.max(this.x, a.x),
              this.y = Math.max(this.y, a.y),
              this.z = Math.max(this.z, a.z),
              this.w = Math.max(this.w, a.w),
              this
          },
          clamp: function(c, Y) {
              return this.x = Math.max(c.x, Math.min(Y.x, this.x)),
              this.y = Math.max(c.y, Math.min(Y.y, this.y)),
              this.z = Math.max(c.z, Math.min(Y.z, this.z)),
              this.w = Math.max(c.w, Math.min(Y.w, this.w)),
              this
          },
          clampScalar: function() {
              var w, S;
              return function(f, s) {
                  return w === V && (w = new Sl,
                  S = new Sl),
                  w.set(f, f, f, f),
                  S.set(s, s, s, s),
                  this.clamp(w, S)
              }
          }(),
          clampLength: function(K, n) {
              var S = this.length();
              return this.divideScalar(S || 1).multiplyScalar(Math.max(K, Math.min(n, S)))
          },
          floor: function() {
              return this.x = Math.floor(this.x),
              this.y = Math.floor(this.y),
              this.z = Math.floor(this.z),
              this.w = Math.floor(this.w),
              this
          },
          ceil: function() {
              return this.x = Math.ceil(this.x),
              this.y = Math.ceil(this.y),
              this.z = Math.ceil(this.z),
              this.w = Math.ceil(this.w),
              this
          },
          round: function() {
              return this.x = Math.round(this.x),
              this.y = Math.round(this.y),
              this.z = Math.round(this.z),
              this.w = Math.round(this.w),
              this
          },
          roundToZero: function() {
              return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x),
              this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y),
              this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z),
              this.w = this.w < 0 ? Math.ceil(this.w) : Math.floor(this.w),
              this
          },
          negate: function() {
              return this.x = -this.x,
              this.y = -this.y,
              this.z = -this.z,
              this.w = -this.w,
              this
          },
          dot: function($) {
              return this.x * $.x + this.y * $.y + this.z * $.z + this.w * $.w
          },
          lengthSq: function() {
              return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w
          },
          length: function() {
              return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w)
          },
          manhattanLength: function() {
              return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w)
          },
          normalize: function() {
              return this.divideScalar(this.length() || 1)
          },
          setLength: function(r) {
              return this.normalize().multiplyScalar(r)
          },
          lerp: function(x, R) {
              return this.x += (x.x - this.x) * R,
              this.y += (x.y - this.y) * R,
              this.z += (x.z - this.z) * R,
              this.w += (x.w - this.w) * R,
              this
          },
          lerpVectors: function(N, q, S) {
              return this.subVectors(q, N).multiplyScalar(S).add(N)
          },
          equals: function(Z) {
              return Z.x === this.x && Z.y === this.y && Z.z === this.z && Z.w === this.w
          },
          fromArray: function(h, Y) {
              return Y === V && (Y = 0),
              this.x = h[Y],
              this.y = h[Y + 1],
              this.z = h[Y + 2],
              this.w = h[Y + 3],
              this
          },
          toArray: function(q, j) {
              return q === V && (q = []),
              j === V && (j = 0),
              q[j] = this.x,
              q[j + 1] = this.y,
              q[j + 2] = this.z,
              q[j + 3] = this.w,
              q
          },
          fromBufferAttribute: function(C, J) {
              return this.x = C.getX(J),
              this.y = C.getY(J),
              this.z = C.getZ(J),
              this.w = C.getW(J),
              this
          }
      });
      var Rh = n.Math.Vector3 = function(l, P, E) {
          l === V ? (this.x = 0,
          this.y = 0,
          this.z = 0) : "object" == typeof l ? this.copy(l) : this.set(l, P == V ? l : P, E == V ? l : E)
      }
      ;
      G.assign(Rh.prototype, {
          isNaN: function() {
              return isNaN(this.x) || isNaN(this.y) || isNaN(this.z)
          },
          set: function(Y, u, v) {
              return this.x = Y,
              this.y = u,
              this.z = v,
              this
          },
          equals: function(f) {
              return f && this.x === f.x && this.y === f.y && this.z === f.z
          },
          setScalar: function(T) {
              return this.x = T,
              this.y = T,
              this.z = T,
              this
          },
          setX: function(s) {
              return this.x = s,
              this
          },
          setY: function(D) {
              return this.y = D,
              this
          },
          setZ: function(k) {
              return this.z = k,
              this
          },
          clone: function() {
              return new this.constructor(this.x,this.y,this.z)
          },
          copy: function(i) {
              return i.x === V ? (this.x = i[0],
              this.y = i[1],
              this.z = i[2]) : (this.x = i.x,
              this.y = i.y,
              this.z = i.z || 0),
              this
          },
          add: function(J) {
              return this.x += J.x,
              this.y += J.y,
              this.z += J.z,
              this
          },
          addScalar: function(c) {
              return this.x += c,
              this.y += c,
              this.z += c,
              this
          },
          addVectors: function(S, l) {
              return this.x = S.x + l.x,
              this.y = S.y + l.y,
              this.z = S.z + l.z,
              this
          },
          addScaledVector: function(k, P) {
              return this.x += k.x * P,
              this.y += k.y * P,
              this.z += k.z * P,
              this
          },
          sub: function(p) {
              return this.x -= p.x,
              this.y -= p.y,
              this.z -= p.z,
              this
          },
          subScalar: function(L) {
              return this.x -= L,
              this.y -= L,
              this.z -= L,
              this
          },
          subVectors: function(A, v) {
              return this.x = A.x - v.x,
              this.y = A.y - v.y,
              this.z = A.z - v.z,
              this
          },
          divide: function(V) {
              return this.x /= V.x,
              this.y /= V.y,
              this.z /= V.z,
              this
          },
          multiply: function(L) {
              return this.x *= L.x,
              this.y *= L.y,
              this.z *= L.z,
              this
          },
          multiplyScalar: function(x) {
              return this.x *= x,
              this.y *= x,
              this.z *= x,
              this
          },
          distanceTo: function(E) {
              return Math.sqrt(this.distanceToSquared(E))
          },
          distanceToSquared: function(z) {
              var $ = this.x - z.x
                , l = this.y - z.y
                , Q = this.z - z.z;
              return $ * $ + l * l + Q * Q
          },
          distanceToSquared2: function(i) {
              var I = this.x - i[0]
                , o = this.y - i[1]
                , _ = this.z - i[2];
              return I * I + o * o + _ * _
          },
          divideVectors: function(N, b) {
              return this.x = N.x / b.x,
              this.y = N.y / b.y,
              this.z = N.z / b.z,
              this
          },
          multiplyVectors: function(s, T) {
              return this.x = s.x * T.x,
              this.y = s.y * T.y,
              this.z = s.z * T.z,
              this
          },
          transformDirection: function(u) {
              var b = this.x
                , U = this.y
                , c = this.z
                , o = u.el;
              return this.x = o[0] * b + o[4] * U + o[8] * c,
              this.y = o[1] * b + o[5] * U + o[9] * c,
              this.z = o[2] * b + o[6] * U + o[10] * c,
              this.normalize()
          },
          applyAxisAngle: function() {
              var m = new Qp;
              return function(Y, d) {
                  return this.applyQuaternion(m.setFromAxisAngle(Y, d))
              }
          }(),
          applyEuler: function() {
              var Z = new Qp;
              return function(S) {
                  return this.applyQuaternion(Z.setFromEuler(S))
              }
          }(),
          applyQuaternion: function(c) {
              var K = this.x
                , G = this.y
                , V = this.z
                , T = c._x
                , z = c._y
                , R = c._z
                , L = c._w
                , x = L * K + z * V - R * G
                , D = L * G + R * K - T * V
                , u = L * V + T * G - z * K
                , g = -T * K - z * G - R * V;
              return this.x = x * L + g * -T + D * -R - u * -z,
              this.y = D * L + g * -z + u * -T - x * -R,
              this.z = u * L + g * -R + x * -z - D * -T,
              this
          },
          applyMatrix4: function(m) {
              var L = this.x
                , W = this.y
                , u = this.z
                , d = m.el
                , T = 1 / (d[3] * L + d[7] * W + d[11] * u + d[15]);
              return this.x = (d[0] * L + d[4] * W + d[8] * u + d[12]) * T,
              this.y = (d[1] * L + d[5] * W + d[9] * u + d[13]) * T,
              this.z = (d[2] * L + d[6] * W + d[10] * u + d[14]) * T,
              this
          },
          applyMatrix3: function(M) {
              var y = this.x
                , p = this.y
                , o = this.z
                , B = M.el;
              return this.x = B[0] * y + B[3] * p + B[6] * o,
              this.y = B[1] * y + B[4] * p + B[7] * o,
              this.z = B[2] * y + B[5] * p + B[8] * o,
              this
          },
          negate: function() {
              return this.x = -this.x,
              this.y = -this.y,
              this.z = -this.z,
              this
          },
          reflect: function() {
              var e = new Rh;
              return function(x) {
                  return this.sub(e.copy(x).multiplyScalar(2 * this.dot(x)))
              }
          }(),
          dot: function(J) {
              return this.x * J.x + this.y * J.y + this.z * J.z
          },
          lengthSq: function() {
              return this.x * this.x + this.y * this.y + this.z * this.z
          },
          length: function() {
              return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z)
          },
          manhattanLength: function() {
              return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z)
          },
          normalize: function() {
              var P = this.length();
              return P ? this.multiplyScalar(1 / P) : this
          },
          setLength: function(K) {
              return this.normalize().multiplyScalar(K)
          },
          fromArray: function(i, e) {
              return e === V && (e = 0),
              this.x = i[e],
              this.y = i[e + 1],
              this.z = i[e + 2],
              this
          },
          toArray: function(Y, g) {
              return Y === V && (Y = [0, 0, 0]),
              g === V && (g = 0),
              Y[g] = this.x,
              Y[g + 1] = this.y,
              Y[g + 2] = this.z,
              Y
          },
          cross: function(g) {
              return this.crossVectors(this, g)
          },
          angleTo: function(L) {
              var R = this.dot(L) / Math.sqrt(this.lengthSq() * L.lengthSq());
              return R > 1 || -1 > R ? 0 : Math.acos(R)
          },
          lerp: function(E, d) {
              return this.x += (E.x - this.x) * d,
              this.y += (E.y - this.y) * d,
              this.z += (E.z - this.z) * d,
              this
          },
          lerpVectors: function(V, H, D) {
              return this.subVectors(H, V).multiplyScalar(D).add(V)
          },
          crossVectors: function(u, V) {
              var S = u.x
                , E = u.y
                , N = u.z
                , C = V.x
                , H = V.y
                , P = V.z;
              return this.x = E * P - N * H,
              this.y = N * C - S * P,
              this.z = S * H - E * C,
              this
          },
          min: function(p) {
              return this.x = Math.min(this.x, p.x),
              this.y = Math.min(this.y, p.y),
              this.z = Math.min(this.z, p.z),
              this
          },
          max: function(s) {
              return this.x = Math.max(this.x, s.x),
              this.y = Math.max(this.y, s.y),
              this.z = Math.max(this.z, s.z),
              this
          },
          setFromMatrixPosition: function(n) {
              return this.setFromMatrixColumn(n, 3)
          },
          setFromMatrixScale: function(f) {
              var P = this.setFromMatrixColumn(f, 0).length()
                , e = this.setFromMatrixColumn(f, 1).length()
                , i = this.setFromMatrixColumn(f, 2).length();
              return this.x = P,
              this.y = e,
              this.z = i,
              this
          },
          setFromMatrixColumn: function($, j) {
              return this.fromArray($.el, 4 * j)
          }
      });
      var le = n.Math.Vector2 = function(r, s, W) {
          "object" == typeof r && (r.x != V ? (s = r.y,
          r = r.x,
          W = r.e) : (W = r[2],
          s = r[1],
          r = r[0])),
          this.set(r || 0, s || 0, W)
      }
      ;
      le.prototype = {},
      le.prototype.constructor = le,
      G.defineProperties(le.prototype, {
          width: {
              get: function() {
                  return this.x
              },
              set: function(r) {
                  this.x = r
              }
          },
          height: {
              get: function() {
                  return this.y
              },
              set: function(O) {
                  this.y = O
              }
          }
      }),
      le.prototype.clone = function() {
          return new le(this.x,this.y,this.e)
      }
      ,
      le.prototype.copy = function(a) {
          return this.set(a.x, a.y, a.e),
          this
      }
      ,
      le.prototype.equals = function(u) {
          return u.x === this.x && u.y === this.y
      }
      ,
      le.prototype.set = function(L, A, z) {
          return this.x = L || 0,
          this.y = A || (0 !== A ? this.x : 0),
          z != V && (this.e = z),
          this
      }
      ,
      le.prototype.setScalar = function(m) {
          return this.x = m,
          this.y = m,
          this
      }
      ,
      le.prototype.setX = function(b) {
          return this.x = b || 0,
          this
      }
      ,
      le.prototype.setY = function(f) {
          return this.y = f || 0,
          this
      }
      ,
      le.prototype.add = function(F) {
          return this.x += F.x,
          this.y += F.y,
          this
      }
      ,
      le.prototype.addVectors = function(A, Y) {
          return this.x = A.x + Y.x,
          this.y = A.y + Y.y,
          this
      }
      ,
      le.prototype.addScalar = function(x) {
          return this.x += x,
          this.y += x,
          this
      }
      ,
      le.prototype.addScaledVector = function(i, _) {
          return this.x += i.x * _,
          this.y += i.y * _,
          this
      }
      ,
      le.prototype.sub = function(W) {
          return this.x -= W.x,
          this.y -= W.y,
          this
      }
      ,
      le.prototype.subScalar = function(B) {
          return this.x -= B,
          this.y -= B,
          this
      }
      ,
      le.prototype.subVectors = function(D, I) {
          return this.x = D.x - I.x,
          this.y = D.y - I.y,
          this
      }
      ,
      le.prototype.multiply = function(G) {
          return this.x *= G.x,
          this.y *= G.y,
          this
      }
      ,
      le.prototype.multiplyScalar = function(u) {
          return this.x *= u,
          this.y *= u,
          this
      }
      ,
      le.prototype.divide = function(y) {
          return this.x /= y.x,
          this.y /= y.y,
          this
      }
      ,
      le.prototype.divideScalar = function(S) {
          return this.multiplyScalar(1 / S)
      }
      ,
      le.prototype.min = function(T) {
          return this.x = Math.min(this.x, T.x),
          this.y = Math.min(this.y, T.y),
          this
      }
      ,
      le.prototype.max = function(n) {
          return this.x = Math.max(this.x, n.x),
          this.y = Math.max(this.y, n.y),
          this
      }
      ,
      le.prototype.fromArray = function(E, L) {
          return L === V && (L = 0),
          this.x = E[L],
          this.y = E[L + 1],
          this
      }
      ,
      le.prototype.clamp = function(T, q) {
          return this.x = Math.max(T.x, Math.min(q.x, this.x)),
          this.y = Math.max(T.y, Math.min(q.y, this.y)),
          this
      }
      ,
      le.prototype.clampScalar = function() {
          var _, Z;
          return function(j, p) {
              return _ === V && (_ = new le,
              Z = new le),
              _.set(j, j),
              Z.set(p, p),
              this.clamp(_, Z)
          }
      }(),
      le.prototype.clampLength = function(j, Y) {
          var N = this.length();
          return this.multiplyScalar(Math.max(j, Math.min(Y, N)) / N)
      }
      ,
      le.prototype.dot = function(t) {
          return this.x * t.x + this.y * t.y
      }
      ,
      le.prototype.lengthSq = function() {
          return this.x * this.x + this.y * this.y
      }
      ,
      le.prototype.length = function() {
          return Math.sqrt(this.x * this.x + this.y * this.y)
      }
      ,
      le.prototype.normalize = function() {
          return this.divideScalar(this.length())
      }
      ,
      le.prototype.angle = function() {
          var C = Math.atan2(this.y, this.x);
          return 0 > C && (C += 2 * Math.PI),
          C
      }
      ,
      le.prototype.distanceTo = function(O) {
          return Math.sqrt(this.distanceToSquared(O))
      }
      ,
      le.prototype.distanceToSquared = function(N) {
          var U = this.x - N.x
            , F = this.y - N.y;
          return U * U + F * F
      }
      ,
      le.prototype.isNearEnough = function(d) {
          return this.distanceToSquared(d) < 1e-8
      }
      ,
      le.prototype.setLength = function(A) {
          var C = this.length();
          return C ? this.multiplyScalar(A / C) : this
      }
      ,
      le.prototype.lerp = function(n, J) {
          return this.x += (n.x - this.x) * J,
          this.y += (n.y - this.y) * J,
          this
      }
      ,
      le.prototype.lerpVectors = function(k, w, M) {
          return this.subVectors(w, k).multiplyScalar(M).add(k)
      }
      ,
      le.prototype.rotateAround = function(A, k) {
          var S = A ? A.x : 0
            , w = A ? A.y : 0
            , D = Math.cos(k)
            , $ = Math.sin(k)
            , x = this.x - S
            , s = this.y - w;
          return this.x = x * D - s * $ + S,
          this.y = x * $ + s * D + w,
          this
      }
      ;
      var wk = n.Math.Matrix3 = function() {
          this.el = [1, 0, 0, 0, 1, 0, 0, 0, 1]
      }
      ;
      G.assign(wk.prototype, {
          isMatrix3: !0,
          set: function(v, x, O, C, s, S, R, m, b) {
              var H = this.el;
              return H[0] = v,
              H[1] = C,
              H[2] = R,
              H[3] = x,
              H[4] = s,
              H[5] = m,
              H[6] = O,
              H[7] = S,
              H[8] = b,
              this
          },
          identity: function() {
              return this.set(1, 0, 0, 0, 1, 0, 0, 0, 1),
              this
          },
          clone: function() {
              return (new this.constructor).fromArray(this.el)
          },
          copy: function(w) {
              var p = this.el
                , e = w.el;
              return p[0] = e[0],
              p[1] = e[1],
              p[2] = e[2],
              p[3] = e[3],
              p[4] = e[4],
              p[5] = e[5],
              p[6] = e[6],
              p[7] = e[7],
              p[8] = e[8],
              this
          },
          setFromMatrix4: function(h) {
              var R = h.el;
              return this.set(R[0], R[4], R[8], R[1], R[5], R[9], R[2], R[6], R[10]),
              this
          },
          applyToBufferAttribute: function() {
              var M = new Rh;
              return function(g) {
                  for (var i = 0, e = g.count; e > i; i++)
                      M.x = g.getX(i),
                      M.y = g.getY(i),
                      M.z = g.getZ(i),
                      M.applyMatrix3(this),
                      g.setXYZ(i, M.x, M.y, M.z);
                  return g
              }
          }(),
          multiply: function(X) {
              return this.multiplyMatrices(this, X)
          },
          premultiply: function(r) {
              return this.multiplyMatrices(r, this)
          },
          multiplyMatrices: function(X, L) {
              var m = X.el
                , f = L.el
                , M = this.el
                , k = m[0]
                , S = m[3]
                , C = m[6]
                , G = m[1]
                , q = m[4]
                , g = m[7]
                , W = m[2]
                , B = m[5]
                , R = m[8]
                , u = f[0]
                , d = f[3]
                , c = f[6]
                , J = f[1]
                , p = f[4]
                , j = f[7]
                , v = f[2]
                , Q = f[5]
                , r = f[8];
              return M[0] = k * u + S * J + C * v,
              M[3] = k * d + S * p + C * Q,
              M[6] = k * c + S * j + C * r,
              M[1] = G * u + q * J + g * v,
              M[4] = G * d + q * p + g * Q,
              M[7] = G * c + q * j + g * r,
              M[2] = W * u + B * J + R * v,
              M[5] = W * d + B * p + R * Q,
              M[8] = W * c + B * j + R * r,
              this
          },
          multiplyScalar: function(g) {
              var e = this.el;
              return e[0] *= g,
              e[3] *= g,
              e[6] *= g,
              e[1] *= g,
              e[4] *= g,
              e[7] *= g,
              e[2] *= g,
              e[5] *= g,
              e[8] *= g,
              this
          },
          determinant: function() {
              var Q = this.el
                , l = Q[0]
                , i = Q[1]
                , j = Q[2]
                , a = Q[3]
                , X = Q[4]
                , p = Q[5]
                , w = Q[6]
                , s = Q[7]
                , m = Q[8];
              return l * X * m - l * p * s - i * a * m + i * p * w + j * a * s - j * X * w
          },
          getInverse: function(z) {
              var R = z.el
                , l = this.el
                , p = R[0]
                , E = R[1]
                , H = R[2]
                , e = R[3]
                , T = R[4]
                , O = R[5]
                , f = R[6]
                , G = R[7]
                , q = R[8]
                , $ = q * T - O * G
                , V = O * f - q * e
                , y = G * e - T * f
                , L = p * $ + E * V + H * y;
              if (0 === L)
                  return this.identity();
              var h = 1 / L;
              return l[0] = $ * h,
              l[1] = (H * G - q * E) * h,
              l[2] = (O * E - H * T) * h,
              l[3] = V * h,
              l[4] = (q * p - H * f) * h,
              l[5] = (H * e - O * p) * h,
              l[6] = y * h,
              l[7] = (E * f - G * p) * h,
              l[8] = (T * p - E * e) * h,
              this
          },
          transpose: function() {
              var M, K = this.el;
              return M = K[1],
              K[1] = K[3],
              K[3] = M,
              M = K[2],
              K[2] = K[6],
              K[6] = M,
              M = K[5],
              K[5] = K[7],
              K[7] = M,
              this
          },
          getNormalMatrix: function(p) {
              return this.setFromMatrix4(p).getInverse(this).transpose()
          },
          transposeIntoArray: function(c) {
              var n = this.el;
              return c[0] = n[0],
              c[1] = n[3],
              c[2] = n[6],
              c[3] = n[1],
              c[4] = n[4],
              c[5] = n[7],
              c[6] = n[2],
              c[7] = n[5],
              c[8] = n[8],
              this
          },
          setUvTransform: function(g, C, L, i, G, K, o) {
              var E = Math.cos(G)
                , n = Math.sin(G);
              this.set(L * E, L * n, -L * (E * K + n * o) + K + g, -i * n, i * E, -i * (-n * K + E * o) + o + C, 0, 0, 1)
          },
          scale: function(z, H) {
              var n = this.el;
              return n[0] *= z,
              n[3] *= z,
              n[6] *= z,
              n[1] *= H,
              n[4] *= H,
              n[7] *= H,
              this
          },
          rotate: function(H) {
              var a = Math.cos(H)
                , h = Math.sin(H)
                , e = this.el
                , b = e[0]
                , F = e[3]
                , J = e[6]
                , q = e[1]
                , G = e[4]
                , Q = e[7];
              return e[0] = a * b + h * q,
              e[3] = a * F + h * G,
              e[6] = a * J + h * Q,
              e[1] = -h * b + a * q,
              e[4] = -h * F + a * G,
              e[7] = -h * J + a * Q,
              this
          },
          translate: function(C, f) {
              var d = this.el;
              return d[0] += C * d[2],
              d[3] += C * d[5],
              d[6] += C * d[8],
              d[1] += f * d[2],
              d[4] += f * d[5],
              d[7] += f * d[8],
              this
          },
          equals: function(C) {
              for (var I = this.el, k = C.el, n = 0; 9 > n; n++)
                  if (I[n] !== k[n])
                      return !1;
              return !0
          },
          fromArray: function(A, D) {
              D === V && (D = 0);
              for (var Z = 0; 9 > Z; Z++)
                  this.el[Z] = A[Z + D];
              return this
          },
          toArray: function(O, n) {
              O === V && (O = []),
              n === V && (n = 0);
              var d = this.el;
              return O[n] = d[0],
              O[n + 1] = d[1],
              O[n + 2] = d[2],
              O[n + 3] = d[3],
              O[n + 4] = d[4],
              O[n + 5] = d[5],
              O[n + 6] = d[6],
              O[n + 7] = d[7],
              O[n + 8] = d[8],
              O
          }
      });
      var Yi = n.Math.Plane = function(z, $) {
          this.normal = z !== V ? z : new Rh(1,0,0),
          this.constant = $ !== V ? $ : 0
      }
      ;
      G.assign(Yi.prototype, {
          set: function(A, J) {
              return this.normal.copy(A),
              this.constant = J,
              this
          },
          setComponents: function(d, Q, x, M) {
              return this.normal.set(d, Q, x),
              this.constant = M,
              this
          },
          setFromNormalAndCoplanarPoint: function($, g) {
              return this.normal.copy($),
              this.constant = -g.dot(this.normal),
              this
          },
          setFromCoplanarPoints: function() {
              var I = new Rh
                , T = new Rh;
              return function(Q, t, p) {
                  var l = I.subVectors(p, t).cross(T.subVectors(Q, t)).normalize();
                  return this.setFromNormalAndCoplanarPoint(l, Q),
                  this
              }
          }(),
          clone: function() {
              return (new this.constructor).copy(this)
          },
          copy: function(f) {
              return this.normal.copy(f.normal),
              this.constant = f.constant,
              this
          },
          normalize: function() {
              var J = 1 / this.normal.length();
              return this.normal.multiplyScalar(J),
              this.constant *= J,
              this
          },
          negate: function() {
              return this.constant *= -1,
              this.normal.negate(),
              this
          },
          distanceToPoint: function(G) {
              return this.normal.dot(G) + this.constant
          },
          distanceToSphere: function(T) {
              return this.distanceToPoint(T.center) - T.radius
          },
          projectPoint: function(K, B) {
              return B === V && (B = new Rh),
              B.copy(this.normal).multiplyScalar(-this.distanceToPoint(K)).add(K)
          },
          intersectLine: function() {
              var g = new Rh;
              return function(c, W) {
                  W === V && (W = new Rh);
                  var P = c.delta(g)
                    , X = this.normal.dot(P);
                  if (0 === X)
                      return 0 === this.distanceToPoint(c.start) ? W.copy(c.start) : V;
                  var Y = -(c.start.dot(this.normal) + this.constant) / X;
                  return 0 > Y || Y > 1 ? V : W.copy(P).multiplyScalar(Y).add(c.start)
              }
          }(),
          intersectsLine: function(C) {
              var m = this.distanceToPoint(C.start)
                , B = this.distanceToPoint(C.end);
              return 0 > m && B > 0 || 0 > B && m > 0
          },
          intersectsBox: function(S) {
              return S.intersectsPlane(this)
          },
          intersectsSphere: function(e) {
              return e.intersectsPlane(this)
          },
          coplanarPoint: function(m) {
              return m === V && (m = new Rh),
              m.copy(this.normal).multiplyScalar(-this.constant)
          },
          applyMatrix4: function() {
              var N = new Rh
                , B = new wk;
              return function(S, l) {
                  var k = l || B.getNormalMatrix(S)
                    , R = this.coplanarPoint(N).applyMatrix4(S)
                    , E = this.normal.applyMatrix3(k).normalize();
                  return this.constant = -R.dot(E),
                  this
              }
          }(),
          translate: function(v) {
              return this.constant -= v.dot(this.normal),
              this
          },
          equals: function(n) {
              return n.normal.equals(this.normal) && n.constant === this.constant
          }
      });
      var nr = n.Math.Ray = function(X, Q) {
          this.origin = X !== V ? X.clone() : new Rh,
          this.direction = Q !== V ? Q.clone() : new Rh
      }
      ;
      G.assign(nr.prototype, {
          set: function(R, B) {
              return this.origin.copy(R),
              this.direction.copy(B),
              this
          },
          clone: function() {
              return (new this.constructor).copy(this)
          },
          copy: function(J) {
              return this.origin.copy(J.origin),
              this.direction.copy(J.direction),
              this.maxHitLen = J.maxHitLen,
              this
          },
          at: function(I, D) {
              var x = D || new Rh;
              return x.copy(this.direction).multiplyScalar(I).add(this.origin)
          },
          setMaxHitLength: function(g) {
              this.maxHitLen = g
          },
          lookAt: function(e) {
              return this.direction.copy(e).sub(this.origin).normalize(),
              this
          },
          applyMatrix4: function(L) {
              var J = this.maxHitLen;
              if (J) {
                  var N = this.direction.clone().multiplyScalar(J).add(this.origin);
                  N.applyMatrix4(L)
              }
              return this.origin.applyMatrix4(L),
              this.direction.transformDirection(L),
              J && (this.maxHitLen = this.origin.distanceTo(N)),
              this
          },
          intersectSphere: function() {
              var u = new Rh;
              return function(J, v) {
                  u.subVectors(J.center, this.origin);
                  var m = u.dot(this.direction)
                    , Y = u.dot(u) - m * m
                    , K = J.radius * J.radius;
                  if (Y > K)
                      return null;
                  var A = Math.sqrt(K - Y)
                    , X = m - A
                    , q = m + A;
                  return 0 > X && 0 > q ? null : 0 > X ? this.at(q, v) : this.at(X, v)
              }
          }(),
          intersectEllipsoid: function() {
              var i = new Rh
                , L = new Rh;
              return function(P, d) {
                  i.subVectors(P.center, this.origin),
                  i.divide(P.radius),
                  L.divideVectors(this.direction, P.radius);
                  var n = L.lengthSq()
                    , T = i.dot(L)
                    , _ = i.dot(i) * n - T * T;
                  if (_ > n)
                      return null;
                  var X = Math.sqrt(n - _)
                    , Q = (T - X) / n
                    , $ = (T + X) / n;
                  return 0 > Q && 0 > $ ? null : 0 > Q ? this.at($, d) : this.at(Q, d)
              }
          }(),
          intersectBox: function(m, C) {
              var z, e, R, x, i, s, J = 1 / this.direction.x, n = 1 / this.direction.y, f = 1 / this.direction.z, j = this.origin;
              if (J >= 0 ? (z = (m.min.x - j.x) * J,
              e = (m.max.x - j.x) * J) : (z = (m.max.x - j.x) * J,
              e = (m.min.x - j.x) * J),
              n >= 0 ? (R = (m.min.y - j.y) * n,
              x = (m.max.y - j.y) * n) : (R = (m.max.y - j.y) * n,
              x = (m.min.y - j.y) * n),
              z > x || R > e)
                  return null;
              if ((R > z || z !== z) && (z = R),
              (e > x || e !== e) && (e = x),
              f >= 0 ? (i = (m.min.z - j.z) * f,
              s = (m.max.z - j.z) * f) : (i = (m.max.z - j.z) * f,
              s = (m.min.z - j.z) * f),
              z > s || i > e)
                  return null;
              if ((i > z || z !== z) && (z = i),
              (e > s || e !== e) && (e = s),
              0 > e)
                  return null;
              var V = z >= 0 ? z : e
                , v = this.maxHitLen;
              return v && V > v ? null : this.at(V, C)
          },
          intersectTriangle: function() {
              var e = new Rh
                , B = new Rh
                , P = new Rh
                , p = new Rh;
              return function(z, b, K, V, Y) {
                  B.subVectors(b, z),
                  P.subVectors(K, z),
                  p.crossVectors(B, P);
                  var L, f = this.direction.dot(p);
                  if (f > 0) {
                      if (V)
                          return null;
                      L = 1
                  } else {
                      if (!(0 > f))
                          return null;
                      L = -1,
                      f = -f
                  }
                  e.subVectors(this.origin, z);
                  var R = L * this.direction.dot(P.crossVectors(e, P));
                  if (0 > R)
                      return null;
                  var Z = L * this.direction.dot(B.cross(e));
                  if (0 > Z || R + Z > f)
                      return null;
                  var v = -L * e.dot(p);
                  if (0 > v)
                      return null;
                  var i = v / f
                    , k = this.maxHitLen;
                  return k && i > k ? null : this.at(i, Y)
              }
          }()
      });
      var Wi = n.Math.Box3 = function(q, i) {
          this.min = q !== V ? q : new Rh(1 / 0,1 / 0,1 / 0),
          this.max = i !== V ? i : new Rh(-1 / 0,-1 / 0,-1 / 0)
      }
      ;
      G.assign(Wi.prototype, {
          set: function(r, U) {
              return this.min.copy(r),
              this.max.copy(U),
              this
          },
          setFromArray: function(S) {
              for (var t = 1 / 0, U = 1 / 0, b = 1 / 0, C = -1 / 0, X = -1 / 0, c = -1 / 0, e = 0, d = S.length; d > e; e += 3) {
                  var K = S[e]
                    , F = S[e + 1]
                    , p = S[e + 2];
                  t > K && (t = K),
                  U > F && (U = F),
                  b > p && (b = p),
                  K > C && (C = K),
                  F > X && (X = F),
                  p > c && (c = p)
              }
              return this.min.set(t, U, b),
              this.max.set(C, X, c),
              this
          },
          setFromPoints: function(v) {
              this.makeEmpty();
              for (var m = 0, k = v.length; k > m; m++)
                  this.expandByPoint(v[m]);
              return this
          },
          clone: function() {
              return (new this.constructor).copy(this)
          },
          intersectsBox: function(s) {
              return s.max.x < this.min.x || s.min.x > this.max.x || s.max.y < this.min.y || s.min.y > this.max.y || s.max.z < this.min.z || s.min.z > this.max.z ? !1 : !0
          },
          copy: function(_) {
              return this.min.copy(_.min),
              this.max.copy(_.max),
              this
          },
          makeEmpty: function() {
              return this.min.x = this.min.y = this.min.z = 1 / 0,
              this.max.x = this.max.y = this.max.z = -1 / 0,
              this
          },
          isEmpty: function() {
              return this.max.x < this.min.x || this.max.y < this.min.y || this.max.z < this.min.z
          },
          expandByPoint: function(H) {
              return this.min.min(H),
              this.max.max(H),
              this
          },
          expandByBox: function(T) {
              return this.min.min(T.min),
              this.max.max(T.max),
              this
          },
          applyMatrix4: function() {
              var d = [new Rh, new Rh, new Rh, new Rh, new Rh, new Rh, new Rh, new Rh];
              return function(K) {
                  return this.isEmpty() ? this : (d[0].set(this.min.x, this.min.y, this.min.z).applyMatrix4(K),
                  d[1].set(this.min.x, this.min.y, this.max.z).applyMatrix4(K),
                  d[2].set(this.min.x, this.max.y, this.min.z).applyMatrix4(K),
                  d[3].set(this.min.x, this.max.y, this.max.z).applyMatrix4(K),
                  d[4].set(this.max.x, this.min.y, this.min.z).applyMatrix4(K),
                  d[5].set(this.max.x, this.min.y, this.max.z).applyMatrix4(K),
                  d[6].set(this.max.x, this.max.y, this.min.z).applyMatrix4(K),
                  d[7].set(this.max.x, this.max.y, this.max.z).applyMatrix4(K),
                  this.setFromPoints(d),
                  this)
              }
          }()
      });
      var rd = n.Math.Sphere = function(S, q) {
          this.center = S !== V ? S : new Rh,
          this.radius = q !== V ? q : 0
      }
      ;
      G.assign(rd.prototype, {
          set: function(L, G) {
              return this.center.copy(L),
              this.radius = G,
              this
          },
          setFromPoints: function() {
              var e = new Wi;
              return function(o, Y) {
                  var i = this.center;
                  Y !== V ? i.copy(Y) : e.setFromPoints(o).getCenter(i);
                  for (var g = 0, R = 0, D = o.length; D > R; R++)
                      g = Math.max(g, i.distanceToSquared(o[R]));
                  return this.radius = Math.sqrt(g),
                  this
              }
          }(),
          clone: function() {
              return (new this.constructor).copy(this)
          },
          copy: function(L) {
              return this.center.copy(L.center),
              this.radius = L.radius,
              this
          },
          empty: function() {
              return this.radius <= 0
          },
          containsPoint: function(c) {
              return c.distanceToSquared(this.center) <= this.radius * this.radius
          },
          distanceToPoint: function(B) {
              return B.distanceTo(this.center) - this.radius
          },
          intersectsSphere: function(I) {
              var P = this.radius + I.radius;
              return I.center.distanceToSquared(this.center) <= P * P
          },
          intersectsBox: function(r) {
              return r.intersectsSphere(this)
          },
          intersectsPlane: function(x) {
              return Math.abs(x.distanceToPoint(this.center)) <= this.radius
          },
          clampPoint: function(G, u) {
              var $ = this.center.distanceToSquared(G);
              return u === V && (u = new Rh),
              u.copy(G),
              $ > this.radius * this.radius && (u.sub(this.center).normalize(),
              u.multiplyScalar(this.radius).add(this.center)),
              u
          },
          getBoundingBox: function(F) {
              return F === V && (F = new Wi),
              F.set(this.center, this.center),
              F.expandByScalar(this.radius),
              F
          },
          applyMatrix4: function(D) {
              return this.center.applyMatrix4(D),
              this.radius = this.radius * D.getMaxScaleOnAxis(),
              this
          },
          translate: function(J) {
              return this.center.add(J),
              this
          },
          equals: function(p) {
              return p.center.equals(this.center) && p.radius === this.radius
          }
      });
      var yr = n.Math.Frustum = function(j, D, N, f, t, v) {
          this.planes = [j !== V ? j : new Yi, D !== V ? D : new Yi, N !== V ? N : new Yi, f !== V ? f : new Yi, t !== V ? t : new Yi, v !== V ? v : new Yi]
      }
      ;
      G.assign(yr.prototype, {
          set: function(Z, f, C, V, r, L) {
              var q = this.planes;
              return q[0].copy(Z),
              q[1].copy(f),
              q[2].copy(C),
              q[3].copy(V),
              q[4].copy(r),
              q[5].copy(L),
              this
          },
          clone: function() {
              return (new this.constructor).copy(this)
          },
          copy: function(i) {
              for (var m = this.planes, e = 0; 6 > e; e++)
                  m[e].copy(i.planes[e]);
              return this
          },
          setFromMatrix: function(_) {
              var K = this.planes
                , x = _.el
                , v = x[0]
                , W = x[1]
                , I = x[2]
                , c = x[3]
                , V = x[4]
                , t = x[5]
                , d = x[6]
                , q = x[7]
                , X = x[8]
                , h = x[9]
                , w = x[10]
                , $ = x[11]
                , p = x[12]
                , z = x[13]
                , E = x[14]
                , D = x[15];
              return K[0].setComponents(c - v, q - V, $ - X, D - p).normalize(),
              K[1].setComponents(c + v, q + V, $ + X, D + p).normalize(),
              K[2].setComponents(c + W, q + t, $ + h, D + z).normalize(),
              K[3].setComponents(c - W, q - t, $ - h, D - z).normalize(),
              K[4].setComponents(c - I, q - d, $ - w, D - E).normalize(),
              K[5].setComponents(c + I, q + d, $ + w, D + E).normalize(),
              this
          },
          intersectsObject: function() {
              var t = new rd;
              return function(M) {
                  var h = M.geometry;
                  return null === h.boundingSphere && h.computeBoundingSphere(),
                  t.copy(h.boundingSphere).applyMatrix4(M.matrixWorld),
                  this.intersectsSphere(t)
              }
          }(),
          intersectsSprite: function() {
              var c = new rd;
              return function(C) {
                  return c.center.set(0, 0, 0),
                  c.radius = .7071067811865476,
                  c.applyMatrix4(C.matrixWorld),
                  this.intersectsSphere(c)
              }
          }(),
          intersectsSphere: function(W) {
              for (var t = this.planes, j = W.center, a = -W.radius, L = 0; 6 > L; L++) {
                  var N = t[L].distanceToPoint(j);
                  if (a > N)
                      return !1
              }
              return !0
          },
          intersectsBox: function() {
              var y = new Rh;
              return function(j) {
                  for (var q = this.planes, x = 0; 6 > x; x++) {
                      var r = q[x];
                      if (y.x = r.normal.x > 0 ? j.max.x : j.min.x,
                      y.y = r.normal.y > 0 ? j.max.y : j.min.y,
                      y.z = r.normal.z > 0 ? j.max.z : j.min.z,
                      r.distanceToPoint(y) < 0)
                          return !1
                  }
                  return !0
              }
          }(),
          containsPoint: function(Z) {
              for (var W = this.planes, k = 0; 6 > k; k++)
                  if (W[k].distanceToPoint(Z) < 0)
                      return !1;
              return !0
          }
      });
      var Sc = n.Math.Matrix4 = function() {
          this.el = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]
      }
      ;
      G.assign(Sc.prototype, {
          set: function(y, l, n, s, Y, r, N, F, G, T, k, V, J, H, a, U) {
              var d = this.el;
              return d[0] = y,
              d[4] = l,
              d[8] = n,
              d[12] = s,
              d[1] = Y,
              d[5] = r,
              d[9] = N,
              d[13] = F,
              d[2] = G,
              d[6] = T,
              d[10] = k,
              d[14] = V,
              d[3] = J,
              d[7] = H,
              d[11] = a,
              d[15] = U,
              this
          },
          clone: function() {
              return (new Sc).fromArray(this.el)
          },
          fromArray: function(F, v) {
              v === V && (v = 0);
              for (var y = this.el, x = 0; 16 > x; x++)
                  y[x] = F[x + v];
              return this
          },
          getElements: function() {
              return this.el
          },
          scale: function(X) {
              var v = this.el
                , O = X.x
                , p = X.y
                , x = X.z;
              return v[0] *= O,
              v[4] *= p,
              v[8] *= x,
              v[1] *= O,
              v[5] *= p,
              v[9] *= x,
              v[2] *= O,
              v[6] *= p,
              v[10] *= x,
              v[3] *= O,
              v[7] *= p,
              v[11] *= x,
              this
          },
          makeRotationFromEuler: function(s) {
              var t = this.el
                , V = s._x
                , Y = s._y
                , w = s._z
                , j = s._order
                , P = Math.cos(V)
                , J = Math.sin(V)
                , X = Math.cos(Y)
                , l = Math.sin(Y)
                , x = Math.cos(w)
                , a = Math.sin(w);
              if ("XYZ" === j) {
                  var f = P * x
                    , W = P * a
                    , z = J * x
                    , B = J * a;
                  t[0] = X * x,
                  t[4] = -X * a,
                  t[8] = l,
                  t[1] = W + z * l,
                  t[5] = f - B * l,
                  t[9] = -J * X,
                  t[2] = B - f * l,
                  t[6] = z + W * l,
                  t[10] = P * X
              } else if ("YXZ" === j) {
                  var R = X * x
                    , D = X * a
                    , Z = l * x
                    , T = l * a;
                  t[0] = R + T * J,
                  t[4] = Z * J - D,
                  t[8] = P * l,
                  t[1] = P * a,
                  t[5] = P * x,
                  t[9] = -J,
                  t[2] = D * J - Z,
                  t[6] = T + R * J,
                  t[10] = P * X
              } else if ("ZXY" === j) {
                  var R = X * x
                    , D = X * a
                    , Z = l * x
                    , T = l * a;
                  t[0] = R - T * J,
                  t[4] = -P * a,
                  t[8] = Z + D * J,
                  t[1] = D + Z * J,
                  t[5] = P * x,
                  t[9] = T - R * J,
                  t[2] = -P * l,
                  t[6] = J,
                  t[10] = P * X
              } else if ("ZYX" === j) {
                  var f = P * x
                    , W = P * a
                    , z = J * x
                    , B = J * a;
                  t[0] = X * x,
                  t[4] = z * l - W,
                  t[8] = f * l + B,
                  t[1] = X * a,
                  t[5] = B * l + f,
                  t[9] = W * l - z,
                  t[2] = -l,
                  t[6] = J * X,
                  t[10] = P * X
              } else if ("YZX" === j) {
                  var n = P * X
                    , K = P * l
                    , i = J * X
                    , C = J * l;
                  t[0] = X * x,
                  t[4] = C - n * a,
                  t[8] = i * a + K,
                  t[1] = a,
                  t[5] = P * x,
                  t[9] = -J * x,
                  t[2] = -l * x,
                  t[6] = K * a + i,
                  t[10] = n - C * a
              } else if ("XZY" === j) {
                  var n = P * X
                    , K = P * l
                    , i = J * X
                    , C = J * l;
                  t[0] = X * x,
                  t[4] = -a,
                  t[8] = l * x,
                  t[1] = n * a + C,
                  t[5] = P * x,
                  t[9] = K * a - i,
                  t[2] = i * a - K,
                  t[6] = J * x,
                  t[10] = C * a + n
              }
              return t[3] = 0,
              t[7] = 0,
              t[11] = 0,
              t[12] = 0,
              t[13] = 0,
              t[14] = 0,
              t[15] = 1,
              this
          },
          makeRotationFromQuaternion: function(x) {
              var G = this.el
                , I = x._x
                , W = x._y
                , P = x._z
                , H = x._w
                , y = I + I
                , m = W + W
                , B = P + P
                , U = I * y
                , $ = I * m
                , F = I * B
                , N = W * m
                , b = W * B
                , O = P * B
                , p = H * y
                , r = H * m
                , T = H * B;
              return G[0] = 1 - (N + O),
              G[4] = $ - T,
              G[8] = F + r,
              G[1] = $ + T,
              G[5] = 1 - (U + O),
              G[9] = b - p,
              G[2] = F - r,
              G[6] = b + p,
              G[10] = 1 - (U + N),
              G[3] = 0,
              G[7] = 0,
              G[11] = 0,
              G[12] = 0,
              G[13] = 0,
              G[14] = 0,
              G[15] = 1,
              this
          },
          identity: function() {
              return this.set(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1),
              this
          },
          getInverse: function(i) {
              var W = this.el
                , R = i.el
                , D = R[0]
                , Y = R[1]
                , b = R[2]
                , v = R[3]
                , e = R[4]
                , f = R[5]
                , h = R[6]
                , B = R[7]
                , Z = R[8]
                , x = R[9]
                , z = R[10]
                , T = R[11]
                , k = R[12]
                , r = R[13]
                , P = R[14]
                , K = R[15]
                , y = x * P * B - r * z * B + r * h * T - f * P * T - x * h * K + f * z * K
                , X = k * z * B - Z * P * B - k * h * T + e * P * T + Z * h * K - e * z * K
                , a = Z * r * B - k * x * B + k * f * T - e * r * T - Z * f * K + e * x * K
                , m = k * x * h - Z * r * h - k * f * z + e * r * z + Z * f * P - e * x * P
                , $ = D * y + Y * X + b * a + v * m;
              if (0 === $)
                  return this.identity();
              var L = 1 / $;
              return W[0] = y * L,
              W[1] = (r * z * v - x * P * v - r * b * T + Y * P * T + x * b * K - Y * z * K) * L,
              W[2] = (f * P * v - r * h * v + r * b * B - Y * P * B - f * b * K + Y * h * K) * L,
              W[3] = (x * h * v - f * z * v - x * b * B + Y * z * B + f * b * T - Y * h * T) * L,
              W[4] = X * L,
              W[5] = (Z * P * v - k * z * v + k * b * T - D * P * T - Z * b * K + D * z * K) * L,
              W[6] = (k * h * v - e * P * v - k * b * B + D * P * B + e * b * K - D * h * K) * L,
              W[7] = (e * z * v - Z * h * v + Z * b * B - D * z * B - e * b * T + D * h * T) * L,
              W[8] = a * L,
              W[9] = (k * x * v - Z * r * v - k * Y * T + D * r * T + Z * Y * K - D * x * K) * L,
              W[10] = (e * r * v - k * f * v + k * Y * B - D * r * B - e * Y * K + D * f * K) * L,
              W[11] = (Z * f * v - e * x * v - Z * Y * B + D * x * B + e * Y * T - D * f * T) * L,
              W[12] = m * L,
              W[13] = (Z * r * b - k * x * b + k * Y * z - D * r * z - Z * Y * P + D * x * P) * L,
              W[14] = (k * f * b - e * r * b - k * Y * h + D * r * h + e * Y * P - D * f * P) * L,
              W[15] = (e * x * b - Z * f * b + Z * Y * h - D * x * h - e * Y * z + D * f * z) * L,
              this
          },
          makeRotationAxis: function(p, R) {
              var e = Math.cos(R)
                , l = Math.sin(R)
                , b = 1 - e
                , c = p.x
                , M = p.y
                , K = p.z
                , q = b * c
                , a = b * M;
              return this.set(q * c + e, q * M - l * K, q * K + l * M, 0, q * M + l * K, a * M + e, a * K - l * c, 0, q * K - l * M, a * K + l * c, b * K * K + e, 0, 0, 0, 0, 1),
              this
          },
          multiply: function(d) {
              return this.multiplyMatrices(this, d)
          },
          premultiply: function(X) {
              return this.multiplyMatrices(X, this)
          },
          multiplyMatrices: function(B, i) {
              var c = B.el
                , H = i.el
                , O = this.el
                , u = c[0]
                , n = c[4]
                , Z = c[8]
                , A = c[12]
                , I = c[1]
                , J = c[5]
                , U = c[9]
                , S = c[13]
                , e = c[2]
                , K = c[6]
                , r = c[10]
                , x = c[14]
                , l = c[3]
                , t = c[7]
                , o = c[11]
                , w = c[15]
                , m = H[0]
                , f = H[4]
                , W = H[8]
                , F = H[12]
                , D = H[1]
                , G = H[5]
                , s = H[9]
                , T = H[13]
                , Q = H[2]
                , N = H[6]
                , E = H[10]
                , $ = H[14]
                , p = H[3]
                , _ = H[7]
                , L = H[11]
                , R = H[15];
              return O[0] = u * m + n * D + Z * Q + A * p,
              O[4] = u * f + n * G + Z * N + A * _,
              O[8] = u * W + n * s + Z * E + A * L,
              O[12] = u * F + n * T + Z * $ + A * R,
              O[1] = I * m + J * D + U * Q + S * p,
              O[5] = I * f + J * G + U * N + S * _,
              O[9] = I * W + J * s + U * E + S * L,
              O[13] = I * F + J * T + U * $ + S * R,
              O[2] = e * m + K * D + r * Q + x * p,
              O[6] = e * f + K * G + r * N + x * _,
              O[10] = e * W + K * s + r * E + x * L,
              O[14] = e * F + K * T + r * $ + x * R,
              O[3] = l * m + t * D + o * Q + w * p,
              O[7] = l * f + t * G + o * N + w * _,
              O[11] = l * W + t * s + o * E + w * L,
              O[15] = l * F + t * T + o * $ + w * R,
              this
          },
          lookAt: function() {
              var W = new Rh
                , E = new Rh
                , w = new Rh;
              return function(p, v, _) {
                  var C = this.el;
                  return w.subVectors(p, v),
                  0 === w.lengthSq() && (w.z = 1),
                  w.normalize(),
                  W.crossVectors(_, w),
                  0 === W.lengthSq() && (1 === Math.abs(_.z) ? w.x += 1e-4 : w.z += 1e-4,
                  w.normalize(),
                  W.crossVectors(_, w)),
                  W.normalize(),
                  E.crossVectors(w, W),
                  C[0] = W.x,
                  C[4] = E.x,
                  C[8] = w.x,
                  C[1] = W.y,
                  C[5] = E.y,
                  C[9] = w.y,
                  C[2] = W.z,
                  C[6] = E.z,
                  C[10] = w.z,
                  this
              }
          }(),
          extractScale: function() {
              var P;
              return function(s) {
                  P === V && (P = new Rh),
                  s === V && (s = new Rh);
                  var n = P.setFromMatrixColumn(this, 0).length()
                    , a = P.setFromMatrixColumn(this, 1).length()
                    , y = P.setFromMatrixColumn(this, 2).length();
                  return s.set(n, a, y),
                  s
              }
          }(),
          extractRotation: function() {
              var q;
              return function(Z) {
                  q === V && (q = new Rh),
                  Z === V && (Z = new Sc);
                  var n = this.el
                    , O = Z.el
                    , S = 1 / q.setFromMatrixColumn(Z, 0).length()
                    , Q = 1 / q.setFromMatrixColumn(Z, 1).length()
                    , x = 1 / q.setFromMatrixColumn(Z, 2).length();
                  return n[0] = O[0] * S,
                  n[1] = O[1] * S,
                  n[2] = O[2] * S,
                  n[4] = O[4] * Q,
                  n[5] = O[5] * Q,
                  n[6] = O[6] * Q,
                  n[8] = O[8] * x,
                  n[9] = O[9] * x,
                  n[10] = O[10] * x,
                  this
              }
          }(),
          multiplyScalar: function(f) {
              var k = this.el;
              return k[0] *= f,
              k[4] *= f,
              k[8] *= f,
              k[12] *= f,
              k[1] *= f,
              k[5] *= f,
              k[9] *= f,
              k[13] *= f,
              k[2] *= f,
              k[6] *= f,
              k[10] *= f,
              k[14] *= f,
              k[3] *= f,
              k[7] *= f,
              k[11] *= f,
              k[15] *= f,
              this
          },
          getPosition: function(F) {
              return F === V && (F = new Rh),
              F.setFromMatrixColumn(this, 3)
          },
          setPosition: function(s) {
              var B = this.el;
              return B[12] = s.x,
              B[13] = s.y,
              B[14] = s.z,
              this
          },
          toArray: function(b, q) {
              b === V && (b = []),
              q === V && (q = 0);
              var s = this.el;
              return b[q] = s[0],
              b[q + 1] = s[1],
              b[q + 2] = s[2],
              b[q + 3] = s[3],
              b[q + 4] = s[4],
              b[q + 5] = s[5],
              b[q + 6] = s[6],
              b[q + 7] = s[7],
              b[q + 8] = s[8],
              b[q + 9] = s[9],
              b[q + 10] = s[10],
              b[q + 11] = s[11],
              b[q + 12] = s[12],
              b[q + 13] = s[13],
              b[q + 14] = s[14],
              b[q + 15] = s[15],
              b
          },
          determinant: function() {
              var F = this.el
                , J = F[0]
                , r = F[4]
                , l = F[8]
                , S = F[12]
                , x = F[1]
                , W = F[5]
                , j = F[9]
                , g = F[13]
                , Y = F[2]
                , V = F[6]
                , o = F[10]
                , Z = F[14]
                , s = F[3]
                , T = F[7]
                , i = F[11]
                , z = F[15];
              return s * (+S * j * V - l * g * V - S * W * o + r * g * o + l * W * Z - r * j * Z) + T * (+J * j * Z - J * g * o + S * x * o - l * x * Z + l * g * Y - S * j * Y) + i * (+J * g * V - J * W * Z - S * x * V + r * x * Z + S * W * Y - r * g * Y) + z * (-l * W * Y - J * j * V + J * W * o + l * x * V - r * x * o + r * j * Y)
          },
          copy: function(m) {
              var O = this.el
                , L = m.el;
              return O[0] = L[0],
              O[1] = L[1],
              O[2] = L[2],
              O[3] = L[3],
              O[4] = L[4],
              O[5] = L[5],
              O[6] = L[6],
              O[7] = L[7],
              O[8] = L[8],
              O[9] = L[9],
              O[10] = L[10],
              O[11] = L[11],
              O[12] = L[12],
              O[13] = L[13],
              O[14] = L[14],
              O[15] = L[15],
              this
          },
          compose: function(p, n, u) {
              var e = this.el
                , f = n._x
                , E = n._y
                , j = n._z
                , J = n._w
                , $ = f + f
                , g = E + E
                , x = j + j
                , h = f * $
                , B = f * g
                , q = f * x
                , s = E * g
                , T = E * x
                , A = j * x
                , R = J * $
                , t = J * g
                , L = J * x
                , V = u.x
                , d = u.y
                , Q = u.z;
              return e[0] = (1 - (s + A)) * V,
              e[1] = (B + L) * V,
              e[2] = (q - t) * V,
              e[3] = 0,
              e[4] = (B - L) * d,
              e[5] = (1 - (h + A)) * d,
              e[6] = (T + R) * d,
              e[7] = 0,
              e[8] = (q + t) * Q,
              e[9] = (T - R) * Q,
              e[10] = (1 - (h + s)) * Q,
              e[11] = 0,
              e[12] = p.x,
              e[13] = p.y,
              e[14] = p.z,
              e[15] = 1,
              this
          },
          decompose: function() {
              var u = new Rh
                , p = new Sc;
              return function(x, e, A) {
                  var V = this.el
                    , K = u.set(V[0], V[1], V[2]).length()
                    , m = u.set(V[4], V[5], V[6]).length()
                    , q = u.set(V[8], V[9], V[10]).length()
                    , a = this.determinant();
                  0 > a && (K = -K),
                  x.x = V[12],
                  x.y = V[13],
                  x.z = V[14],
                  p.copy(this);
                  var t = 1 / K
                    , F = 1 / m
                    , r = 1 / q;
                  return p.el[0] *= t,
                  p.el[1] *= t,
                  p.el[2] *= t,
                  p.el[4] *= F,
                  p.el[5] *= F,
                  p.el[6] *= F,
                  p.el[8] *= r,
                  p.el[9] *= r,
                  p.el[10] *= r,
                  e.setFromRotationMatrix(p),
                  A.x = K,
                  A.y = m,
                  A.z = q,
                  this
              }
          }()
      });
      var Mi = n.Math.Triangle = function(O, L, h) {
          this.a = O !== V ? O : new Rh,
          this.b = L !== V ? L : new Rh,
          this.c = h !== V ? h : new Rh
      }
      ;
      G.assign(Mi, {
          barycoordFromPoint: function() {
              var w = new Rh
                , v = new Rh
                , $ = new Rh;
              return function(p, e, z, u, N) {
                  w.subVectors(u, e),
                  v.subVectors(z, e),
                  $.subVectors(p, e);
                  var O = w.dot(w)
                    , K = w.dot(v)
                    , V = w.dot($)
                    , k = v.dot(v)
                    , o = v.dot($)
                    , F = O * k - K * K
                    , q = N || new Rh;
                  if (0 === F)
                      return q.set(-2, -1, -1);
                  var T = 1 / F
                    , x = (k * V - K * o) * T
                    , f = (O * o - K * V) * T;
                  return q.set(1 - x - f, f, x)
              }
          }()
      });
      var Ml = n.Math.Euler = function(G, r, P, m, D) {
          this.set(G, r, P, m, D)
      }
      ;
      Ml.RotationOrders = ["XYZ", "YZX", "ZXY", "XZY", "YXZ", "ZYX"],
      Ml.DefaultOrder = "XYZ",
      Ml.ReverseOrder = function(z) {
          return z = z[2] + z[1] + z[0],
          z.toUpperCase()
      }
      ,
      G.defineProperties(Ml.prototype, {
          x: {
              get: function() {
                  return this._x
              },
              set: function(U) {
                  this._x = U,
                  this.onChangeCallback()
              }
          },
          y: {
              get: function() {
                  return this._y
              },
              set: function(M) {
                  this._y = M,
                  this.onChangeCallback()
              }
          },
          z: {
              get: function() {
                  return this._z
              },
              set: function(C) {
                  this._z = C,
                  this.onChangeCallback()
              }
          },
          order: {
              get: function() {
                  return this._order
              },
              set: function(Z) {
                  this._order = Z,
                  this.onChangeCallback()
              }
          }
      }),
      G.assign(Ml.prototype, {
          set: function(S, J, y, $, R) {
              return $c(S) && (R = y,
              $ = J,
              y = S[2],
              J = S[1],
              S = S[0]),
              $ ? R && ($ = Ml.ReverseOrder($)) : $ = "ZYX",
              this._x = S || 0,
              this._y = J || 0,
              this._z = y || 0,
              this._order = $ || this._order,
              this.onChangeCallback(),
              this
          },
          clone: function() {
              return new this.constructor(this._x,this._y,this._z,this._order)
          },
          copy: function(k) {
              return this._x = k._x,
              this._y = k._y,
              this._z = k._z,
              this._order = k._order,
              this.onChangeCallback(),
              this
          },
          setFromRotationMatrix: function(Q, m, t) {
              var w = n.Math.clamp
                , a = Q.el || Q
                , p = a[0]
                , P = a[4]
                , V = a[8]
                , h = a[1]
                , $ = a[5]
                , s = a[9]
                , T = a[2]
                , U = a[6]
                , q = a[10];
              return m = m || this._order,
              "XYZ" === m ? (this._y = Math.asin(w(V, -1, 1)),
              Math.abs(V) < .99999 ? (this._x = Math.atan2(-s, q),
              this._z = Math.atan2(-P, p)) : (this._x = Math.atan2(U, $),
              this._z = 0)) : "YXZ" === m ? (this._x = Math.asin(-w(s, -1, 1)),
              Math.abs(s) < .99999 ? (this._y = Math.atan2(V, q),
              this._z = Math.atan2(h, $)) : (this._y = Math.atan2(-T, p),
              this._z = 0)) : "ZXY" === m ? (this._x = Math.asin(w(U, -1, 1)),
              Math.abs(U) < .99999 ? (this._y = Math.atan2(-T, q),
              this._z = Math.atan2(-P, $)) : (this._y = 0,
              this._z = Math.atan2(h, p))) : "ZYX" === m ? (this._y = Math.asin(-w(T, -1, 1)),
              Math.abs(T) < .99999 ? (this._x = Math.atan2(U, q),
              this._z = Math.atan2(h, p)) : (this._x = 0,
              this._z = Math.atan2(-P, $))) : "YZX" === m ? (this._z = Math.asin(w(h, -1, 1)),
              Math.abs(h) < .99999 ? (this._x = Math.atan2(-s, $),
              this._y = Math.atan2(-T, p)) : (this._x = 0,
              this._y = Math.atan2(V, q))) : "XZY" === m ? (this._z = Math.asin(-w(P, -1, 1)),
              Math.abs(P) < .99999 ? (this._x = Math.atan2(U, $),
              this._y = Math.atan2(V, p)) : (this._x = Math.atan2(-s, q),
              this._y = 0)) : console.warn("unsupported order: " + m),
              this._order = m,
              t !== !1 && this.onChangeCallback(),
              this
          },
          setFromQuaternion: function() {
              var N = new Sc;
              return function(V, L, _) {
                  return N.makeRotationFromQuaternion(V),
                  this.setFromRotationMatrix(N, L, _)
              }
          }(),
          setFromVector3: function(N, f) {
              return this.set(N.x, N.y, N.z, f || this._order)
          },
          reorder: function() {
              var i = new Qp;
              return function(Z) {
                  return i.setFromEuler(this),
                  this.setFromQuaternion(i, Z)
              }
          }(),
          equals: function(U) {
              return U._x === this._x && U._y === this._y && U._z === this._z && U._order === this._order
          },
          fromArray: function(c) {
              return this._x = c[0],
              this._y = c[1],
              this._z = c[2],
              c[3] !== V && (this._order = c[3]),
              this.onChangeCallback(),
              this
          },
          toArray: function(z, F) {
              return z === V && (z = []),
              F === V && (F = 0),
              z[F] = this._x,
              z[F + 1] = this._y,
              z[F + 2] = this._z,
              z[F + 3] = this._order,
              z
          },
          toVector3: function(p) {
              return p ? p.set(this._x, this._y, this._z) : new Rh(this._x,this._y,this._z)
          },
          onChange: function(V) {
              return this.onChangeCallback = V,
              this
          },
          onChangeCallback: function() {}
      });
      var tb = {
          ms_ac: function(V, n) {
              for (var f = n.ms_ac, K = 0; K < f.length; K++)
                  Mo(V, f[K])
          },
          ms_listener: function(l) {
              l.addListeners = function() {
                  var v = this
                    , x = Wl;
                  M.mockTouch && (x = rm.concat(Fg).concat(Kp)),
                  v.__events__ = x;
                  for (var i = 0, t = x.length; t > i; i++) {
                      var p = x[i];
                      "wheel" === p && !v.handle_wheel && v.handle_mousewheel && (v.handle_wheel = function(d) {
                          Po(v, d)
                      }
                      ),
                      v["handle_" + p] && Qn(p, v.getView(), v)
                  }
              }
              ,
              l.removeListeners = function() {
                  var h = this
                    , x = h.__events__;
                  if (x) {
                      h.__events__ = V;
                      for (var e = 0, F = x.length; F > e; e++)
                          h["handle_" + x[e]] && qn(x[e], h.getView(), h)
                  }
              }
          },
          ms_fire: function(i) {
              i.mp = function(T, t, v) {
                  this.addPropertyChangeListener(T, t, v)
              }
              ,
              i.ump = function(j, t) {
                  this.removePropertyChangeListener(j, t)
              }
              ,
              i.fp = function(W, H, x, Y, q) {
                  return this.firePropertyChange(W, H, x, Y, q)
              }
              ,
              i.addPropertyChangeListener = function(O, B, K) {
                  var Q = this;
                  Q._62I || (Q._62I = new ze),
                  Q._62I.add(O, B, K)
              }
              ,
              i.removePropertyChangeListener = function(G, J) {
                  this._62I && this._62I.remove(G, J)
              }
              ,
              i.firePropertyChange = function(t, K, R, x, d) {
                  if (x) {
                      if (x(K, R))
                          return !1
                  } else if (K === R)
                      return !1;
                  var O = this
                    , n = d || {};
                  return n.property = t,
                  n.oldValue = K,
                  n.newValue = R,
                  n.source = O,
                  n.data = O,
                  O._62I && O._62I.fire(n),
                  O.onPropertyChanged && O.onPropertyChanged(n),
                  !0
              }
          },
          ms_attr: function(l) {
              l.a = function(G, H) {
                  var L = this;
                  if (2 === arguments.length)
                      L.setAttr(G, H);
                  else {
                      if (!Ql(G))
                          return L.getAttr(G);
                      for (var O in G)
                          L.setAttr(O, G[O])
                  }
                  return L
              }
              ,
              l.getAttr = function($, U) {
                  if (U === V && (U = 1),
                  this._attrObject && $in this._attrObject)
                      return this._attrObject[$];
                  if (this.getImage) {
                      var R = this.getImage();
                      if (Xq(R) && (R = wm[R]),
                      Ql(R) && "dataBindings"in R)
                          for (var s = R.dataBindings, g = s.length - 1; g >= 0; g--) {
                              var z = s[g];
                              if (z.attr === $) {
                                  if ("defaultValue"in z)
                                      return z.defaultValue;
                                  break
                              }
                          }
                  }
                  return U ? S[$] : V
              }
              ,
              l.setAttr = function(u, d) {
                  var c = this;
                  c._attrObject || (c._attrObject = {});
                  var s = c._attrObject[u];
                  d === V ? delete c._attrObject[u] : c._attrObject[u] = d,
                  c.fp && c.fp("a:" + u, s, d) && c.onAttrChanged && c.onAttrChanged(u, s, d)
              }
              ,
              l.getSerializableAttrs = function() {
                  var b, $ = {};
                  for (b in this._attrObject)
                      $[b] = 1;
                  return $
              }
          },
          ms_bnb: function(G) {
              G.getBodyColor = function(T) {
                  return T.s("body.color")
              }
              ,
              G.getBorderColor = function(V) {
                  return V.s("border.color")
              }
          },
          _51o: function(N) {
              N.mi = function(g, o, W) {
                  this.addInteractorListener(g, o, W)
              }
              ,
              N.umi = function(l, J) {
                  this.removeInteractorListener(l, J)
              }
              ,
              N.fi = function(Y) {
                  this.fireInteractorEvent(Y)
              }
              ,
              N.addInteractorListener = function(t, _, x) {
                  var e = this;
                  e._63I || (e._63I = new ze),
                  e._63I.add(t, _, x)
              }
              ,
              N.removeInteractorListener = function(R, C) {
                  this._63I && this._63I.remove(R, C)
              }
              ,
              N.fireInteractorEvent = function(V) {
                  this._63I && this._63I.fire(V)
              }
              ,
              N.setInteractors = function(G) {
                  var M = this
                    , f = M._interactors;
                  f && f.each(function(c) {
                      c.tearDown()
                  }),
                  $c(G) && (G = new Mh(G)),
                  M._interactors = G,
                  G && G.each(function(D) {
                      D.setUp()
                  }),
                  M.fp("interactors", f, G),
                  M.invalidateSelection()
              }
              ,
              N.getInteractors = function() {
                  return this._interactors
              }
          },
          _49o: function($) {
              $._44O = E,
              $._45O = E,
              $.getTopPainters = function() {
                  return this._44O
              }
              ,
              $.getBottomPainters = function() {
                  return this._45O
              }
              ,
              $.addTopPainter = function(j) {
                  var r = this;
                  r._44O || (r._44O = new Mh),
                  r._44O.contains(j) || (r._44O.add(j),
                  r.redraw && r.redraw())
              }
              ,
              $.removeTopPainter = function(s) {
                  var U = this;
                  U._44O && (U._44O.remove(s),
                  U.redraw && U.redraw())
              }
              ,
              $.addBottomPainter = function(y) {
                  var Q = this;
                  Q._45O || (Q._45O = new Mh),
                  Q._45O.contains(y) || (Q._45O.add(y),
                  Q.redraw && Q.redraw())
              }
              ,
              $.removeBottomPainter = function(r) {
                  var U = this;
                  U._45O && (U._45O.remove(r),
                  U.redraw && U.redraw())
              }
              ,
              $._93db = function(g, h) {
                  var D = this;
                  D._45O && D._45O.each(function(K) {
                      K.draw ? K.draw(g, h) : K.call(D, g, h)
                  })
              }
              ,
              $._92db = function(G, a) {
                  var $ = this;
                  $._44O && $._44O.each(function(E) {
                      E.draw ? E.draw(G, a) : E.call($, G, a)
                  })
              }
          },
          ms_sm: function(w) {
              w.sm = function() {
                  return this.getSelectionModel()
              }
              ,
              w.setSelectableFunc = function(N) {
                  this.sm().setFilterFunc(N)
              }
              ,
              w.getSelectableFunc = function() {
                  return this.sm().getFilterFunc()
              }
              ,
              w.getSelectionModel = function() {
                  var E = this;
                  return E._selectionModel ? E._selectionModel : E.dm().sm()
              }
              ,
              w.isSelectionModelShared = function() {
                  return !this._selectionModel
              }
              ,
              w.setSelectionModelShared = function(Y) {
                  var F = this
                    , u = !F._selectionModel
                    , A = F.handleSelectionChange
                    , n = F.dm();
                  u !== Y && (F.invalidateSelection && F.invalidateSelection(),
                  Y ? (n.sm().ms(A, F),
                  F._selectionModel.ums(A, F),
                  F._selectionModel.dispose(),
                  F._selectionModel = E) : (n.sm().ums(A, F),
                  F._selectionModel = new Kg(n),
                  F._selectionModel.ms(A, F)),
                  F.onSelectionModelSharedChanged(),
                  F.fp("selectionModelShared", u, Y))
              }
              ,
              w.onSelectionModelSharedChanged = function() {
                  var J = this;
                  J.redraw(),
                  J.invalidateSelection && J.invalidateSelection()
              }
              ,
              w.removeSelection = function() {
                  var k = this.dm();
                  k.beginTransaction(),
                  this.sm().toSelection().each(k.remove, k),
                  k.endTransaction()
              }
              ,
              w.selectAll = function() {
                  var Z = this;
                  Z.sm().ss(Z.dm().toDatas(function(f) {
                      return Z.isVisible(f) && Z.isSelectable(f)
                  }))
              }
              ,
              w.isSelected = function(_) {
                  return this.sm().co(_)
              }
              ,
              w.isSelectedById = function(t) {
                  var u = this.dm().getDataById(t);
                  return u ? this.isSelected(u) : !1
              }
              ,
              w.isSelectable = function(f) {
                  return this.sm().isSelectable(f)
              }
          },
          ms_tx: function(R) {
              R._64I = 0,
              R._65O = 0,
              R.isScrollable = function() {
                  return this.getWidth() < this._64I
              }
              ,
              R._40o = function() {
                  return this.isScrollable()
              }
              ,
              R.getLogicalPoint = function(w) {
                  return Pf(w, this._canvas || this._view, this.tx(), this.ty ? this.ty() : 0)
              }
              ,
              R.tx = function(w) {
                  return w === V ? this.getTranslateX() : (this.setTranslateX(w),
                  void 0)
              }
              ,
              R.getTranslateX = function() {
                  return this._65O
              }
              ,
              R.setTranslateX = function(n) {
                  var s = this
                    , r = s.getWidth() - s._64I;
                  r > n && (n = r),
                  n > 0 && (n = 0),
                  n = w(n);
                  var P = s._65O;
                  s._65O = n,
                  s.fp(xs, P, n)
              }
          },
          ms_ty: function(O) {
              O._23Q = 0,
              O._66O = 0,
              O._41o = function() {
                  return this.getHeight() < this._23Q
              }
              ,
              O.getLogicalPoint = function(q) {
                  return Pf(q, this._canvas || this._view, this.tx ? this.tx() : 0, this.ty())
              }
              ,
              O.ty = function(B) {
                  return B === V ? this.getTranslateY() : (this.setTranslateY(B),
                  void 0)
              }
              ,
              O.getTranslateY = function() {
                  return this._66O
              }
              ,
              O.setTranslateY = function(a) {
                  var A = this
                    , U = A.getHeight() - A._23Q;
                  U > a && (a = U),
                  a > 0 && (a = 0),
                  a = w(a);
                  var k = A._66O;
                  A._66O = a,
                  A.fp(_l, k, a)
              }
          },
          ms_txy: function(n) {
              n._65O = 0,
              n._66O = 0,
              n.tx = function(K) {
                  return K === V ? this.getTranslateX() : (this.setTranslateX(K),
                  void 0)
              }
              ,
              n.ty = function(s) {
                  return s === V ? this.getTranslateY() : (this.setTranslateY(s),
                  void 0)
              }
              ,
              n.onTranslateEnded = function() {}
              ,
              n.setTranslate = function(S, p, q) {
                  var N = this;
                  if (q = Dg(q)) {
                      N._65I && N._65I.stop(!0);
                      var f = N.tx()
                        , T = N.ty();
                      q.action = function(z) {
                          N.setTranslate(f + (S - f) * z, T + (p - T) * z)
                      }
                      ,
                      q._37o = function() {
                          delete N._66I,
                          delete N._65I,
                          N.onTranslateEnded()
                      }
                      ,
                      N._66I = 1,
                      N._65I = Bl(q)
                  } else
                      N.tx(S),
                      N.ty(p)
              }
              ,
              n.getTranslateX = function() {
                  return this._65O
              }
              ,
              n.setTranslateX = function(W) {
                  var q = this;
                  W = q.adjustTranslateX(W);
                  var z = q._65O;
                  q._65O = W,
                  q.fp(xs, z, W)
              }
              ,
              n.getTranslateY = function() {
                  return this._66O
              }
              ,
              n.setTranslateY = function(M) {
                  var G = this;
                  M = G.adjustTranslateY(M);
                  var Z = G._66O;
                  G._66O = M,
                  G.fp(_l, Z, M)
              }
              ,
              n.adjustTranslateX = function(m) {
                  return w(m)
              }
              ,
              n.adjustTranslateY = function(e) {
                  return w(e)
              }
              ,
              n.translate = function(N, n, B) {
                  this.setTranslate(this.tx() + N, this.ty() + n, B)
              }
              ,
              n.getLogicalPoint = function(w) {
                  var n = this;
                  return Pf(w, this._canvas || n._view, n.tx(), n.ty())
              }
          },
          ms_dm: function(W) {
              W.dm = function(R) {
                  return R ? (this.setDataModel(R),
                  void 0) : this.getDataModel()
              }
              ,
              W.getDataModel = function() {
                  return this._dataModel
              }
          },
          ms_lp: function(q) {
              q.lp = function(I) {
                  return this.getLogicalPoint(I)
              }
          },
          ms_v: function(T) {
              T._disabled = !1,
              T.setDisabled = function(j, B) {
                  var W = this
                    , p = W._disabled;
                  p !== j && (p && (is(W._63O),
                  delete W._63O),
                  j && (Qc(W._view, W._63O = Pk(B)),
                  W.iv()),
                  W._disabled = j,
                  W.fp("disabled", p, j))
              }
              ,
              T.isDisabled = function() {
                  return this._disabled
              }
              ,
              T.getDisabledDiv = function() {
                  return this._63O
              }
              ,
              T.getView = function() {
                  return this._view
              }
              ,
              T.addToDOM = function(F) {
                  var L = this
                    , M = L.getView()
                    , h = M.style;
                  F = F || Y.body,
                  F.appendChild(M),
                  h.left = "0",
                  h.right = "0",
                  h.top = "0",
                  h.bottom = "0",
                  b(W, "resize", function() {
                      L.iv()
                  }),
                  L.iv()
              }
              ,
              T.getWidth = function() {
                  return this._view.clientWidth
              }
              ,
              T.getHeight = function() {
                  return this._view.clientHeight
              }
              ,
              T.setWidth = function(Q) {
                  var s = this;
                  s._view.style.width = Q + nc,
                  s.iv(),
                  s.fp && s.fp(gq, E, Q)
              }
              ,
              T.setHeight = function(k) {
                  var T = this;
                  T._view.style.height = k + nc,
                  T.iv(),
                  T.fp && T.fp(Ki, E, k)
              }
              ,
              T.setFocus = function(m) {
                  var G = this
                    , Y = G._currentEditor;
                  return m && Y && (Y.getView && (Y = Y.getView()),
                  Y.contains(m.target)) ? !1 : (aq(G._view),
                  G.endEditing && G.endEditing(),
                  G.fireViewEvent("focus"),
                  !0)
              }
              ,
              T.iv = function(Q) {
                  this.invalidate(Q)
              }
              ,
              T.invalidate = function(h) {
                  var P = this;
                  P._68I || (P._68I = 1,
                  rb(P.validate, P, E, h),
                  P.onInvalidated && P.onInvalidated(),
                  P.fireViewEvent("invalidate"))
              }
              ,
              T.validate = function() {
                  var J = this
                    , U = J._view;
                  if (J._68I && (delete J._68I,
                  U.parentNode))
                      if (0 === U.offsetWidth && 0 === U.offsetHeight && J._67I !== E)
                          J._67I === V && (J._67I = M.reinvalidateCount),
                          J._67I > 0 ? J._67I-- : J._67I = E,
                          J.iv();
                      else {
                          J.fireViewEvent("beginValidate"),
                          J.validateImpl(),
                          J.onValidated && J.onValidated(),
                          J.fireViewEvent("validate");
                          var W = J._63O;
                          W && (U.lastChild !== W && (is(W),
                          Qc(U, W)),
                          ib(W, 0, 0, J.getWidth(), J.getHeight())),
                          hg(J),
                          Pl(J),
                          ol(J)
                      }
              }
              ,
              T.layout = function(B, J, Y, P) {
                  1 === arguments.length ? ib(this, B) : ib(this, B, J, Y, P)
              }
              ,
              T.addViewListener = function(u, a, T) {
                  var B = this;
                  B._67O || (B._67O = new ze),
                  B._67O.add(u, a, T)
              }
              ,
              T.removeViewListener = function(u, v) {
                  this._67O.remove(u, v)
              }
              ,
              T.fireViewEvent = function(B) {
                  var n = this;
                  n._67O && (Xq(B) && (B = {
                      kind: B
                  }),
                  n._67O.fire(B)),
                  M.viewListener && M.viewListener(n, B)
              }
          },
          ms_tip: function(I) {
              I.setToolTipEnabled = function(U) {
                  var q = this;
                  U ? Ul || q._13o || (q.enableToolTip(),
                  q.fp("toolTipEnabled", !1, !0)) : q._13o && (q.disableToolTip(),
                  q.fp("toolTipEnabled", !0, !1))
              }
              ,
              I.isToolTipEnabled = function() {
                  return !!this._13o
              }
              ,
              I.enableToolTip = function() {
                  var e = this;
                  if (!Ul && !e._13o) {
                      e._13o = function(l) {
                          var O = e.getToolTip(l);
                          O != E ? M.toolTipContinual && M.isToolTipShowing() ? op(l, O) : (Ab(),
                          Lr = {
                              timeout: vk(Ei, Kc),
                              e: l,
                              info: O
                          }) : Ab()
                      }
                      ;
                      var y = e.getView();
                      b(y, Ao, e._13o),
                      b(y, "mouseleave", M.hideToolTip)
                  }
              }
              ,
              I.disableToolTip = function() {
                  var y = this;
                  if (y._13o) {
                      var X = y.getView();
                      D(X, Ao, y._13o),
                      D(X, "mouseleave", M.hideToolTip),
                      delete y._13o
                  }
              }
              ,
              I.getToolTip = function(F) {
                  var L = this;
                  if (L.getDataAt) {
                      var K = L.getDataAt(F);
                      return K ? K.getToolTip() : E
                  }
                  return L.getValue ? L.getValue() : void 0
              }
          },
          _52o: function(O) {
              O._zoom = 1,
              O._29I = Wk,
              O.zoomIn = function(y, W) {
                  this.setZoom(this._zoom * lm, y, W)
              }
              ,
              O.zoomOut = function(z, b) {
                  this.setZoom(this._zoom / lm, z, b)
              }
              ,
              O.zoomReset = function(O, I) {
                  this.setZoom(1, O, I)
              }
              ,
              O.scrollZoomIn = function($) {
                  this.setZoom(this._zoom * Qe, E, $)
              }
              ,
              O.scrollZoomOut = function(B) {
                  this.setZoom(this._zoom / Qe, E, B)
              }
              ,
              O.pinchZoomIn = function($) {
                  this.setZoom(this._zoom * pd, E, $)
              }
              ,
              O.pinchZoomOut = function(y) {
                  this.setZoom(this._zoom / pd, E, y)
              }
              ,
              O.adjustZoom = function(g) {
                  return Qq > g ? Qq : g > Ui ? Ui : g
              }
              ,
              O.getZoom = function() {
                  return this._zoom
              }
              ,
              O.setZoom = function(l, T, z) {
                  var p = this;
                  if (T = Dg(T)) {
                      p._14o && p._14o.stop(!0);
                      var k = p._zoom;
                      T.action = function(h) {
                          p._96O(k + (l - k) * h, z)
                      }
                      ,
                      T._37o = function() {
                          delete p._zooming,
                          delete p._14o,
                          p.onZoomEnded()
                      }
                      ,
                      p._zooming = 1,
                      p._14o = Bl(T)
                  } else
                      p._96O(l, z)
              }
              ,
              O._96O = function(M, K) {
                  var p = this;
                  if (M = p.adjustZoom(M),
                  M !== p._zoom) {
                      p.validate();
                      var l = p._29I
                        , f = p._zoom;
                      0 !== l.width && 0 !== l.height && (K = K ? K : {
                          x: l.x + l.width / 2,
                          y: l.y + l.height / 2
                      },
                      p.tx((K.x - l.x) * f - K.x * M),
                      p.ty((K.y - l.y) * f - K.y * M)),
                      p._zoom = M,
                      p.fp("zoom", f, M)
                  }
              }
          },
          ms_edge: function(R) {
              R._2I = function(f) {
                  var S = this;
                  S._44I || (S._44I = new Mh),
                  S._42I || (S._42I = new Mh),
                  S._44I.add(f),
                  S._42I.add(f),
                  S._20I()
              }
              ,
              R._4I = function(i) {
                  var t = this;
                  t._44I || (t._44I = new Mh),
                  t._43I || (t._43I = new Mh),
                  t._44I.add(i),
                  t._43I.add(i),
                  t._20I()
              }
              ,
              R._16I = function($) {
                  var r = this;
                  r._44I.remove($),
                  r._42I.remove($),
                  r._44I.isEmpty() && delete r._44I,
                  r._42I.isEmpty() && delete r._42I,
                  r._20I()
              }
              ,
              R._18I = function(k) {
                  var f = this;
                  f._44I.remove(k),
                  f._43I.remove(k),
                  f._44I.isEmpty() && delete f._44I,
                  f._43I.isEmpty() && delete f._43I,
                  f._20I()
              }
              ,
              R._20I = function() {
                  var l = this;
                  if (delete l._45I,
                  !l._44I || l._44I.isEmpty())
                      return delete l._70O,
                      void 0;
                  var c;
                  l._44I.each(function(N) {
                      N.isLooped() && (c || (c = {}),
                      c[N._id] || (l._45I || (l._45I = new Mh),
                      l._45I.add(N),
                      c[N._id] = N))
                  }),
                  c ? (l._70O = new Mh,
                  l._44I.each(function(g) {
                      c[g._id] ? "A" === c[g._id] || (c[g._id] = "A",
                      l._70O.add(g)) : l._70O.add(g)
                  })) : l._70O = l._44I
              }
              ,
              R.hasAgentEdges = function() {
                  return !!this._49I && !this._49I.isEmpty()
              }
              ,
              R.getSourceAgentEdges = function() {
                  return this._46I
              }
              ,
              R.getTargetAgentEdges = function() {
                  return this._47I
              }
              ,
              R._1I = function(n) {
                  var P = this;
                  P._46I || (P._46I = new Mh),
                  P._48I || (P._48I = new Mh),
                  P._46I.add(n),
                  P._48I.add(n),
                  P._19I()
              }
              ,
              R._3I = function(T) {
                  var o = this;
                  o._47I || (o._47I = new Mh),
                  o._48I || (o._48I = new Mh),
                  o._47I.add(T),
                  o._48I.add(T),
                  o._19I()
              }
              ,
              R._15I = function(F) {
                  var G = this;
                  G._46I.remove(F),
                  G._48I.remove(F),
                  G._46I.isEmpty() && delete G._46I,
                  G._48I.isEmpty() && delete G._48I,
                  G._19I()
              }
              ,
              R._17I = function(u) {
                  var R = this;
                  R._47I.remove(u),
                  R._48I.remove(u),
                  R._47I.isEmpty() && delete R._47I,
                  R._48I.isEmpty() && delete R._48I,
                  R._19I()
              }
              ,
              R._19I = function() {
                  var P = this;
                  delete P._49I;
                  var f = P._48I;
                  if (f && !f.isEmpty()) {
                      var _ = {};
                      f.each(function(B) {
                          _[B._id] ? P._49I || (P._49I = new Mh) : _[B._id] = B
                      }),
                      P._49I ? f.each(function(B) {
                          _[B._id] && (P._49I.add(B),
                          delete _[B._id])
                      }) : P._49I = f
                  }
              }
              ,
              R.getLoopedEdges = function() {
                  return this._45I
              }
              ,
              R.getEdges = function() {
                  return this._70O
              }
              ,
              R.getAgentEdges = function() {
                  return this._49I
              }
              ,
              R.getSourceEdges = function() {
                  return this._42I
              }
              ,
              R.getTargetEdges = function() {
                  return this._43I
              }
              ,
              R._8I = function() {
                  this._70O && this._70O.each(function(L) {
                      L._7I()
                  })
              }
          },
          ms_shadow: function(K) {
              En.PARAMS.forEach(function(c) {
                  var J = c.replace(/(^|\.)[a-z]/g, function(y) {
                      return y[y.length - 1].toUpperCase()
                  })
                    , q = J.charAt(0).toLowerCase() + J.substr(1);
                  K["getShadow" + J] = function() {
                      return this._getShadowParam(q)
                  }
                  ,
                  K["setShadow" + J] = function(g) {
                      this._setShadowParam(q, g)
                  }
              }),
              K.enableShadow = function(I) {
                  this.shadowMap.setShadow(!0, I)
              }
              ,
              K.disableShadow = function() {
                  this.shadowMap.setShadow(!1)
              }
              ,
              K._getShadowParam = function(N) {
                  return this.shadowMap.getShadow()[N]
              }
              ,
              K._setShadowParam = function(q, G) {
                  var e = this._getShadowParam(q)
                    , A = {};
                  A[q] = G;
                  var L = this.shadowMap;
                  L.setShadow(L.enable, A),
                  this.firePropertyChange("shadow" + q.charAt(0).toUpperCase() + q.substr(1), e, G)
              }
          }
      };
      rc(M, {
          getVersion: function() {
              return "7.2.1"
          }
      }, !0),
      rc(M, {
          numberDigits: 5,
          crossOrigin: "",
          baseZIndex: V,
          isTouchable: Ul,
          mockTouch: !0,
          devicePixelRatio: W.devicePixelRatio ? W.devicePixelRatio : 1,
          reinvalidateCount: 3,
          hitMaxArea: 3e3,
          imageCacheThreshold: 20,
          autoMakeVisible: !0,
          autoHideScrollBar: !0,
          disabledOpacity: .4,
          disabledBackground: l.disabledBackground,
          forceHierarchicalSerialization: !0,
          hoverDelay: 600,
          clickDelay: 200,
          toolTipDelay: 800,
          toolTipContinual: !1,
          getDragger: function() {
              return gd
          },
          lineCap: "butt",
          lineJoin: "round",
          imageGradient: "linear.northeast",
          dashPattern: [16, 16],
          blockMinSize: 1,
          encodeStringKey: null,
          doubleClickSpeed: 500,
          doubleClickRange: 1,
          doubleTouchRange: 20,
          touchMoveThreshold: 10,
          animDuration: 200,
          animEasing: function(h) {
              return h * h
          },
          labelColor: ck,
          labelSelectColor: yd,
          labelFont: "12px arial, sans-serif",
          widgetIndent: Ul ? 30 : 20,
          widgetRowHeight: Ul ? 30 : 20,
          widgetHeaderHeight: Ul ? 32 : 22,
          widgetTitleHeight: Ul ? 34 : 24,
          scrollBarColor: sd,
          scrollBarSize: 7,
          scrollBarTimeout: 1e3,
          scrollBarMinLength: 20,
          scrollBarInteractiveSize: Ul ? 32 : 16,
          zoomIncrement: 1.3,
          scrollZoomIncrement: 1.05,
          pinchZoomIncrement: 1.08,
          pinchZoomThreshold: 1,
          zoomMax: 20,
          zoomMin: .01,
          segmentResolution: 12,
          shapeResolution: 24,
          shapeSide: 24,
          intersectionLineRect: Sq,
          intersectionLineLine: Wr,
          isEnter: bq,
          isEsc: pg,
          isDelete: Xr,
          isSpace: ec,
          isLeft: Ll,
          isUp: yo,
          isRight: zp,
          isDown: Cf,
          isTouchEvent: sg,
          getTarget: tj,
          isString: Xq,
          isNumber: te,
          isBoolean: mf,
          isArray: $c,
          isSelectAll: td,
          isFunction: Oi,
          isObject: Ql,
          getPropertyValue: sj,
          setPropertyValue: Hk,
          addMethod: rc,
          isMobile: function() {
              var K;
              return function() {
                  return K !== V ? K : (K = !1,
                  function(Y) {
                      (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(Y) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(Y.substr(0, 4))) && (K = !0)
                  }(navigator.userAgent || navigator.vendor || W.opera),
                  K)
              }
          }(),
          createGradient: function(t, e, j, Y, R, M, S, K) {
              var H = sc[e];
              return H(t, j, Y, R, M, S, K)
          },
          appendToScreen: function(k) {
              k = k.getView ? k.getView() : k,
              (Y.fullscreenElement || Y.mozFullScreenElement || Y.webkitFullscreenElement || Y.msFullscreenElement || Y.body).appendChild(k)
          },
          encodeString: function(L) {
              return n.Math.encodeBase64(L, M.encodeStringKey)
          },
          decodeString: function(z) {
              return n.Math.decodeBase64(z, M.encodeStringKey)
          },
          findView: function(q) {
              var X = function(T, W) {
                  var f = W._ht;
                  f && T.push(f);
                  var y = W.children
                    , u = y.length;
                  if (u)
                      for (var E = 0; u > E; E++)
                          X(T, y[E])
              }
                , Q = [];
              X(Q, Y.body);
              var V = function(G, F) {
                  for (var K = "2d" === F ? qg.GraphView : rn.Graph3dView, q = 0, $ = G.length; $ > q; q++)
                      if (G[q]instanceof K)
                          return Q[q];
                  return null
              };
              return "all" === q ? Q : "2d" === q ? V(Q, "2d") : "3d" === q ? V(Q, "3d") : V(Q, "3d") || V(Q, "2d")
          },
          toggleFullscreen: function(y) {
              var A = y.getView();
              if (Y.fullscreenElement || Y.mozFullScreenElement || Y.webkitFullscreenElement || Y.msFullscreenElement)
                  Y.exitFullscreen ? Y.exitFullscreen() : Y.msExitFullscreen ? Y.msExitFullscreen() : Y.mozCancelFullScreen ? Y.mozCancelFullScreen() : Y.webkitExitFullscreen && Y.webkitExitFullscreen();
              else {
                  var v = !0;
                  if (y.isSelfViewEvent) {
                      var X = y.getX()
                        , u = y.getY()
                        , J = y.getWidth()
                        , Q = y.getHeight()
                        , s = A.style.background
                        , x = A.style.backgroundColor;
                      s || x || (A.style.backgroundColor = "white"),
                      A.requestFullscreen ? A.requestFullscreen() : A.msRequestFullscreen ? A.msRequestFullscreen() : A.mozRequestFullScreen ? A.mozRequestFullScreen() : A.webkitRequestFullscreen && A.webkitRequestFullscreen();
                      var F = setInterval(function() {
                          if (A !== (Y.fullscreenElement || Y.mozFullScreenElement || Y.webkitFullscreenElement || Y.msFullscreenElement))
                              clearInterval(F),
                              y.setX(X),
                              y.setY(u),
                              y.setWidth(J),
                              y.setHeight(Q),
                              y._fullscreen = !1,
                              A.style.oldBackgroundColor = x,
                              y.iv();
                          else {
                              var f = n.Default.getWindowInfo();
                              (v || f.width !== y.getWidth() || f.height !== y.getHeight()) && (y.setX(f.left),
                              y.setY(f.top),
                              y.setWidth(f.width),
                              y.setHeight(f.height),
                              y._fullscreen = !0,
                              y.iv(),
                              v = !1)
                          }
                      }, 500)
                  } else {
                      var O = A.style.left
                        , _ = A.style.top
                        , J = A.style.width
                        , Q = A.style.height
                        , s = A.style.background
                        , x = A.style.backgroundColor;
                      s || x || (A.style.backgroundColor = "white"),
                      A.requestFullscreen ? A.requestFullscreen() : A.msRequestFullscreen ? A.msRequestFullscreen() : A.mozRequestFullScreen ? A.mozRequestFullScreen() : A.webkitRequestFullscreen && A.webkitRequestFullscreen();
                      var F = setInterval(function() {
                          if (A !== (Y.fullscreenElement || Y.mozFullScreenElement || Y.webkitFullscreenElement || Y.msFullscreenElement))
                              clearInterval(F),
                              A.style.left = O,
                              A.style.top = _,
                              A.style.width = J,
                              A.style.height = Q,
                              A.style.oldBackgroundColor = x,
                              y.iv();
                          else {
                              var E = n.Default.getWindowInfo();
                              (v || E.width !== y.getWidth() || E.height !== y.getHeight()) && (ib(y),
                              v = !1)
                          }
                      }, 500)
                  }
              }
          },
          appendTimeStamp: function(Q) {
              return Q
          },
          setCompType: function(T, E) {
              Oi(E) || Ql(E) ? Yn[T] = E : kp(T)
          },
          getCompType: function(G) {
              var O = Yn[G];
              return O === V && Jm.test(G) && kp(G),
              O
          },
          getCompTypeMap: function() {
              return Yn
          },
          drawCompType: function(d, z, V, n, E, U) {
              d(z, V, n, E, U)
          },
          numberListener: function() {
              var f = {
                  46: 1,
                  8: 1,
                  9: 1,
                  27: 1,
                  13: 1,
                  109: 1,
                  110: 1,
                  189: 1,
                  190: 1
              };
              return function(I) {
                  var i = I.keyCode;
                  f[i] || 65 === i && M.isCtrlDown(I) || 86 === i && M.isCtrlDown(I) || 67 === i && M.isCtrlDown(I) || 88 === i && M.isCtrlDown(I) || i >= 35 && 40 >= i || (I.shiftKey || 48 > i || i > 57) && (96 > i || i > 105) && I.preventDefault()
              }
          }(),
          ignoreKeyCodes: [122, 123],
          preventDefault: function(N) {
              var e = N.target.tagName;
              ("DIV" === e || "CANVAS" === e) && !(M.ignoreKeyCodes.indexOf(N.keyCode) >= 0) && ("keydown" !== N.type || Ll(N) || zp(N) || yo(N) || Cf(N) || Xr(N) || 65 === N.keyCode && (N.metaKey || N.ctrlKey)) && (N.preventDefault(),
              N.preventManipulation && N.preventManipulation())
          },
          getWindowInfo: function() {
              var O = Y.documentElement
                , a = O && (O.scrollLeft || O.scrollTop) ? O : Y.body;
              return {
                  target: a,
                  left: a.scrollLeft,
                  top: a.scrollTop,
                  width: W.innerWidth || a.clientWidth,
                  height: W.innerHeight || a.clientHeight
              }
          },
          isDragging: function() {
              return !!gd
          },
          isLeftButton: function(D) {
              return sg(D) ? !0 : 0 === D.button
          },
          isMiddleButton: function(y) {
              return sg(y) ? !1 : y && (1 === y.button || 4 & (y.buttons || 0))
          },
          isRightButton: function(I) {
              return sg(I) ? !1 : I && (2 === I.button || 2 & (I.buttons || 0))
          },
          isInput: function(C) {
              if (!C)
                  return !1;
              var p = C.tagName;
              return "INPUT" === p || "TEXTAREA" === p || "SELECT" === p
          },
          getTouchCount: function(r) {
              return sg(r) ? r.touches.length : 1
          },
          isDoubleClick: function() {
              function Z(I) {
                  I.details = 0,
                  I.timeout = null,
                  I.lastPoint = null
              }
              var T = {};
              return io = new m,
              xc = io.getTime(),
              function(W) {
                  if (Yp(W) > 1)
                      return !1;
                  var o = W.button == E ? "" : W.button
                    , J = W.type + o
                    , u = J + "_isDoubleClick"
                    , z = T[J];
                  if (z || (z = T[J] = {
                      details: 0,
                      timeout: null,
                      lastPoint: null
                  }),
                  W[u] === V) {
                      W[u] = !0;
                      var I = Gp(W);
                      z.timeout && (_d(z.timeout),
                      z.timeout = null);
                      var O = sg(W) ? M.doubleTouchRange : M.doubleClickRange;
                      z.lastPoint && Qf(z.lastPoint, I) > O && Z(z),
                      z.lastPoint = I,
                      z.details++,
                      z.timeout = vk(function() {
                          Z(this)
                      }
                      .bind(z), M.doubleClickSpeed)
                  }
                  return 2 === z.details
              }
          }(),
          isShiftDown: function(W) {
              return W ? W.shiftKey : de["16"]
          },
          isCtrlDown: function(_) {
              return _ ? Dc ? _.metaKey : _.ctrlKey : Dc ? de["91"] : de["17"]
          },
          getClientPoint: function(x) {
              return sg(x) && (x = bb(x)),
              {
                  x: x.clientX,
                  y: x.clientY
              }
          },
          isMouseEvent: function(F) {
              return F instanceof MouseEvent || 0 === F.type.indexOf("mouse")
          },
          getTargetElement: function(G) {
              if (M.isMouseEvent(G) || !Y.elementFromPoint)
                  return G.target;
              var J = Bd(G);
              return Y.elementFromPoint(J.x, J.y)
          },
          getPagePoint: function(w) {
              return sg(w) && (w = bb(w)),
              {
                  x: w.pageX,
                  y: w.pageY
              }
          },
          createObject: function(k, o) {
              var U = new k;
              for (var S in o) {
                  var Q = o[S];
                  if (Oi(Q))
                      U[S] = Q;
                  else if (0 === S.indexOf("s:"))
                      U.s(S.substr(2), o[S]);
                  else if (0 === S.indexOf("a:"))
                      U.a(S.substr(2), o[S]);
                  else {
                      var s = zn(S)
                        , Q = o[S];
                      U[s] ? (U[s](Q),
                      "setToolTip" === s && U.enableToolTip && U.enableToolTip()) : U[S] = Q
                  }
              }
              return U
          },
          setImage: function(h, s, t, m) {
              var x = arguments.length;
              4 === x ? lq(h, m, s, t) : 2 === x ? Xq(s) ? lq(h, s) : Gn(h, s) : 1 === x && lq(h, h)
          },
          getImage: function(A, i, T) {
              var a;
              if (A == E)
                  return E;
              if (Ql(A) ? a = A : (a = wm[A],
              A && a === V && (xq && xq[A] || lq(A, A))),
              i && a && a.tagName) {
                  var n;
                  n = "override" === T ? "colors_override" : "override_rgb" === T ? "colors_override_rgb" : "override_a" === T ? "colors_override_a" : "colors",
                  a[n] || (a[n] = {
                      __count__: 0
                  });
                  var w = a[n][i];
                  return w || (a[n].__count__ > M.imageCacheThreshold && (a[n] = {
                      __count__: 0
                  }),
                  w = ci(a, bd(i), a.width, a.height, T),
                  a[n][i] = w,
                  a[n].__count__++),
                  w
              }
              return a
          },
          isImageComplete: function(t, c, W) {
              var J = Ti(t);
              if (!J)
                  return !1;
              if (J.tagName)
                  return J.complete;
              for (var s, t, n, C = J.comps, X = !0, S = 0, q = C.length; q > S; S++)
                  if (s = C[S],
                  n = s.type,
                  "image" === s.type) {
                      t = s.name,
                      t && t.func && (t = yn(t, c));
                      var L = hp(t, c, W);
                      if (!L) {
                          X = !1;
                          break
                      }
                  } else if (Jm.test(n) && M.getCompType(n) === V) {
                      X = !1,
                      kp(n);
                      break
                  }
              return X
          },
          getId: function() {
              var f = 1;
              return function() {
                  return ++f
              }
          }(),
          callLater: function(M, _, B, D) {
              var S = function() {
                  M.apply(_, B)
              };
              return D ? vk(S, D) : W.requestAnimationFrame(S)
          },
          cancelLater: function(f, o) {
              o ? _d(f) : W.cancelAnimationFrame(f)
          },
          clone: function(W) {
              if (null == W || "object" != typeof W)
                  return W;
              if (W instanceof Date) {
                  var z = new Date;
                  return z.setTime(W.getTime()),
                  z
              }
              if (W instanceof Array) {
                  for (var z = [], w = 0, I = W.length; I > w; w++)
                      z[w] = Ej(W[w]);
                  return z
              }
              if (W instanceof Mh) {
                  for (var z = new Mh, w = 0, I = W.length; I > w; w++)
                      z.set(w, Ej(W.get(w)));
                  return z
              }
              if (W instanceof _i)
                  return W;
              if (W instanceof G) {
                  var z = {};
                  for (var e in W)
                      W.hasOwnProperty(e) && (z[e] = Ej(W[e]));
                  return z
              }
              return W
          },
          callWhenLoaded: function(r, y) {
              y = y || 100;
              var b = Oc(r, y);
              Pi || (Pi = {}),
              Pi[b] = {
                  tick: b,
                  cb: r,
                  delay: y
              }
          },
          beforeLoadURL: function(F, i) {
              if (Pi) {
                  var e = {};
                  for (var i in Pi) {
                      var E = Pi[i];
                      _d(E.tick);
                      var A = Oc(E.cb, E.delay);
                      e[A] = {
                          tick: A,
                          delay: E.delay,
                          cb: E.cb
                      }
                  }
                  Pi = e
              }
              return M.convertURL ? M.convertURL(F, i) : F
          },
          convertURL: function(e) {
              return e
          },
          handleRefGraphLoaded: function() {},
          handleCompTypeLoaded: function() {},
          handleImageLoaded: function() {},
          handleUnfoundImage: function() {
              return M.getImage("default_blank")
          },
          resizeImagePOT: function(M, P) {
              if (!M || !M.tagName)
                  return M;
              var B = M.width
                , q = M.height;
              if (!B || !q)
                  return M;
              if (rk.isPOT(B) && rk.isPOT(q) && (!P || B === q))
                  return M;
              var $, E;
              P ? E = $ = rk.nearestPOT(Math.min(B, q)) : ($ = rk.nearestPOT(B),
              E = rk.nearestPOT(q));
              var f = Jl()
                , C = f.getContext("2d");
              return Uj(f, $, E, 1),
              C.drawImage(M, 0, 0, B, q, 0, 0, $, E),
              f
          },
          sortFunc: function(W, I) {
              if (W === I)
                  return 0;
              if (W == E && I != E)
                  return 1;
              if (W != E && I == E)
                  return -1;
              if (W == E && I == E)
                  return 0;
              var n, M = typeof W, X = typeof I;
              return M === Tk && X === Tk ? n = W.localeCompare(I) : M === Mc && X === Mc && (n = W - I),
              n === V && (n = ("" + W).localeCompare("" + I)),
              n > 0 ? 1 : 0 > n ? -1 : 0
          },
          getClassMap: function() {
              return jj
          },
          getClass: function(T) {
              if (Xq(T)) {
                  var m, l = jj[T];
                  if (!l) {
                      m = T.split("."),
                      l = W;
                      for (var N = 0; N < m.length; N++)
                          l = l[m[N]];
                      jj[T] = l
                  }
                  return l
              }
              return T
          },
          def: function(N, b, P) {
              var h, g, i, G = function() {};
              if (G.prototype = b.prototype,
              h = new G,
              Xq(N)) {
                  if (jj[N])
                      throw "'" + N + "' already defined";
                  i = No(N),
                  h.getClassName = function() {
                      return N
                  }
              } else
                  i = N;
              if (h.constructor = i,
              h.getClass = function() {
                  return i
              }
              ,
              h.getSuperClass = function() {
                  return b
              }
              ,
              P)
                  for (g in P)
                      tb[g] && tb.hasOwnProperty(g) ? tb[g](h, P) : qs(h, P, g);
              i.prototype = h,
              i.superClass = b.prototype
          },
          startAnim: function() {
              var V = function(b) {
                  b.duration && (b.startTime = Nr()),
                  b.timeId = rb(b.tick, E, E, b.interval)
              };
              return function(N) {
                  return N = Ej(N),
                  N.easing = N.easing || M.animEasing,
                  N.duration || N.frames || (N.duration = M.animDuration),
                  N.t = 0,
                  N.duration ? N.interval = 0 : (N.frame = 0,
                  N.interval = N.interval || 10),
                  N.tick = function() {
                      if (N.duration) {
                          var k = (Nr() - N.startTime) / N.duration;
                          if (k > 1 && (k = 1),
                          N.t = k,
                          N.action(N.easing(k), k),
                          !N.isRunning())
                              return;
                          1 === k ? N.stop() : N._isPaused || (N.timeId = rb(N.tick))
                      } else {
                          if (N.frame++,
                          k = N.t = N.frame / N.frames,
                          N.action(N.easing(k), k),
                          !N.isRunning())
                              return;
                          N.frame < N.frames ? N._isPaused || (N.timeId = rb(N.tick, E, E, N.interval)) : N.stop()
                      }
                  }
                  ,
                  N.resume = function() {
                      N._isPaused && (delete N._isPaused,
                      N.duration ? N.t < 1 && (N.startTime = Nr() - N.duration * N.t,
                      N.timeId = rb(N.tick)) : N.frame < N.frames && (N.timeId = rb(N.tick, E, E, N.interval)))
                  }
                  ,
                  N.pause = function() {
                      zj(N.timeId, !N.duration),
                      N._isPaused = !0
                  }
                  ,
                  N.isPaused = function() {
                      return this._isPaused
                  }
                  ,
                  N.stop = function(F) {
                      N.isRunning() && (zj(N.timeId, !N.duration),
                      delete N.timeId,
                      N.duration ? N.t < 1 && F && (N.t = 1,
                      N.action(N.easing(1), 1)) : N.frame < N.frames && F && (N.frame = N.frames,
                      N.action(N.easing(1), 1)),
                      N._37o && N._37o(),
                      N.finishFunc && N.finishFunc())
                  }
                  ,
                  N.isRunning = function() {
                      return N.timeId != E
                  }
                  ,
                  N.delay ? rb(V, E, [N], N.delay) : V(N),
                  N
              }
          }(),
          getTextSize: function() {
              var j = {}
                , d = Y ? Jl().getContext("2d") : E;
              return function(O, R) {
                  d.font = O ? O : Id;
                  var g = j[d.font];
                  return g || (g = 2 * d.measureText("e").width + 4,
                  j[d.font] = g),
                  {
                      width: d.measureText(R).width + 4,
                      height: g
                  }
              }
          }(),
          drawText: function(z, M, n, $, q, k, A, F, d, T) {
              if (M != E) {
                  var b = eh(n, M)
                    , V = {};
                  V.y = T && T !== De ? T === Dj ? k + b.height / 2 : k + F - b.height / 2 : k + F / 2,
                  V.x = d && d !== Mb ? d === Gq ? q + A - b.width / 2 : q + A / 2 : q + b.width / 2,
                  bs(z, M, V, n, $)
              }
          },
          getDistance: function(Y, z) {
              var P = Y.length;
              return z ? 3 === P ? O(Kq(Y[0] - z[0]) + Kq(Y[1] - z[1]) + Kq(Y[2] - z[2])) : 2 === P ? O(Kq(Y[0] - z[0]) + Kq(Y[1] - z[1])) : Y.z === V ? O(Kq(z.x - Y.x) + Kq(z.y - Y.y)) : O(Kq(z.x - Y.x) + Kq(z.y - Y.y) + Kq(z.z - Y.z)) : 3 === P ? O(Kq(Y[0]) + Kq(Y[1]) + Kq(Y[2])) : 2 === P ? O(Kq(Y[0]) + Kq(Y[1])) : void 0
          },
          brighter: function(D, P) {
              return 0 > P && (P = -P),
              ur(D, P ? P : 40)
          },
          darker: function(x, d) {
              return d > 0 && (d = -d),
              ur(x, d ? d : -40)
          },
          unionPoint: function(x, m) {
              if (!x)
                  return E;
              if (2 === arguments.length)
                  return x && m ? {
                      x: K(x.x, m.x),
                      y: K(x.y, m.y),
                      width: u(x.x - m.x),
                      height: u(x.y - m.y)
                  } : E;
              var W = x;
              if (W._as && (W = W._as),
              W.length === V)
                  return E;
              var S = W.length;
              if (0 >= S)
                  return E;
              for (var N = 1, r = W[0], k = {
                  x: r.x,
                  y: r.y,
                  width: 0,
                  height: 0
              }; S > N; N++) {
                  r = W[N];
                  var T = K(k.x, r.x)
                    , P = X(k.x + k.width, r.x)
                    , t = K(k.y, r.y)
                    , Y = X(k.y + k.height, r.y);
                  k.x = T,
                  k.y = t,
                  k.width = P - T,
                  k.height = Y - t
              }
              return k
          },
          unionRect: function(e, H) {
              if (e && !H)
                  return Ej(e);
              if (!e && H)
                  return Ej(H);
              if (e && H) {
                  var Z = {
                      x: K(e.x, H.x),
                      y: K(e.y, H.y)
                  };
                  return Z.width = X(e.x + e.width, H.x + H.width) - Z.x,
                  Z.height = X(e.y + e.height, H.y + H.height) - Z.y,
                  Z
              }
              return E
          },
          containsPoint: function(_, k, O, W) {
              if (W != E && 1 !== W) {
                  var Y = _.x + _.width / 2
                    , l = _.y + _.height / 2;
                  _ = {
                      x: Y - _.width / 2 * W,
                      y: l - _.height / 2 * W,
                      width: _.width * W,
                      height: _.height * W
                  }
              }
              if (O) {
                  var N = _.width / 2
                    , z = _.height / 2
                    , r = o(-O)
                    , w = P(-O)
                    , p = k.x - _.x - N
                    , v = k.y - _.y - z;
                  return k = {
                      x: w * p - r * v,
                      y: r * p + w * v
                  },
                  tp({
                      x: -N,
                      y: -z,
                      width: _.width,
                      height: _.height
                  }, k)
              }
              return !(!_ || k.x < _.x || k.y < _.y || k.x > _.x + _.width || k.y > _.y + _.height)
          },
          containsRect: function(k, b) {
              if (!k || !b)
                  return !1;
              var Z = b.x
                , y = b.y
                , R = b.width
                , N = b.height
                , Y = k.width
                , r = k.height;
              if (0 > (Y | r | R | N))
                  return !1;
              var S = k.x
                , e = k.y;
              if (S > Z || e > y)
                  return !1;
              if (Y += S,
              R += Z,
              Z >= R) {
                  if (Y >= S || R > Y)
                      return !1
              } else if (Y >= S && R > Y)
                  return !1;
              if (r += e,
              N += y,
              y >= N) {
                  if (r >= e || N > r)
                      return !1
              } else if (r >= e && N > r)
                  return !1;
              return !0
          },
          intersectsRect: function(G, J) {
              if (!G || !J)
                  return !1;
              var z = J.width
                , E = J.height
                , O = G.width
                , i = G.height;
              if (0 >= O || 0 >= i || 0 >= z || 0 >= E)
                  return !1;
              var b = J.x
                , e = J.y
                , y = G.x
                , B = G.y;
              return O += y,
              i += B,
              z += b,
              E += e,
              O > b && i > e && z > y && E > B
          },
          intersection: function(j, t) {
              if (!j || !t)
                  return E;
              var Q = t.x
                , g = t.y
                , W = j.x
                , k = j.y
                , $ = Q
                , P = g
                , M = W
                , v = k;
              return $ += t.width,
              P += t.height,
              M += j.width,
              v += j.height,
              W > Q && (Q = W),
              k > g && (g = k),
              $ > M && ($ = M),
              P > v && (P = v),
              $ -= Q,
              P -= g,
              0 >= $ || 0 >= P ? E : {
                  x: Q,
                  y: g,
                  width: $,
                  height: P
              }
          },
          grow: function(T, I, B) {
              B === V && (B = I),
              T.x -= I,
              T.y -= B,
              T.width = T.width + 2 * I,
              T.height = T.height + 2 * B
          },
          getScreenPoint: function(a, P, N, v, i, l, R) {
              var s = N.getBoundingClientRect()
                , L = a * (l || 1) - N.scrollLeft + (v || 0)
                , o = P * (R || 1) - N.scrollTop + (i || 0)
                , F = Fr(N, !1);
              if (F) {
                  var I = new Rh(L,o,0);
                  return I.applyMatrix4(F),
                  console.log(I),
                  {
                      x: I.x,
                      y: I.y
                  }
              }
              return {
                  x: L + s.left,
                  y: o + s.top
              }
          },
          getLogicalPoint: function(S, H, j, a, R, T) {
              var I, z, B = H.getBoundingClientRect();
              S.target ? (Tr(S) ? Dc ? de["91"] = !0 : de["17"] = !0 : Dc ? de["91"] = !1 : de["17"] = !1,
              de["16"] = Oh(S) ? !0 : !1,
              S = sg(S) ? bb(S) : S,
              I = S.clientX,
              z = S.clientY) : (I = S.x,
              z = S.y);
              var u = Fr(H, !0);
              if (u) {
                  var l = new Rh(I,z,0);
                  l.applyMatrix4(u);
                  do {
                      if (Math.abs(l.z) <= 1e-6)
                          break;
                      var U = new Rh(I,z,1);
                      if (U.applyMatrix4(matrix),
                      Math.abs(U.z) <= 1e-6) {
                          l = U;
                          break
                      }
                      if (U.sub(l),
                      Math.abs(U.z) <= 1e-6)
                          break;
                      l.addScaledVector(U, -l.z / U.z)
                  } while (!1);return {
                      x: (l.x + H.scrollLeft - (j || 0)) / (R || 1),
                      y: (l.y + H.scrollTop - (a || 0)) / (T || 1)
                  }
              }
              return {
                  x: (I - B.left + H.scrollLeft - (j || 0)) / (R || 1),
                  y: (z - B.top + H.scrollTop - (a || 0)) / (T || 1)
              }
          },
          removeHTML: function() {
              var p;
              return function(w) {
                  return w && w.getView && (w = w.getView()),
                  w && w.parentNode ? p === w ? !0 : (p = w,
                  w.parentNode.removeChild(w),
                  p = E,
                  !0) : !1
              }
          }(),
          getToolTipDiv: function() {
              if (!vf) {
                  vf = cf(),
                  Tq = cf();
                  var N = vf.style;
                  M.baseZIndex != E && (N.zIndex = $n(M.baseZIndex) + 3 + ""),
                  N.whiteSpace = "nowrap",
                  N.color = M.toolTipLabelColor,
                  N.background = M.toolTipBackground,
                  N.font = M.toolTipLabelFont,
                  N.padding = "5px",
                  N.boxShadow = "0px 0px 3px " + M.toolTipShadowColor
              }
              return vf
          },
          isToolTipShowing: function() {
              return vf && vf.parentNode ? !0 : Tq && Tq.parentNode ? !0 : !1
          },
          hideToolTip: function() {
              is(vf),
              is(Tq),
              Vf()
          },
          showToolTip: function(z, t) {
              if (!z || t == E)
                  return Ab(),
                  void 0;
              M.getToolTipDiv();
              var s, m;
              if (t.html ? (t = t.html,
              s = Tq,
              is(vf)) : (s = vf,
              is(Tq)),
              m = s.style,
              s.innerHTML = t,
              s.parentNode || n.Default.appendToScreen(s),
              z.target) {
                  z = Bd(z);
                  var g = $e()
                    , O = z.x
                    , W = z.y
                    , b = Ul ? 60 : 12;
                  if (Ul) {
                      var A = s.getBoundingClientRect();
                      m.left = O - A.width / 2 + nc,
                      m.top = W - A.height - b < g.top ? W + b + nc : W - A.height - b + nc
                  } else {
                      m.left = O + b + nc,
                      m.top = W + b + nc;
                      var A = s.getBoundingClientRect();
                      A.left + A.width > g.width && (m.left = O - b - A.width + nc),
                      A.top + A.height > g.height && (m.top = W - b - A.height + nc),
                      A.left < 0 && (m.left = O + b + nc),
                      A.top < 0 && (m.top = W + b + nc)
                  }
              } else
                  m.left = z.x + nc,
                  m.top = z.y + nc;
              Vf()
          },
          startDragging: function(M, C, I) {
              I == V && (I = !0),
              M !== gd && (gd ? I && (sg(C) ? gd.handleWindowTouchEnd(C) : gd.handleWindowMouseUp(C)) : sg(C) ? (b(W, wl, zc),
              b(W, Ci, Mr)) : (b(W, Ao, Dn),
              b(W, ge, hk)),
              gd = M)
          },
          getImageMap: function() {
              return wm
          },
          toBoundaries: function(I, o, C, Z) {
              var r = [];
              return _q(I, o, C, Z).forEach(function(T) {
                  var O = [];
                  T.forEach(function(b) {
                      O.push(b.x, b.y)
                  }),
                  r.push(O)
              }),
              r
          },
          getCurrentKeyCodeMap: function() {
              return de
          },
          drawCenterImage: function(D, q, r, c, B, S, P, n) {
              !B && S && S.isSelfViewEvent && (B = S);
              var L = Aj(q, B, S)
                , Y = Xc(q, B, S);
              Gm(D, q, w(r - L / 2), w(c - Y / 2), L, Y, B, S, P, n)
          },
          drawStretchImage: function(N, o, L, Q, R, q, H, E, p, v, $, Y) {
              !E && p && p.isSelfViewEvent && (E = p);
              var n, T = Aj(o, E, p, q), h = Xc(o, E, p, H);
              "uniform" === L ? (n = K(q / T, H / h),
              T *= n,
              h *= n,
              Q += w((q - T) / 2),
              R += w((H - h) / 2),
              q = T,
              H = h) : "centerUniform" === L && ((T > q || h > H) && (n = K(q / T, H / h),
              T *= n,
              h *= n),
              Q += w((q - T) / 2),
              R += w((H - h) / 2),
              q = T,
              H = h);
              var a = N.interactiveInfo;
              if (a) {
                  var e;
                  if (e = "center" === L ? {
                      x: Q + q / 2 - T / 2,
                      y: R + H / 2 - h / 2,
                      width: T,
                      height: h
                  } : {
                      x: Q,
                      y: R,
                      width: q,
                      height: H
                  },
                  a.rect) {
                      var d = a.compInfos
                        , J = d.length;
                      J && (d[J - 1].rect.image = o)
                  } else
                      a.rect = e
              }
              if ("center" === L) {
                  var M = $ !== !1 && (T > q || h > H);
                  M && (N.save(),
                  N.beginPath(),
                  N.rect(Q, R, q, H),
                  N.clip()),
                  Gm(N, o, Q + q / 2 - T / 2, R + H / 2 - h / 2, T, h, E, p, v, Y),
                  M && N.restore()
              } else
                  Gm(N, o, Q, R, q, H, E, p, v, Y)
          },
          toCanvas: function(j, g, J, l, q, P, p, t, O) {
              j = Ti(j, p),
              g = g || Aj(j, q),
              J = J || Xc(j, q);
              var v = Jl()
                , T = hq(v);
              return t ? (Uj(v, g, J, t),
              T.scale(t, t)) : Uj(v, g, J, 1),
              Eq(T, j, l, 0, 0, g, J, q, P, p, O),
              j && j.clampToEdge && (v.clampToEdge = j.clampToEdge),
              T.restore(),
              v
          },
          toGrayColor: function(Z) {
              if (!Z)
                  return Z;
              var h = Il(Z)
                , p = w(.299 * h[0] + .587 * h[1] + .114 * h[2]);
              return "rgba(" + p + "," + p + "," + p + "," + h[3] / 255 + ")"
          },
          createGradientImage: function(u, B, F, a) {
              for (var A = ["L", 0, 0, u, 0, 1, 0, 0, 1, 0, 0], d = 0, E = Math.min(B.length, F.length); E > d; d++)
                  A.push(F[d], B[d]);
              var D = n.Default.toCanvas({
                  width: u,
                  height: u,
                  clampToEdge: !0,
                  comps: [{
                      type: "shape",
                      rotation: a || 0,
                      points: [0, 0, u, 0, u, u, 0, u],
                      background: "#ffffff",
                      gradientPack: A
                  }]
              });
              return D
          },
          createElement: function(s, y, O, r) {
              var _ = Y.createElement(s);
              return Hd(_, y || l.widgetBorder, 2),
              _.style.font = O ? O : Id,
              r != E && (_.value = r),
              M.onElementCreated && M.onElementCreated(_),
              _
          },
          containedInView: function(J, O) {
              var p = Si(O).getBoundingClientRect();
              return tp({
                  x: p.left,
                  y: p.top,
                  width: p.width,
                  height: p.height
              }, Gp(J))
          },
          isIsolating: function() {
              return fj > 0
          },
          setIsolating: function(W) {
              W ? fj++ : fj--
          },
          getMSMap: function() {
              return tb
          },
          stringify: function(A, q, g) {
              var c = Date.prototype.toJSON;
              Date.prototype.toJSON = function() {
                  return "__ht__date" + this.getTime()
              }
              ,
              q = g ? 0 : q == E ? 2 : q;
              var F = JSON.stringify(A, function(c, i) {
                  return "function" == typeof i ? "__ht__" + (i.__ht__ || i.toString()) : te(i) ? nq(i) : i instanceof n.List ? "__ht__list" + (i.__ht__list || M.stringify(i._as)) : i
              }, q);
              return Date.prototype.toJSON = c,
              g && (F = il + df(F)),
              F
          },
          parse: function(n) {
              return Xq(n) ? n.substr(0, 12) != il || (n = md(n.substr(12)),
              Xq(n)) ? JSON.parse(n, function(y, _) {
                  if (Xq(_))
                      if ("__ht__function" == _.substr(0, 14)) {
                          var U = _.indexOf("{") + 1
                            , a = _.lastIndexOf("}")
                            , $ = _.indexOf("(") + 1
                            , N = _.indexOf(")");
                          if (U && a && $ && N)
                              try {
                                  var V = new Function(_.substring($, N),_.substring(U, a));
                                  return V.__ht__ = _.substr(6),
                                  V
                              } catch (D) {
                                  throw console.info("=== SyntaxError ===\n", _),
                                  D
                              }
                      } else {
                          if ("__ht__date" == _.substr(0, 10))
                              return new Date($n(_.substr(10)));
                          if ("__ht__list" === _.substr(0, 10))
                              return new Mh(M.parse(_.substr(10)))
                      }
                  return _
              }) : n : n
          },
          loadJS: function(e, H) {
              H && e.push(H);
              var z = e.shift();
              if ($c(z))
                  e = z.contact(e),
                  M.loadJS(e);
              else if (Oi(z))
                  z(),
                  M.loadJS(e);
              else if (Xq(z)) {
                  var S = Y.createElement("script");
                  S.onload = function() {
                      M.loadJS(e)
                  }
                  ,
                  S.setAttribute("src", z),
                  Y.getElementsByTagName("head")[0].appendChild(S)
              } else
                  e.length && M.loadJS(e)
          },
          extendClass: function(U, s) {
              var z = U.prototype;
              for (var b in s)
                  tb[b] && tb.hasOwnProperty(b) ? tb[b](z, s) : z[b] = s[b]
          },
          toRoundedCorner: function() {
              function m(G, i, T) {
                  G.x = i.x,
                  G.y = i.e || T,
                  G.z = i.y
              }
              var b = new Rh
                , U = new Rh
                , _ = new Rh
                , O = new Rh;
              return function(g, T) {
                  var c, W = 0;
                  g.getPoints && (W = g.getElevation(),
                  g = g.getPoints()),
                  c = g instanceof Mh ? g : new Mh(g);
                  var A = c.size();
                  if (0 >= T)
                      return {
                          points: c
                      };
                  var q = new Mh
                    , x = new Mh
                    , v = c.get(0);
                  m(b, v, W),
                  q.add(v),
                  x.add(1);
                  for (var M = 1; A > M; M++)
                      if (A > M + 1) {
                          var P = c.get(M)
                            , f = c.get(M + 1);
                          m(U, P, W),
                          m(_, f, W),
                          O.subVectors(b, U).setLength(Math.min(.99 * O.length(), T)).add(U),
                          P.e !== V || v.e !== V ? q.add({
                              x: O.x,
                              y: O.z,
                              e: O.y
                          }) : q.add({
                              x: O.x,
                              y: O.z
                          }),
                          q.add(P),
                          O.subVectors(_, U).setLength(Math.min(.99 * O.length(), T)).add(U),
                          P.e !== V || f.e !== V ? q.add(v = {
                              x: O.x,
                              y: O.z,
                              e: O.y
                          }) : q.add(v = {
                              x: O.x,
                              y: O.z
                          }),
                          b.copy(O),
                          x.addAll([2, 3])
                      } else
                          q.add(c.get(M)),
                          x.add(2);
                  return {
                      points: q,
                      segments: x
                  }
              }
          }(),
          toColorData: Il,
          setCanvas: Uj,
          createDiv: cf,
          createDisabledDiv: Pk,
          createView: Te,
          createCanvas: Jl,
          appendChild: Qc,
          initContext: hq,
          checkLoadingImage: hg,
          translateAndScale: Sn,
          layout: ib,
          getPosition: Eo,
          drawPoints: Cc,
          drawRoundRect: ws,
          drawBorder: Ri,
          setFocus: aq,
          getter: bc,
          setter: zn,
          isEmptyObject: Qm,
          cameraPriority: function() {
              var P = {
                  skybox: 0,
                  main: 1e4,
                  top: 1e7,
                  infinity: 1 / 0
              };
              return G.seal(G.defineProperties({}, {
                  skybox: {
                      configurable: !1,
                      enumerable: !1,
                      get: function() {
                          return P.skybox
                      },
                      set: function(l) {
                          if (l >= P.main)
                              throw new RangeError("Skybox camera must have lower priority than the main camera.");
                          P.skybox = Number(l)
                      }
                  },
                  main: {
                      configurable: !1,
                      enumerable: !1,
                      get: function() {
                          return P.main
                      },
                      set: function(I) {
                          if (I <= P.skybox)
                              throw new RangeError("Main camera must have higher priority than the skybox camera.");
                          if (I >= P.top)
                              throw new RangeError("Main camera must have lower priority than the top camera.");
                          P.main = Number(I)
                      }
                  },
                  top: {
                      configurable: !1,
                      enumerable: !1,
                      get: function() {
                          return P.top
                      },
                      set: function(z) {
                          if (z <= P.main)
                              throw new RangeError("Top camera must have higher priority than the main camera.");
                          P.top = Number(z)
                      }
                  }
              }))
          }()
      }, !0),
      rc(d, {
          autoAdjustIndex: 1,
          hierarchicalRendering: 1,
          adjustChildrenToTop: 1,
          autoHideScrollBar: 1,
          autoUpdate: 1,
          firstPersonMode: 1,
          ortho: 1,
          strict: 1,
          stickToRight: 1,
          instant: 1,
          closePath: 1,
          hierarchical: 1,
          doubleClickToToggle: 1,
          continuousLayout: 1,
          syncSize: 1
      }, !0);
      var Un = M.disabledOpacity
        , Kc = M.toolTipDelay
        , Ph = M.devicePixelRatio
        , Bc = M.autoMakeVisible
        , Ch = M.autoHideScrollBar
        , ub = M.imageGradient
        , op = M.showToolTip
        , Ab = M.hideToolTip
        , oi = M.dashPattern
        , Mq = M.lineCap
        , Nn = M.lineJoin
        , Yg = M.labelColor
        , eo = M.labelSelectColor
        , Id = M.labelFont
        , fl = M.widgetIndent
        , Ye = M.widgetRowHeight
        , Lj = M.widgetHeaderHeight
        , Yj = M.widgetTitleHeight
        , ej = M.scrollBarColor
        , _n = M.scrollBarSize
        , Uf = M.scrollBarTimeout
        , on = M.scrollBarMinLength
        , co = M.scrollBarInteractiveSize
        , lm = M.zoomIncrement
        , Qe = M.scrollZoomIncrement
        , pd = M.pinchZoomIncrement
        , Ui = M.zoomMax
        , Qq = M.zoomMin
        , Hp = M.createObject
        , ad = M.preventDefault
        , re = M.setImage
        , Ti = M.getImage
        , hp = M.isImageComplete
        , Oj = M.drawCenterImage
        , Eq = M.drawStretchImage
        , Pm = M.getId
        , rb = M.callLater
        , zj = M.cancelLater
        , Xj = M.sortFunc
        , Ej = M.clone
        , No = M.getClass
        , Bl = M.startAnim
        , Dd = M.brighter
        , Oo = M.darker
        , vh = M.drawText
        , eh = M.getTextSize
        , ni = M.isLeftButton
        , no = M.isMiddleButton
        , Rm = M.isRightButton
        , Yp = M.getTouchCount
        , Xk = M.isDoubleClick
        , Oh = M.isShiftDown
        , Tr = M.isCtrlDown
        , Gp = M.getClientPoint
        , Bd = M.getPagePoint
        , Qf = M.getDistance
        , kr = M.unionPoint
        , Ee = M.unionRect
        , tp = M.containsPoint
        , ke = M.containsRect
        , Ib = M.intersectsRect
        , Tb = M.intersection
        , $e = M.getWindowInfo
        , nk = M.grow
        , Pf = M.getLogicalPoint
        , Pj = M.getScreenPoint
        , dq = M.startDragging
        , is = M.removeHTML
        , sr = M.createElement
        , xi = M.segmentResolution
        , yb = M.shapeResolution
        , Zj = M.shapeSide
        , Ik = M.def
        , jq = function(S, v, E) {
          Ik(p + "." + S, v, E)
      }
        , _h = function(A, I) {
          A.childNodes.forEach(function(J) {
              I(J),
              _h(J, I)
          })
      };
      rc(M, {
          toolTipLabelColor: Yg,
          toolTipLabelFont: Id,
          toolTipBackground: l.toolTipBackground,
          toolTipShadowColor: sd,
          debugTipLabelFont: Id,
          debugTipLabelColor: Yg,
          debugTipBackground: l.toolTipBackground,
          drawBreakableText: Cp,
          setDevicePixelRatio: function(C) {
              Ph = M.devicePixelRatio = "number" == typeof C ? C : W.devicePixelRatio,
              _h(Y.body, function(R) {
                  var m = R._ht;
                  m && m._canvas && (Uj(m._canvas, m.getWidth(), m.getHeight()),
                  m.redraw ? m.redraw() : m.iv())
              })
          }
      }, !0);
      var Uk = 1e-6
        , dj = "undefined" != typeof Uint16Array ? Uint16Array : Array
        , ld = "undefined" != typeof Float32Array ? Float32Array : Array
        , Bb = function(F, m, M) {
          var N = [F[0] - m[0], F[1] - m[1], F[2] - m[2]];
          if (M) {
              var g = Qf(N);
              g > 0 && (N[0] /= g,
              N[1] /= g,
              N[2] /= g)
          }
          return N
      }
        , un = function() {
          var H = "charCodeAt"
            , K = 2 * (2 * Rn.length + 1);
          for (var o in W)
              if (o === p + Mb[0] + (nc.length + 2)) {
                  var b = W[o];
                  if (!b)
                      break;
                  for (var k = b.length, $ = 0; k > $; $++)
                      if (b[$][H](0) === K && b[$ + 1] != E && b[$ + 1] === nc[0] && b[$ + 2] != E && b[$ + 2][H](0) === K) {
                          for (var y = $ + 3; k > y; y++)
                              if (b[y][H](0) === K) {
                                  if (0 == b[y + 1])
                                      for (var U, v = y + 2; k > v; v++) {
                                          if (b[v][H](0) === K) {
                                              0 == b[v - 1] && U && (vs = U.substr(0, U.length - 1));
                                              break
                                          }
                                          U == E ? U = b[v] : U += b[v]
                                      }
                                  break
                              }
                          break
                      }
                  break
              }
          return function(H) {
              return [-H[0], -H[1], -H[2]]
          }
      }()
        , Zk = function(Z, Y) {
          return 3 === Z.length ? Z[0] * Y[0] + Z[1] * Y[1] + Z[2] * Y[2] : Z[0] * Y[0] + Z[1] * Y[1]
      }
        , zm = function() {
          var R = new Array(16);
          return R[0] = 1,
          R[1] = 0,
          R[2] = 0,
          R[3] = 0,
          R[4] = 0,
          R[5] = 1,
          R[6] = 0,
          R[7] = 0,
          R[8] = 0,
          R[9] = 0,
          R[10] = 1,
          R[11] = 0,
          R[12] = 0,
          R[13] = 0,
          R[14] = 0,
          R[15] = 1,
          R
      }
        , Lm = zm()
        , fs = function(N) {
          var Y = new Array(16);
          return Y[0] = N[0],
          Y[1] = N[1],
          Y[2] = N[2],
          Y[3] = N[3],
          Y[4] = N[4],
          Y[5] = N[5],
          Y[6] = N[6],
          Y[7] = N[7],
          Y[8] = N[8],
          Y[9] = N[9],
          Y[10] = N[10],
          Y[11] = N[11],
          Y[12] = N[12],
          Y[13] = N[13],
          Y[14] = N[14],
          Y[15] = N[15],
          Y
      }
        , ae = function(S, X) {
          return S[0] = X[0],
          S[1] = X[1],
          S[2] = X[2],
          S[3] = X[3],
          S[4] = X[4],
          S[5] = X[5],
          S[6] = X[6],
          S[7] = X[7],
          S[8] = X[8],
          S[9] = X[9],
          S[10] = X[10],
          S[11] = X[11],
          S[12] = X[12],
          S[13] = X[13],
          S[14] = X[14],
          S[15] = X[15],
          S
      }
        , vr = function(D) {
          return D[0] = 1,
          D[1] = 0,
          D[2] = 0,
          D[3] = 0,
          D[4] = 0,
          D[5] = 1,
          D[6] = 0,
          D[7] = 0,
          D[8] = 0,
          D[9] = 0,
          D[10] = 1,
          D[11] = 0,
          D[12] = 0,
          D[13] = 0,
          D[14] = 0,
          D[15] = 1,
          D
      }
        , Wb = function($, P) {
          var L = $[0]
            , Z = $[1]
            , k = $[2];
          return $[0] = P[0] * L + P[4] * Z + P[8] * k + P[12],
          $[1] = P[1] * L + P[5] * Z + P[9] * k + P[13],
          $[2] = P[2] * L + P[6] * Z + P[10] * k + P[14],
          $
      }
        , Or = function(u, o) {
          var X = u[0]
            , K = u[1]
            , $ = u[2]
            , f = u[3];
          return u[0] = o[0] * X + o[4] * K + o[8] * $ + o[12] * f,
          u[1] = o[1] * X + o[5] * K + o[9] * $ + o[13] * f,
          u[2] = o[2] * X + o[6] * K + o[10] * $ + o[14] * f,
          u[3] = o[3] * X + o[7] * K + o[11] * $ + o[15] * f,
          u
      }
        , ok = function() {
          var F, W, h, g, Y = oj(fo[1] + fo[7]), w = oj(fo[0] + fo[3] - fo[10]), K = oj(fo[8] + 2), A = function() {
              return W = h.charAt(F),
              F += 1,
              W
          }, z = function() {
              var _ = "";
              if (W === K)
                  for (; A(); ) {
                      if (W === K)
                          return A(),
                          _;
                      _ += W
                  }
              else
                  A()
          }, Z = function() {
              for (; W && " " >= W; )
                  A()
          }, p = function() {
              var M, c = {};
              if (W === Y) {
                  if (A(),
                  Z(),
                  W === w)
                      return A(),
                      c;
                  for (; W; ) {
                      if (M = z(),
                      Z(),
                      A(),
                      c[M] = g(),
                      Z(),
                      W === w)
                          return A(),
                          c;
                      A(),
                      Z()
                  }
              }
          };
          return g = function() {
              switch (Z(),
              W) {
              case Y:
                  return p();
              default:
                  return z()
              }
          }
          ,
          function(N) {
              if (e = {},
              N) {
                  var n;
                  if (h = N,
                  F = 0,
                  W = " ",
                  n = g(),
                  Z(),
                  !W)
                      return n
              }
          }
      }()
        , sf = function(U, w) {
          if (w) {
              var D = o(w)
                , $ = P(w)
                , h = U[4]
                , f = U[5]
                , q = U[6]
                , v = U[7]
                , x = U[8]
                , b = U[9]
                , j = U[10]
                , V = U[11];
              U[4] = h * $ + x * D,
              U[5] = f * $ + b * D,
              U[6] = q * $ + j * D,
              U[7] = v * $ + V * D,
              U[8] = x * $ - h * D,
              U[9] = b * $ - f * D,
              U[10] = j * $ - q * D,
              U[11] = V * $ - v * D
          }
      }
        , qp = function(Q, F) {
          if (F) {
              var J = o(F)
                , x = P(F)
                , W = Q[0]
                , Z = Q[1]
                , A = Q[2]
                , S = Q[3]
                , V = Q[8]
                , e = Q[9]
                , C = Q[10]
                , K = Q[11];
              Q[0] = W * x - V * J,
              Q[1] = Z * x - e * J,
              Q[2] = A * x - C * J,
              Q[3] = S * x - K * J,
              Q[8] = W * J + V * x,
              Q[9] = Z * J + e * x,
              Q[10] = A * J + C * x,
              Q[11] = S * J + K * x
          }
      }
        , Yd = function(I, f) {
          if (f) {
              var B = o(f)
                , V = P(f)
                , r = I[0]
                , N = I[1]
                , F = I[2]
                , s = I[3]
                , $ = I[4]
                , h = I[5]
                , A = I[6]
                , W = I[7];
              I[0] = r * V + $ * B,
              I[1] = N * V + h * B,
              I[2] = F * V + A * B,
              I[3] = s * V + W * B,
              I[4] = $ * V - r * B,
              I[5] = h * V - N * B,
              I[6] = A * V - F * B,
              I[7] = W * V - s * B
          }
      }
        , Dp = function(O, h, g) {
          return lp(E, g === !1 ? E : O.getFinalScale3d(), O.getFinalRotation3d(), O.getRotationMode(), O.p3(), E, h)
      }
        , lp = function(R, u, s, H, d, G, P) {
          return G || (G = zm()),
          d && Bg(G, d),
          tl(G, s, H),
          P && Fo(G, G, P),
          u && zf(G, u),
          R && Fo(G, G, R),
          G
      }
        , ed = function(P, I, b) {
          I = $n(I),
          b = $n(b);
          var $ = this;
          $.g = P,
          $._84O = I,
          $._85O = b,
          $._70I = !0,
          $.F = 0,
          $._83O = I + b,
          $.pen = {
              x: 0,
              y: 0
          }
      }
        , Qo = "lineDashOffset"
        , bo = "setLineDash"
        , wi = function(G) {
          for (var x in G)
              1 === x.length && (Qo = G[x]);
          return x ? 1 : 0
      }
        , cq = function(b, d, C) {
          return Og(d) ? b : b[bo] ? (b[bo](d),
          C && (b.lineDashOffset = C),
          b) : new ed(b,d[0],d.length > 1 ? d[1] : d[0])
      }
        , wh = function(F, d) {
          !Og(d) && F[bo] && (F[bo](On),
          F.lineDashOffset = 0)
      };
      if (Ik(ed, G, {
          _69I: 6,
          moveTo: function(d, f) {
              var M = this
                , I = M.pen;
              I.x = d,
              I.y = f,
              M.g.moveTo(d, f),
              M.start || (M.start = {
                  x: d,
                  y: f
              })
          },
          lineTo: function(S, W) {
              var T = this
                , p = T.pen
                , _ = S - p.x
                , t = W - p.y
                , Z = a(t, _)
                , k = P(Z)
                , m = o(Z)
                , O = T._23O(p.x, p.y, S, W)
                , F = T._85O
                , i = T._84O
                , Q = T._83O;
              if (T.F) {
                  if (T.F > O)
                      return T._70I ? T._72I(S, W) : T.moveTo(S, W),
                      T.F -= O,
                      void 0;
                  if (T._70I ? T._72I(p.x + k * T.F, p.y + m * T.F) : T.moveTo(p.x + k * T.F, p.y + m * T.F),
                  O -= T.F,
                  T.F = 0,
                  T._70I = !T._70I,
                  !O)
                      return
              }
              var L = q(O / Q);
              if (L) {
                  for (var H = k * i, Y = m * i, K = k * F, u = m * F, x = 0; L > x; x++)
                      T._70I ? (T._72I(p.x + H, p.y + Y),
                      T.moveTo(p.x + K, p.y + u)) : (T.moveTo(p.x + K, p.y + u),
                      T._72I(p.x + H, p.y + Y));
                  O -= Q * L
              }
              T._70I ? O > i ? (T._72I(p.x + k * i, p.y + m * i),
              T.moveTo(S, W),
              T.F = F - (O - i),
              T._70I = !1) : (T._72I(S, W),
              O === i ? (T.F = 0,
              T._70I = !T._70I) : (T.F = i - O,
              T.moveTo(S, W))) : O > F ? (T.moveTo(p.x + k * F, p.y + m * F),
              T._72I(S, W),
              T.F = i - (O - F),
              T._70I = !0) : (T.moveTo(S, W),
              O === F ? (T.F = 0,
              T._70I = !T._70I) : T.F = F - O)
          },
          quadraticCurveTo: function(L, I, w, u) {
              var X, d = this, h = d.pen, j = h.x, i = h.y, K = d._22O(j, i, L, I, w, u), t = 0, N = 0, V = d._85O, $ = d._84O;
              if (d.F) {
                  if (d.F > K)
                      return d._70I ? d._71I(L, I, w, u) : d.moveTo(w, u),
                      d.F -= K,
                      void 0;
                  if (t = d.F / K,
                  X = d._20O(j, i, L, I, w, u, t),
                  d._70I ? d._71I(X[2], X[3], X[4], X[5]) : d.moveTo(X[4], X[5]),
                  d.F = 0,
                  d._70I = !d._70I,
                  !K)
                      return
              }
              var O = K - K * t
                , s = q(O / d._83O)
                , M = $ / K
                , x = V / K;
              if (s)
                  for (var l = 0; s > l; l++)
                      d._70I ? (N = t + M,
                      X = d._21O(j, i, L, I, w, u, t, N),
                      d._71I(X[2], X[3], X[4], X[5]),
                      t = N,
                      N = t + x,
                      X = d._21O(j, i, L, I, w, u, t, N),
                      d.moveTo(X[4], X[5])) : (N = t + x,
                      X = d._21O(j, i, L, I, w, u, t, N),
                      d.moveTo(X[4], X[5]),
                      t = N,
                      N = t + M,
                      X = d._21O(j, i, L, I, w, u, t, N),
                      d._71I(X[2], X[3], X[4], X[5])),
                      t = N;
              O = K - K * t,
              d._70I ? O > $ ? (N = t + M,
              X = d._21O(j, i, L, I, w, u, t, N),
              d._71I(X[2], X[3], X[4], X[5]),
              d.moveTo(w, u),
              d.F = V - (O - $),
              d._70I = !1) : (X = d._19O(j, i, L, I, w, u, t),
              d._71I(X[2], X[3], X[4], X[5]),
              K === $ ? (d.F = 0,
              d._70I = !d._70I) : (d.F = $ - O,
              d.moveTo(w, u))) : O > V ? (N = t + x,
              X = d._21O(j, i, L, I, w, u, t, N),
              d.moveTo(X[4], X[5]),
              X = d._19O(j, i, L, I, w, u, N),
              d._71I(X[2], X[3], X[4], X[5]),
              d.F = $ - (O - V),
              d._70I = !0) : (d.moveTo(w, u),
              O === V ? (d.F = 0,
              d._70I = !d._70I) : d.F = V - O)
          },
          bezierCurveTo: function() {
              var J = arguments;
              this.pen = {
                  x: J[4],
                  y: J[5]
              },
              this.g.bezierCurveTo(J[0], J[1], J[2], J[3], J[4], J[5])
          },
          arc: function(T, o, k, P, m, u) {
              u || (P = -P,
              m = -m),
              In(this, T, o, P, m - P, k, k, !1)
          },
          rect: function(m, Q, E, j) {
              var O = this;
              O.pen = {
                  x: m,
                  y: Q
              },
              O.moveTo(m, Q),
              O.lineTo(m, Q + j),
              O.lineTo(m + E, Q + j),
              O.lineTo(m + E, Q),
              O.lineTo(m, Q)
          },
          beginPath: function() {
              this.g.beginPath()
          },
          closePath: function() {
              this.lineTo(this.start.x, this.start.y)
          },
          _23O: function(H, R, X, d) {
              var q = X - H
                , w = d - R;
              return O(q * q + w * w)
          },
          _22O: function(j, O, K, c, x, U, u) {
              for (var H, a, Z, S, o, L, w, C = 0, R = j, E = O, Y = u > 0 ? u : this._69I, y = 1; Y >= y; y++)
                  Z = y / Y,
                  S = 1 - Z,
                  o = S * S,
                  L = 2 * Z * S,
                  w = Z * Z,
                  H = o * j + L * K + w * x,
                  a = o * O + L * c + w * U,
                  C += this._23O(R, E, H, a),
                  R = H,
                  E = a;
              return C
          },
          _21O: function(n, A, u, B, p, e, i, a) {
              var C = this;
              if (0 === i)
                  return C._20O(n, A, u, B, p, e, a);
              if (1 === a)
                  return C._19O(n, A, u, B, p, e, i);
              var F = C._20O(n, A, u, B, p, e, a);
              return F.push(i / a),
              C._19O.apply(C, F)
          },
          _20O: function(N, U, W, o, M, V, m) {
              if (1 !== m) {
                  var f = W + (M - W) * m
                    , X = o + (V - o) * m;
                  W = N + (W - N) * m,
                  o = U + (o - U) * m,
                  M = W + (f - W) * m,
                  V = o + (X - o) * m
              }
              return [N, U, W, o, M, V]
          },
          _19O: function(H, Y, D, z, P, T, S) {
              if (1 !== S) {
                  var M = H + (D - H) * S
                    , U = Y + (z - Y) * S;
                  D += (P - D) * S,
                  z += (T - z) * S,
                  H = M + (D - M) * S,
                  Y = U + (z - U) * S
              }
              return [H, Y, D, z, P, T]
          },
          _72I: function(C, Q) {
              var $ = this.pen;
              (C !== $.x || Q !== $.y) && ($.x = C,
              $.y = Q,
              this.g.lineTo(C, Q))
          },
          _71I: function(B, N, v, A) {
              var R = this.pen;
              (B !== v || N !== A || v !== R.x || A !== R.y) && (R.x = v,
              R.y = A,
              this.g.quadraticCurveTo(B, N, v, A))
          }
      }),
      _ && gb) {
          var Yq = gb.toString();
          Fc = Yq.indexOf($m.substr(0, 2)) > 0 && Yq.indexOf(Dj + Dj.substr(1, 1)) > 1 || Yq.indexOf(qf.substr(0, 2) + $m.substr(2, 2) + Mb[0] + $m[4]) > 1 ? !0 : !1
      }
      !0 && W.console && (W.navigator && W.navigator.userAgent.toLowerCase().indexOf("chrome") > -1 ? W.console.log.apply(console, ["Hightopo - Version：" + n.Default.getVersion() + " - %c申请试用：http://hightopo.com/request.html", "color: #f00;"]) : W.console.log("Hightopo - Version：" + n.Default.getVersion() + " - 申请试用：http://hightopo.com/request.html"));
      var xk = E
        , Qg = E
        , Pl = M.checkLoadingCompType = function(i) {
          xk && !i._72O && (Qg || (Qg = {}),
          Qg[i._72O = Pm()] = i)
      }
        , kp = function(O, q) {
          if (q || (q = O),
          q && (xk || (xk = {}),
          !xk[O])) {
              var K = new tn;
              if (xk[q] = {
                  request: K,
                  url: q
              },
              q = M.beforeLoadURL(q, O),
              q.data) {
                  var y = M.parse(q.data);
                  mk(O, y),
                  M.handleCompTypeLoaded(O, y)
              } else {
                  K.onload = function() {
                      if (200 === this.status || 0 === this.status) {
                          var v = M.parse(K.getResponseText());
                          mk(O, v),
                          M.handleCompTypeLoaded(O, v)
                      } else
                          mk(O, E)
                  }
                  ,
                  K.onerror = function() {
                      mk(O, E)
                  }
                  ;
                  var h = {};
                  h.url = encodeURI(q),
                  h.sync = !1,
                  K.send(h)
              }
          }
      }
        , mk = function(m, B) {
          if (Yn[m] = B,
          delete xk[m],
          Qm(xk) && (xk = E,
          Qg)) {
              for (var i in Qg) {
                  var q = Qg[i];
                  q.invalidateAll && q.invalidateAll(V, "compTypeLoaded", m),
                  q.redraw && q.redraw(),
                  q.iv(),
                  delete q._72O
              }
              Qg = E
          }
          if (B && Qg)
              for (var i in Qg) {
                  var q = Qg[i];
                  q.invalidateAll && q.invalidateAll(V, "compTypeLoading", m),
                  q.redraw && q.redraw(),
                  q.iv()
              }
      }
        , eb = l.chart
        , eg = ""
        , Im = !0
        , Ce = M.compStack = []
        , cn = /^style@/
        , Tf = /^attr@/
        , Ze = /^field@/
        , bl = {
          x: .5,
          y: .5
      }
        , Db = function() {
          Im = !0
      }
        , bj = function() {
          return Im
      }
        , Aj = function(v, U, i, V) {
          if (!v)
              return 0;
          if (yn(v.fitSize, U, i) && V)
              return V;
          var Z = yn(v.width, U, i);
          return null == Z ? 20 : Z
      }
        , Xc = function(S, O, H, D) {
          if (!S)
              return 0;
          if (yn(S.fitSize, O, H) && D)
              return D;
          var Q = yn(S.height, O, H);
          return null == Q ? 20 : Q
      }
        , yn = function(m, q, C) {
          if (!m || !m.func)
              return m;
          var e, R = m.func, G = m.value;
          return e = Oi(R) ? C && C.vectorDataBindingDisabled && !m.isSafeFunc ? G : R(q, C) : q instanceof _i || (n.ui ? q instanceof n.ui.View : 0) ? Tf.test(R) ? q.a(eg + R.slice(5)) : cn.test(R) ? q.s(eg + R.slice(6)) : Ze.test(R) ? q[R.slice(6)] : q[R] ? q[R](C) : G : G,
          G !== V && e == E ? G : e
      }
        , Gm = M.drawImage = function() {
          var Z, t, Y, F, j, L, m = function(U, d) {
              U.getValue && U.getValue.compType === d || (U.getValue = function(n) {
                  var C = w(U, n);
                  if (C === V && d.properties) {
                      var D = d.properties[n];
                      D && (C = D.defaultValue)
                  }
                  return C
              }
              ,
              U.getColor = function(q, n) {
                  return n === !0 ? r(q) : r(U.getValue(q))
              }
              ,
              U.getValue.compType = d)
          }, w = function(p, P, L) {
              var B, G = !1;
              if (p.prefix && t instanceof _i) {
                  var v = t.a(eg + P);
                  v !== V && (G = !0,
                  B = v)
              }
              return B === V && (B = p[P]),
              B && B.func && (G = !0,
              B = yn(B, t, Y)),
              L && (B = L(B),
              G || (p[P] = B)),
              B
          }, r = function(d, R) {
              var u;
              return u = R ? w(d, R) : d,
              Z && Z.compGray && u ? M.toGrayColor(u) : j && u ? pf(u, j, L) : u
          }, c = function(d) {
              if ($c(d)) {
                  for (var v = new Mh, j = d.length, U = 0; j > U; U += 2)
                      v.add({
                          x: d[U],
                          y: d[U + 1]
                      });
                  d = v
              }
              return d
          }, x = function(A) {
              var b = w(A, "anchorX")
                , h = w(A, "anchorY");
              if (b !== V || h !== V)
                  return {
                      x: b === V ? bl.x : b,
                      y: h === V ? bl.y : h
                  };
              var k = w(A, "type")
                , m = w(A, "name");
              if ("image" !== k || !m)
                  return bl;
              var C = Ti(m);
              return C && C.anchorX !== V && C.anchorY !== V ? {
                  x: C.anchorX,
                  y: C.anchorY
              } : bl
          }, I = function(g, V) {
              var r = w(g, gp)
                , E = x(g);
              if ($c(r)) {
                  var n = r.length
                    , A = w(g, "relative")
                    , u = V.width
                    , o = V.height;
                  if (4 === n)
                      r = {
                          x: r[0],
                          y: r[1],
                          width: r[2],
                          height: r[3]
                      },
                      A && (r.x *= u,
                      r.y *= o,
                      r.width *= u,
                      r.height *= o);
                  else if (3 === n) {
                      var H = r[0];
                      r = {
                          width: r[1],
                          height: r[2]
                      },
                      A && (r.width *= u,
                      r.height *= o),
                      "object" == typeof H ? H.length && (H = {
                          x: H[0],
                          y: H[1]
                      }) : H = Eo(H, V, r),
                      r.x = H.x - r.width * E.x,
                      r.y = H.y - r.height * E.y
                  }
                  r.x += w(g, "offsetX") || 0,
                  r.y += w(g, "offsetY") || 0,
                  !A && V.fitSize && (r = k(g, r, V))
              }
              return r
          }, k = function(q, C, I) {
              if (C) {
                  var R, b, B, N = {
                      x: C.x,
                      y: C.y,
                      width: C.width,
                      height: C.height
                  }, i = x(q), r = w(q, "layoutH"), H = w(q, "layoutV"), J = 1, U = 1, y = 0, s = 0, t = 1, m = 1;
                  switch (r) {
                  case "left":
                      break;
                  case "right":
                      N.x += I.width - I.rw;
                      break;
                  case "center":
                      N.x += .5 * (I.width - I.rw);
                      break;
                  case "scale":
                  case "leftright":
                  default:
                      R = w(q, Ek) || 0,
                      R && (y = Math.abs(s = Math.sin(R)),
                      t = Math.abs(m = Math.cos(R))),
                      "leftright" !== r ? (J += t * (I.widthScale - 1),
                      U += y * (I.widthScale - 1)) : (J += N.width ? t * (I.width - I.rw) / N.width : 0,
                      U += N.height ? y * (I.width - I.rw) / N.height : 0,
                      b = -Math.min(-i.x * m + i.y * s, -i.x * m - (1 - i.y) * s, (1 - i.x) * m + i.y * s, (1 - i.x) * m - (1 - i.y) * s))
                  }
                  switch (H) {
                  case "top":
                      break;
                  case "bottom":
                      N.y += I.height - I.rh;
                      break;
                  case "center":
                      N.y += .5 * (I.height - I.rh);
                      break;
                  case "scale":
                  case "topbottom":
                  default:
                      R == E && (R = w(q, Ek),
                      R && (y = Math.abs(s = Math.sin(R)),
                      t = Math.abs(m = Math.cos(R)))),
                      "topbottom" !== H ? (J += y * (I.heightScale - 1),
                      U += t * (I.heightScale - 1)) : (J += N.width ? y * (I.height - I.rh) / N.width : 0,
                      U += N.height ? t * (I.height - I.rh) / N.height : 0,
                      B = -Math.min(-i.x * s - i.y * m, -i.x * s + (1 - i.y) * m, (1 - i.x) * s - i.y * m, (1 - i.x) * s + (1 - i.y) * m))
                  }
                  return (1 !== J || 1 !== U) && ("scale" !== r && r ? "leftright" === r && (N.x += N.width * (1 - J) * i.x + b * (I.width - I.rw)) : N.x += N.x * (I.widthScale - 1) + i.x * N.width * (I.widthScale - J),
                  "scale" !== H && H ? "topbottom" === H && (N.y += N.height * (1 - U) * i.y + B * (I.height - I.rh)) : N.y += N.y * (I.heightScale - 1) + i.y * N.height * (I.heightScale - U),
                  N.width *= J,
                  N.height *= U),
                  N.width < 0 && (N.width = 0),
                  N.height < 0 && (N.height = 0),
                  N
              }
          }, q = function(f) {
              return $c(f) ? new Mh(f) : f
          }, S = function(h, y, m, z, T, g, B) {
              var F = Z.interactiveInfo
                , $ = h.transform;
              if ($)
                  return Z.save(),
                  Z.setTransform($.a, $.b, $.c, $.d, $.tx, $.ty),
                  F && F.compInfos.push({
                      comp: h,
                      rect: y,
                      matrix: $.clone(),
                      prefix: eg,
                      refRect: F.refRect
                  }),
                  !0;
              T === V && (T = 1),
              g === V && (g = 1);
              var N = w(h, "clipPercentage")
                , Q = sp(m, y);
              if (Q && !z && 1 === T && 1 === g && !(1 > N))
                  return F && F.compInfos.push({
                      comp: h,
                      rect: y,
                      matrix: F.matrix.clone(),
                      prefix: eg,
                      refRect: F.refRect
                  }),
                  !1;
              B = B || bl;
              var c = y.x + y.width * B.x
                , x = y.y + y.height * B.y
                , o = m.x + m.width * B.x
                , R = m.y + m.height * B.y
                , a = m.width ? T * (y.width / m.width) : 1
                , M = m.height ? g * (y.height / m.height) : 1;
              if (Z.save(),
              F && (F.matrix.appendTranslate(c, x).appendRotate(z).appendScale(a, M).appendTranslate(-o, -R),
              F.compInfos.push({
                  comp: h,
                  rect: y,
                  matrix: F.matrix.clone(),
                  prefix: eg,
                  refRect: F.refRect
              })),
              od(Z, c, x),
              Iq(Z, z || 0),
              ig(Z, a, M),
              od(Z, -o, -R),
              1 > N) {
                  0 > N && (N = 0);
                  var D = yg(m, w(h, "clipDirection"), N);
                  Z.beginPath(),
                  Z.rect(D.x, D.y, D.width, D.height),
                  Z.clip()
              }
              return !0
          }, J = function() {
              Z.restore()
          }, g = function(y, o, T) {
              var W = w(y, "path")
                , s = w(y, Ek)
                , Q = w(y, "scaleX")
                , z = w(y, "scaleY")
                , N = x(y)
                , v = E
                , P = Om(null, W);
              if (T || (T = y.unionRect,
              T || (T = kr(P),
              y.path.func || (y.unionRect = T)),
              v = T),
              T) {
                  v || (v = y.unionRect,
                  v || (v = kr(P),
                  y.path.func || (y.unionRect = v)));
                  var U = S(y, T, v, s, Q, z, N)
                    , f = w(y, "borderPattern")
                    , g = cq(Z, f)
                    , K = r(y, "background")
                    , C = r(y, "borderColor")
                    , h = w(y, "borderWidth")
                    , n = w(y, "gradient")
                    , Y = r(y, "gradientColor")
                    , R = w(y, "border3d")
                    , u = r(y, "border3dColor")
                    , j = w(y, "border3dAccuracy")
                    , p = Z.lineJoin
                    , I = Z.lineCap;
                  Z.lineJoin = w(y, "borderJoin") || Nn,
                  Z.lineCap = w(y, "borderCap") || Mq,
                  K ? (eq(Z, K, n, Y, v),
                  Om(Z, W),
                  Z.fill(),
                  g !== Z && Om(Z, W)) : Om(Z, W);
                  var A = w(y, "borderWidthAbsolute");
                  if (A && (Z.save(),
                  Z.setTransform(1, 0, 0, 1, 0, 0)),
                  h && C && (Z.lineWidth = h,
                  Z.strokeStyle = C,
                  Z.stroke(),
                  R && Zo(Z, C, u, h, F, j)),
                  wh(Z, f),
                  w(y, "dash")) {
                      var k = w(y, "dashWidth") || h;
                      if (k > 0) {
                          f = w(y, "dashPattern") || oi;
                          var g = cq(Z, f, w(y, "dashOffset"))
                            , t = r(y, "dashColor") || r(wj);
                          g !== Z && Om(Z, W),
                          Z.strokeStyle = t,
                          Z.lineWidth = k,
                          Z.stroke(),
                          w(y, "dash3d") && Zo(Z, t, r(y, "dash3dColor"), k, F, w(y, "dash3dAccuracy")),
                          wh(Z, f)
                      }
                  }
                  A && Z.restore(),
                  o === gp && Kk(Z, K, w(y, "depth"), v),
                  Z.lineJoin = p,
                  Z.lineCap = I,
                  U && J()
              }
          }, Q = function(e, s, D, b) {
              var K = w(e, $h, c)
                , y = w(e, Ek)
                , O = x(e);
              if (K && b.fitSize) {
                  var o = new Mh
                    , I = kr(K)
                    , M = k(e, I, b)
                    , Q = I.x + O.x * I.width
                    , f = I.y + O.y * I.height
                    , H = M.x + O.x * M.width
                    , n = M.y + O.y * M.height
                    , _ = I.width ? M.width / I.width : 1
                    , d = I.height ? M.height / I.height : 1;
                  K.each(function(P) {
                      o.add({
                          x: H + (P.x - Q) * _,
                          y: n + (P.y - f) * d
                      })
                  }),
                  K = o,
                  e.unionRect = null
              }
              var A = w(e, "scaleX")
                , N = w(e, "scaleY")
                , u = s === Zr
                , G = E;
              if (!D && u && (D = e.unionRect,
              D || (D = kr(K),
              e.points.func || (e.unionRect = D)),
              G = D),
              D) {
                  u ? G || (G = e.unionRect,
                  G || (G = kr(K),
                  e.points.func || (e.unionRect = G))) : G = D;
                  var g, U, a, $, C = S(e, D, G, y, A, N, O), T = w(e, "borderPattern"), l = cq(Z, T), W = r(e, "background"), V = Ti(w(e, "repeatImage"), j, L), m = w(e, "gradientPack"), v = r(e, "borderColor"), z = w(e, "borderWidth"), R = Ti(w(e, "borderRepeatImage"), j, L), p = w(e, "segments", q), P = w(e, "gradient"), i = r(e, "gradientColor"), B = w(e, "border3d"), h = r(e, "border3dColor"), X = w(e, "border3dAccuracy"), oj = w(e, "closePath"), Bk = w(e, "fillRule") || "nonzero", Zq = Z.lineJoin, Vf = Z.lineCap;
                  if (Z.lineJoin = w(e, "borderJoin") || Nn,
                  Z.lineCap = w(e, "borderCap") || Mq,
                  u)
                      if (W || V || m) {
                          var Ge = w(e, "fillClipPercentage");
                          if (1 > Ge) {
                              0 > Ge && (Ge = 0);
                              var zr = yg(G, w(e, "fillClipDirection"), Ge);
                              Z.save(),
                              Z.beginPath(),
                              Z.rect(zr.x, zr.y, zr.width, zr.height),
                              Z.clip()
                          }
                          Cc(Z, K, p, oj),
                          m ? Wq(Z, m, r) : V ? Ji(Z, V, j, L, t, Y) : eq(Z, W, P, i, G),
                          Z.fill(Bk),
                          m && Z.restore(),
                          1 > Ge && Z.restore(),
                          l !== Z && Cc(l, K, p, oj)
                      } else
                          Cc(l, K, p, oj);
                  else if ("roundRect" === s ? g = w(e, "cornerRadius") : "polygon" === s ? g = w(e, "polygonSide") : "arc" === s && (g = w(e, "arcFrom"),
                  U = w(e, "arcTo"),
                  a = w(e, "arcClose"),
                  $ = w(e, "arcOval")),
                  W || V || m) {
                      var Ge = w(e, "fillClipPercentage");
                      if (1 > Ge) {
                          0 > Ge && (Ge = 0);
                          var zr = yg(G, w(e, "fillClipDirection"), Ge);
                          Z.save(),
                          Z.beginPath(),
                          Z.rect(zr.x, zr.y, zr.width, zr.height),
                          Z.clip()
                      }
                      Cr(Z, s, G, g, U, a, $),
                      m ? Wq(Z, m, r) : V ? Ji(Z, V, j, L, t, Y) : eq(Z, W, P, i, G),
                      Z.fill(Bk),
                      m && Z.restore(),
                      1 > Ge && Z.restore(),
                      Z !== l && Cr(l, s, G, g, U, a, $)
                  } else
                      Cr(l, s, G, g, U, a, $);
                  var Mn = w(e, "borderWidthAbsolute");
                  if (Mn && (Z.save(),
                  Z.setTransform(1, 0, 0, 1, 0, 0)),
                  z && (v || R) && (Z.lineWidth = z,
                  R ? Nb(Z, R, j, L, t, Y) : Z.strokeStyle = v,
                  Z.stroke(),
                  B && Zo(Z, v, h, z, F, X)),
                  wh(Z, T),
                  w(e, "dash")) {
                      var Ri = w(e, "dashWidth") || z;
                      if (Ri > 0) {
                          T = w(e, "dashPattern") || oi;
                          var l = cq(Z, T, w(e, "dashOffset"))
                            , Oj = r(e, "dashColor") || r(wj);
                          l !== Z && (u ? Cc(l, K, p, oj) : Cr(l, s, G, g, U, a, $)),
                          Z.strokeStyle = Oj,
                          Z.lineWidth = Ri,
                          Z.stroke(),
                          w(e, "dash3d") && Zo(Z, Oj, r(e, "dash3dColor"), Ri, F, w(e, "dash3dAccuracy")),
                          wh(Z, T)
                      }
                  }
                  Mn && Z.restore(),
                  s === gp && Kk(Z, W, w(e, "depth"), G),
                  Z.lineJoin = Zq,
                  Z.lineCap = Vf,
                  C && J()
              }
          }, f = function(r, k) {
              var g = j || w(r, ah)
                , D = L || w(r, "blendMode")
                , R = w(r, "name")
                , P = Ti(R, g, D);
              P ? Eq(Z, P, w(r, "stretch"), k.x, k.y, k.width, k.height, t, Y, g, null, D) : Im = !1
          }, l = function(p, t) {
              var T = w(p, "text");
              T != E && vh(Z, T, w(p, "font"), r(p, ah), t.x, t.y, t.width, t.height, w(p, "align"), w(p, "vAlign"))
          }, B = function(J, e) {
              Ri(Z, r(J, ah), e.x, e.y, e.width, e.height, w(J, "width"))
          }, h = function(x, k) {
              var m = w(x, Bh)
                , u = 0;
              if (m && (m.forEach(function(A) {
                  u += A
              }),
              u > 0)) {
                  for (var L = w(x, "colors") || eb, G = w(x, "startAngle") || 0, i = w(x, "hollow"), j = w(x, _r), b = w(x, Be), Q = w(x, om), g = j ? new Mh : E, z = k.x, S = k.y, N = k.width, I = k.height, q = z + N / 2, h = S + I / 2, T = K(N, I) / 2, f = 0, V = 0; V < m.length; V++) {
                      var O = m[V]
                        , Y = y * O / u
                        , d = G + Y;
                      if (Z.fillStyle = L[f++],
                      f === L.length && (f = 0),
                      Z.beginPath(),
                      i) {
                          var s = q + P(G) * T / 2
                            , H = h + o(G) * T / 2
                            , l = q + P(d) * T
                            , F = h + o(d) * T;
                          Z.moveTo(s, H),
                          Z.arc(q, h, T / 2, G, d, !1),
                          Z.lineTo(l, F),
                          Z.arc(q, h, T, d, G, !0)
                      } else
                          Z.moveTo(q, h),
                          Z.arc(q, h, T, d, G, !0);
                      g && (Y = (G + d) / 2,
                      g.add({
                          text: Oi(j) ? j(O, V, u, t) : O,
                          x: q + .75 * P(Y) * T,
                          y: h + .75 * o(Y) * T
                      })),
                      Z.closePath(),
                      Z.fill(),
                      G = d
                  }
                  g && g.each(function(L) {
                      vh(Z, L.text, b, Q, L.x, L.y, 0, 0, ef)
                  })
              }
          }, p = function(D, v) {
              var C = w(D, rj);
              if (C && C.length > 0) {
                  var R = C.length
                    , I = w(D, _r)
                    , V = w(D, Be)
                    , n = w(D, om)
                    , K = I ? new Mh : E
                    , y = w(D, "minValue") || 0
                    , L = w(D, "maxValue");
                  if (L == E && (L = 0,
                  C.forEach(function(u) {
                      w(u, Bh).forEach(function(R) {
                          L = X(L, R)
                      })
                  })),
                  y === L)
                      return;
                  for (var m = v.height / (L - y), A = v.y + L * m, Y = w(C[0], Bh).length, k = v.width / (3 * Y + 1), H = 2 * k / R, p = 0, j = 0; R > j; j++)
                      for (var u = C[j], W = w(u, ah), r = w(u, "colors"), $ = w(u, Bh), U = 0; Y > U; U++) {
                          r ? Z.fillStyle = r[U] : W ? Z.fillStyle = W : (Z.fillStyle = eb[p++],
                          p === eb.length && (p = 0));
                          var o = $[U]
                            , J = o * m
                            , B = v.x + (1 + 3 * U) * k + j * H;
                          if (xg(Z, B, A - J, H, J),
                          K) {
                              var O = Oi(I) ? I(o, U, u, t) : o
                                , b = eh(V, O).height;
                              K.add({
                                  x: B,
                                  y: A - J - b,
                                  width: H,
                                  height: b,
                                  text: O
                              })
                          }
                      }
                  K && K.each(function(H) {
                      vh(Z, H.text, V, n, H.x, H.y, H.width, H.height, ef)
                  })
              }
          }, u = function(L, l) {
              var S = w(L, rj);
              if (S && S.length > 0) {
                  var Q = S.length
                    , p = w(S[0], Bh).length
                    , A = l.width / (3 * p + 1)
                    , o = 0
                    , V = w(L, "maxValue")
                    , b = w(L, _r)
                    , e = w(L, Be)
                    , y = w(L, om)
                    , k = b ? new Mh : E;
                  if (V == E) {
                      V = 0;
                      for (var q = 0; p > q; q++) {
                          for (var N = 0, f = 0; Q > f; f++)
                              N += w(S[f], Bh)[q];
                          V = X(V, N)
                      }
                  }
                  if (V > 0) {
                      for (var q = 0; p > q; q++)
                          for (var a = l.y + l.height, f = 0; Q > f; f++) {
                              var O = S[f]
                                , I = w(O, ah)
                                , d = w(O, Bh)[q]
                                , F = d / V * l.height;
                              I ? Z.fillStyle = I : (Z.fillStyle = eb[o++],
                              o === eb.length && (o = 0)),
                              a -= F;
                              var z = {
                                  x: l.x + (1 + 3 * q) * A,
                                  y: a,
                                  width: 2 * A,
                                  height: F
                              };
                              xg(Z, z.x, z.y, z.width, z.height),
                              k && (z.text = Oi(b) ? b(d, q, O, t) : d,
                              k.add(z))
                          }
                      k && k.each(function(x) {
                          vh(Z, x.text, e, y, x.x, x.y, x.width, x.height, ef)
                      })
                  }
              }
          }, z = function(v, r) {
              var M = w(v, rj);
              if (M && M.length > 0) {
                  for (var T = M.length, s = w(M[0], Bh).length, C = r.width / (3 * s + 1), a = 0, N = w(v, _r), I = w(v, Be), m = w(v, om), J = N ? new Mh : E, B = 0; s > B; B++) {
                      for (var V = 0, p = 0; T > p; p++)
                          V += w(M[p], Bh)[B];
                      if (V > 0) {
                          var U = r.y + r.height;
                          for (p = 0; T > p; p++) {
                              var S = M[p]
                                , A = w(S, ah)
                                , $ = w(S, Bh)[B]
                                , Q = $ / V * r.height;
                              A ? Z.fillStyle = A : (Z.fillStyle = eb[a++],
                              a === eb.length && (a = 0)),
                              U -= Q;
                              var g = {
                                  x: r.x + (1 + 3 * B) * C,
                                  y: U,
                                  width: 2 * C,
                                  height: Q
                              };
                              xg(Z, g.x, g.y, g.width, g.height),
                              J && (g.text = Oi(N) ? N($, B, S, t) : $,
                              J.add(g))
                          }
                      }
                  }
                  J && J.each(function(N) {
                      vh(Z, N.text, I, m, N.x, N.y, N.width, N.height, ef)
                  })
              }
          }, O = function(v, I) {
              var c = w(v, rj);
              if (c && c.length > 0) {
                  var n = c.length
                    , e = w(v, "minValue") || 0
                    , g = w(v, "maxValue");
                  if (g == E && (g = 0,
                  c.forEach(function(Q) {
                      w(Q, Bh).forEach(function(F) {
                          g = X(g, F)
                      })
                  })),
                  e === g)
                      return;
                  for (var B = I.height / (g - e), u = I.y + g * B, S = w(c[0], Bh).length, q = I.width / (3 * S + 1), G = 0, x = w(v, "lineWidth") || 2, b = w(v, "line3d"), U = w(v, "linePoint"), L = w(v, _r), A = w(v, Be), p = w(v, om), a = 0; n > a; a++) {
                      var V = c[a]
                        , k = w(V, ah)
                        , O = w(V, Bh);
                      k ? Z.strokeStyle = k : (k = Z.strokeStyle = eb[G++],
                      G === eb.length && (G = 0)),
                      Z.beginPath();
                      for (var $ = 0; S > $; $++) {
                          var l = I.x + (2 + 3 * $) * q
                            , D = u - O[$] * B;
                          0 === $ ? Z.moveTo(l, D) : Z.lineTo(l, D)
                      }
                      if (Z.lineWidth = x,
                      Z.stroke(),
                      b && Zo(Z, k, E, x, F),
                      U || L) {
                          var j, Q = x / 2 + 2;
                          for ($ = 0; S > $; $++) {
                              var C = O[$];
                              if (l = I.x + (2 + 3 * $) * q,
                              D = u - C * B,
                              Oi(U) ? U(Z, l, D, k, $, V, t) : U && (Z.fillStyle = k,
                              Z.beginPath(),
                              Z.arc(l, D, Q, 0, y, !0),
                              Z.fill()),
                              Oi(L) ? j = L(C, $, V, t) : L && (j = C),
                              j) {
                                  var J = eh(A, j).height
                                    , P = Z.shadowBlur;
                                  if (P) {
                                      var s = Z.shadowOffsetX
                                        , d = Z.shadowOffsetY
                                        , T = Z.shadowColor;
                                      Z.shadowOffsetX = 0,
                                      Z.shadowOffsetY = 0,
                                      Z.shadowBlur = 0,
                                      Z.shadowColor = E
                                  }
                                  vh(Z, j, A, p, l, D - J - Q + 2, 0, J, ef),
                                  P && (Z.shadowOffsetX = s,
                                  Z.shadowOffsetY = d,
                                  Z.shadowBlur = P,
                                  Z.shadowColor = T)
                              }
                          }
                      }
                  }
              }
          }, i = function(o) {
              Z = o[0],
              t = o[1],
              Y = o[2],
              F = o[3],
              j = o[4],
              L = o[5]
          }, $ = function() {
              return [Z, t, Y, F, j, L]
          }, T = function(L, D) {
              var F;
              Y && Y.getDrawableState ? F = Y.getDrawableState(t) : Y && Y.getState ? F = Y.getState(t) : (F = t instanceof _i ? t.s(Vm) : null,
              (F === V || null === F) && (F = w(L, Vm)));
              var S = w(D, Vm);
              return S !== V && null !== S && S !== F ? !1 : w(D, jk)
          }, R = {
              border: B,
              image: f,
              text: l,
              pieChart: h,
              columnChart: p,
              stackedColumnChart: u,
              percentageColumnChart: z,
              lineChart: O
          };
          return function(C, f, b, l, e, O, n, o, K, U) {
              if (f && e && O) {
                  var N = $();
                  Z = C,
                  t = n,
                  Y = o,
                  !t && Y && Y.isSelfViewEvent && (t = Y),
                  F = Y ? Y._zoom ? Y._zoom : 1 : 1,
                  j = K,
                  L = U;
                  var G = e
                    , u = O;
                  if (Lo()) {
                      var P, X, A, d, y;
                      0 === Z[_c] ? Lo[0] && (P = !0) : P = !0,
                      Z.texureImage2D ? Lo[1] && (X = !0) : X = !0,
                      Z.texureImage3D ? Lo[2] && (A = !0) : A = !0,
                      Z.drawDNDState ? Lo[3] && (y = !0) : y = !0,
                      Nd.widget[0] ? Lo[4] && (d = !0) : d = !0,
                      P && X && A && d && y && (G = b,
                      u = l)
                  }
                  if (f.tagName)
                      return Xq(vs) && !W[vs] || Z.drawImage(f, G, u, e, O),
                      i(N),
                      void 0;
                  if (0 == w(f, "visible"))
                      return i(N),
                      void 0;
                  j || (j = yn(f.color, t, Y)),
                  U || (L = yn(f.blendMode, t, Y)),
                  Xq(vs) && !W[vs] && (e = G,
                  O = u);
                  var h = Aj(f, t, Y, e)
                    , H = Xc(f, t, Y, O)
                    , s = {
                      x: 0,
                      y: 0,
                      width: h,
                      height: H,
                      fitSize: w(f, "fitSize")
                  }
                    , p = w(f, "clip")
                    , k = w(f, "opacity");
                  if (s.fitSize) {
                      var D = s.rw = yn(f.width, t, Y) || 20;
                      s.widthScale = h / D;
                      var _ = s.rh = yn(f.height, t, Y) || 20;
                      s.heightScale = H / _
                  }
                  if (Z.save(),
                  Z.interactiveInfo) {
                      var B = Z.interactiveInfo.matrix
                        , a = B.clone();
                      B.appendTranslate(G, u).appendScale(e / h, O / H),
                      Z.interactiveInfo.refRect = s
                  }
                  od(Z, G, u),
                  (h !== e || H !== O) && Z.scale(e / h, O / H),
                  p && (Oi(p) ? p(Z, h, H, t, Y, f) : (Z.beginPath(),
                  Z.rect(0, 0, h, H),
                  Z.clip())),
                  k != E && (Z.globalAlpha *= k),
                  w(f, "comps").forEach(function(h) {
                      if (h.prefix) {
                          var G = eg
                            , j = yn(h.prefix, t, Y);
                          j && (eg = eg + j + ".")
                      }
                      if (0 == T(f, h))
                          return h.prefix && (eg = G),
                          void 0;
                      if (Ce.splice(0, 0, h),
                      Z.interactiveInfo)
                          var v = Z.interactiveInfo.matrix.clone();
                      var b = w(h, "opacity")
                        , p = w(h, "shadow")
                        , o = w(h, "type")
                        , u = w(h, "refRect") || s
                        , P = I(h, u);
                      if (b != E) {
                          var O = Z.globalAlpha;
                          Z.globalAlpha *= b
                      }
                      if (p) {
                          var _ = Z.shadowOffsetX
                            , d = Z.shadowOffsetY
                            , B = Z.shadowBlur
                            , i = Z.shadowColor
                            , y = w(h, "shadowOffsetX")
                            , N = w(h, "shadowOffsetY")
                            , k = w(h, "shadowBlur")
                            , D = r(h, "shadowColor");
                          Z.shadowOffsetX = (y == E ? 3 : y) * F,
                          Z.shadowOffsetY = (N == E ? 3 : N) * F,
                          Z.shadowBlur = (k == E ? 6 : k) * F,
                          Z.shadowColor = D || r($p)
                      }
                      if ("save" === o)
                          Z.save();
                      else if ("endClip" === o || "restore" === o)
                          Z.restore();
                      else if ("clip" === o)
                          Z.save(),
                          Cc(Z, w(h, "points", c), w(h, "segments", q), !0),
                          Z.clip();
                      else if (sc[o])
                          P = P || {
                              x: 0,
                              y: 0,
                              width: u.width,
                              height: u.height
                          },
                          Q(h, o, P, u);
                      else if (o === Zr)
                          Q(h, o, P, u);
                      else if ("SVGPath" === o)
                          g(h, o, P);
                      else {
                          P = P || {
                              x: 0,
                              y: 0,
                              width: u.width,
                              height: u.height
                          };
                          var W = w(h, Ek)
                            , X = w(h, "scaleX")
                            , z = w(h, "scaleY")
                            , L = x(h)
                            , U = S(h, P, P, W, X, z, L);
                          if (Oi(o))
                              m(h, o),
                              M.drawCompType(o, Z, P, h, t, Y);
                          else if (M.getCompType(o)) {
                              var l = M.getCompType(o)
                                , $ = l.func || l;
                              m(h, l),
                              M.drawCompType($, Z, P, h, t, Y)
                          } else
                              R[o] ? R[o](h, P) : M.getCompType(o) === V && Jm.test(o) && kp(o);
                          U && J()
                      }
                      p && (Z.shadowOffsetX = _,
                      Z.shadowOffsetY = d,
                      Z.shadowBlur = B,
                      Z.shadowColor = i),
                      b != E && (Z.globalAlpha = O),
                      Z.interactiveInfo && (Z.interactiveInfo.matrix = v),
                      h.prefix && (eg = G),
                      Ce.splice(0, 1)
                  }),
                  Z.interactiveInfo && (Z.interactiveInfo.matrix = a),
                  Z.restore(),
                  i(N)
              }
          }
      }();
      M.getCurrentComp = function() {
          return Ce[0]
      }
      ,
      M.getParentComp = function() {
          return Ce[1]
      }
      ,
      M.getInternal = function() {
          return {
              isEnter: bq,
              isEsc: pg,
              isSpace: ec,
              isLeft: Ll,
              isUp: yo,
              isRight: zp,
              isDown: Cf,
              addMethod: rc,
              superCall: Jg,
              toPointsArray: _q,
              translateAndScale: Sn,
              appendArray: ph,
              createWorldMatrix: lp,
              vec3TransformMat4: Wb,
              setCanvas: Uj,
              createDiv: cf,
              createView: Te,
              createCanvas: Jl,
              createImage: Go,
              initContext: hq,
              layout: ib,
              fillRect: xg,
              Mat: Ck,
              drawBorder: Ri,
              isString: Xq,
              setBorder: Hd,
              getPropertyValue: sj,
              setPropertyValue: Hk,
              drawVerticalLine: Ne,
              draw3DRect: Kk,
              getPinchDist: fd,
              isSameRect: sp,
              getPosition: Eo,
              intersectionLineRect: Sq,
              getNodeRect: wo,
              getEdgeAgentPosition: or,
              getEdgeHostPosition: $g,
              getImageWidth: Aj,
              getImageHeight: Xc,
              initItemElement: ho,
              drawPoints: Cc,
              createG2: cq,
              closePopup: fc,
              isH: nj,
              createAnim: Dg,
              createNormalMatrix: vn,
              toColorArray: bd,
              createNormals: Yc,
              toFloatArray: ee,
              glMV: Fb,
              glPop: uo,
              batchShape: jc,
              createNodeMatrix: Dp,
              getShapeModel: hc,
              getFaceInfo: Dq,
              transformAppend: Mg,
              drawFaceInfo: np,
              to3dPointsArray: cd,
              setGLDebugMode: function(e) {
                  dr = e
              },
              cube: function() {
                  return {
                      vs: qj,
                      is: Vh,
                      uv: $j
                  }
              },
              ui: function() {
                  return {
                      DataUI: bk,
                      NodeUI: Zd,
                      EdgeUI: Mm,
                      GroupUI: Wh,
                      ShapeUI: Ro,
                      GridUI: pe,
                      Data3dUI: wf,
                      Node3dUI: Uo,
                      Shape3dUI: lh
                  }
              },
              getInternalVersion: function() {
                  return "U2FsdGVkX1/010fjRC+OIEbV8JGURc4hxRw99yIp4NE="
              },
              getDragger: function() {
                  return gd
              },
              addMSMap: function(u) {
                  rc(tb, u)
              },
              k: L,
              addEventListener: b,
              removeEventListener: D
          }
      }
      ,
      function(C) {
          function R(l, B) {
              l != E && (B == E && Tk != typeof l ? this._54O(l, 256) : this._54O(l, B))
          }
          function w() {
              return new R(E)
          }
          function N(w, K, Y, g, D, O) {
              for (; --O >= 0; ) {
                  var u = K * this[w++] + Y[g] + D;
                  D = q(u / 67108864),
                  Y[g++] = 67108863 & u
              }
              return D
          }
          function v(W, e, M, i, q, L) {
              for (var w = 32767 & e, g = e >> 15; --L >= 0; ) {
                  var O = 32767 & this[W]
                    , S = this[W++] >> 15
                    , H = g * O + S * w;
                  O = w * O + ((32767 & H) << 15) + M[i] + (1073741823 & q),
                  q = (O >>> 30) + (H >>> 15) + g * S + (q >>> 30),
                  M[i++] = 1073741823 & O
              }
              return q
          }
          function V(I, O, a, o, T, t) {
              for (var s = 16383 & O, k = O >> 14; --t >= 0; ) {
                  var x = 16383 & this[I]
                    , e = this[I++] >> 14
                    , _ = k * x + e * s;
                  x = s * x + ((16383 & _) << 14) + a[o] + T,
                  T = (x >> 28) + (_ >> 14) + k * e,
                  a[o++] = 268435455 & x
              }
              return T
          }
          function A(U) {
              return nk.charAt(U)
          }
          function I(V, k) {
              var C = _d[V.charCodeAt(k)];
              return C == E ? -1 : C
          }
          function m(M) {
              for (var D = this.t - 1; D >= 0; --D)
                  M[D] = this[D];
              M.t = this.t,
              M.s = this.s
          }
          function Z(z) {
              this.t = 1,
              this.s = 0 > z ? -1 : 0,
              z > 0 ? this[0] = z : -1 > z ? this[0] = z + this.DV : this.t = 0
          }
          function g(C) {
              var p = w();
              return p._58O(C),
              p
          }
          function U(H, G) {
              var N, P = this;
              if (16 == G)
                  N = 4;
              else if (8 == G)
                  N = 3;
              else if (256 == G)
                  N = 8;
              else if (2 == G)
                  N = 1;
              else if (32 == G)
                  N = 5;
              else {
                  if (4 != G)
                      return P.fromRadix(H, G),
                      void 0;
                  N = 2
              }
              P.t = 0,
              P.s = 0;
              for (var g = H.length, r = !1, d = 0; --g >= 0; ) {
                  var z = 8 == N ? 255 & H[g] : I(H, g);
                  0 > z ? "-" == H.charAt(g) && (r = !0) : (r = !1,
                  0 == d ? P[P.t++] = z : d + N > P.DB ? (P[P.t - 1] |= (z & (1 << P.DB - d) - 1) << d,
                  P[P.t++] = z >> P.DB - d) : P[P.t - 1] |= z << d,
                  d += N,
                  d >= P.DB && (d -= P.DB))
              }
              8 == N && 0 != (128 & H[0]) && (P.s = -1,
              d > 0 && (P[P.t - 1] |= (1 << P.DB - d) - 1 << d)),
              P._57O(),
              r && R.ZERO._78O(P, P)
          }
          function S() {
              for (var H = this, L = H.s & H.DM; H.t > 0 && H[H.t - 1] == L; )
                  --H.t
          }
          function j(S) {
              var e = this;
              if (e.s < 0)
                  return "-" + e._85O()[xq](S);
              var D;
              if (16 == S)
                  D = 4;
              else if (8 == S)
                  D = 3;
              else if (2 == S)
                  D = 1;
              else if (32 == S)
                  D = 5;
              else {
                  if (4 != S)
                      return e.toRadix(S);
                  D = 2
              }
              var L, m = (1 << D) - 1, I = !1, k = "", n = e.t, N = e.DB - n * e.DB % D;
              if (n-- > 0)
                  for (N < e.DB && (L = e[n] >> N) > 0 && (I = !0,
                  k = A(L)); n >= 0; )
                      D > N ? (L = (e[n] & (1 << N) - 1) << D - N,
                      L |= e[--n] >> (N += e.DB - D)) : (L = e[n] >> (N -= D) & m,
                      0 >= N && (N += e.DB,
                      --n)),
                      L > 0 && (I = !0),
                      I && (k += A(L));
              return I ? k : "0"
          }
          function u() {
              var V = w();
              return R.ZERO._78O(this, V),
              V
          }
          function s() {
              return this.s < 0 ? this._85O() : this
          }
          function a(J) {
              var p = this
                , f = p.s - J.s;
              if (0 != f)
                  return f;
              var I = p.t;
              if (f = I - J.t,
              0 != f)
                  return p.s < 0 ? -f : f;
              for (; --I >= 0; )
                  if (0 != (f = p[I] - J[I]))
                      return f;
              return 0
          }
          function i(z) {
              var Y, Q = 1;
              return 0 != (Y = z >>> 16) && (z = Y,
              Q += 16),
              0 != (Y = z >> 8) && (z = Y,
              Q += 8),
              0 != (Y = z >> 4) && (z = Y,
              Q += 4),
              0 != (Y = z >> 2) && (z = Y,
              Q += 2),
              0 != (Y = z >> 1) && (z = Y,
              Q += 1),
              Q
          }
          function Q() {
              var Q = this;
              return Q.t <= 0 ? 0 : Q.DB * (Q.t - 1) + i(Q[Q.t - 1] ^ Q.s & Q.DM)
          }
          function B(i, V) {
              var P;
              for (P = this.t - 1; P >= 0; --P)
                  V[P + i] = this[P];
              for (P = i - 1; P >= 0; --P)
                  V[P] = 0;
              V.t = this.t + i,
              V.s = this.s
          }
          function t(g, v) {
              for (var c = g; c < this.t; ++c)
                  v[c - g] = this[c];
              v.t = X(this.t - g, 0),
              v.s = this.s
          }
          function T(F, H) {
              var A, i = this, u = F % i.DB, G = i.DB - u, m = (1 << G) - 1, T = q(F / i.DB), o = i.s << u & i.DM;
              for (A = i.t - 1; A >= 0; --A)
                  H[A + T + 1] = i[A] >> G | o,
                  o = (i[A] & m) << u;
              for (A = T - 1; A >= 0; --A)
                  H[A] = 0;
              H[T] = o,
              H.t = i.t + T + 1,
              H.s = i.s,
              H._57O()
          }
          function l(Z, J) {
              var H = this;
              J.s = H.s;
              var i = q(Z / H.DB);
              if (i >= H.t)
                  return J.t = 0,
                  void 0;
              var m = Z % H.DB
                , x = H.DB - m
                , t = (1 << m) - 1;
              J[0] = H[i] >> m;
              for (var S = i + 1; S < H.t; ++S)
                  J[S - i - 1] |= (H[S] & t) << x,
                  J[S - i] = H[S] >> m;
              m > 0 && (J[H.t - i - 1] |= (H.s & t) << x),
              J.t = H.t - i,
              J._57O()
          }
          function D(s, N) {
              for (var X = this, j = 0, v = 0, Z = K(s.t, X.t); Z > j; )
                  v += X[j] - s[j],
                  N[j++] = v & X.DM,
                  v >>= X.DB;
              if (s.t < X.t) {
                  for (v -= s.s; j < X.t; )
                      v += X[j],
                      N[j++] = v & X.DM,
                      v >>= X.DB;
                  v += X.s
              } else {
                  for (v += X.s; j < s.t; )
                      v -= s[j],
                      N[j++] = v & X.DM,
                      v >>= X.DB;
                  v -= s.s
              }
              N.s = 0 > v ? -1 : 0,
              -1 > v ? N[j++] = X.DV + v : v > 0 && (N[j++] = v),
              N.t = j,
              N._57O()
          }
          function r(N, k) {
              var T = this.abs()
                , H = N.abs()
                , y = T.t;
              for (k.t = y + H.t; --y >= 0; )
                  k[y] = 0;
              for (y = 0; y < H.t; ++y)
                  k[y + T.t] = T.am(0, H[y], k, y, 0, T.t);
              k.s = 0,
              k._57O(),
              this.s != N.s && R.ZERO._78O(k, k)
          }
          function x(t) {
              for (var R = this.abs(), N = t.t = 2 * R.t; --N >= 0; )
                  t[N] = 0;
              for (N = 0; N < R.t - 1; ++N) {
                  var y = R.am(N, R[N], t, 2 * N, 0, 1);
                  (t[N + R.t] += R.am(N + 1, 2 * R[N], t, 2 * N + 1, y, R.t - N - 1)) >= R.DV && (t[N + R.t] -= R.DV,
                  t[N + R.t + 1] = 1)
              }
              t.t > 0 && (t[t.t - 1] += R.am(N, R[N], t, 2 * N, 0, 1)),
              t.s = 0,
              t._57O()
          }
          function k(e, p, V) {
              var L = e.abs()
                , j = this;
              if (!(L.t <= 0)) {
                  var z = j.abs();
                  if (z.t < L.t)
                      return p != E && p._58O(0),
                      V != E && j._77O(V),
                      void 0;
                  V == E && (V = w());
                  var b = w()
                    , g = j.s
                    , k = e.s
                    , T = j.DB - i(L[L.t - 1]);
                  T > 0 ? (L._44O(T, b),
                  z._44O(T, V)) : (L._77O(b),
                  z._77O(V));
                  var s = b.t
                    , Q = b[s - 1];
                  if (0 != Q) {
                      var d = Q * (1 << j.F1) + (s > 1 ? b[s - 2] >> j.F2 : 0)
                        , D = j.FV / d
                        , U = (1 << j.F1) / d
                        , o = 1 << j.F2
                        , A = V.t
                        , B = A - s
                        , Z = p == E ? w() : p;
                      for (b._59O(B, Z),
                      V._52O(Z) >= 0 && (V[V.t++] = 1,
                      V._78O(Z, V)),
                      R.ONE._59O(s, Z),
                      Z._78O(b, b); b.t < s; )
                          b[b.t++] = 0;
                      for (; --B >= 0; ) {
                          var J = V[--A] == Q ? j.DM : q(V[A] * D + (V[A - 1] + o) * U);
                          if ((V[A] += b.am(0, J, V, B, 0, s)) < J)
                              for (b._59O(B, Z),
                              V._78O(Z, V); V[A] < --J; )
                                  V._78O(Z, V)
                      }
                      p != E && (V._45O(s, p),
                      g != k && R.ZERO._78O(p, p)),
                      V.t = s,
                      V._57O(),
                      T > 0 && V._46O(T, V),
                      0 > g && R.ZERO._78O(V, V)
                  }
              }
          }
          function b(g) {
              var B = w();
              return this.abs()._49O(g, E, B),
              this.s < 0 && B._52O(R.ZERO) > 0 && g._78O(B, B),
              B
          }
          function d(N) {
              this.m = N
          }
          function e(K) {
              return K.s < 0 || K._52O(this.m) >= 0 ? K.mod(this.m) : K
          }
          function $(F) {
              return F
          }
          function Y(H) {
              H._49O(this.m, E, H)
          }
          function c(F, G, v) {
              F._47O(G, v),
              this._74O(v)
          }
          function G(G, y) {
              G._48O(y),
              this._74O(y)
          }
          function M() {
              if (this.t < 1)
                  return 0;
              var T = this[0];
              if (0 == (1 & T))
                  return 0;
              var g = 3 & T;
              return g = 15 & g * (2 - (15 & T) * g),
              g = 255 & g * (2 - (255 & T) * g),
              g = 65535 & g * (2 - (65535 & (65535 & T) * g)),
              g = g * (2 - T * g % this.DV) % this.DV,
              g > 0 ? this.DV - g : -g
          }
          function h(l) {
              var O = this;
              O.m = l,
              O.mp = l._50O(),
              O.mpl = 32767 & O.mp,
              O.mph = O.mp >> 15,
              O.um = (1 << l.DB - 15) - 1,
              O.mt2 = 2 * l.t
          }
          function W(N) {
              var A = w();
              return N.abs()._59O(this.m.t, A),
              A._49O(this.m, E, A),
              N.s < 0 && A._52O(R.ZERO) > 0 && this.m._78O(A, A),
              A
          }
          function _(d) {
              var r = w();
              return d._77O(r),
              this._74O(r),
              r
          }
          function J(R) {
              for (var w = this; R.t <= w.mt2; )
                  R[R.t++] = 0;
              for (var c = 0; c < w.m.t; ++c) {
                  var v = 32767 & R[c]
                    , t = v * w.mpl + ((v * w.mph + (R[c] >> 15) * w.mpl & w.um) << 15) & R.DM;
                  for (v = c + w.m.t,
                  R[v] += w.m.am(0, t, R, c, 0, w.m.t); R[v] >= R.DV; )
                      R[v] -= R.DV,
                      R[++v]++
              }
              R._57O(),
              R._45O(w.m.t, R),
              R._52O(w.m) >= 0 && R._78O(w.m, R)
          }
          function n(s, O) {
              s._48O(O),
              this._74O(O)
          }
          function Pr(H, O, n) {
              H._47O(O, n),
              this._74O(n)
          }
          function lj() {
              return 0 == (this.t > 0 ? 1 & this[0] : this.s)
          }
          function rp(E, A) {
              if (E > 4294967295 || 1 > E)
                  return R.ONE;
              var F = w()
                , H = w()
                , U = A._73O(this)
                , $ = i(E) - 1;
              for (U._77O(F); --$ >= 0; )
                  if (A._76O(F, H),
                  (E & 1 << $) > 0)
                      A._75O(H, U, F);
                  else {
                      var J = F;
                      F = H,
                      H = J
                  }
              return A.revert(F)
          }
          function Hn(T, W) {
              var x;
              return x = 256 > T || W._51O() ? new d(W) : new h(W),
              this.exp(T, x)
          }
          function Tf() {
              var o = this;
              if (o.s < 0) {
                  if (1 == o.t)
                      return o[0] - o.DV;
                  if (0 == o.t)
                      return -1
              } else {
                  if (1 == o.t)
                      return o[0];
                  if (0 == o.t)
                      return 0
              }
              return (o[1] & (1 << 32 - o.DB) - 1) << o.DB | o[0]
          }
          function Fc(l, v) {
              return new R(l,v)
          }
          function $k() {
              var a = this;
              a.n = E,
              a.e = 0,
              a.d = E,
              a.p = E,
              a.q = E,
              a.dmp1 = E,
              a.dmq1 = E,
              a._10A = E
          }
          function Ld(k) {
              return k._53O(this.e, this.n)
          }
          function Go(W) {
              var V, S, N, M = "", I = 0;
              for (V = 0; V < W.length && W.charAt(V) != Xp; ++V)
                  N = oj.indexOf(W.charAt(V)),
                  0 > N || (0 == I ? (M += A(N >> 2),
                  S = 3 & N,
                  I = 1) : 1 == I ? (M += A(S << 2 | N >> 4),
                  S = 15 & N,
                  I = 2) : 2 == I ? (M += A(S),
                  M += A(N >> 2),
                  S = 3 & N,
                  I = 3) : (M += A(S << 2 | N >> 4),
                  M += A(15 & N),
                  I = 0));
              return 1 == I && (M += A(S << 2)),
              M
          }
          function uf(I) {
              var N = I.split("")
                , f = Go(I);
              return N.forEach(function(t) {
                  var q = t.length;
                  q > 0 && f && (Jr += $n(t))
              }),
              f
          }
          function Ee(Q, o) {
              var d = $i._4O.Util._56O(Q, "ss")
                , T = {}
                , q = 0;
              return T.v = d == o,
              T.t = 1,
              T.s = 0 > q ? -1 : 0,
              Ih = T.v,
              q > 0 ? T[0] = q : -1 > q ? T[0] = q + T.DV : T.t = 0,
              [d, T]
          }
          function vb(v) {
              var K = 38
                , k = v.substring(0, K);
              if (k && 30 == k.indexOf("05000420")) {
                  var W = ["ss", v.substring(K)];
                  return W
              }
              return []
          }
          function ur(M, Z) {
              Z = Z.replace(xr, ""),
              Z = Z.replace(/[ \n]+/g, "");
              var b = Fc(Z, 16);
              if (b._55O() > this.n._55O())
                  return 0;
              var N = this._37O(b)
                , j = N[xq](16).replace(/^1f+00/, "")
                , s = vb(j);
              if (0 == s.length)
                  return !1;
              for (var i, W, A, h = .5, x = Zj, T = [0, .5, .75, .875, .9375], a = [], d = [], $ = [], q = y / x, l = s[1], F = Ee(M, l)[0], u = 0, L = 0; u < T.length; u++) {
                  var D = 0 === u % 2 ? 0 : .5;
                  for (i = 0; x >= i; i++)
                      W = (i + D) * q,
                      A = 1 - T[u],
                      a.push(P(W) * h * A, -h + 2 * T[u] * h, -o(W) * h * A),
                      d.push((i + D) / x, A)
              }
              for (u = 0; u < T.length - 1; u++) {
                  var K = u * (x + 1)
                    , c = (u + 1) * (x + 1);
                  for (i = 0; x > i; i++)
                      $.push(K + i, c + i + 1, c + i, K + i, K + i + 1, c + i + 1)
              }
              return $.forEach(function(d) {
                  L += d
              }),
              l == F && L > 10
          }
          var Ej, If = 0xdeadbeefcafe, Lg = 15715070 == (16777215 & If), xq = "toString", Ip = "", Fq = "nat", pl = function() {};
          f = C["D" + 11182[xq](H(2, 5))];
          var Nn = R.prototype;
          iq += pn.substr(0, 1);
          var Pc = C.navigator ? C.navigator.appName : "";
          Lg && "Microsoft Internet Explorer" == Pc ? (Nn.am = v,
          Ej = 30) : Lg && "Netscape" != Pc ? (Nn.am = N,
          Ej = 26) : (Nn.am = V,
          Ej = 28),
          Nn.DB = Ej,
          Nn.DM = (1 << Ej) - 1,
          Nn.DV = 1 << Ej;
          var or = 52;
          Nn.FV = H(2, or),
          Nn.F1 = or - Ej,
          Nn.F2 = 2 * Ej - or;
          var Pf, Rh, nk = "0123456789abcdefghijklmnopqrstuvwxyz", _d = [], Ri = function(m) {
              return String.fromCharCode(m)
          };
          for (Pf = "0".charCodeAt(0),
          Rh = 0; 9 >= Rh; ++Rh)
              _d[Pf++] = Rh;
          for (Pf = "a".charCodeAt(0),
          Rh = 10; 36 > Rh; ++Rh)
              _d[Pf++] = Rh;
          for (Pf = "A".charCodeAt(0),
          Rh = 10; 36 > Rh; ++Rh)
              _d[Pf++] = Rh;
          var jf = d.prototype;
          jf._73O = e,
          jf.revert = $,
          jf._74O = Y,
          jf._75O = c,
          jf._76O = G;
          var Kb = h.prototype;
          Kb._73O = W,
          Kb.revert = _,
          Kb._74O = J,
          Kb._75O = Pr,
          Kb._76O = n,
          Nn._77O = m,
          Nn._58O = Z,
          Nn._54O = U,
          Nn._57O = S,
          Nn._59O = B,
          Nn._45O = t,
          Nn._44O = T,
          Nn._46O = l,
          Nn._78O = D,
          Nn._47O = r,
          Nn._48O = x,
          Nn._49O = k,
          Nn._50O = M,
          Nn._51O = lj,
          Nn.exp = rp,
          Nn.toString = j,
          Nn._85O = u,
          Nn.abs = s,
          Nn._52O = a,
          Nn._55O = Q,
          Nn.mod = b,
          Nn._53O = Hn,
          R.ZERO = g(0),
          R.ONE = g(1),
          Nn._86O = Tf;
          var qb = function(c, i) {
              var j = this;
              j.isPublic = !0,
              typeof c !== Tk ? (j.n = c,
              j.e = i) : c != E && i != E && c.length > 0 && i.length > 0 && (j.n = Fc(c, 16),
              j.e = $n(i, 16))
          };
          Ue = function() {
              var F, w, S = uf(mi), M = S.substr(0, 4), T = S.substr(4, 2), r = S.substr(6, 2), $ = 1, J = !$, j = L, D = [], t = Jk.charAt(7);
              if (f && (f[xq]().indexOf(Fq) < 0 || f[iq][xq]().indexOf(Fq) < 0 || !S ? F = E : (S = new f(M - 0,T - $,r - 0),
              w = S.setHours(9),
              f[iq]() > w ? F = _j[t] : J = !0)),
              S && F && F[0] && F[z(.5)] && j) {
                  var P = ok(F[0])
                    , X = ok(F[1]);
                  for (var I in X)
                      D.push(I);
                  var o, V = 0, R = P[D[V]], C = X[D[V++]], G = X[D[V++]], b = X[D[V++]], K = X[D[V++]], B = X[D[V++]], e = X[D[V++]], x = P[D[V]], v = X[D[V++]], A = Mg._27O(j);
                  if (R === C && A && v) {
                      o = C + G + b + K + B + e;
                      var l = !e || e === uc;
                      if (!l && e)
                          for (var O, i = 0, Y = e.length; Y > i; i++)
                              e[i] === sq[V] ? O === uc ? l = !0 : O[0] === sh[5] && uc && uc.indexOf(O.substr(1)) >= 0 ? l = !0 : O = E : (O == E ? O = e[i] : O += e[i],
                              i === Y - 1 && (O === uc ? l = !0 : O[0] === sh[5] && uc && uc.indexOf(O.substr(1)) >= 0 && (l = !0)));
                      o && A._31O(o, v) && A._31O(R, x) && l && (!B || f[iq]() < B) && (J = !0)
                  }
              }
              return J || (Cr = Og),
              t
          }
          ;
          var Uf = $k.prototype;
          Uf._37O = Ld,
          Uf._38O = qb;
          var oj = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
            , Xp = "="
            , $b = 25
            , $r = 10
            , mi = "ICESFQ=="
            , bc = bc || function(k, G) {
              var E = {}
                , u = E._7A = {}
                , s = u._6A = function() {
                  function I() {}
                  return {
                      _80O: function(o) {
                          I.prototype = this;
                          var Y = new I;
                          return o && Y._5A(o),
                          Y.hasOwnProperty("_82O") || (Y._82O = function() {
                              Y.$super._82O.apply(this, arguments)
                          }
                          ),
                          Y._82O.prototype = Y,
                          Y.$super = this,
                          Y
                      },
                      _3A: function() {
                          var z = this._80O();
                          return z._82O.apply(z, arguments),
                          z
                      },
                      _82O: function() {},
                      _5A: function(X) {
                          for (var r in X)
                              X.hasOwnProperty(r) && (this[r] = X[r]);
                          X.hasOwnProperty(xq) && (this.toString = X.toString)
                      },
                      _88O: function() {
                          return this._82O.prototype._80O(this)
                      }
                  }
              }()
                , d = u._39O = s._80O({
                  _82O: function(u, C) {
                      u = this._84O = u || [],
                      this._65O = C != G ? C : 4 * u.length
                  },
                  toString: function(W) {
                      return (W || c).stringify(this)
                  },
                  _89O: function(f) {
                      var y = this._84O
                        , t = f._84O
                        , L = this._65O
                        , B = f._65O;
                      if (this._57O(),
                      L % 4)
                          for (var N = 0; B > N; N++) {
                              var J = 255 & t[N >>> 2] >>> 24 - 8 * (N % 4);
                              y[L + N >>> 2] |= J << 24 - 8 * ((L + N) % 4)
                          }
                      else if (t.length > 65535)
                          for (var N = 0; B > N; N += 4)
                              y[L + N >>> 2] = t[N >>> 2];
                      else
                          y.push.apply(y, t);
                      return this._65O += B,
                      this
                  },
                  _57O: function() {
                      var K = this._84O
                        , Z = this._65O;
                      K[Z >>> 2] &= 4294967295 << 32 - 8 * (Z % 4),
                      K.length = z(Z / 4)
                  },
                  _88O: function() {
                      var y = s._88O.call(this);
                      return y._84O = this._84O.slice(0),
                      y
                  },
                  _87O: function(v) {
                      for (var H = [], t = 0; v > t; t += 4)
                          H.push(0 | 4294967296 * F);
                      return new d._82O(H,v)
                  }
              })
                , C = E._2A = {}
                , c = C._69O = {
                  stringify: function(m) {
                      var P, L = m._84O, n = m._65O, X = [];
                      for (P = 0; n > P; P++) {
                          var C = 255 & L[P >>> 2] >>> 24 - 8 * (P % 4);
                          X.push((C >>> 4).toString(16)),
                          X.push((15 & C).toString(16))
                      }
                      return X.join("")
                  },
                  _68O: function(Z) {
                      for (var w = Z.length, z = [], J = 0; w > J; J += 2)
                          z[J >>> 3] |= $n(Z.substr(J, 2), 16) << 24 - 4 * (J % 8);
                      return new d._82O(z,w / 2)
                  }
              }
                , v = C._8A = {
                  stringify: function(A) {
                      var E, y = A._84O, t = A._65O, C = [];
                      for (E = 0; t > E; E++) {
                          var e = 255 & y[E >>> 2] >>> 24 - 8 * (E % 4);
                          C.push(Ri(e))
                      }
                      return C.join("")
                  },
                  _68O: function(c) {
                      var P, X = c.length, e = [];
                      for (P = 0; X > P; P++)
                          e[P >>> 2] |= (255 & c.charCodeAt(P)) << 24 - 8 * (P % 4);
                      return new d._82O(e,X)
                  }
              }
                , a = C._9A = {
                  stringify: function(I) {
                      try {
                          return decodeURIComponent(escape(v.stringify(I)))
                      } catch (f) {
                          throw new Error("")
                      }
                  },
                  _68O: function(V) {
                      return v._68O(unescape(encodeURIComponent(V)))
                  }
              }
                , L = u._32O = s._80O({
                  _1A: function() {
                      this._83O = new d._82O,
                      this._23O = 0
                  },
                  _33O: function(k) {
                      typeof k == Tk && (k = a._68O(k)),
                      this._83O._89O(k),
                      this._23O += k._65O
                  },
                  _25O: function(Q) {
                      var b = this._83O
                        , E = b._84O
                        , i = b._65O
                        , $ = this._79O
                        , P = 4 * $
                        , u = i / P;
                      u = Q ? z(u) : X((0 | u) - this._22O, 0);
                      var O = u * $
                        , U = K(4 * O, i);
                      if (O) {
                          for (var G = 0; O > G; G += $)
                              this._20O(E, G);
                          var l = E.splice(0, O);
                          b._65O -= U
                      }
                      return new d._82O(l,U)
                  },
                  _88O: function() {
                      var e = s._88O.call(this);
                      return e._83O = this._83O._88O(),
                      e
                  },
                  _22O: 0
              });
              u._66O = L._80O({
                  cfg: s._80O(),
                  _82O: function(L) {
                      this.cfg = this.cfg._80O(L),
                      this._1A()
                  },
                  _1A: function() {
                      L._1A.call(this),
                      this._34O()
                  },
                  _81O: function(z) {
                      return this._33O(z),
                      this._25O(),
                      this
                  },
                  _72O: function(R) {
                      R && this._33O(R);
                      var r = this._21O();
                      return r
                  },
                  _79O: 16,
                  _26O: function(m) {
                      return function(t, D) {
                          return new m._82O(D)._72O(t)
                      }
                  },
                  _19O: function(q) {
                      return function(z, Q) {
                          return new Y._71O._82O(q,Q)._72O(z)
                      }
                  }
              });
              var Y = E._67O = {};
              return E
          }();
          !function() {
              var k = bc
                , a = k._7A
                , V = a._39O
                , e = a._66O
                , A = k._67O
                , R = []
                , I = [];
              !function() {
                  function B(W) {
                      for (var D = O(W), G = 2; D >= G; G++)
                          if (!(W % G))
                              return !1;
                      return !0
                  }
                  function S(T) {
                      return 0 | 4294967296 * (T - (0 | T))
                  }
                  for (var F = 2, i = 0; 64 > i; )
                      B(F) && (8 > i && (R[i] = S(H(F, .5))),
                      I[i] = S(H(F, 1 / 3)),
                      i++),
                      F++
              }();
              var Y = []
                , B = A._41O = e._80O({
                  _34O: function() {
                      this._64O = new V._82O(R.slice(0))
                  },
                  _20O: function(v, N) {
                      for (var E = this._64O._84O, H = E[0], o = E[1], S = E[2], D = E[3], F = E[4], s = E[5], e = E[6], K = E[7], u = 0; 64 > u; u++) {
                          if (16 > u)
                              Y[u] = 0 | v[N + u];
                          else {
                              var R = Y[u - 15]
                                , y = (R << 25 | R >>> 7) ^ (R << 14 | R >>> 18) ^ R >>> 3
                                , J = Y[u - 2]
                                , q = (J << 15 | J >>> 17) ^ (J << 13 | J >>> 19) ^ J >>> 10;
                              Y[u] = y + Y[u - 7] + q + Y[u - 16]
                          }
                          var W = F & s ^ ~F & e
                            , $ = H & o ^ H & S ^ o & S
                            , l = (H << 30 | H >>> 2) ^ (H << 19 | H >>> 13) ^ (H << 10 | H >>> 22)
                            , t = (F << 26 | F >>> 6) ^ (F << 21 | F >>> 11) ^ (F << 7 | F >>> 25)
                            , _ = K + t + W + I[u] + Y[u]
                            , p = l + $;
                          K = e,
                          e = s,
                          s = F,
                          F = 0 | D + _,
                          D = S,
                          S = o,
                          o = H,
                          H = 0 | _ + p
                      }
                      E[0] = 0 | E[0] + H,
                      E[1] = 0 | E[1] + o,
                      E[2] = 0 | E[2] + S,
                      E[3] = 0 | E[3] + D,
                      E[4] = 0 | E[4] + F,
                      E[5] = 0 | E[5] + s,
                      E[6] = 0 | E[6] + e,
                      E[7] = 0 | E[7] + K
                  },
                  _21O: function() {
                      var X = this._83O
                        , V = X._84O
                        , $ = 8 * this._23O
                        , M = 8 * X._65O;
                      return V[M >>> 5] |= 128 << 24 - M % 32,
                      V[(M + 64 >>> 9 << 4) + 14] = q($ / 4294967296),
                      V[(M + 64 >>> 9 << 4) + 15] = $,
                      X._65O = 4 * V.length,
                      this._25O(),
                      this._64O
                  },
                  _88O: function() {
                      var D = e._88O.call(this);
                      return D._64O = this._64O._88O(),
                      D
                  }
              });
              k._41O = e._26O(B),
              k._42O = e._19O(B)
          }();
          var xr = new RegExp("");
          xr.compile("[^0-9a-f]", "gi"),
          $k._28O = -1,
          $k._29O = -2,
          Uf._31O = ur,
          Uf._63O = ur,
          $k._43O = -2;
          var Ao = new function() {
              var A = this;
              A._5O = function(K, e) {
                  if ("8" != K.substring(e + 2, e + 3))
                      return 1;
                  var u = $n(K.substring(e + 3, e + 4));
                  return 0 == u ? -1 : u > 0 && 10 > u ? u + 1 : -2
              }
              ,
              A._13O = function(H, m) {
                  var x = A._5O(H, m);
                  return 1 > x ? "" : H.substring(m + 2, m + 2 + 2 * x)
              }
              ,
              A._12O = function(C, J) {
                  var L = A._13O(C, J);
                  if ("" == L)
                      return -1;
                  var H;
                  return H = $n(L.substring(0, 1)) < 8 ? new R(L,16) : new R(L.substring(2),16),
                  H._86O()
              }
              ,
              A._6O = function(v, c) {
                  var a = A._5O(v, c);
                  return 0 > a ? a : c + 2 * (a + 1)
              }
              ,
              A._11O = function(W, G) {
                  var z = A._6O(W, G)
                    , r = A._12O(W, G);
                  return W.substring(z, z + 2 * r)
              }
              ,
              A._10O = function(S, p) {
                  var l = A._6O(S, p)
                    , f = A._12O(S, p);
                  return l + 2 * f
              }
              ,
              A._7O = function(w, P) {
                  var u = []
                    , D = A._6O(w, P);
                  u.push(D);
                  for (var v = A._12O(w, P), z = D, j = 0; ; ) {
                      var m = A._10O(w, z);
                      if (m == E || m - D >= 2 * v)
                          break;
                      if (j >= 200)
                          break;
                      u.push(m),
                      z = m,
                      j++
                  }
                  return u
              }
          }
          ;
          if (Ao._90O = Ri($r + 24),
          Ao._91O = p + Ri($r * $r + 8),
          $i == E || !$i)
              var $i = {};
          $i._4O != E && $i._4O || ($i._4O = {});
          var rg = $i._4O;
          $i._4O.Util = new function() {
              var O = this;
              O._56O = function(X) {
                  var c = new $i._4O._3O;
                  return c._30O(X)
              }
              ,
              O._4A = function(e) {
                  var L = new $i._4O._3O;
                  return L._36O(e)
              }
              ,
              O._11A = function(R) {
                  var i = new rg._3O;
                  return i._30O(R)
              }
          }
          ,
          $i._4O._3O = function() {
              var Z = this;
              Z._8O = function(C, s) {
                  if ("ss" == C && "cj" == s) {
                      try {
                          Z.md = bc._67O._41O._3A()
                      } catch (f) {
                          pl(Ip)
                      }
                      Z._24O = function(j) {
                          Z.md._81O(j)
                      }
                      ,
                      Z._35O = function(D) {
                          var Q = bc._2A._69O._68O(D);
                          Z.md._81O(Q)
                      }
                      ,
                      Z._60O = function() {
                          var z = Z.md._72O();
                          return z[xq](bc._2A._69O)
                      }
                      ,
                      Z._30O = function(U) {
                          return Z._24O(U),
                          Z._60O()
                      }
                      ,
                      Z._36O = function(E) {
                          return Z._35O(E),
                          Z._60O()
                      }
                  }
              }
              ,
              Z._24O = function() {
                  pl(Ip)
              }
              ,
              Z._35O = function() {
                  pl(Ip)
              }
              ,
              Z._60O = function() {
                  pl(Ip)
              }
              ,
              Z._30O = function() {
                  pl(Ip)
              }
              ,
              Z._36O = function() {
                  pl(Ip)
              }
              ,
              Z._8O("ss", "cj")
          }
          ,
          Dh = function(D) {
              var W = xo[Bf[7]]
                , g = 1
                , p = !1;
              if (Hr.a != xo[Mc])
                  return Hr.a;
              if (Hr.forEach(function(x) {
                  g *= x
              }),
              D > g) {
                  if (W && W[1] && W[0]) {
                      var U = W[0]
                        , J = W[1];
                      J = J.split(Ao._90O),
                      U = U.split(Ao._90O);
                      var Y = J[3]
                        , L = U[3]
                        , h = J[7]
                        , B = J[11]
                        , K = J[15]
                        , q = J[19]
                        , l = J[23]
                        , C = J[27]
                        , n = U[7]
                        , a = Y + h + B + K + q + l
                        , P = l ? !1 : !0
                        , T = L === Y;
                      if (l) {
                          var N = l && l.split(zn("firefox")[3]);
                          if (N)
                              for (var e = 0; e < N.length; e++) {
                                  var m = N[e];
                                  if (m[0] === bi[8] && (m = m.substring(1)),
                                  vc.indexOf(m) >= 0) {
                                      P = !0;
                                      break
                                  }
                              }
                      }
                      p = T && vd()(L, n) && vd()(a, C) && P && (!q || q > D),
                      p && B.indexOf(me.length) >= 0 && (Dh[me.length] = me),
                      p && B.indexOf(me.length + 1) >= 0 && (Dh[me.length + 1] = me),
                      p && B.indexOf(me.length + 3) >= 0 && (Dh[me.length + 3] = me)
                  }
                  p || (bk.prototype._42 = Ei)
              } else
                  p = !0,
                  Dh[me.length] = Dh[me.length + 1] = Dh[me.length + 3] = me;
              return Hr.a = p,
              p
          }
          ,
          $b = String.fromCharCode($b + 20);
          var Fj = function(L) {
              return L = L.replace(xr, Ip),
              L = L.replace(/[ \n]+/g, Ip)
          }
            , ml = "30"
            , fs = "06"
            , vh = "02"
            , jn = "03"
            , cp = Fc
            , sb = /^1f+00/
            , Mg = function() {
              var c;
              return c = {
                  _18O: function(i) {
                      var W = i
                        , v = W.replace(/\s+/g, "")
                        , O = Go(v);
                      return O
                  },
                  _14O: function(z) {
                      var _ = this._18O(z)
                        , n = this._15O(_);
                      return n
                  },
                  _15O: function(i) {
                      var w = this._17O(i);
                      if ("2a864886f70d010101" == w._61O) {
                          var L = this._16O(w.key)
                            , c = new $k;
                          return c._38O(L.n, L.e),
                          c
                      }
                      pl(Ip)
                  },
                  _16O: function(E) {
                      var h = {};
                      E.substr(0, 2) != ml && pl(Ip);
                      var c = Ao._7O(E, 0);
                      return 2 != c.length && pl(Ip),
                      E.substr(c[0], 2) != vh && pl(Ip),
                      h.n = Ao._11O(E, c[0]),
                      E.substr(c[1], 2) != vh && pl(Ip),
                      h.e = Ao._11O(E, c[1]),
                      h
                  },
                  _17O: function(N) {
                      var r = {};
                      r._40O = E;
                      var L = Ao._7O(N, 0);
                      2 != L.length && pl(Ip);
                      var e = L[0];
                      N.substr(e, 2) != ml && pl(Ip);
                      var h = Ao._7O(N, e);
                      return 2 != h.length && pl(Ip),
                      N.substr(h[0], 2) != fs && pl(Ip),
                      r._61O = Ao._11O(N, h[0]),
                      N.substr(h[1], 2) == fs ? r._40O = Ao._11O(N, h[1]) : N.substr(h[1], 2) == ml && (r._40O = {},
                      r._40O.p = Ao._70O(N, h[1], [0], vh),
                      r._40O.q = Ao._70O(N, h[1], [1], vh),
                      r._40O.g = Ao._70O(N, h[1], [2], vh)),
                      N.substr(L[1], 2) != jn && pl(Ip),
                      r.key = Ao._11O(N, L[1]).substr(2),
                      r
                  }
              },
              c._17O ? c : E
          }()
            , In = Mg._27O = function(p) {
              return Mg._14O(p)
          }
          ;
          vd = function() {
              return function(i, T) {
                  if (i && T) {
                      T = Fj(T);
                      var m = cp(T, H(2, 4))
                        , A = this;
                      if (!A || !A.n || m._55O() > A.n._55O())
                          return 0;
                      var X = A._37O(m)
                        , b = X[xq](H(2, 4)).replace(sb, "")
                        , f = vb(b);
                      if (0 == f.length)
                          return !1;
                      var $ = f[0]
                        , Y = f[1]
                        , W = function(H) {
                          return $i._4O.Util._56O(H, $)
                      }
                        , t = W(i);
                      return Y == t
                  }
              }
              .bind(In(L))
          }
          ;
          var To, lh;
          return function() {
              var W = jo.length - qq.length;
              if (W > 0)
                  for (var R = 0; W > R; R++)
                      To = rg.Util,
                      lh = Fj
          }(),
          Qh = function(k, u) {
              u = lh(u);
              var q = In(Qo)
                , D = nc.length
                , Y = 2 * D
                , z = cp(u, H(D, Y))
                , E = q
                , e = !0;
              if (E) {
                  var _ = E[pk[0]];
                  _ && z._55O() <= _._55O() && (e = !1)
              }
              if (e)
                  return 0;
              var Q = E._37O(z)
                , K = Q[xq](H(D, Y)).replace(sb, "")
                , L = vb(K);
              if (0 == L.length)
                  return !1;
              var j = L[0]
                , U = L[1]
                , G = To._11A(k, j);
              return U == G
          }
          ,
          Mg
      }(W, G),
      rc(M, {
          load: function() {
              var K = {}
                , P = function(Q) {
                  return Q ? "c_" + (Q.sync ? "1" : "0") + "_" + (Q.post ? "1" : "0") + "_" + (Q.responseType || "H") + "_" + (Q.mimeType || "H") + "_" + (Q.data ? JSON.stringify(Q.data) : "H") : ""
              };
              return function(k, m, v) {
                  var x, c = K[k], r = P(v);
                  return c && (x = c[r]) ? (x.push(m),
                  void 0) : (K[k] || (c = K[k] = {
                      count: 0
                  }),
                  x = c[r] = [m],
                  c.count++,
                  M.xhrLoad(k, function(v) {
                      delete c[r],
                      c.count--,
                      c.count || delete K[k],
                      x.forEach(function(z) {
                          z(v)
                      })
                  }, v),
                  void 0)
              }
          }(),
          asyncEach: function(V, I, u) {
              "function" != typeof u && (u = Function.prototype);
              var v = new Array(V.length)
                , s = 0
                , r = !1;
              V.forEach(function(J, X) {
                  I(J, function(q, I) {
                      return r ? void 0 : q ? (r = !0,
                      u(null)) : (v[X] = I,
                      s++,
                      s === V.length ? u(v) : void 0)
                  })
              })
          },
          xhrLoad: function(B, T, i) {
              var z = !1;
              $c(B) || (z = !0,
              B = [B]),
              i = i || {};
              var Q = i.sync
                , g = null
                , G = i.method || "GET";
              return i.post && (G = "POST"),
              i.method = G,
              M.asyncEach(B, function(b, R) {
                  var f = new tn;
                  b = M.beforeLoadURL(b),
                  b.data ? R(null, b.data) : (i.url = encodeURI(b),
                  i.responseType ? f.setResponseType(i.responseType) : f.setOverrideMimeType(i.mimeType || "text/plain"),
                  f.onload = function() {
                      200 === this.status || 0 === this.status ? R(null, f.getResponseText()) : R(!0)
                  }
                  ,
                  f.onerror = function() {
                      R(!0)
                  }
                  ,
                  f.send(i))
              }, function(v) {
                  var A = "function" == typeof T;
                  (A || Q) && (g = z && v ? v[0] : v,
                  A && T(g))
              }),
              Q ? g : void 0
          }
      });
      var zq = G.setPrototypeOf || function(P, p) {
          return P.__proto__ = p,
          P
      }
        , id = G.getPrototypeOf || function(s) {
          return s.__proto__
      }
        , Eb = G.freeze;
      G.isFrozen;
      var Lk = function() {
          var u = function(V) {
              return V
          };
          return function(Y) {
              return Y && Y.length ? new Function("o",["return o['", Y.join("']['"), "'];"].join("")) : u
          }
      }()
        , Bo = function() {
          var j = function(i, V) {
              return i = V
          };
          return function(l) {
              return l && l.length ? new Function("o","v",["return o['", l.join("']['"), "'] = v;"].join("")) : j
          }
      }();
      !function() {
          function n(f) {
              var X = [];
              if (f)
                  for (var j; (j = M.exec(f)) != V; )
                      X.push(j[1]);
              return X
          }
          function T(z, R) {
              var Y = F.exec(R);
              this._cell = z,
              this._key = Y[1],
              this._format = Y[2],
              this._style = n(Y[3])
          }
          function b(Q) {
              for (var S = this._cellList = [], l = this._paramList = [], X = Q.split(K), f = 0, R = X.length; R > f; ++f) {
                  var O = X[f];
                  if ("{{" !== O)
                      for (var y = O.split(C), G = 0, J = y.length; J > G; ++G) {
                          var v = y[G];
                          C.test(v) ? (l.push(new T(S.length,v)),
                          S.push(V)) : v.length > 0 && S.push(v)
                      }
                  else
                      S.push("{")
              }
              this._formatList = this._cellList.slice(0)
          }
          var Q = {}
            , g = {}
            , K = /(\{\{)/
            , C = /(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/
            , F = /\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/
            , M = /\&([\w\.]*)/g;
          b.prototype._73O = function(O) {
              for (var J = this._paramList.length; J--; ) {
                  var W = this._paramList[J]
                    , K = O[$n(W._key) + 1]
                    , X = g[W._format];
                  X && (K = X(K, W._style)),
                  this._formatList[W._cell] = K
              }
              return this._formatList.join("")
          }
          ,
          b.prototype._map = function(p) {
              for (var B = this._paramList.length; B--; ) {
                  var R = this._paramList[B]
                    , d = p[R._key]
                    , k = g[R._format];
                  k && (d = k(d, R._style)),
                  this._formatList[R._cell] = d
              }
              return this._formatList.join("")
          }
          ;
          var u = function(g) {
              var n = Q[g];
              return n || (Q[g] = n = new b(g)),
              n._73O(arguments)
          };
          return u.map = function($, z) {
              var L = Q[$];
              return L || (Q[$] = L = new b($)),
              L._map(z)
          }
          ,
          u.setValueFormat = function(P, Y) {
              g[P] = Y
          }
          ,
          u.gc = function() {
              Q.length = 0
          }
          ,
          u.__parsed = Q,
          u
      }();
      var ui = function() {
          function A(S, N, Y, I) {
              var d = S ? S.path.slice(0) : [];
              N && d.push(N),
              this.desc = Y,
              this.name = N,
              this.path = Eb(d),
              this.getter = Lk(d),
              this.setter = Bo(d),
              this.isLeaf = I,
              this.parent = S,
              this.children = [],
              this.childMap = {}
          }
          return A.create = function() {
              function e(v, h, o, t) {
                  var K = t(o)
                    , f = new A(v,h,o,K);
                  if (!K) {
                      for (var F = f.children, X = f.childMap, U = G.keys(o), x = 0, s = U.length; s > x; ++x) {
                          var V = U[x]
                            , c = e(f, V, o[V], t);
                          F.push(c),
                          X[c.name] = c
                      }
                      f.children = Eb(F),
                      f.childMap = Eb(X)
                  }
                  return Eb(f),
                  f
              }
              return function(P, _) {
                  return e(V, V, P, _)
              }
          }(),
          A.prototype.forEach = function(q, z) {
              for (var H = this.children, f = 0, Y = H.length; Y > f; ++f) {
                  var I = H[f];
                  q(I, z)
              }
          }
          ,
          A
      }()
        , Eb = G.freeze
        , ug = {
          main: {
              mask: 1,
              priority: M.cameraPriority.main,
              clearDepth: !1,
              ignore: !1
          },
          top: {
              mask: 2,
              priority: M.cameraPriority.top,
              ignore: !1
          }
      }
        , Rb = "main"
        , Qd = ug[Rb].mask
        , Hc = function(Q, K, k) {
          if (Q = Q || 0,
          !(K in ug)) {
              if (ap >= 32)
                  throw new Error("Only 31 render layer can be defined.");
              ug[K] = {
                  mask: 1 << ap++,
                  priority: ug[Rb].priority
              }
          }
          if (k)
              for (var W in k)
                  ug[K][W] = k[W];
          return Vg = mh(G.keys(ug)),
          ap = Vg.length,
          Q |= ug[K].mask
      }
        , Bk = function(c, K) {
          return c && K && c & K
      }
        , mh = function(C) {
          return C.sort(function(P, v) {
              return ug[P].priority - ug[v].priority
          })
      }
        , Vg = mh(G.keys(ug))
        , ap = Vg.length;
      rc(M, {
          setRenderLayerInfo: function(n, k) {
              Hc(0, n, k)
          },
          getRenderLayerInfo: function(p) {
              return ug[p]
          }
      }, !0);
      var Mh = n.List = function() {
          this._as = [];
          var I, Z, N = arguments.length;
          if (1 === N) {
              var P = arguments[0];
              if (fb(P) && (P = P._as),
              $c(P))
                  for (Z = P.length,
                  I = 0; Z > I; I++)
                      this._as.push(P[I]);
              else
                  P != E && this._as.push(P)
          } else if (N > 1)
              for (I = 0; N > I; I++)
                  this._as.push(arguments[I])
      }
      ;
      jq("List", G, {
          forEach: function(T, Y) {
              this.each(T, Y)
          },
          push: function() {
              for (var u = 0; u < arguments.length; u++)
                  this.add(arguments[u])
          },
          pop: function() {
              return this._as.pop()
          },
          shift: function() {
              return this._as.shift()
          },
          unshift: function() {
              return this._as.unshift.apply(this._as, arguments)
          },
          size: function() {
              return this._as.length
          },
          isEmpty: function() {
              return 0 === this._as.length
          },
          add: function(w, I) {
              return I === V ? this._as.push(w) : this._as.splice(I, 0, w)
          },
          addAll: function(Q) {
              fb(Q) && (Q = Q._as),
              $c(Q) ? ph(this._as, Q) : this._as.push(Q)
          },
          get: function(w) {
              return this._as[w]
          },
          slice: function(V, t) {
              return new Mh(this._as.slice(V, t))
          },
          remove: function(j) {
              var d = this._as.indexOf(j);
              return d >= 0 && d < this._as.length && this.removeAt(d),
              d
          },
          removeAt: function(M) {
              return this._as.splice(M, 1)[0]
          },
          set: function(o, t) {
              return this._as[o] = t
          },
          clear: function() {
              return this._as.splice(0, this._as.length)
          },
          contains: function(R) {
              return this._as.indexOf(R) >= 0
          },
          indexOf: function(Y) {
              return this._as.indexOf(Y)
          },
          each: function(s, X) {
              for (var _ = 0, l = this._as.length; l > _; _++) {
                  var v = this._as[_];
                  X ? s.call(X, v, _, this) : s(v, _, this)
              }
          },
          reverseEach: function(u, r) {
              for (var V = this._as.length - 1; V >= 0; V--) {
                  var k = this._as[V];
                  r ? u.call(r, k) : u(k)
              }
          },
          getArray: function() {
              return this._as
          },
          toArray: function(J, A) {
              if (J) {
                  for (var G, k = [], R = 0, W = this._as.length; W > R; R++)
                      G = this._as[R],
                      A ? J.call(A, G) && k.push(G) : J(G) && k.push(G);
                  return k
              }
              return this._as.concat()
          },
          toList: function(f, L) {
              if (f) {
                  for (var d, A = new Mh, F = 0, C = this._as.length; C > F; F++)
                      d = this._as[F],
                      L ? f.call(L, d) && A.add(d) : f(d) && A.add(d);
                  return A
              }
              return new Mh(this)
          },
          reverse: function() {
              this._as.reverse()
          },
          sort: function(K) {
              return this._as.sort(K ? K : Xj),
              this
          },
          toString: function() {
              return this._as.toString()
          }
      }),
      G.defineProperties(Mh.prototype, {
          length: {
              get: function() {
                  return this._as.length
              },
              set: function(o) {
                  this._as.length = o
              }
          }
      });
      var $b = new Mh;
      rc($b, {
          size: function() {
              return 0
          },
          indexOf: function() {
              return -1
          },
          contains: function() {
              return !1
          },
          isEmpty: function() {
              return !0
          },
          sort: ts,
          each: ts,
          reverseEach: ts,
          toArray: function() {
              return []
          },
          toList: function() {
              return new Mh
          },
          add: kb,
          addAll: kb,
          set: kb,
          remove: kb,
          removeAt: kb,
          clear: kb
      });
      var ze = n.Notifier = function() {
          this._f = 0
      }
      ;
      jq("Notifier", G, {
          contains: function(B, D) {
              if (this._ls)
                  for (var p, c = 0, R = this._ls.size(); R > c; c++)
                      if (p = this._ls.get(c),
                      B === p.l && D === p.s)
                          return !0;
              return !1
          },
          add: function(_, n, l) {
              var k = this
                , w = {
                  l: _,
                  s: n,
                  a: l
              };
              k._ls || (k._ls = new Mh),
              k._f ? (k._as || (k._as = new Mh),
              k._as.add(w)) : w.a ? k._ls.add(w, 0) : k._ls.add(w)
          },
          remove: function(I, e) {
              var x = this;
              x._ls && (x._f ? (x._rs || (x._rs = new Mh),
              x._rs.add({
                  l: I,
                  s: e
              })) : x._remove(I, e))
          },
          _remove: function(l, z) {
              for (var S, O = this._ls, y = 0, Y = O.size(); Y > y; y++)
                  if (S = O.get(y),
                  S.l === l && S.s === z)
                      return O.removeAt(y),
                      void 0
          },
          fire: function(t) {
              var i = this
                , I = i._ls;
              if (i._b = 1e4,
              I) {
                  ++i._f;
                  try {
                      for (var R, v = 0, n = I.size(); n > v; v++)
                          R = I.get(v),
                          R.s ? R.l.call(R.s, t) : R.l(t)
                  } catch (t) {
                      vk(function() {
                          throw t
                      })
                  } finally {
                      if (--i._f)
                          return;
                      if (i._rs) {
                          for (n = i._rs.size(),
                          v = 0; n > v; v++)
                              R = i._rs.get(v),
                              i._remove(R.l, R.s);
                          delete i._rs
                      }
                      if (i._as) {
                          for (n = i._as.size(),
                          v = 0; n > v; v++)
                              R = i._as.get(v),
                              R.a ? I.add(R, 0) : I.add(R);
                          delete i._as
                      }
                  }
              }
          }
      });
      var _i = n.Data = function() {
          this._id = Pm()
      }
      ;
      jq("Data", G, {
          ms_ac: ["tag", "name", "displayName", "icon", "toolTip", "attrObject", "styleMap", "layer", "adjustChildrenToTop", "dataBindings"],
          ms_dm: 1,
          ms_attr: 1,
          _icon: E,
          _parent: E,
          _children: $b,
          _childMap: E,
          _styleMap: E,
          _layer: "0",
          _renderLayer: Rb,
          _renderLayerMask: Qd,
          _adjustChildrenToTop: !1,
          getRenderLayerMask: function() {
              return this._renderLayerMask || Qd
          },
          getRenderLayer: function() {
              return this._renderLayer || Rb
          },
          setRenderLayer: function(G) {
              var v = this
                , z = Hc(0, G);
              v._renderLayerMask = z;
              var p = v._renderLayer;
              v._renderLayer = G,
              v.fp("renderLayer", p, v._renderLayer)
          },
          testRenderLayer: function(q) {
              var x = ug[q];
              return x && Bk(this._renderLayerMask, ug[q].mask)
          },
          getUIClass: function() {
              return E
          },
          _22Q: function() {
              return E
          },
          beginTransaction: function() {
              this._dataModel && this._dataModel.beginTransaction()
          },
          endTransaction: function() {
              this._dataModel && this._dataModel.endTransaction()
          },
          s: function(Q, v) {
              var G = this;
              if (2 === arguments.length)
                  G.setStyle(Q, v);
              else {
                  if (!Ql(Q))
                      return G.getStyle(Q);
                  for (var w in Q)
                      G.setStyle(w, Q[w])
              }
              return G
          },
          fp: function(j, n, Z, L, U) {
              return this.firePropertyChange(j, n, Z, L, U)
          },
          firePropertyChange: function(G, K, n, x, Y) {
              if (x) {
                  if (x(K, n))
                      return !1
              } else if (K === n)
                  return !1;
              var o = this
                , H = Y || {};
              return H.property = G,
              H.oldValue = K,
              H.newValue = n,
              H.data = o,
              o._dataModel && o._dataModel.handleDataPropertyChange(H),
              o.onPropertyChanged(H),
              !0
          },
          onPropertyChanged: function(l) {
              var K = this
                , s = K._parent
                , j = l.property;
              if (ks(s)) {
                  var z = K.s($k)
                    , Z = "s:ingroup" === j;
                  (z && ls[j] || j === Z) && s._81I(),
                  (z || Z) && s.fp("childChange", !0, !1)
              }
              Np(s) && (ls[j] || "elevation" === j || Ud[j] || "scaleTall" === j || "tall" === j) && s.updateFromChildren()
          },
          _21I: function(U) {
              var v = this;
              if (U && v._dataModel)
                  throw "Remove data from dataModel before adding";
              v._dataModel = U
          },
          removeFromDataModel: function() {
              this._dataModel ? this._dataModel.remove(this) : this.setParent(null)
          },
          clearChildrenFromDataModel: function() {
              for (var s = 0, $ = this._children.toArray(), V = $.length; V > s; s++)
                  $[s].removeFromDataModel()
          },
          getId: function() {
              return this._id
          },
          setId: function(f) {
              this._id = f
          },
          getChildren: function() {
              return this._children
          },
          size: function() {
              return this._children.size()
          },
          toChildren: function(s, e) {
              return this._children.toList(s, e)
          },
          eachChild: function(k, V) {
              this._children.each(k, V)
          },
          addChild: function(d, Z) {
              var L = this;
              d !== L && (L._children === $b && (L._children = new Mh,
              L._childMap = {}),
              Z >= 0 || (Z = L._children.size()),
              L._childMap[d._id] || L.isDescendantOf(d) || (d._parent && d._parent.removeChild(d),
              (0 > Z || Z > L._children.size()) && (Z = L._children.size()),
              L._children.add(d, Z),
              L._childMap[d._id] = d,
              d.setParent(L),
              L.onChildAdded(d, Z),
              L.fp(Ir, E, d)))
          },
          onChildAdded: function() {},
          removeChild: function(p) {
              var L = this;
              if (L._childMap && L._childMap[p._id]) {
                  var g = L._children.remove(p);
                  delete L._childMap[p._id],
                  L.fp(Ir, p, E),
                  p.setParent(E, g),
                  L.onChildRemoved(p, g)
              }
          },
          onChildRemoved: function() {},
          getChildAt: function(o) {
              return this._children.get(o)
          },
          clearChildren: function() {
              var x = this;
              if (!x._children.isEmpty())
                  for (var u = 0, B = x._children.toArray(), r = B.length; r > u; u++)
                      x.removeChild(B[u])
          },
          getParent: function() {
              return this._parent
          },
          setParent: function(u, i) {
              var H = this;
              if (!(H._73I || H._parent === u || H === u || u && u.isDescendantOf(H))) {
                  var A, Q = H._parent;
                  H._parent = u,
                  H._73I = 1,
                  Q ? (i == E && (i = Q.getChildren().indexOf(H)),
                  Q.removeChild(H)) : H._dataModel && i == E && (i = H._dataModel.getRoots().indexOf(H)),
                  u && (u.addChild(H),
                  A = u.getChildren().indexOf(H)),
                  delete H._73I,
                  H.fp("parent", Q, u, V, {
                      oldIndex: i,
                      newIndex: A
                  }),
                  H.onParentChanged(Q, u)
              }
          },
          onParentChanged: function() {},
          hasChildren: function() {
              return this._children.size() > 0
          },
          isEmpty: function() {
              return this._children.isEmpty()
          },
          isRelatedTo: function(V) {
              return V ? this.isDescendantOf(V) || V.isDescendantOf(this) : !1
          },
          isParentOf: function(c) {
              return c && this._childMap ? !!this._childMap[c._id] : !1
          },
          isDescendantOf: function(A) {
              if (!A || A.isEmpty())
                  return !1;
              for (var R = this._parent; R; ) {
                  if (A === R)
                      return !0;
                  R = R._parent
              }
              return !1
          },
          getStyle: function(m, b) {
              b === V && (b = 1);
              var d = this._styleMap ? this._styleMap[m] : V;
              return d === V && b ? U[m] : d
          },
          setStyle: function(b, $) {
              var j = this;
              j._styleMap || (j._styleMap = {});
              var z = j._styleMap[b];
              $ === V ? delete j._styleMap[b] : j._styleMap[b] = $,
              j.fp("s:" + b, z, $) && j.onStyleChanged(b, z, $)
          },
          onStyleChanged: function() {},
          iv: function(i) {
              this.invalidate(i)
          },
          invalidate: function(Q) {
              this.fp(Q || "*", !1, !0)
          },
          toString: function() {
              var A = this;
              return A._displayName || A._name || A._tag || A._id
          },
          toLabel: function() {
              return this._displayName || this._name
          },
          addStyleIcon: function(P, H) {
              var A = this
                , N = A.s(Rq);
              A.beginTransaction(),
              N || A.s(Rq, N = {}),
              H ? N[P] = H : delete N[P],
              A.fp(Rq, E, N),
              A.endTransaction()
          },
          removeStyleIcon: function(G) {
              var g = this.s(Rq);
              if (g) {
                  var n = g[G];
                  delete g[G],
                  this.fp(Rq, E, g)
              }
              return n
          },
          _calcAnchorMatrix3d: function() {},
          appendAnchorMatrix3d: function($) {
              var j = this;
              if (j.hasOwnProperty("_anchor") || j.hasOwnProperty("_anchorElevation")) {
                  var I = j.getAnchor3d()
                    , n = {
                      x: I.x - .5,
                      y: I.y - .5,
                      z: I.z - .5
                  };
                  Bg($, [-n.x, -n.y, -n.z])
              }
          },
          getSerializableProperties: function() {
              return {
                  name: 1,
                  displayName: 1,
                  icon: 1,
                  toolTip: 1,
                  parent: 1,
                  layer: 1,
                  renderLayer: 1,
                  tag: 1,
                  adjustChildrenToTop: 1,
                  dataBindings: 1
              }
          },
          getSerializableStyles: function() {
              var K, r = {};
              for (K in this._styleMap)
                  r[K] = 1;
              return r
          },
          getCurrentPrefix: function() {
              return this._interactPrefix || eg
          },
          ca: function(P, d) {
              var m = this.getCurrentPrefix();
              return P = m + P,
              2 === arguments.length ? this.a(P, d) : this.a(P)
          }
      });
      var em = n.DataModel = function() {
          var h = this;
          h._isDeserializing = 0,
          h._datas = new Mh,
          h._dataMap = {},
          h._roots = new Mh,
          h._rootMap = {},
          h._fsDataMap = {},
          h._78O = {},
          h._reflectorMap = {},
          h._36I = new ze,
          h._35I = new ze,
          h._serializeNotifier = new ze,
          h._selectionModel = new Kg(h);
          var D = h._29Q = []
            , v = h._scheduleCallback = function() {
              for (var A = Date.now(), d = 0; d < D.length; d++) {
                  var K = D[d];
                  K.enabled && A - K.lastTime > K.interval && (K.beforeAction && K.beforeAction(),
                  K.action && h.each(function(y) {
                      K.action(y)
                  }),
                  K.afterAction && K.afterAction(),
                  K.lastTime = A)
              }
              D.length && (h._30Q = W.requestAnimationFrame(v))
          }
      }
      ;
      jq("DataModel", G, {
          ms_fire: 1,
          ms_attr: 1,
          ms_ac: ["layers", "name", "autoAdjustIndex", "hierarchicalRendering", "background", "envmap", "postProcessingData", "init"],
          _name: V,
          _autoAdjustIndex: !0,
          _hierarchicalRendering: !1,
          _background: V,
          _init: V,
          _envmap: V,
          _cubicEnvmap: !1,
          _postProcessingData: V,
          sm: function() {
              return this.getSelectionModel()
          },
          mm: function(G, d, w) {
              this.addDataModelChangeListener(G, d, w)
          },
          umm: function(j, Q) {
              this.removeDataModelChangeListener(j, Q)
          },
          md: function(i, J, O) {
              this.addDataPropertyChangeListener(i, J, O)
          },
          umd: function(M, e) {
              this.removeDataPropertyChangeListener(M, e)
          },
          mh: function(q, n, G) {
              this.addHierarchyChangeListener(q, n, G)
          },
          umh: function(z, Y) {
              this.removeHierarchyChangeListener(z, Y)
          },
          getAttrObject: function() {
              return this._attrObject
          },
          setAttrObject: function(m) {
              return this._attrObject = m
          },
          getSelectionModel: function() {
              return this._selectionModel
          },
          size: function() {
              return this._datas.size()
          },
          isEmpty: function() {
              return this._datas.isEmpty()
          },
          getRoots: function() {
              return this._roots
          },
          getDatas: function() {
              return this._datas
          },
          getFullscreenDatas: function() {
              return this._fsDataMap
          },
          getReflectors: function() {
              return this._reflectorMap
          },
          getDataById: function(V) {
              return this._dataMap[V]
          },
          removeDataById: function(B) {
              this.remove(this.getDataById(B))
          },
          toDatas: function(X, L) {
              return this._datas.toList(X, L)
          },
          each: function(z, A) {
              this._datas.each(z, A)
          },
          getDataByTag: function(x) {
              return this._78O[x]
          },
          getTagMap: function() {
              return this._78O
          },
          removeDataByTag: function(V) {
              this.remove(this.getDataByTag(V))
          },
          add: function(Q, k, y) {
              var g = this
                , h = Q._id
                , a = Q._tag
                , M = g._roots;
              if (g._dataMap[h])
                  throw "'" + h + "' already exists";
              a != E && (g._78O[a] = Q),
              g._dataMap[h] = Q,
              y >= 0 ? g._datas.add(Q, y) : g._datas.add(Q),
              Q._parent || (g._rootMap[h] = Q,
              k >= 0 ? M.add(Q, k) : M.add(Q)),
              Q.s("fullscreen") !== V && (g._fsDataMap[h] = Q),
              Q.s("shape3d.reflector") && (g._reflectorMap[h] = Q),
              Q._21I(g),
              g.onAdded(Q),
              g._36I.fire({
                  kind: "add",
                  data: Q,
                  rootsIndex: k,
                  datasIndex: y
              })
          },
          onAdded: function() {},
          remove: function(k, i) {
              if (k) {
                  var R = this
                    , D = k._id
                    , u = i && i.keepStructure
                    , S = i && i.keepChildren
                    , N = k.getTag();
                  if (k._dataModel === R) {
                      this.beginTransaction(),
                      u ? R._removingData || (R._removingData = k) : R.prepareRemove(k),
                      S || k.toChildren().each(function(y) {
                          R.remove(y, i)
                      }, R),
                      u ? R._removingData === k && (k._parent && k._parent.removeChild(k),
                      delete R._removingData) : k._parent && k._parent.removeChild(k);
                      var b = R._datas.remove(k);
                      delete R._dataMap[D],
                      N != E && delete R._78O[N];
                      var c;
                      R._rootMap[D] && (delete R._rootMap[D],
                      c = R._roots.remove(k)),
                      R._fsDataMap[D] && delete R._fsDataMap[D],
                      R._reflectorMap[D] && delete R._reflectorMap[D],
                      k._21I(E),
                      R.onRemoved(k),
                      R._36I.fire({
                          kind: mc,
                          data: k,
                          rootsIndex: c,
                          datasIndex: b
                      }),
                      this.endTransaction()
                  }
              }
          },
          onRemoved: function() {},
          prepareRemove: function() {},
          clear: function() {
              var b = this;
              if (b._datas.size()) {
                  var S = b._historyManager ? this.toJSON() : V;
                  b._datas.toArray().forEach(function(m) {
                      m._21I(E)
                  }),
                  b._datas.clear(),
                  b._dataMap = {},
                  b._roots.clear(),
                  b._rootMap = {},
                  b._fsDataMap = {},
                  b._reflectorMap = {},
                  b._78O = {},
                  b._36I.fire({
                      kind: Cn,
                      json: S
                  })
              }
          },
          contains: function(G) {
              return G && G._dataModel === this
          },
          handleDataPropertyChange: function(T) {
              var g = this
                , r = T.data
                , e = T.property;
              if ("parent" === e) {
                  var j = r._id
                    , Z = g._rootMap
                    , H = g._roots;
                  r._parent ? Z[j] && (delete Z[j],
                  H.remove(r)) : Z[j] || (Z[j] = r,
                  H.add(r))
              } else if ("tag" === e) {
                  var p = T.oldValue
                    , N = T.newValue
                    , A = g._78O;
                  p != E && delete A[p],
                  N != E && (A[N] = r)
              } else if ("s:fullscreen" === e) {
                  var j = r._id
                    , s = g._fsDataMap;
                  T.oldValue != E && delete s[j],
                  T.newValue != E && (s[j] = r)
              } else if ("s:shape3d.reflector" === e) {
                  var j = r._id
                    , o = g._reflectorMap;
                  T.oldValue && delete o[j],
                  T.newValue && (o[j] = r)
              }
              this.onDataPropertyChanged(r, T),
              this._35I.fire(T)
          },
          onDataPropertyChanged: function() {},
          addDataModelChangeListener: function(L, u, _) {
              this._36I.add(L, u, _)
          },
          removeDataModelChangeListener: function(Y, M) {
              this._36I.remove(Y, M)
          },
          addSerializeListener: function(T, Q, F) {
              this._serializeNotifier.add(T, Q, F)
          },
          removeSerializeListener: function(z, $) {
              this._serializeNotifier.remove(z, $)
          },
          fireSerializeEvent: function(R) {
              this._serializeNotifier.fire(R)
          },
          addDataPropertyChangeListener: function(w, O, s) {
              this._35I.add(w, O, s)
          },
          removeDataPropertyChangeListener: function(L, b) {
              this._35I.remove(L, b)
          },
          _38I: function(q, Y, y) {
              this._37I && this._37I.fire({
                  data: q,
                  oldIndex: Y,
                  newIndex: y
              })
          },
          addHierarchyChangeListener: function(n, B, c) {
              this._37I || (this._37I = new ze),
              this._37I.add(n, B, c)
          },
          removeHierarchyChangeListener: function(x, u) {
              this._37I.remove(x, u)
          },
          getSiblings: function(K) {
              var R = K._parent;
              return R ? R._children : this._roots
          },
          eachByHierarchical: function(q, P, a) {
              if (P)
                  return this._eachByHierarchical(q, P, a);
              for (var L = 0, E = this._roots, M = E.size(); M > L; L++)
                  if (this._eachByHierarchical(q, E.get(L), a) === !1)
                      return !1;
              return !0
          },
          _eachByHierarchical: function(D, n, g) {
              if (g) {
                  if (D.call(g, n) === !1)
                      return !1
              } else if (D(n) === !1)
                  return !1;
              for (var F = n.size(), V = 0; F > V; V++)
                  if (this._eachByHierarchical(D, n.getChildAt(V), g) === !1)
                      return !1;
              return !0
          },
          reverseEachByHierarchical: function(j, n, m) {
              if (n)
                  return this._reverseEachByHierarchical(j, n, m);
              for (var A = this._roots, V = A.size(), h = V - 1; h >= 0; h--)
                  if (this._reverseEachByHierarchical(j, A.get(h), m) === !1)
                      return !1;
              return !0
          },
          _reverseEachByHierarchical: function(K, M, x) {
              for (var W = M.size(), h = W - 1; h >= 0; h--)
                  if (this._reverseEachByHierarchical(K, M.getChildAt(h), x) === !1)
                      return !1;
              if (x) {
                  if (K.call(x, M) === !1)
                      return !1
              } else if (K(M) === !1)
                  return !1;
              return !0
          },
          eachByDepthFirst: function(B, A, s) {
              if (A)
                  return this._11I(B, A, s);
              for (var R = 0, k = this._roots, T = k.size(); T > R; R++)
                  if (this._11I(B, k.get(R), s) === !1)
                      return !1;
              return !0
          },
          _11I: function(N, i, $) {
              for (var t = i.size(), w = 0; t > w; w++)
                  if (this._11I(N, i.getChildAt(w), $) === !1)
                      return !1;
              if ($) {
                  if (N.call($, i) === !1)
                      return !1
              } else if (N(i) === !1)
                  return !1;
              return !0
          },
          eachByBreadthFirst: function(v, V, C) {
              var H = new Mh;
              for (V ? H.add(V) : this._roots.each(H.add, H); H.size() > 0; )
                  if (V = H.removeAt(0),
                  V.eachChild(H.add, H),
                  C) {
                      if (v.call(C, V) === !1)
                          return !1
                  } else if (v(V) === !1)
                      return !1;
              return !0
          },
          moveTo: function(k, G) {
              var d = this.getSiblings(k)
                , Z = d.indexOf(k);
              Z === G || 0 > Z || G >= 0 && G <= d.size() && (d.remove(k),
              G > d.size() && G--,
              d.add(k, G),
              this._38I(k, Z, G))
          },
          moveUp: function(B) {
              this.moveTo(B, this.getSiblings(B).indexOf(B) - 1)
          },
          moveDown: function(_) {
              this.moveTo(_, this.getSiblings(_).indexOf(_) + 1)
          },
          moveToTop: function(b) {
              this.moveTo(b, 0)
          },
          moveToBottom: function(l) {
              this.moveTo(l, this.getSiblings(l).size())
          },
          moveSelectionUp: function(y) {
              this.beginTransaction(),
              y || (y = this.sm());
              var G = new Mh;
              fi(y, G, this._roots),
              G.each(this.moveUp, this),
              this.endTransaction()
          },
          moveSelectionDown: function(B) {
              this.beginTransaction(),
              B || (B = this.sm());
              var T = new Mh;
              ye(B, T, this._roots),
              T.each(this.moveDown, this),
              this.endTransaction()
          },
          moveSelectionToTop: function(h) {
              this.beginTransaction(),
              h || (h = this.sm());
              var g = new Mh;
              Gc(h, g, this._roots),
              g.each(this.moveToTop, this),
              this.endTransaction()
          },
          moveSelectionToBottom: function(R) {
              this.beginTransaction(),
              R || (R = this.sm());
              var s = new Mh;
              kf(R, s, this._roots),
              s.each(this.moveToBottom, this),
              this.endTransaction()
          },
          moveToIndex: function(L, s, T) {
              var Q = this.getDatas();
              null == T && (T = Q.indexOf(L)),
              T === s || 0 > T || s >= 0 && s <= Q.size() && (Q.remove(L),
              s > Q.size() && s--,
              Q.add(L, s),
              this._76I(L, T, s))
          },
          bringForward: function(X) {
              this.moveToIndex(X, this.getDatas().indexOf(X) + 1)
          },
          bringToFront: function(L) {
              this.moveToIndex(L, this.size())
          },
          sendBackward: function(g) {
              this.moveToIndex(g, this.getDatas().indexOf(g) - 1)
          },
          sendToBack: function(v) {
              this.moveToIndex(v, 0)
          },
          bringSelectionForward: function(r) {
              this.beginTransaction(),
              r || (r = this.sm());
              for (var f = new Mh, K = this.getDatas(), U = !1, v = 0; v < K.size(); v++) {
                  var d = K.get(K.size() - 1 - v);
                  r.contains(d) ? U && f.add(d) : U = !0
              }
              f.each(this.bringForward, this),
              this.endTransaction()
          },
          bringSelectionToFront: function(B) {
              this.beginTransaction(),
              B || (B = this.sm());
              for (var w = new Mh, Z = this.getDatas(), s = 0; s < Z.size(); s++) {
                  var u = Z.get(s);
                  B.contains(u) && w.add(u)
              }
              w.each(this.bringToFront, this),
              this.endTransaction()
          },
          sendSelectionBackward: function(r) {
              this.beginTransaction(),
              r || (r = this.sm());
              for (var l = new Mh, t = this.getDatas(), V = !1, k = 0; k < t.size(); k++) {
                  var J = t.get(k);
                  r.contains(J) ? V && l.add(J) : V = !0
              }
              l.each(this.sendBackward, this),
              this.endTransaction()
          },
          sendSelectionToBack: function(A) {
              this.beginTransaction(),
              A || (A = this.sm());
              for (var T = new Mh, z = this.getDatas(), s = 0; s < z.size(); s++) {
                  var Q = z.get(z.size() - 1 - s);
                  A.contains(Q) && T.add(Q)
              }
              T.each(this.sendToBack, this),
              this.endTransaction()
          },
          addScheduleTask: function(y) {
              var u = this;
              u.removeScheduleTask(y),
              y.enabled == E && (y.enabled = !0),
              y.interval == E && (y.interval = 10),
              y.lastTime = Date.now(),
              u._29Q.push(y),
              u._30Q == E && (u._30Q = W.requestAnimationFrame(u._scheduleCallback))
          },
          removeScheduleTask: function(i) {
              var s = this
                , n = s._29Q
                , u = n.indexOf(i);
              u >= 0 && n.splice(u, 1),
              n.length || s._30Q == E || (W.cancelAnimationFrame(s._30Q),
              delete s._30Q)
          },
          getHistoryManager: function() {
              return this._historyManager
          },
          enableHistoryManager: function(h) {
              this._historyManager || new n.HistoryManager(this),
              null != h && this._historyManager.setMaxHistoryCount(h),
              this._historyManager.setDisabled(!1)
          },
          disableHistoryManager: function() {
              this._historyManager && this._historyManager.setDisabled(!0)
          },
          clearHistoryManager: function() {
              this._historyManager && this._historyManager.clear()
          },
          undo: function(x) {
              this._historyManager && this._historyManager.undo(x)
          },
          redo: function(e) {
              this._historyManager && this._historyManager.redo(e)
          },
          beginTransaction: function() {
              this._historyManager && this._historyManager.beginTransaction()
          },
          endTransaction: function() {
              this._historyManager && this._historyManager.endTransaction()
          },
          addHistory: function(b) {
              this._historyManager && this._historyManager.addHistory(b)
          },
          onHistoryManagerChanged: function() {},
          isDeserializing: function() {
              return this._isDeserializing > 0
          },
          setDeserializing: function(U) {
              U ? this._isDeserializing++ : this._isDeserializing--
          },
          isCubicEnvmap: function() {
              return this._cubicEnvmap
          },
          setCubicEnvmap: function(b) {
              var E = this._cubicEnvmap;
              this._cubicEnvmap = b,
              this.fp("cubicEnvmap", E, b)
          }
      });
      var Kg = n.SelectionModel = function(K) {
          var T = this;
          T._68O = wr,
          T._map = {},
          T._73O = new Mh,
          T._74I = new ze,
          T._21I(K)
      }
      ;
      jq("SelectionModel", G, {
          ms_fire: 1,
          ms_dm: 1,
          ms: function(g, V, N) {
              this.addSelectionChangeListener(g, V, N)
          },
          ums: function(n, p) {
              this.removeSelectionChangeListener(n, p)
          },
          fd: function() {
              return this.getFirstData()
          },
          ld: function() {
              return this.getLastData()
          },
          sg: function() {
              return this._68O === nh
          },
          co: function(I) {
              return this._map[I._id] != E
          },
          ss: function(I) {
              this.setSelection(I)
          },
          as: function(S) {
              this.appendSelection(S)
          },
          rs: function(X) {
              this.removeSelection(X)
          },
          cs: function() {
              this.clearSelection()
          },
          sa: function() {
              this.selectAll()
          },
          getSelectionMode: function() {
              return this._68O
          },
          setSelectionMode: function(Q) {
              var F = this;
              if (F._68O !== Q && (Q === pk || Q === nh || Q === wr)) {
                  F.cs();
                  var z = F._68O;
                  F._68O = Q,
                  F.fp("selectionMode", z, Q)
              }
          },
          _21I: function(V) {
              var P = this
                , L = P._dataModel;
              L !== V && (L && (P.cs(),
              L.umm(P.handleDataModelChange, P)),
              P._dataModel = V,
              V.mm(P.handleDataModelChange, P, !0),
              P.fp(jh, L, V))
          },
          dispose: function() {
              var A = this;
              A.cs(),
              A._dataModel.umm(A.handleDataModelChange, A)
          },
          handleDataModelChange: function(b) {
              var G = this;
              if (b.kind === mc) {
                  var H = b.data;
                  G.co(H) && (G._73O.remove(H),
                  delete G._map[H._id],
                  G._75I(mc, new Mh(H)))
              } else
                  b.kind === Cn && G.cs()
          },
          getFilterFunc: function() {
              return this._filterFunc
          },
          setFilterFunc: function(_) {
              var V = this;
              if (V._filterFunc !== _) {
                  V.cs();
                  var j = V._filterFunc;
                  V._filterFunc = _,
                  V.fp("filterFunc", j, V._filterFunc)
              }
          },
          _75I: function(Y, l, I, $) {
              I && (this._73O.each(function(U) {
                  $[U._id] ? I.remove(U) : I.add(U)
              }),
              l = I.toList()),
              this._74I.fire({
                  kind: Y,
                  datas: new Mh(l)
              })
          },
          addSelectionChangeListener: function(S, l, v) {
              this._74I.add(S, l, v)
          },
          removeSelectionChangeListener: function(N, E) {
              this._74I.remove(N, E)
          },
          _97O: function(F, J) {
              for (var s, H = this, e = 0, S = new Mh(F); e < S.size(); e++)
                  s = S.get(e),
                  (H._filterFunc && !H._filterFunc(s) || J && H.co(s) || !J && !H.co(s) || !H._dataModel.contains(s)) && (S.removeAt(e),
                  e--);
              return S
          },
          appendSelection: function(v) {
              var y = this;
              if (y._68O !== pk) {
                  var j, $, q = y._73O, t = y._97O(v, !0);
                  t.isEmpty() || (y.sg() && (j = new Mh(q),
                  $ = y._map,
                  q.clear(),
                  y._map = {},
                  t = new Mh(t.get(t.size() - 1))),
                  t.each(function(W) {
                      q.add(W),
                      y._map[W._id] = W
                  }),
                  y._75I("append", t, j, $))
              }
          },
          removeSelection: function(k) {
              var V = this
                , q = V._97O(k)
                , C = 0
                , K = q.size();
              if (0 !== K) {
                  for (; K > C; C++) {
                      var E = q.get(C);
                      V._73O.remove(E),
                      delete V._map[E._id]
                  }
                  V._75I(mc, q)
              }
          },
          toSelection: function(k, q) {
              return this._73O.toList(k, q)
          },
          getSelection: function() {
              return this._73O
          },
          each: function(j, i) {
              this._73O.each(j, i)
          },
          setSelection: function(I) {
              var b = this
                , p = b._73O;
              if (b._68O !== pk && !(p.isEmpty() && !I || 1 === p.size() && b.ld() === I)) {
                  var i = new Mh(p)
                    , m = b._map;
                  p.clear(),
                  b._map = {};
                  var _ = b._97O(I, !0);
                  b.sg() && _.size() > 1 && (_ = new Mh(_.get(_.size() - 1))),
                  _.each(function(A) {
                      p.add(A),
                      b._map[A._id] = A
                  }),
                  b._75I("set", E, i, m)
              }
          },
          clearSelection: function() {
              var K = this
                , Z = K._73O;
              if (Z.size() > 0) {
                  var t = Z.toList();
                  Z.clear(),
                  K._map = {},
                  K._75I(Cn, t)
              }
          },
          selectAll: function() {
              var B = this;
              if (B._68O !== pk) {
                  var i, Q, U = B._dataModel.toDatas();
                  if (B._filterFunc)
                      for (i = 0; i < U.size(); i++)
                          Q = U.get(i),
                          B._filterFunc(Q) || (U.removeAt(i),
                          i--);
                  var A = B._73O
                    , r = new Mh(A)
                    , T = B._map;
                  A.clear(),
                  B._map = {},
                  B.sg() && U.size() > 1 && (U = new Mh(U.get(U.size() - 1)));
                  var f = U.size();
                  for (i = 0; f > i; i++)
                      Q = U.get(i),
                      A.add(Q),
                      B._map[Q._id] = Q;
                  B._75I("all", E, r, T)
              }
          },
          size: function() {
              return this._73O.size()
          },
          isEmpty: function() {
              return this._73O.isEmpty()
          },
          contains: function(h) {
              return this._map[h._id] != E
          },
          getLastData: function() {
              var Q = this._73O;
              return Q.size() > 0 ? Q.get(Q.size() - 1) : E
          },
          getFirstData: function() {
              var X = this._73O;
              return X.size() > 0 ? X.get(0) : E
          },
          isSelectable: function(U) {
              var H = this;
              return U && H._68O !== pk ? H._filterFunc ? H._filterFunc(U) : !0 : !1
          },
          getTopSelection: function() {
              var S = this
                , Q = new Mh;
              return S._73O.each(function(Y) {
                  for (var u = Y.getParent(); u; ) {
                      if (S.contains(u)) {
                          Y = E;
                          break
                      }
                      u = u.parent
                  }
                  Y && Q.add(Y)
              }),
              Q
          }
      });
      var wo = function() {
          return jm(0),
          function(y, d) {
              var v;
              if (dn(d)) {
                  var Y = y.getDataUI(d);
                  Y && Y._88I && (v = Y._88I.rect)
              }
              return v ? v : d.getRect()
          }
      }();
      rc(M, {
          edgeGroupAgentFunc: E,
          graphViewAutoScrollZone: 16,
          graphViewZoomable: !0,
          graphViewResettable: !1,
          graphViewPannable: !0,
          graphViewRectSelectable: !0,
          graphViewScrollBarVisible: !0,
          graphViewRectSelectBorderColor: l.rectSelectBorder,
          graphViewRectSelectBackground: jd,
          graphViewEditPointSize: Ul ? 17 : 7,
          graphViewEditPointBorderColor: l.editPointBorder,
          graphViewEditPointBackground: l.editPointBackground,
          setEdgeType: function(F, M, T) {
              er[F] = M,
              hn[F] = T
          },
          getEdgeType: function(x) {
              return er[x]
          },
          getEdgeTypeMap: function() {
              return er
          },
          getNodeRect: wo
      }, !0);
      var Pq = {
          "layout.h": V,
          "layout.v": V,
          "2d.selectable": !0,
          "2d.visible": !0,
          "2d.movable": !0,
          "2d.editable": !0,
          "2d.move.mode": V,
          "2d.attachable": !1,
          "2d.hostable": !1,
          interactive: !1,
          preventDefaultWhenInteractive: !0,
          "image.stretch": "fill",
          icons: V,
          ingroup: !0,
          "body.color": V,
          "2d.gray": !1,
          fullscreen: V,
          "fullscreen.gap": 2,
          "fullscreen.lock": !1,
          opacity: V,
          pixelPerfect: !0,
          keepAspectRatio: !1,
          "attach.points": null,
          "attach.style": null,
          "attach.close.threshold": 16,
          "clip.direction": "top",
          "clip.percentage": 1,
          "select.color": $p,
          "select.width": 1,
          "select.padding": 2,
          "select.type": gp,
          shadow: !1,
          "shadow.blur": 6,
          "shadow.offset.x": 3,
          "shadow.offset.y": 3,
          shadow2: !1,
          "shadow2.color": $p,
          "shadow2.blur": 6,
          "shadow2.offset.x": 3,
          "shadow2.offset.y": 3,
          "border.color": V,
          "border.width": 2,
          "border.padding": 2,
          "border.type": gp,
          label: V,
          "label.font": V,
          "label.color": Yg,
          "label.background": V,
          "label.position": 31,
          "label.position.fixed": !1,
          "label.offset.x": 0,
          "label.offset.y": 2,
          "label.rotation": V,
          "label.max": V,
          "label.opacity": V,
          "label.scale": 1,
          "label.align": V,
          "label.selectable": !0,
          label2: V,
          "label2.font": V,
          "label2.color": Yg,
          "label2.background": V,
          "label2.position": 34,
          "label2.position.fixed": !1,
          "label2.offset.x": 0,
          "label2.offset.y": -2,
          "label2.rotation": V,
          "label2.max": V,
          "label2.opacity": V,
          "label2.scale": 1,
          "label2.align": V,
          "label2.selectable": !0,
          note: V,
          "note.expanded": !0,
          "note.font": V,
          "note.color": eo,
          "note.background": $p,
          "note.position": 8,
          "note.offset.x": -3,
          "note.offset.y": 3,
          "note.max": V,
          "note.toggleable": !0,
          "note.border.width": 1,
          "note.border.color": V,
          "note.opacity": V,
          "note.scale": 1,
          "note.align": V,
          note2: V,
          "note2.expanded": !0,
          "note2.font": V,
          "note2.color": eo,
          "note2.background": $p,
          "note2.position": 3,
          "note2.offset.x": 3,
          "note2.offset.y": -3,
          "note2.max": V,
          "note2.toggleable": !0,
          "note2.border.width": 1,
          "note2.border.color": V,
          "note2.opacity": V,
          "note2.scale": 1,
          "note2.align": V,
          "group.type": V,
          "group.image": V,
          "group.image.stretch": "fill",
          "group.repeat.image": V,
          "group.border.repeat.image": V,
          "group.padding": 8,
          "group.padding.left": 0,
          "group.padding.right": 0,
          "group.padding.top": 0,
          "group.padding.bottom": 0,
          "group.position": 17,
          "group.toggleable": !0,
          "group.title.font": V,
          "group.title.color": eo,
          "group.title.background": l.groupTitleBackground,
          "group.title.align": Mb,
          "group.title.orientation": Dj,
          "group.background": l.groupBackground,
          "group.depth": 1,
          "group.border.width": 1,
          "group.border.pattern": V,
          "group.border.color": Jp,
          "group.border.radius": V,
          "group.border.cap": Mq,
          "group.border.join": Nn,
          "group.border.width.absolute": !1,
          "group.splitLine": !1,
          "group.gradient": E,
          "group.gradient.color": "#FFF",
          shape: V,
          "shape.background": Jp,
          "shape.repeat.image": V,
          "shape.border.repeat.image": V,
          "shape.border.width": 0,
          "shape.border.width.absolute": !1,
          "shape.border.color": Jp,
          "shape.border.3d": !1,
          "shape.border.3d.color": V,
          "shape.border.3d.accuracy": V,
          "shape.border.cap": Mq,
          "shape.border.join": Nn,
          "shape.border.pattern": V,
          "shape.gradient": E,
          "shape.gradient.color": "#FFF",
          "shape.depth": 0,
          "shape.dash": !1,
          "shape.dash.pattern": oi,
          "shape.dash.offset": 0,
          "shape.dash.color": wj,
          "shape.dash.width": V,
          "shape.dash.3d": !1,
          "shape.dash.3d.color": V,
          "shape.dash.3d.accuracy": V,
          "shape.polygon.side": 6,
          "shape.arc.from": s,
          "shape.arc.to": y,
          "shape.arc.close": !0,
          "shape.arc.oval": !1,
          "shape.corner.radius": V,
          "shape.gradient.pack": V,
          "shape.fill.rule": "nonzero",
          "shape.fill.clip.direction": "top",
          "shape.fill.clip.percentage": 1,
          "shape.foreground": V,
          "shape.foreground.gradient": E,
          "shape.foreground.gradient.color": "#FFF",
          "shape.foreground.clip.direction": "top",
          "shape.foreground.clip.percentage": 1,
          "autolayout.gap": V,
          "autolayout.hgap": V,
          "autolayout.vgap": V,
          "edge.type": V,
          "edge.points": V,
          "edge.segments": V,
          "edge.color": Jp,
          "edge.width": 2,
          "edge.width.absolute": !1,
          "edge.repeat.image": null,
          "edge.offset": 0,
          "edge.group": 0,
          "edge.expanded": !0,
          "edge.gap": 12,
          "edge.toggleable": !0,
          "edge.center": !1,
          "edge.3d": !1,
          "edge.3d.color": V,
          "edge.3d.accuracy": V,
          "edge.cap": Mq,
          "edge.join": Nn,
          "edge.source.position": 17,
          "edge.source.anchor.x": V,
          "edge.source.anchor.y": V,
          "edge.source.offset.x": 0,
          "edge.source.offset.y": 0,
          "edge.source.index": -1,
          "edge.source.percent": 0,
          "edge.target.position": 17,
          "edge.target.anchor.x": V,
          "edge.target.anchor.y": V,
          "edge.target.offset.x": 0,
          "edge.target.offset.y": 0,
          "edge.target.index": -1,
          "edge.target.percent": 0,
          "edge.pattern": V,
          "edge.dash": !1,
          "edge.dash.pattern": oi,
          "edge.dash.offset": 0,
          "edge.dash.color": wj,
          "edge.dash.width": V,
          "edge.dash.3d": !1,
          "edge.dash.3d.color": V,
          "edge.dash.3d.accuracy": V,
          "edge.independent": !1,
          "attach.row.index": 0,
          "attach.column.index": 0,
          "attach.row.span": 1,
          "attach.column.span": 1,
          "attach.padding": 0,
          "attach.padding.left": 0,
          "attach.padding.right": 0,
          "attach.padding.top": 0,
          "attach.padding.bottom": 0,
          "attach.index": -1,
          "attach.offset": 0,
          "attach.offset.relative": !1,
          "attach.offset.opposite": !1,
          "attach.thickness": V,
          "attach.gap": 0,
          "attach.gap.relative": !1,
          "grid.row.count": 1,
          "grid.column.count": 1,
          "grid.row.percents": V,
          "grid.column.percents": V,
          "grid.border": 1,
          "grid.border.left": 0,
          "grid.border.right": 0,
          "grid.border.top": 0,
          "grid.border.bottom": 0,
          "grid.gap": 1,
          "grid.background": l.gridBackground,
          "grid.depth": 1,
          "grid.cell.depth": -1,
          "grid.cell.border.color": l.gridCellBorderColor,
          "grid.block": V,
          "grid.block.padding": 3,
          "grid.block.width": 1,
          "grid.block.color": l.gridBlockColor,
          text: "",
          "text.align": "left",
          "text.vAlign": "middle",
          "text.color": Yg,
          "text.font": Id,
          "text.shadow": !1,
          "text.shadow.color": $p,
          "text.shadow.blur": 6,
          "text.shadow.offset.x": 3,
          "text.shadow.offset.y": 3,
          "text.scale.x": 1,
          "text.scale.y": 1,
          keepPosition: !0
      };
      Pq[Vm] = V,
      rc(U, Pq, !0),
      rc(em, {
          _76I: function(w, p, M) {
              this._39I && this._39I.fire({
                  data: w,
                  oldIndex: p,
                  newIndex: M
              })
          },
          addIndexChangeListener: function(p, z, H) {
              var f = this;
              f._39I || (f._39I = new ze),
              f._39I.add(p, z, H)
          },
          removeIndexChangeListener: function(u, m) {
              this._39I.remove(u, m)
          },
          prepareRemove: function(h) {
              ji(h) && (h.setSource(E),
              h.setTarget(E)),
              h._70O && h._70O.toList().each(this.remove, this),
              h._69O && h._69O.toList().each(function(e) {
                  e.setHost(E)
              }),
              h._host && h.setHost(E)
          },
          onAdded: function(J) {
              this.isAutoAdjustIndex() && this.adjustIndex(J)
          },
          onDataPropertyChanged: function(e, t) {
              Tj[t.property] && this.isAutoAdjustIndex() && this.adjustIndex(e)
          },
          isAdjustable: function(P) {
              return ud(P) || ji(P)
          },
          isAdjustedToBottom: function(u) {
              return ks(u) ? u.isExpanded() && jb(u) : !1
          },
          adjustIndex: function(q) {
              var c = this;
              this.isHierarchicalRendering() || (c.isAdjustedToBottom(q) ? (c.sendToBottom(q),
              q.eachChild(c.adjustIndex, c)) : c.sendToTop(q))
          },
          sendToTop: function(L) {
              var U = this;
              if (U.contains(L) && U.isAdjustable(L)) {
                  var z = U._datas;
                  if (L !== z.get(U.size() - 1)) {
                      var J = z.indexOf(L);
                      z.removeAt(J),
                      z.add(L),
                      U._76I(L, J, U.size() - 1)
                  }
                  if (ji(L)) {
                      var O = L._40I;
                      O && !U.isAdjustedToBottom(O) && U.sendToTop(O),
                      O = L._41I,
                      O && !U.isAdjustedToBottom(O) && U.sendToTop(O)
                  }
                  L._69O && L._69O.each(function(g) {
                      g.isRelatedTo(L) || ud(L) && g.isLoopedHostOn(L) || U.sendToTop(g)
                  }),
                  L.ISubGraph || (!ks(L) || L.isExpanded()) && L._adjustChildrenToTop && L.eachChild(function(A) {
                      ji(A) || U.sendToTop(A)
                  })
              }
          },
          sendToBottom: function(T, t) {
              var X = this;
              if (T !== t && X.contains(T) && X.isAdjustable(T) && (!t || X.contains(t))) {
                  var W = X._datas
                    , w = W.remove(T)
                    , G = t ? X._datas.indexOf(t) : 0;
                  if (W.add(T, G),
                  w !== G) {
                      X._76I(T, w, G);
                      var b = T._parent;
                      !b || b.ISubGraph || ji(b) || X.sendToBottom(T._parent, T)
                  }
              }
          }
      }),
      rc(tb, {
          ms_edit: function(q) {
              q._46O = function(S) {
                  var w = this
                    , T = w.gv.dm()
                    , V = w._index
                    , c = w._89I
                    , U = w._node
                    , P = w._shape
                    , W = w._edge
                    , F = w._77I;
                  U && c ? (this.fi({
                      kind: "endEditRect",
                      event: S,
                      data: U,
                      direction: c
                  }),
                  T.endTransaction()) : P && V >= 0 ? (w.fi({
                      kind: "endEditPoint",
                      event: S,
                      data: P,
                      index: V
                  }),
                  T.endTransaction()) : W && V >= 0 ? (w.fi({
                      kind: "endEditPoint",
                      event: S,
                      data: W,
                      index: V
                  }),
                  T.endTransaction()) : F && (w.fi({
                      kind: "endEditRotation",
                      event: S,
                      data: F
                  }),
                  T.endTransaction())
              }
              ,
              q._78I = function(b) {
                  var J = this;
                  J.autoScroll(b);
                  var V = J.gv.lp(b)
                    , d = J._index
                    , e = J._89I
                    , D = J._node
                    , c = J._shape
                    , X = J._edge
                    , N = J._77I;
                  if (D && e)
                      J._80O(V),
                      J.fi({
                          kind: "betweenEditRect",
                          event: b,
                          data: D,
                          direction: e
                      });
                  else if (c && d >= 0)
                      V.e = c.getPoints().get(d).e,
                      c.setPoint(d, V),
                      J.fi({
                          kind: "betweenEditPoint",
                          event: b,
                          data: c,
                          index: d
                      });
                  else if (X && d >= 0) {
                      var U = X.s(ri);
                      V.e = U.get(d).e,
                      U.set(d, V),
                      X.fp(ri, E, U),
                      J.fi({
                          kind: "betweenEditPoint",
                          event: b,
                          data: X,
                          index: d
                      })
                  } else if (N) {
                      var T = N.p()
                        , j = N.getScale()
                        , t = A + a(V.y - T.y, V.x - T.x);
                      j.y < 0 && (t += s),
                      u(t) < .04 && (t = 0),
                      N.setRotation(t),
                      J.fi({
                          kind: "betweenEditRotation",
                          event: b,
                          data: N
                      })
                  }
              }
              ,
              q._80O = function(W) {
                  var R = this
                    , P = R._node
                    , t = R._rect
                    , d = t.x
                    , D = t.y
                    , V = t.width
                    , u = t.height
                    , N = R._89I
                    , U = R._anchor
                    , m = R._matrix
                    , W = m.tfi(W);
                  "northwest" === N ? t = kr(W, {
                      x: d + V,
                      y: D + u
                  }) : N === me ? t = kr({
                      x: d,
                      y: W.y
                  }, {
                      x: d + V,
                      y: D + u
                  }) : "northeast" === N ? t = kr({
                      x: d,
                      y: W.y
                  }, {
                      x: W.x,
                      y: D + u
                  }) : N === pn ? t = kr({
                      x: W.x,
                      y: D
                  }, {
                      x: d + V,
                      y: D + u
                  }) : N === Tm ? t = kr({
                      x: d,
                      y: D
                  }, {
                      x: W.x,
                      y: D + u
                  }) : "southwest" === N ? t = kr({
                      x: W.x,
                      y: D
                  }, {
                      x: d + V,
                      y: W.y
                  }) : "south" === N ? t = kr({
                      x: d,
                      y: D
                  }, {
                      x: d + V,
                      y: W.y
                  }) : "southeast" === N && (t = kr({
                      x: d,
                      y: D
                  }, W)),
                  P.setPosition(m.tf(t.x + t.width * U.x, t.y + t.height * U.y)),
                  P.setWidth(t.width),
                  P.setHeight(t.height)
              }
              ,
              q._80I = function(T, q, C, U) {
                  var I = this
                    , t = I.gv._zoom
                    , h = (I.gv.getEditPointSize() + 2) / t;
                  return tp({
                      x: q - h / 2,
                      y: C - h / 2,
                      width: h,
                      height: h
                  }, T) ? (I._89I !== U && (I._89I = U),
                  !0) : !1
              }
              ,
              q._79I = function(g, N, R) {
                  var S = this
                    , x = S.gv
                    , H = N ? x.getDataUI(N) : E
                    , q = H ? H._55O : E;
                  if (q) {
                      var h, r, j, e, u = x._zoom, t = (x.getEditPointSize() + 2) / u, K = x.lp(g);
                      if (ud(N)) {
                          if (q._56O && ud(N) && (r = q._98o,
                          tp({
                              x: r.x - t / 2,
                              y: r.y - t / 2,
                              width: t,
                              height: t
                          }, K)))
                              return S._77I = N,
                              R && S.fi({
                                  kind: "beginEditRotation",
                                  event: g,
                                  data: N
                              }),
                              S.setCursor("crosshair"),
                              !0;
                          if (q._43O && N instanceof Io)
                              for (j = N.getPoints(),
                              h = j.size() - 1; h >= 0; h--)
                                  if (r = j.get(h),
                                  tp({
                                      x: r.x - t / 2,
                                      y: r.y - t / 2,
                                      width: t,
                                      height: t
                                  }, K))
                                      return S._index = h,
                                      S._shape = N,
                                      R && S.fi({
                                          kind: "beginEditPoint",
                                          event: g,
                                          data: N,
                                          index: h
                                      }),
                                      S.setCursor("crosshair"),
                                      !0;
                          if (q._42O)
                              for (var p = N.getEditControlPoints(), d = ["northwest", -1, -1, pn, -1, 0, "southwest", -1, 1, "south", 0, 1, "southeast", 1, 1, Tm, 1, 0, "northeast", 1, -1, me, 0, -1], h = 0, e = p.length; e > h; h++) {
                                  var c = d[3 * h]
                                    , I = p[h];
                                  if (S._80I(K, I.x, I.y, c)) {
                                      S._node = N;
                                      var k = N.getWidth()
                                        , s = N.getHeight()
                                        , M = N.getAnchor();
                                      S._rect = {
                                          x: -k * M.x,
                                          y: -s * M.y,
                                          width: k,
                                          height: s
                                      },
                                      S._anchor = M,
                                      S._matrix = N.getMatrix();
                                      var O = N.getRotation()
                                        , W = P(O)
                                        , _ = o(O)
                                        , z = d[3 * h + 1] * Mf(N.getScale().x)
                                        , B = d[3 * h + 2] * Mf(N.getScale().y)
                                        , n = Math.atan2(-_ * z - W * B, W * z - _ * B)
                                        , y = (Math.round(n / (Math.PI / 4)) + 8) % 8
                                        , D = [So, "nesw-resize", Jk, "nwse-resize", So, "nesw-resize", Jk, "nwse-resize"][y];
                                      return S.setCursor(D),
                                      R && S.fi({
                                          kind: "beginEditRect",
                                          event: g,
                                          data: N,
                                          direction: S._89I
                                      }),
                                      !0
                                  }
                              }
                      }
                      if (q._43O && ji(N) && N.s(vj) === $h && (j = N.s(ri)))
                          for (h = j.size() - 1; h >= 0; h--)
                              if (r = j.get(h),
                              tp({
                                  x: r.x - t / 2,
                                  y: r.y - t / 2,
                                  width: t,
                                  height: t
                              }, K))
                                  return S._index = h,
                                  S._edge = N,
                                  R && S.fi({
                                      kind: "beginEditPoint",
                                      event: g,
                                      data: N,
                                      index: h
                                  }),
                                  S.setCursor("crosshair"),
                                  !0
                  }
                  return !1
              }
          },
          ms_gv: function(A) {
              A._currentSubGraph = E,
              A._initView = function() {
                  this._fpsInfo = {
                      time: 0,
                      fps: 0,
                      frames: 0
                  }
              }
              ,
              A.upSubGraph = function() {
                  this.setCurrentSubGraph(mm(this._currentSubGraph))
              }
              ,
              A.isVisible = function(K) {
                  var x = this;
                  if (mm(K) !== x._currentSubGraph)
                      return !1;
                  if (ji(K)) {
                      var N = K._40I
                        , Y = K._41I;
                      if (!N || !Y)
                          return !1;
                      if (!(K.s("edge.independent") || x.isVisible(N) && x.isVisible(Y)))
                          return !1;
                      if (K.isEdgeGroupHidden())
                          return !1
                  } else
                      for (var u = K._parent; u && !u.ISubGraph; ) {
                          if (ks(u) && (!u.isExpanded() || !x.isVisible(u)))
                              return !1;
                          u = u._parent
                      }
                  if (K._parent instanceof ch && !x.isVisible(K._parent))
                      return !1;
                  if (K._refGraph instanceof Oq && !x.isVisible(K._refGraph))
                      return !1;
                  if (x instanceof bp) {
                      if (!K.s("3d.visible"))
                          return !1
                  } else {
                      var E = x.getLayersInfo();
                      if (E) {
                          var y = E[K._layer];
                          if (y && y.visible === !1)
                              return !1
                      }
                      if (!K.s("2d.visible"))
                          return !1
                  }
                  return x._visibleFunc ? x._visibleFunc(K) : !0
              }
              ,
              A.handleSelectionChange = function(S) {
                  var L = this;
                  S.datas.each(function(Y) {
                      L.invalidateData(Y);
                      var e = Y._parent;
                      ks(e) && ud(Y) && Y.s($k) && (L.invalidateData(e),
                      e._49I && e._49I.each(function(k) {
                          L.invalidateData(k)
                      }))
                  }),
                  L.onSelectionChanged(S)
              }
              ,
              A.onSelectionChanged = function(n) {
                  var M = this
                    , U = M.sm();
                  if (1 === U.size() && ("set" === n.kind || "append" === n.kind)) {
                      var j = U.ld();
                      M.isAutoMakeVisible() && M.makeVisible(j),
                      M.adjustIndex && M._dataModel.isAutoAdjustIndex() && M.adjustIndex(j)
                  }
              }
              ,
              A.makeVisible = function(u) {
                  if (u) {
                      var K = this
                        , B = K.getDataUI ? K.getDataUI(u) : K.getData3dUI(u);
                      if (B) {
                          var I = u
                            , N = mm(u);
                          for (N !== K._currentSubGraph && K.setCurrentSubGraph(N); (I = I._parent) && I !== N; )
                              ks(I) && I.setExpanded(!0);
                          K._23I = u,
                          K.iv()
                      }
                  }
              }
              ,
              A.getLabel = function(m) {
                  var Q = m.getStyle(_r);
                  return Q === V ? m.getName() : Q
              }
              ,
              A.getLabelBackground = function(S) {
                  return S.getStyle("label.background")
              }
              ,
              A.getLabelColor = function(C) {
                  return C.getStyle("label.color")
              }
              ,
              A.getLabel2 = function(b) {
                  return b.getStyle("label2")
              }
              ,
              A.getLabel2Background = function(F) {
                  return F.getStyle("label2.background")
              }
              ,
              A.getLabel2Color = function(Q) {
                  return Q.getStyle("label2.color")
              }
              ,
              A.getNote = function(F) {
                  return F.getStyle(Up)
              }
              ,
              A.getNoteBackground = function(l) {
                  return l.getStyle("note.background")
              }
              ,
              A.getNote2 = function(c) {
                  return c.getStyle(lj)
              }
              ,
              A.getNote2Background = function(K) {
                  return K.getStyle("note2.background")
              }
              ,
              A.handleClick = function(D, _, R) {
                  var X = this;
                  _ ? (X.fi({
                      kind: "clickData",
                      event: D,
                      data: _,
                      part: R
                  }),
                  X.onDataClicked(_, D)) : (X.fi({
                      kind: "clickBackground",
                      event: D
                  }),
                  X.onBackgroundClicked(D))
              }
              ,
              A.handleDoubleClick = function(l, x, k) {
                  var I = this;
                  ni(l) && (x ? (I.fi({
                      kind: "doubleClickData",
                      event: l,
                      data: x,
                      part: k
                  }),
                  I.onDataDoubleClicked(x, l, k),
                  I.checkDoubleClickOnNote(l, x, k) || I.checkDoubleClickOnRotation && I.checkDoubleClickOnRotation(l, x, k) || (ji(x) ? I.onEdgeDoubleClicked(x, l, k) : x.ISubGraph ? I.onSubGraphDoubleClicked(x, l, k) : ks(x) ? I.onGroupDoubleClicked(x, l, k) : x.IDoorWindow ? I.onDoorWindowDoubleClicked(x, l, k) : x.ICSGBox && I.onCSGBoxDoubleClicked(x, l, k))) : (I.fi({
                      kind: "doubleClickBackground",
                      event: l
                  }),
                  I.onBackgroundDoubleClicked(l)))
              }
              ,
              A.onSubGraphDoubleClicked = function(s) {
                  this.setCurrentSubGraph(s)
              }
              ,
              A.onEdgeDoubleClicked = function(u, n) {
                  this.isEditable(u) || (u.ISubGraph && !Tr(n) ? this.setCurrentSubGraph(u) : u.s("edge.toggleable") && u.toggle())
              }
              ,
              A._39Q = function(r) {
                  return this.isInteractive(r) ? this.preventDefaultWhenInteractive(r) : !1
              }
              ,
              A.preventDefaultWhenInteractive = function(w) {
                  return w.s("preventDefaultWhenInteractive")
              }
              ,
              A.onGroupDoubleClicked = function(c) {
                  c.s("group.toggleable") && c.toggle()
              }
              ,
              A.onDoorWindowDoubleClicked = function(X) {
                  X.s("dw.toggleable") && X.toggle(!0)
              }
              ,
              A.onCSGBoxDoubleClicked = function(b, v) {
                  var t = this;
                  if (t instanceof bp) {
                      var N = t.intersectObject(v, b);
                      N && b.s(N.part + ".toggleable") && b.toggleFace(N.part, !0)
                  }
              }
              ,
              A.onBackgroundClicked = function() {}
              ,
              A.onBackgroundDoubleClicked = function() {
                  this.upSubGraph()
              }
              ,
              A.onDataClicked = function() {}
              ,
              A.onDataDoubleClicked = function() {}
              ,
              A.onAutoLayoutEnded = function() {}
              ,
              A.onMoveEnded = function() {}
              ,
              A.onPanEnded = function() {}
              ,
              A.onPinchEnded = function() {}
              ,
              A.onRectSelectEnded = function() {}
              ,
              A.onZoomEnded = function() {}
              ,
              A.serialize = function(G) {
                  return this.dm().serialize(G)
              }
              ,
              A.toJSON = function() {
                  return this.dm().toJSON()
              }
              ,
              A.deserialize = function($, f) {
                  var C = this;
                  f = f instanceof _i ? {
                      rootParent: f
                  } : mf(f) ? {
                      setId: f
                  } : Oi(f) ? {
                      finishFunc: f
                  } : f || {},
                  f.view = C;
                  var G = C.dm();
                  return f.__innerHandler__ = function(x) {
                      if (mf(G.a("toolTipEnable")) && (G.a("toolTipEnable") ? C.enableToolTip() : C.disableToolTip()),
                      C instanceof n.graph.GraphView && (mf(G.a("zoomable")) && C.setZoomable && C.setZoomable(G.a("zoomable")),
                      mf(G.a("pannable")) && C.setPannable && C.setPannable(G.a("pannable")),
                      mf(G.a("rectSelectable")) && C.setRectSelectable && C.setRectSelectable(G.a("rectSelectable")),
                      G.a("fitContent") === !0 && C.fitContent && C.fitContent(!0, 0)),
                      C instanceof n.graph3d.Graph3dView) {
                          var o = x.scene;
                          o && o.shadow != E && C.shadowMap.setShadow(o.shadow, o.shadowParams);
                          var g = G.a("sceneContext");
                          g ? (g.eye && C.setEye(g.eye),
                          g.center && C.setCenter(g.center),
                          te(g.far) && C.setFar(g.far),
                          te(g.near) && C.setNear(g.near)) : (te(G.a("sceneNear")) && C.setNear(G.a("sceneNear")),
                          te(G.a("sceneFar")) && C.setFar(G.a("sceneFar")),
                          o && (o.eye && C.setEye(o.eye),
                          o.center && C.setCenter(o.center))),
                          mf(G.a("sceneShadowEnabled")) && (G.a("sceneShadowEnabled") ? C.enableShadow() : C.disableShadow()),
                          G.a("sceneShadowDegreeX") && C.setShadowDegreeX(G.a("sceneShadowDegreeX")),
                          G.a("sceneShadowDegreeZ") && C.setShadowDegreeZ(G.a("sceneShadowDegreeZ")),
                          G.a("sceneShadowIntensity") && C.setShadowIntensity(G.a("sceneShadowIntensity")),
                          G.a("sceneShadowQuality") && C.setShadowQuality(G.a("sceneShadowQuality")),
                          G.a("sceneShadowType") && C.setShadowType(G.a("sceneShadowType")),
                          G.a("sceneShadowRadius") && C.setShadowRadius(G.a("sceneShadowRadius")),
                          G.a("sceneShadowBias") && C.setShadowBias(G.a("sceneShadowBias")),
                          mf(G.a("sceneDashEnable")) && C.setDashDisabled(!G.a("sceneDashEnable")),
                          Xq(G.a("sceneHighlightMode")) && C.setHighlightMode(G.a("sceneHighlightMode")),
                          te(G.a("sceneHighlightWidth")) && C.setHighlightWidth(G.a("sceneHighlightWidth")),
                          G.a("sceneHighlightColor") && C.setHighlightColor(G.a("sceneHighlightColor")),
                          mf(G.a("sceneHeadlightEnable")) && C.setHeadlightDisabled(!G.a("sceneHeadlightEnable")),
                          te(G.a("sceneHeadlightRange")) && C.setHeadlightRange(G.a("sceneHeadlightRange")),
                          G.a("sceneHeadlightColor") && C.setHeadlightColor(G.a("sceneHeadlightColor")),
                          te(G.a("sceneHeadlightIntensity")) && C.setHeadlightIntensity(G.a("sceneHeadlightIntensity")),
                          te(G.a("sceneHeadlightAmbientIntensity")) && C.setHeadlightAmbientIntensity(G.a("sceneHeadlightAmbientIntensity")),
                          mf(G.a("sceneFogEnable")) && C.setFogDisabled(!G.a("sceneFogEnable")),
                          G.a("sceneFogMode") && C.setFogMode(G.a("sceneFogMode")),
                          mf(G.a("sceneFogDensity")) && C.setFogDensity(!G.a("sceneFogDensity")),
                          G.a("sceneFogColor") && C.setFogColor(G.a("sceneFogColor")),
                          te(G.a("sceneFogNear")) && C.setFogNear(G.a("sceneFogNear")),
                          te(G.a("sceneFogFar")) && C.setFogFar(G.a("sceneFogFar")),
                          mf(G.a("sceneBatchBrightnessDisabled")) && C.setBatchBrightnessDisabled(G.a("sceneBatchBrightnessDisabled")),
                          mf(G.a("sceneBatchBlendDisabled")) && C.setBatchBlendDisabled(G.a("sceneBatchBlendDisabled")),
                          mf(G.a("sceneBatchColorDisabled")) && C.setBatchColorDisabled(G.a("sceneBatchColorDisabled")),
                          G.a("sceneBatchInfoMap") && C.setBatchInfoMap(G.a("sceneBatchInfoMap")),
                          te(G.a("sceneMoveStep")) && C.setMoveStep(G.a("sceneMoveStep")),
                          te(G.a("sceneRotateStep")) && C.setRotateStep(G.a("sceneRotateStep"));
                          var j = G.a("sceneSkyboxType") || "sphere";
                          if (j != E) {
                              var Z = {}
                                , N = !1;
                              if ("sphere" === j) {
                                  Z.shape3d = j;
                                  var P = G.a("sceneSkyboxImage");
                                  P && (Z["shape3d.image"] = P,
                                  N = !0)
                              } else
                                  Z.shape3d = V,
                                  ["front", "back", "left", "right", "top", "bottom"].forEach(function(s) {
                                      var J = s + ".image"
                                        , U = s.charAt(0).toUpperCase() + s.slice(1)
                                        , g = G.a("sceneSkybox" + U + "Image");
                                      g && (Z[J] = g,
                                      N = !0)
                                  });
                              if (N) {
                                  var m = new Wd;
                                  m.s3(20, 20, 20),
                                  Z["body.color"] = G.a("sceneSkyboxBodyColor"),
                                  Z.envmap = G.a("sceneSkyboxEnvmap"),
                                  Z.light = !1,
                                  Z["texture.wrap"] = "clampToEdge",
                                  m.s(Z),
                                  ["X", "Y", "Z"].forEach(function(C) {
                                      var z = G.a("sceneSkyboxRotation" + C);
                                      te(z) && m["setRotation" + C](z)
                                  }),
                                  C.setSkybox(m)
                              }
                          }
                      }
                  }
                  ,
                  G.deserialize($, f.rootParent, f)
              }
              ,
              A.isDebugTipShowing = function() {
                  return !!this._debugDiv
              }
              ,
              A.showDebugTip = function() {
                  var i = this
                    , o = i._debugDiv;
                  if (!o) {
                      o = i._debugDiv = Y.createElement("div"),
                      o.style.position = "absolute",
                      o.style.overflow = "hidden",
                      o.style.font = M.debugTipLabelFont,
                      o.style.padding = "6px",
                      o.style.backgroundColor = M.debugTipBackground,
                      o.style.color = M.debugTipLabelColor;
                      var X = i.getView();
                      i._79O ? X.insertBefore(o, i._79O) : X.appendChild(o);
                      var u = function() {
                          i.redraw();
                          var y = i._canvas
                            , a = "FPS: " + i._fpsInfo.fps + "<br/>" + "Datas: " + i.dm().getDatas().length + (y ? "<br/>Size: " + y.width + " * " + y.height : "")
                            , A = i.dm()._historyManager;
                          A && (a += "<br/>Undoes: " + A.getHistories().length + " index: " + A.getHistoryIndex());
                          var O = i.getDebugTip();
                          O && (a += "<hr>" + O),
                          o.innerHTML = a,
                          i._isDebugging && requestAnimationFrame(u)
                      };
                      requestAnimationFrame(u),
                      i._isDebugging = !0
                  }
              }
              ,
              A.hideDebugTip = function() {
                  var A = this
                    , v = A._debugDiv;
                  v && (delete A._debugDiv,
                  A.getView().removeChild(v),
                  A._isDebugging = !1)
              }
              ,
              A.updateDOMAppendMatrix = function() {
                  var f = this.getView();
                  f && (f.updateAppendMatrix = !0)
              }
              ,
              A.countFrame = function() {
                  if (this._isDebugging) {
                      var T = Date.now()
                        , m = this._fpsInfo;
                      T - m.time > 1e3 ? (m.fps = Math.round(1e5 * (m.frames + 1) / (T - m.time)) / 100,
                      m.time = T,
                      m.frames = 0) : m.frames++
                  }
              }
          },
          ms_icons: function(L) {
              L.getRotation = function(S) {
                  return S == E ? 0 : S
              }
              ,
              L._15O = function() {
                  var F = this
                    , L = F.s(Rq);
                  if (L) {
                      var M = F
                        , f = F.data || F._data
                        , P = F._38o = {
                          icons: L,
                          rects: {}
                      };
                      for (var j in L) {
                          var X = L[j]
                            , x = yn(X.shape3d, f, M);
                          if (!(yn(X.visible, f, M) === !1 || yn(X.for3d, f, M) && !F.I3d || x && !F.I3d)) {
                              var c = x ? [x] : yn(X.names, f, M)
                                , C = c ? c.length : 0
                                , m = yn(X.position, f, M) || 3
                                , d = yn(X.offsetX, f, M) || 0
                                , o = yn(X.offsetY, f, M) || 0
                                , R = yn(X.direction, f, M) || Tm
                                , I = yn(X.gap, f, M)
                                , i = I != E ? I : 1
                                , O = yn(X.rotation, f, M)
                                , T = yn(X.keepOrien, f, M)
                                , e = yn(X.rotationFixed, f, M) ? O : F.getRotation(O, T, m)
                                , K = E
                                , g = P.rects[j] = new Array(C);
                              g.rotation = e;
                              for (var V = 0; C > V; V++) {
                                  var $, p, z, q, u = c[V];
                                  if (x)
                                      z = 0,
                                      q = 0;
                                  else {
                                      var Z = Ti(u);
                                      z = yn(X.width, f, M),
                                      q = yn(X.height, f, M),
                                      z == E && (z = Aj(Z, f)),
                                      q == E && (q = Xc(Z, f))
                                  }
                                  if (K ? R === Tm ? d += z / 2 : R === pn ? d -= z / 2 : R === me ? o -= q / 2 : o += q / 2 : K = {
                                      width: z,
                                      height: q
                                  },
                                  F.I3d) {
                                      var W = -z / 2
                                        , Q = -q / 2;
                                      p = {
                                          width: z,
                                          height: q,
                                          mat: F._16O(yn(X.autorotate, f, M), m, K, yn(X.face, f, M) || bn, yn(X.t3, f, M), yn(X.r3, f, M), yn(X.rotationMode, f, M), d, o),
                                          vs: new ld([W, -Q, 0, W, -Q - q, 0, W + z, -Q - q, 0, W + z, -Q, 0])
                                      }
                                  } else
                                      $ = F.getPosition(m, d, o, K, yn(X.positionFixed, f, M)),
                                      p = {
                                          x: $.x - z / 2,
                                          y: $.y - q / 2,
                                          width: z,
                                          height: q
                                      },
                                      F._68o(p, e);
                                  g[V] = p,
                                  R === Tm ? d += z / 2 + i : R === pn ? d -= z / 2 + i : R === me ? o -= q / 2 + i : o += q / 2 + i
                              }
                          }
                      }
                  }
              }
          }
      });
      var Ie = {
          1: 1,
          2: 1,
          6: 1,
          9: 1,
          10: 1,
          14: 1,
          15: 1,
          16: 1,
          21: 1,
          22: 1,
          26: 1,
          29: 1,
          30: 1,
          34: 1,
          36: 1,
          38: 1,
          40: 1,
          42: 1,
          45: 1,
          50: 1,
          52: 1,
          54: 1
      }
        , ab = {
          3: 1,
          7: 1,
          11: 1,
          17: 1,
          23: 1,
          27: 1,
          31: 1,
          44: 1,
          46: 1,
          47: 1,
          49: 1
      }
        , Dm = {
          translateX: 1,
          translateY: 1,
          zoom: 1,
          scrollBarVisible: 1
      }
        , Tj = {
          sourceAgent: 1,
          targetAgent: 1,
          expanded: 1,
          parent: 1,
          host: 1
      }
        , ls = {
          position: 1,
          width: 1,
          height: 1,
          expanded: 1,
          rotation: 1,
          anchor: 1,
          scale: 1,
          "s:edge.points": 1
      }
        , Ac = {
          "edge.type": 1,
          "edge.group": 1
      }
        , Ud = {
          rotation: 1,
          rotationX: 1,
          rotationZ: 1
      }
        , _k = {
          rotation: 1,
          rotationX: 1,
          rotationZ: 1,
          position: 1,
          width: 1,
          height: 1,
          anchor: 1,
          scale: 1
      }
        , Ef = {
          position: 1,
          width: 1,
          height: 1,
          anchor: 1,
          scale: 1,
          "s:grid.row.count": 1,
          "s:grid.column.count": 1,
          "s:grid.row.percents": 1,
          "s:grid.column.percents": 1,
          "s:grid.border": 1,
          "s:grid.border.left": 1,
          "s:grid.border.right": 1,
          "s:grid.border.top": 1,
          "s:grid.border.bottom": 1,
          "s:grid.gap": 1
      }
        , vi = {
          "attach.row.index": 1,
          "attach.column.index": 1,
          "attach.row.span": 1,
          "attach.column.span": 1,
          "attach.padding": 1,
          "attach.padding.left": 1,
          "attach.padding.right": 1,
          "attach.padding.top": 1,
          "attach.padding.bottom": 1,
          "attach.index": 1,
          "attach.offset": 1,
          "attach.offset.relative": 1,
          "attach.offset.opposite": 1,
          "attach.gap": 1,
          "attach.gap.relative": 1,
          "attach.thickness": 1
      }
        , pm = {
          shape: 1,
          thickness: 1,
          position: 1,
          anchor: 1,
          scale: 1
      }
        , mm = function(y) {
          if (!y)
              return E;
          if (ji(y)) {
              var M = y._40I
                , d = y._41I;
              if (!M || !d)
                  return E;
              var Z = mm(M)
                , A = mm(d);
              return Z === A ? Z : E
          }
          for (var q = y._parent; ji(q) && !q.ISubGraph; )
              q = q._parent;
          return q ? q.ISubGraph ? q : mm(q) : E
      }
        , Od = function(B, V, i, U) {
          var h = V.getStyle(i) * U;
          h && nk(B, h),
          h = V.getStyle(i + ".left") * U,
          h && (B.x -= h,
          B.width += h),
          h = V.getStyle(i + ".right") * U,
          h && (B.width += h),
          h = V.getStyle(i + ".top") * U,
          h && (B.y -= h,
          B.height += h),
          h = V.getStyle(i + ".bottom") * U,
          h && (B.height += h),
          B.width < 0 && (B.width = -B.width,
          B.x -= B.width),
          B.height < 0 && (B.height = -B.height,
          B.y -= B.height)
      }
        , jb = function(A) {
          for (var X, m = 0, c = A.size(); c > m; m++)
              if (X = A.getChildAt(m),
              ud(X) && jb(X))
                  return !0;
          return A.hasAgentEdges()
      }
        , vg = function(G) {
          if (!G)
              return E;
          for (var t = G._parent; ks(t); ) {
              if (!ks(t._parent))
                  return t.isExpanded() ? G : t;
              t.isExpanded() || (G = t),
              t = t._parent
          }
          return G
      }
        , hj = function(t, B) {
          if (!t || !B)
              return E;
          var o, p, z, I = mm(t), D = mm(B);
          if (I !== D) {
              for (; D && I !== D; )
                  D = mm(D);
              if (I === D)
                  return t;
              o = new Mh,
              o.add(t, 0);
              for (var e = t._parent; ud(e) && !B.isDescendantOf(e); )
                  o.add(e, 0),
                  e = e._parent;
              for (z = o.size(),
              p = 0; z > p; p++) {
                  var h = o.get(p);
                  if (ks(h) && !h.isExpanded())
                      return h;
                  if (h.ISubGraph)
                      return h
              }
              return t
          }
          return t
      }
        , Bs = function(e) {
          if (e.isLooped())
              return e._source;
          var b = vg(e._source)
            , Z = vg(e._target);
          return b === Z ? e._source : hj(b, Z)
      }
        , _g = function(I) {
          if (I.isLooped())
              return I._target;
          var L = vg(I._source)
            , $ = vg(I._target);
          return L === $ ? I._target : hj($, L)
      }
        , $g = function(Y, Q, o) {
          "target" !== o && (o = "source");
          var g = "target" === o ? Q.getTargetAgent() : Q.getSourceAgent()
            , f = "edge." + o + ".";
          if (ji(g)) {
              var E = Y.getDataUI(g);
              E._79o();
              var l = Q.s(f + "index");
              if (l >= 0) {
                  var x = Rl(E);
                  return x[Math.max(0, Math.min(l, x.length - 1))]
              }
              var a = Q.s(f + "percent") || 0;
              a = Math.max(0, Math.min(a, 1));
              var D = Ol(E);
              return oh(D, 100 * a)
          }
          return or(Y, g, Q.s(f + "position"), Q.s(f + "offset.x"), Q.s(f + "offset.y"), Q.s(f + "anchor.x"), Q.s(f + "anchor.y"))
      }
        , or = function(G, r, J, F, A, W, x) {
          if (!r)
              return E;
          var z, c = r.getRotation ? r.getRotation() : 0;
          if (W !== V || x !== V) {
              W = W === V ? .5 : W,
              x = x === V ? .5 : x;
              var u = r.getScale();
              if (c && !dn(r, G) || u.x < 0 || u.y < 0) {
                  var S = r.getPosition()
                    , U = r.getWidth()
                    , C = r.getHeight()
                    , s = r.getAnchor()
                    , i = new Ck(c,S.x,S.y,u.x,u.y);
                  J = i.tf((W - s.x) * U, (x - s.y) * C)
              } else
                  z = wo(G, r),
                  J = {
                      x: z.x + W * z.width,
                      y: z.y + x * z.height
                  }
          } else
              J = Eo(J, wo(G, r));
          if (c) {
              var R = P(c)
                , p = o(c)
                , k = F * R - A * p;
              A = F * p + A * R,
              F = k
          }
          return J.x += F,
          J.y += A,
          J
      }
        , Ko = function(l, h) {
          if (!l || !h)
              return E;
          var L, s, g, m, B, M;
          if (l === h) {
              if (m = l.getLoopedEdges(),
              !m)
                  return E;
              m = new Mh(m)
          } else {
              if (B = l.getAgentEdges(),
              M = h.getAgentEdges(),
              !B || !M)
                  return E;
              for (s = B.size(),
              L = 0; s > L; L++)
                  g = B.get(L),
                  M.contains(g) && (m || (m = new Mh),
                  m.add(g))
          }
          if (m)
              for (L = 0; L < m.size(); L++)
                  g = m.get(L),
                  g.getStyle(vj) === $h && (g._22I(E),
                  m.removeAt(L),
                  L--);
          return m
      }
        , wq = function(Q, G) {
          var i = Ko(Q, G);
          if (i && !i.isEmpty()) {
              if (1 === i.size())
                  return i.get(0)._22I(E),
                  void 0;
              var Z = new Mh
                , p = new Mh;
              i.each(function(v) {
                  var P = v.s("edge.group");
                  Z.contains(P) || Z.add(P)
              }),
              Z.sort(),
              Z.each(function(O) {
                  p.add(new n.EdgeGroup(i.toList(function(H) {
                      return O === H.s("edge.group")
                  }),p))
              }),
              p.each(function(L) {
                  L.each(function(x) {
                      x._22I(L)
                  })
              })
          }
      }
        , gj = function(F, R, W) {
          var Q = F._canvas;
          F._zoom;
          var S = Pf(R, Q)
            , w = Pf(W, Q);
          return {
              x: S.x - w.x,
              y: S.y - w.y
          }
      }
        , Jb = function(b, d) {
          if (d) {
              var F = d.rect
                , m = d.color
                , x = d.rotation
                , c = d.labelWidth
                , f = d.background
                , S = d.opacity
                , l = d.scale
                , i = l != E && 1 !== l;
              if (S != E) {
                  var V = b.globalAlpha;
                  b.globalAlpha *= S
              }
              if (x || i) {
                  b.save();
                  var o = F.x + F.width / 2
                    , Z = F.y + F.height / 2;
                  od(b, o, Z),
                  x && Iq(b, x),
                  i && b.scale(l, l),
                  od(b, -o, -Z)
              }
              if (f && xg(b, F.x, F.y, F.width, F.height, f),
              c) {
                  var T = F.width
                    , D = b.createLinearGradient(F.x, F.y, F.x + T, F.y);
                  D.addColorStop(0, m),
                  D.addColorStop(.9, m),
                  D.addColorStop(1, Pe),
                  m = D,
                  F.width = c
              }
              Cp(b, d.ss, F, d.font, m, d.align),
              c && (F.width = T),
              (x || i) && b.restore(),
              S != E && (b.globalAlpha = V)
          }
      }
        , Sk = function(e, w) {
          if (w) {
              var d = w.rect
                , a = d.x
                , p = d.y
                , S = d.width
                , v = d.height
                , L = w.background
                , h = w.backgroundImage
                , B = w.borderWidth
                , g = w.borderColor
                , c = w.labelWidth
                , N = w.opacity
                , C = w.scale
                , J = C != E && 1 !== C;
              if (N != E) {
                  var j = e.globalAlpha;
                  e.globalAlpha *= N
              }
              if (J) {
                  e.save();
                  var M = d.x + d.width / 2
                    , u = d.y + d.height / 2;
                  od(e, M, u),
                  e.scale(C, C),
                  od(e, -M, -u)
              }
              if (w.expanded) {
                  var z = K(8, S / 4)
                    , R = p + v - 8;
                  if (e.fillStyle = L,
                  e.beginPath(),
                  e.moveTo(a, p),
                  e.lineTo(a, R),
                  e.lineTo(a + S / 2, R),
                  e.lineTo(a + S / 2, p + v),
                  e.lineTo(a + S / 2 + z, R),
                  e.lineTo(a + S, R),
                  e.lineTo(a + S, p),
                  e.closePath(),
                  e.fill(),
                  B && (e.lineWidth = B,
                  e.lineJoin = "round",
                  e.lineCap = "round",
                  g ? (e.strokeStyle = g,
                  e.stroke()) : (e.strokeStyle = Oo(L),
                  e.beginPath(),
                  e.moveTo(a + S, p),
                  e.lineTo(a + S, R),
                  e.lineTo(a + S / 2 + z, R),
                  e.lineTo(a + S / 2, p + v),
                  e.stroke(),
                  e.strokeStyle = Dd(L),
                  e.beginPath(),
                  e.moveTo(a + S, p),
                  e.lineTo(a, p),
                  e.lineTo(a, R),
                  e.lineTo(a + S / 2, R),
                  e.lineTo(a + S / 2, p + v),
                  e.stroke())),
                  h)
                      Eq(e, Ti(h), jg, d.x, d.y, d.width, d.height - 8, w.data, w.view);
                  else {
                      if (d.height -= 8,
                      L = w.color,
                      c) {
                          var W = S
                            , U = e.createLinearGradient(a, p, a + W, p);
                          U.addColorStop(0, L),
                          U.addColorStop(.9, L),
                          U.addColorStop(1, Pe),
                          L = U,
                          d.width = c
                      }
                      Cp(e, w.ss, d, w.font, L, w.align),
                      c && (d.width = W),
                      d.height += 8
                  }
              } else if (w.icon)
                  Gm(e, Ti(w.icon), a, p, S, v, w.data, w.view);
              else {
                  var X = S / 2;
                  B && (e.lineWidth = B,
                  e.lineJoin = "round",
                  e.lineCap = "round",
                  e.strokeStyle = g ? g : Oo(L),
                  e.beginPath(),
                  e.arc(a + X, p + X, X, A, 1.6 * s, !0),
                  e.moveTo(a + X, p + v),
                  e.lineTo(a + S - X / 5, p + X),
                  e.stroke(),
                  e.strokeStyle = g ? g : Dd(L),
                  e.beginPath(),
                  e.arc(a + X, p + X, X, 1.6 * s, A, !0),
                  e.moveTo(a + X, p + v),
                  e.lineTo(a + X / 5, p + X),
                  e.stroke()),
                  e.fillStyle = L,
                  e.beginPath(),
                  e.arc(a + X, p + X, X, 0, y, !0),
                  e.moveTo(a + X, p + v),
                  e.lineTo(a + S - X / 5, p + X),
                  e.lineTo(a + X / 5, p + X),
                  e.closePath(),
                  e.fill(),
                  e.fillStyle = w.color,
                  e.beginPath(),
                  e.arc(a + X, p + X, X / 3, 0, y, !0),
                  e.fill()
              }
              J && e.restore(),
              N != E && (e.globalAlpha = j)
          }
      }
        , Zl = function(F, W) {
          return W > 2 * F ? F : W / 2
      }
        , Qb = function(r, K, Z, U) {
          if (!r || !K)
              return 0;
          var I = a(K.y - r.y, K.x - r.x);
          return Z || (I = K.x < r.x ? I + s : I),
          I + U
      }
        , hi = function(o, x, i, H, p, b, m) {
          m && (o.x > x.x || o.x === x.x && o.y > x.y) && (i = Kl[i],
          p = -p);
          var M = Eo(i, {
              x: 0,
              y: 0,
              width: Qf(o, x),
              height: 0
          }, b);
          return M.x += H,
          M.y += p,
          M = new Ck(a(x.y - o.y, x.x - o.x)).tf(M),
          M.x += o.x,
          M.y += o.y,
          M
      }
        , xp = function(O, T, v, N, g) {
          if (O._19Q = !0,
          !v.getEdgeGroup())
              return N ? v.s("edge.gap") : 0;
          if (ji(v.getSourceAgent()) || ji(v.getTargetAgent()))
              return 0;
          var r, $ = 0, h = 0, f = 0;
          if (v.getEdgeGroup().getSiblings().each(function(Q) {
              Q.each(function(i) {
                  if (T.isVisible(i) && i.s(vj) == g) {
                      var c = i.s("edge.gap");
                      r ? (h += f / 2 + c / 2,
                      f = c) : (r = i,
                      f = c),
                      i === v && ($ = h)
                  }
              })
          }),
          N)
              return h - $ + f;
          var M = $ - h / 2;
          return r && v._40I !== r._40I && (O._19Q = !1),
          M
      }
        , fr = function() {
          var h = function(H) {
              var z = [];
              return H.forEach(function(n) {
                  z.push({
                      x: n.x,
                      y: n.y
                  }),
                  z.push({
                      x: n.x + n.width,
                      y: n.y + n.height
                  }),
                  z.push({
                      x: n.x + n.width,
                      y: n.y
                  }),
                  z.push({
                      x: n.x,
                      y: n.y + n.height
                  })
              }),
              z
          };
          return function(F, s, A) {
              if ("oval" === F) {
                  var U = 0
                    , B = A.height / A.width
                    , k = B * B
                    , b = A.x + A.width / 2
                    , X = A.y + A.height / 2
                    , g = h(s);
                  g.forEach(function(x) {
                      var P = x.x - b
                        , i = x.y - X
                        , E = P * P + i * i / k;
                      E > U && (U = E)
                  }),
                  U = O(U);
                  var M = B * U;
                  return {
                      x: b - U,
                      y: X - M,
                      width: 2 * U,
                      height: 2 * M
                  }
              }
              if ("circle" === F) {
                  var C = 0
                    , b = A.x + A.width / 2
                    , X = A.y + A.height / 2
                    , g = h(s);
                  return g.forEach(function(O) {
                      var D = O.x - b
                        , d = O.y - X
                        , R = D * D + d * d;
                      R > C && (C = R)
                  }),
                  C = O(C),
                  {
                      x: b - C,
                      y: X - C,
                      width: 2 * C,
                      height: 2 * C
                  }
              }
              return "roundRect" === F ? (nk(A, K(A.width, A.height) / 16),
              A) : A
          }
      }()
        , qg = n.graph = {}
        , Kh = function(z, P, w) {
          Ik(p + ".graph." + z, P, w)
      };
      n.layout = {};
      var Ip = {}
        , sb = function(M, d, a, v, N, E, s, q) {
          var S = s._zoom;
          if (S !== s._cacheZoom && (s._cacheZoom = S,
          s._cacheImage = {}),
          S *= Ph,
          v = Math.ceil(v * S),
          N = Math.ceil(N * S),
          v > 2048 || N > 2048)
              return d;
          var C = [d.uuid, v, N, a].join("_");
          d.cacheRule && (C += "_" + yn(d.cacheRule, E, s));
          var e = s._cacheImage[C];
          return e || (Db(),
          e = n.Default.toCanvas(d, v, N, a, E, s, q),
          bj() && (s._cacheImage[C] = e)),
          e
      };
      rc(M, {
          setImageCacheRule: function(Q, n) {
              var r;
              n || "object" != typeof Q ? (r = {},
              r[Q] = n) : r = Q;
              for (var c in r) {
                  var M = r[c];
                  Xq(c) ? (Ik = Ti(c),
                  Ik ? Ik.cacheRule = M : Ip[c] = M) : c.cacheRule = M
              }
          }
      });
      var qr = {
          comps: [{
              type: Zr,
              points: [85, 50, 70, 115, 100, 71, 86, 107, 88, 49, 47, 89, 113, 97, 66, 84, 56, 110, 84, 112, 110, 108, 113, 119, 80, 106, 78, 117, 107, 107, 111, 87, 70, 82, 57, 122, 83, 101, 50, 65, 113, 66, 103, 61],
              borderWidth: 1,
              borderColor: E
          }]
      };
      if (qr[gq] = qr[Ki] = 160,
      W.Image) {
          var mb = new W.Image;
          mb.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",
          re("default_blank", mb)
      }
      re("node_image", Go(30, 30, [{
          type: gp,
          rect: [4, 5, 22, 16],
          gradient: ub,
          gradientColor: Pp,
          background: Jp
      }, {
          type: gp,
          rect: [2, 3, 26, 20],
          borderWidth: 1,
          borderColor: Jp
      }, {
          type: gp,
          rect: [11, 23, 8, 4],
          background: Jp
      }, {
          type: gp,
          rect: [6, 27, 18, 2],
          background: Jp
      }])),
      re("node_icon", Go(16, 16, [{
          type: gp,
          rect: [2, 2, 12, 10],
          gradient: ub,
          gradientColor: Pp,
          background: Jp
      }, {
          type: zd,
          rect: [2, 2, 12, 10],
          width: 1,
          color: Jp
      }, {
          type: gp,
          rect: [6, 12, 4, 2],
          background: Jp
      }, {
          type: gp,
          rect: [4, 14, 8, 1],
          background: Jp
      }])),
      re("block_icon", Go(16, 16, [{
          type: zd,
          rect: [1, 1, 14, 14],
          width: 1,
          color: Jp
      }])),
      re("group_image", Go(66, 39, [{
          type: gp,
          rect: [44.3, 18, 18.1, 12.8],
          gradient: ub,
          gradientColor: Pp,
          background: Jp
      }, {
          type: gp,
          rect: [3.3, 17.8, 18.1, 12.8],
          gradient: ub,
          gradientColor: Pp,
          background: Jp
      }, {
          type: gp,
          rect: [15.8, 3.2, 33.5, 26.4],
          borderWidth: 1,
          borderColor: Jp,
          gradient: ub,
          gradientColor: Pp,
          background: Jp
      }, {
          type: gp,
          rect: [26.2, 29.4, 12.8, 4.2],
          background: Jp
      }, {
          type: gp,
          rect: [21.3, 33.5, 22.5, 2.3],
          background: Jp
      }, {
          type: gp,
          rect: [5.3, 32.7, 14.1, 2.1],
          background: Jp
      }, {
          type: gp,
          rect: [9, 30.4, 6.7, 2.4],
          background: Jp
      }, {
          type: gp,
          rect: [50, 30.7, 6.7, 2.4],
          background: Jp
      }, {
          type: gp,
          rect: [46.3, 33, 14.1, 2.1],
          background: Jp
      }])),
      re("group_icon", Go(16, 16, [{
          type: gp,
          rect: [4, 12, 4, 2],
          background: Jp
      }, {
          type: gp,
          rect: [2, 13, 8, 1],
          background: Jp
      }, {
          type: gp,
          rect: [12, 12, 2, 1],
          background: Jp
      }, {
          type: gp,
          rect: [11, 13, 4, 1],
          background: Jp
      }, {
          type: gp,
          rect: [10, 7, 6, 5],
          gradient: ub,
          gradientColor: Pp,
          background: Jp
      }, {
          type: gp,
          rect: [1, 2, 10, 10],
          gradient: ub,
          gradientColor: Pp,
          background: Jp
      }, {
          type: zd,
          rect: [1, 2, 10, 10],
          width: 1,
          color: Jp
      }])),
      re("refGraph_icon", Go(16, 16, [{
          type: "shape",
          borderWidth: 1,
          borderColor: Jp,
          borderCap: "round",
          rotation: .7854,
          points: [12.5502, 6.7981, 12.5502, 6.7981, 12.5502, 4.8181, 12.5502, 3.7981, 12.5502, 2.7781, 11.36687, 1.7981, 10.0502, 1.7981, 8.73354, 1.7981, 7.5502, 2.8181, 7.5502, 3.7981, 7.5502, 4.55989, 7.5502, 7.79805, 7.5502, 7.79805, 7.5502, 7.79805, 7.5502, 9.7981, 10.0502, 9.7981],
          segments: [1, 4, 4, 4, 4, 4]
      }, {
          type: "shape",
          borderWidth: 1,
          borderColor: Jp,
          borderCap: "round",
          rotation: -2.35619,
          points: [8.4498, 11.2019, 8.4498, 11.2019, 8.4498, 9.2219, 8.4498, 8.2019, 8.4498, 7.1819, 7.26646, 6.2019, 5.9498, 6.2019, 4.63313, 6.2019, 3.4498, 7.2219, 3.4498, 8.2019, 3.4498, 8.9637, 3.4498, 12.20186, 3.4498, 12.20186, 3.4498, 12.20186, 3.4498, 14.2019, 5.9498, 14.2019],
          segments: [1, 4, 4, 4, 4, 4]
      }])),
      re("edge_icon", Go(16, 16, [{
          type: gp,
          rect: [2.1, 6.9, 11.5, 2.6],
          rotation: -.79,
          gradient: ub,
          gradientColor: Pp,
          background: Jp
      }, {
          type: gp,
          rect: [10.8, 1, 4, 4],
          background: Jp
      }, {
          type: gp,
          rect: [1, 11, 4, 4],
          background: Jp
      }])),
      re("subGraph_image", Go(72, 45, [{
          type: Zr,
          points: [9, 42, .3, 38.4, 2.4, 28.8, 5.7, 21.6, 11.7, 22.5, 11.7, 15.9, 16.8, 13.8, 21.6, 12, 24.3, 15.9, 27.9, 3, 42.3, 2.1, 59.4, 4.5, 57.3, 18.3, 67.5, 18.9, 69.6, 27.3, 69.9, 38.4, 64.2, 41.4],
          segments: [1, 3, 3, 3, 3, 3, 3, 3, 3],
          gradient: ub,
          gradientColor: Pp,
          background: Jp
      }, {
          type: gp,
          rect: [29.6, 30.7, 3.6, 1.8],
          background: Jp
      }, {
          type: gp,
          rect: [28.4, 32.3, 6, 1.2],
          background: Jp
      }, {
          type: gp,
          rect: [37.3, 32, 10.8, 1.8],
          background: Jp
      }, {
          type: gp,
          rect: [39.1, 29.9, 7.2, 2.3],
          background: Jp
      }, {
          type: gp,
          rect: [26.6, 23.7, 9.6, 7.2],
          gradient: ub,
          gradientColor: Pp,
          background: Jp
      }, {
          type: gp,
          rect: [34.3, 16.8, 16.8, 13.2],
          borderWidth: 1,
          borderColor: Jp,
          gradient: ub,
          gradientColor: Pp,
          background: Jp
      }])),
      re("subGraph_icon", Go(17, 17, [{
          type: Zr,
          points: [2.2, 14.6, .2, 11.9, .8, 8.8, 1.8, 5.9, 5.6, 7.4, 3.8, 1.6, 10.3, 3, 14.5, 4.2, 12.2, 7.5, 18.9, 7.2, 14.5, 14.5],
          segments: [1, 3, 3, 3, 3, 3],
          gradient: ub,
          gradientColor: Pp,
          background: Jp
      }])),
      re("shape_icon", Go(16, 16, [{
          type: Zr,
          points: [1.5, 1, 8.4, 1, 8.4, 7.2, 14.6, 7.1, 14.6, 14.9, 1.5, 14.9, 1.5, 1],
          background: Jp
      }])),
      re("polyline_icon", Go(16, 16, [{
          type: Zr,
          points: [1.5, 1, 8.4, 1, 8.4, 7.2, 14.6, 7.1, 14.6, 14.9, 1.5, 14.9, 1.5, 1],
          borderWidth: 1,
          borderColor: Jp
      }, Lp(7.5, .4), Lp(7.5, 6.3), Lp(13.6, 6.3), Lp(13.6, 14), Lp(.7, 13.9), Lp(.7, .3)])),
      re("grid_icon", Go(16, 16, [{
          type: gp,
          rect: [1, 1, 4, 4],
          background: Jp,
          gradient: ub,
          gradientColor: Pp
      }, {
          type: gp,
          rect: [6, 1, 4, 4],
          background: Jp,
          gradient: ub,
          gradientColor: Pp
      }, {
          type: gp,
          rect: [11, 1, 4, 4],
          background: Jp,
          gradient: ub,
          gradientColor: Pp
      }, {
          type: gp,
          rect: [11, 6, 4, 4],
          background: Jp,
          gradient: ub,
          gradientColor: Pp
      }, {
          type: gp,
          rect: [6, 6, 4, 4],
          background: Jp,
          gradient: ub,
          gradientColor: Pp
      }, {
          type: gp,
          rect: [1, 6, 4, 4],
          background: Jp,
          gradient: ub,
          gradientColor: Pp
      }, {
          type: gp,
          rect: [11, 11, 4, 4],
          background: Jp,
          gradient: ub,
          gradientColor: Pp
      }, {
          type: gp,
          rect: [6, 11, 4, 4],
          background: Jp,
          gradient: ub,
          gradientColor: Pp
      }, {
          type: gp,
          rect: [1, 11, 4, 4],
          background: Jp,
          gradient: ub,
          gradientColor: Pp
      }])),
      re("light_icon", Go(16, 16, [{
          type: "rect",
          rect: [6, 9, 5, 5],
          borderWidth: 1,
          borderColor: Jp
      }, {
          type: "circle",
          rect: [1, 1, 15, 10],
          borderWidth: 1,
          borderColor: Jp,
          gradient: ub,
          gradientColor: Pp,
          background: {
              func: function(g) {
                  var _ = g ? g.s(os) : E;
                  return $c(_) ? "rgb(" + $n(255 * _[0]) + "," + $n(255 * _[1]) + "," + $n(255 * _[2]) + ")" : _ || Jp
              }
          }
      }])),
      re("text_icon", Go(16, 16, [{
          type: "shape",
          points: [3, 3, 13, 3, 8, 3, 8, 14],
          segments: [1, 2, 1, 2],
          borderWidth: 1,
          borderColor: Jp
      }])),
      re("border_image", {
          fitSize: !0,
          comps: [{
              type: "border",
              relative: !0,
              rect: [0, 0, 1, 1],
              color: {
                  func: "style@border_color"
              },
              width: {
                  func: "style@border_width"
              }
          }]
      }),
      re("columnChart_image", {
          fitSize: !0,
          boundExtend: 150,
          comps: [{
              type: {
                  func: "style@chart.type"
              },
              relative: !0,
              rect: [0, 0, 1, 1],
              label: {
                  func: "style@chart.label"
              },
              labelColor: {
                  func: "style@chart.label.color"
              },
              labelFont: {
                  func: "style@chart.label.font"
              },
              series: {
                  func: "style@chart.series"
              },
              minValue: {
                  func: "style@chart.min.value"
              },
              maxValue: {
                  func: "style@chart.max.value"
              }
          }]
      }),
      re("lineChart_image", {
          fitSize: !0,
          boundExtend: 150,
          comps: [{
              type: "lineChart",
              relative: !0,
              rect: [0, 0, 1, 1],
              label: {
                  func: "style@chart.label"
              },
              labelColor: {
                  func: "style@chart.label.color"
              },
              labelFont: {
                  func: "style@chart.label.font"
              },
              series: {
                  func: "style@chart.series"
              },
              minValue: {
                  func: "style@chart.min.value"
              },
              maxValue: {
                  func: "style@chart.max.value"
              },
              linePoint: {
                  func: "style@chart.line.point"
              },
              lineWidth: {
                  func: "style@chart.line.width"
              },
              line3d: {
                  func: "style@chart.line.3d"
              }
          }]
      }),
      re("pieChart_image", {
          fitSize: !0,
          boundExtend: 150,
          comps: [{
              type: "pieChart",
              relative: !0,
              rect: [0, 0, 1, 1],
              label: {
                  func: "style@chart.label"
              },
              labelColor: {
                  func: "style@chart.label.color"
              },
              labelFont: {
                  func: "style@chart.label.font"
              },
              hollow: {
                  func: "style@chart.hollow"
              },
              startAngle: {
                  func: "style@chart.start.angle"
              },
              values: {
                  func: "style@chart.values"
              },
              colors: {
                  func: "style@chart.colors"
              }
          }]
      });
      var Ar = function(Y, C, n, t, H, i) {
          var S, G, L, Q, e, Z, b, P, E, l, W, h = [];
          if (Math.abs(t) > 2 * Math.PI && (t = 2 * Math.PI),
          e = Math.ceil(Math.abs(t) / (Math.PI / 4)),
          S = t / e,
          G = -S,
          L = -n,
          e > 0) {
              Z = Y + Math.cos(n) * H,
              b = C + Math.sin(-n) * i,
              h.push({
                  x: Z,
                  y: b
              });
              for (var D = 0; e > D; D++)
                  L += G,
                  Q = L - G / 2,
                  P = Y + Math.cos(L) * H,
                  E = C + Math.sin(L) * i,
                  l = Y + Math.cos(Q) * (H / Math.cos(G / 2)),
                  W = C + Math.sin(Q) * (i / Math.cos(G / 2)),
                  h.push({
                      x: l,
                      y: W
                  }),
                  h.push({
                      x: P,
                      y: E
                  })
          }
          return h
      }
        , mo = function(E) {
          if (E) {
              var A = E._data;
              if (A instanceof n.Shape)
                  return {
                      points: A.getPoints(),
                      segments: A.getSegments()
                  };
              var t;
              if (A instanceof n.Edge && (t = E._78o)) {
                  var U, D, W = t.type, H = t.points, C = t.segments, h = t.edgeTypeInfo;
                  if (!W || H) {
                      var T = t.sourcePoint
                        , p = T.x
                        , y = T.y
                        , w = t.targetPoint
                        , L = w.x
                        , S = w.y;
                      if (W)
                          C ? (U = new Mh({
                              x: p,
                              y: y
                          }),
                          U.addAll(H),
                          U.add({
                              x: L,
                              y: S
                          }),
                          D = new Mh(C._as)) : (U = new Mh({
                              x: p,
                              y: y
                          }),
                          H.each(function(V) {
                              U.add(V)
                          }),
                          U.add({
                              x: L,
                              y: S
                          }));
                      else if (t.looped) {
                          U = new Mh(Ar(p, y, 0, 2 * Math.PI, t.radius, t.radius)),
                          D = new Mh([1]);
                          for (var b = 0; b < (U.size() - 1) / 2; b++)
                              D.add(3)
                      } else
                          U = new Mh,
                          t.center ? (U.add({
                              x: t.c1.x,
                              y: t.c1.y
                          }),
                          U.add({
                              x: p,
                              y: y
                          }),
                          U.add({
                              x: L,
                              y: S
                          }),
                          U.add({
                              x: t.c2.x,
                              y: t.c2.y
                          })) : (U.add({
                              x: p,
                              y: y
                          }),
                          U.add({
                              x: L,
                              y: S
                          }))
                  } else
                      h && (U = new Mh(h.points._as),
                      h.segments && (D = new Mh(h.segments._as)));
                  return {
                      points: U,
                      segments: D
                  }
              }
          }
      }
        , Ol = function(q, e, x) {
          if (null == e) {
              var X = mo(q);
              if (!X)
                  return;
              e = X.points,
              x = X.segments
          }
          if (e) {
              if (Array.isArray(e) && (e = new Mh(e)),
              "number" == typeof e.get(0)) {
                  for (var k = new n.List, Z = 0; Z < e.size(); Z += 2)
                      k.add({
                          x: e.get(Z),
                          y: e.get(Z + 1)
                      });
                  e = k
              }
              if (!x) {
                  x = [1];
                  for (var F = e.length - 1; F > 0; F--)
                      x.push(2)
              }
              Array.isArray(x) && (x = new Mh(x));
              for (var s = _q(e._as, x._as, 50), v = s.length, o = [], Z = 0; v > Z; Z++) {
                  var V = s[Z];
                  V.length > 1 && o.push(V)
              }
              return o
          }
      }
        , hb = function(x) {
          for (var D = 0, v = x.length - 1, j = 0; v > j; j++) {
              var G = x[j]
                , W = x[j + 1]
                , A = W.x - G.x
                , X = W.y - G.y;
              D += Math.sqrt(A * A + X * X)
          }
          return D
      }
        , rq = function(H, E) {
          for (var e = 0, w = E.length, f = 0; w > f; f++) {
              var u = E[f];
              if (e += u,
              e > H)
                  return f
          }
          return Math.min(f, w - 1)
      }
        , Ae = function(X, J) {
          for (var S = 0, i = 0, H = 0, p = X.length - 1, n = 0; p > n; n++) {
              var a = X[n]
                , D = X[n + 1]
                , g = D.x - a.x
                , y = D.y - a.y;
              if (H = Math.sqrt(g * g + y * y),
              S += H,
              S > J) {
                  S -= H,
                  i = n;
                  break
              }
          }
          var f = X[i]
            , V = X[i + 1]
            , m = Math.atan2(V.y - f.y, V.x - f.x)
            , r = J - S
            , y = Math.sin(m) * r
            , g = Math.cos(m) * r;
          return {
              x: f.x + g,
              y: f.y + y
          }
      }
        , oh = function(O, A) {
          if (O) {
              var P;
              if (0 === A)
                  P = O[0][0];
              else if (100 === A)
                  O = O[O.length - 1],
                  P = O[O.length - 1];
              else {
                  for (var c = 0, j = [], Q = O.length, u = 0; Q > u; u++) {
                      var v = O[u]
                        , F = hb(v);
                      c += F,
                      j.push(F)
                  }
                  for (var g = c * A / 100, G = rq(g, j), k = 0, C = 0; G > C; C++)
                      k += j[C];
                  g -= k,
                  P = Ae(O[G], g)
              }
              return P
          }
      }
        , Rl = function(A) {
          var r, B, S, d, x = mo(A), m = [], H = x.points, L = x.segments, j = -1;
          for (B = 0,
          S = L ? L.length : H.length; S > B; B++) {
              if (r = L ? L.get(B) : 1,
              3 === r)
                  d = 2;
              else if (4 === r)
                  d = 3;
              else {
                  if (5 === r)
                      continue;
                  d = 1
              }
              j += d,
              m.push(H.get(j))
          }
          return m
      }
        , Vq = function(K, Y, _, Q) {
          function F(S) {
              if (S >= 0 && 1 >= S) {
                  p = Y(S);
                  var e = (K.x - p.x) * (K.x - p.x) + (K.y - p.y) * (K.y - p.y);
                  return V > e ? (V = e,
                  I = S,
                  !0) : !1
              }
          }
          _ = _ || 100,
          Q = Q || 1e-5;
          for (var V = 1 / 0, I = 0, p = new le, N = 0; _ > N; ++N)
              F(N / _);
          for (var M = 1 / (2 * _); M > Q; )
              F(I - M) || F(I + M) || (M /= 2);
          return I
      };
      rc(M, {
          _edgeProtectMethod: {
              getStraightLinePoints: Ol,
              calculateLineLength: hb,
              calcSegmentIndexByDistance: rq,
              calculatePointAlongLine: Ae,
              getPercentPosition: oh,
              getRealPointsFromDataUI: Rl
          }
      });
      var lf = function(p, m) {
          for (var u = p.vertices, t = 0; t < u.length; t++) {
              var r = u[t]
                , X = r.y;
              r.y = r.z,
              r.z = -X,
              m && (r.y += m)
          }
      }
        , _b = function(T) {
          for (var v, E, e, b, F, o, k = [], N = [], M = [], I = T.faces, z = 0, h = 0, t = 0, G = I.length; G > z; z++,
          h += 6,
          t += 9) {
              var J = I[z];
              1 === J.i ? (v || (v = [],
              E = [],
              e = []),
              gs(J, z, h, t, T, v, e, E)) : 2 === J.i ? (b || (b = [],
              F = [],
              o = []),
              gs(J, z, h, t, T, b, o, F)) : gs(J, z, h, t, T, k, M, N)
          }
          return {
              vs: k,
              uv: N,
              ns: M,
              top_vs: v,
              top_uv: E,
              top_ns: e,
              bottom_vs: b,
              bottom_uv: F,
              bottom_ns: o
          }
      }
        , gs = function(v, h, T, D, e, E, x, M) {
          var l = e.vertices
            , F = e.faceVertexUvs
            , L = l[v.a]
            , $ = l[v.b]
            , d = l[v.c];
          E.push(L.x, L.y, L.z, $.x, $.y, $.z, d.x, d.y, d.z);
          var U, t, W, P = v.vertexNormals;
          3 === P.length ? (U = P[0],
          t = P[1],
          W = P[2]) : U = t = W = v.normal,
          x.push(U.x, U.y, U.z, t.x, t.y, t.z, W.x, W.y, W.z);
          var k = F[0][h][0]
            , g = F[0][h][1]
            , m = F[0][h][2];
          M.push(k.x, k.y, g.x, g.y, m.x, m.y)
      }
        , mq = function() {
          function L(H, v) {
              return H.dot(v) > 0
          }
          function g(N, u, E, V, H, r, b) {
              for (var O, d, q = [u, E, V], j = [H, r, b], D = [], Y = q.length, s = !0; Y-- && s; ) {
                  for (var z = q[Y], c = j.length, x = !1; c--; )
                      if (z.equals(j[c])) {
                          j.splice(c, 1),
                          D.push(z),
                          x = !0;
                          break
                      }
                  if (!x) {
                      if (O) {
                          s = !1;
                          break
                      }
                      O = z
                  }
              }
              return s && 2 === D.length && (d = j[0],
              W.subVectors(O, D[0]),
              m.subVectors(d, D[0]),
              R.subVectors(O, D[1]),
              W.x * R.y * m.z + R.x * m.y * W.z + m.x * W.y * R.z - m.x * R.y * W.z - m.y * R.z * W.x - m.z * R.x * W.y < 1e-6 && (n.subVectors(d, D[1]),
              w.subVectors(D[1], D[0]),
              L(w, W) && L(w, m) && (w.negate(),
              L(w, R) && L(w, n)))) ? (N.push(D[1].x, D[1].y, D[1].z),
              N.push(O.x, O.y, O.z),
              N.push(O.x, O.y, O.z),
              N.push(D[0].x, D[0].y, D[0].z),
              N.push(D[0].x, D[0].y, D[0].z),
              N.push(d.x, d.y, d.z),
              N.push(d.x, d.y, d.z),
              N.push(D[1].x, D[1].y, D[1].z),
              2) : (N.push(u.x, u.y, u.z),
              N.push(E.x, E.y, E.z),
              N.push(E.x, E.y, E.z),
              N.push(V.x, V.y, V.z),
              N.push(V.x, V.y, V.z),
              N.push(u.x, u.y, u.z),
              1)
          }
          function q() {
              this._vertexMap = {},
              this._lineMap = {},
              this._lineList = []
          }
          function s(e, b, i, k, Z, m, Y) {
              var R = [i, Z];
              e[0] === k && R.reverse();
              var c = [R[0]._key, R[1]._key].join("|")
                , U = e._triangles[c];
              U || (e._triangles[c] = U = {});
              var y = [m._key, Y._key].join("|");
              U[y] || (U[y] = [m, Y])
          }
          function M(B, h, g) {
              var E = B._planes[g._key];
              if (!E)
                  for (var u in B._planes) {
                      var L = B._planes[u];
                      if (L._normal.angleTo(g) < .001) {
                          E = L;
                          break
                      }
                  }
              return E ? (E._vertices.indexOf(h) < 0 && E._vertices.push(h),
              void 0) : (B._planes[g._key] = {
                  _normal: g,
                  _vertices: [h]
              },
              void 0)
          }
          function l(z, Z) {
              return 0 === Z ? "0|0|0" : 1 / 0 === Math.abs(Z) ? [z.x, z.y, z.z].join("|") : [Math.round(e.angleTo(z) * Z), Math.round(H.angleTo(z) * Z), Math.round(D.angleTo(z) * Z)].join("|")
          }
          function P(M, X) {
              var n = M._ctlineModel;
              if (n || (M._ctlineModel = n = []),
              n[0])
                  return n[0];
              var C;
              C = $c(M) ? M : [M];
              var E, Y, A, z, y, i, B, e, G, b, _, s, d, o, D, h, V, H, Z, I = ["", "top_", "bottom_"];
              n = [];
              var R = [];
              for (pr(C, X, R),
              E = 0,
              Y = R.length; Y > E; E++)
                  if (b = R[E])
                      for (Ec(b),
                      A = 0,
                      z = I.length; z > A; A++)
                          if (G = b[I[A] + "lvs"])
                              for (V = n.length,
                              H = G.length,
                              n.length = V + H,
                              Z = 0; H > Z; ++Z,
                              ++V)
                                  n[V] = G[Z];
                          else if (B = b[I[A] + "vs"]) {
                              e = b[I[A] + "is"],
                              i = e ? e.length : B.length / 3;
                              for (var y = 0; i - 1 > y; )
                                  e ? (_ = e[y],
                                  s = e[y + 1],
                                  d = e[y + 2],
                                  o = e[y + 3],
                                  D = e[y + 4],
                                  h = e[y + 5]) : (_ = y,
                                  s = y + 1,
                                  d = y + 2,
                                  o = y + 3,
                                  D = y + 4,
                                  h = y + 5),
                                  a.fromArray(B, 3 * _),
                                  v.fromArray(B, 3 * s),
                                  $.fromArray(B, 3 * d),
                                  O.fromArray(B, 3 * o),
                                  F.fromArray(B, 3 * D),
                                  K.fromArray(B, 3 * h),
                                  y += 3 * g(n, a, v, $, O, F, K);
                              i > y && (e ? (_ = e[y],
                              s = e[y + 1],
                              d = e[y + 2]) : (_ = y,
                              s = y + 1,
                              d = y + 2),
                              a.fromArray(B, 3 * _),
                              v.fromArray(B, 3 * s),
                              $.fromArray(B, 3 * d),
                              n.push(a.x, a.y, a.z),
                              n.push(v.x, v.y, v.z),
                              n.push(v.x, v.y, v.z),
                              n.push($.x, $.y, $.z),
                              n.push($.x, $.y, $.z),
                              n.push(a.x, a.y, a.z))
                          }
              return M._ctlineModel[0] = n,
              n
          }
          function Q(t, r, P) {
              var B = t._ctlineModel;
              B || (t._ctlineModel = B = []);
              var i = B[1];
              if (i && i.epsilon === P)
                  return i;
              i = [],
              i.epsilon = P;
              var k;
              k = $c(t) ? t : [t];
              var S, e, n, Z, O, c, U, x, R, J, m, o, N = ["", "top_", "bottom_"], X = new q, u = [];
              for (pr(k, r, u),
              S = 0,
              e = u.length; e > S; S++)
                  if (R = u[S])
                      for (Ec(R),
                      n = 0,
                      Z = N.length; Z > n; n++)
                          if (U = R[N[n] + "vs"]) {
                              x = R[N[n] + "is"],
                              c = x ? x.length : U.length / 3;
                              for (var O = 0, O = 0; c > O; O += 3)
                                  x ? (J = x[O],
                                  m = x[O + 1],
                                  o = x[O + 2]) : (J = O,
                                  m = O + 1,
                                  o = O + 2),
                                  X._addTriangle(U, V, J, m, o, P)
                          }
              return X._toLineVS(i),
              t._ctlineModel[1] = i,
              i
          }
          function Y(m, _, G) {
              var J = m._ctlineModel;
              J || (m._ctlineModel = J = []);
              var Q = J[1];
              if (Q && Q.epsilon === G)
                  return Q;
              Q = [],
              Q.epsilon = G;
              var H;
              H = $c(m) ? m : [m];
              var L, e, U, O, F, u, v, M, g, B, W, D, p, A = ["", "top_", "bottom_"], P = new q, V = [];
              for (pr(H, _, V),
              L = 0,
              e = V.length; e > L; L++)
                  if (B = V[L])
                      for (Ec(B),
                      U = 0,
                      O = A.length; O > U; U++)
                          if (v = B[A[U] + "vs"]) {
                              M = B[A[U] + "is"],
                              g = B[A[U] + "ns"],
                              u = M ? M.length : v.length / 3;
                              for (var F = 0, F = 0; u > F; F += 3)
                                  M ? (W = M[F],
                                  D = M[F + 1],
                                  p = M[F + 2]) : (W = F,
                                  D = F + 1,
                                  p = F + 2),
                                  P._addTriangle(v, g, W, D, p, G)
                          }
              return P._toLineVS(Q),
              m._ctlineModel[2] = Q,
              Q
          }
          var a = new Rh
            , v = new Rh
            , $ = new Rh
            , O = new Rh
            , F = new Rh
            , K = new Rh
            , W = new Rh
            , R = new Rh
            , m = new Rh
            , n = new Rh
            , w = new Rh
            , S = new Rh;
          q.prototype._findVertex = function(e, H) {
              S.fromArray(e, 3 * H);
              var P = [S.x, S.y, S.z].join(",")
                , L = this._vertexMap[P];
              if (!L) {
                  var g = S.clone();
                  g._key = P,
                  this._vertexMap[P] = L = g
              }
              return L
          }
          ,
          q.prototype._findLine = function(F, v) {
              var X = [F, v];
              F._key > v._key && X.reverse(),
              X._key = [X[0]._key, X[1]._key].join("|");
              var Z = this._lineMap[X._key];
              return Z || (this._lineMap[X._key] = Z = X,
              X._triangles = {},
              X._planes = {},
              this._lineList.push(X)),
              Z
          }
          ;
          var e = new Rh(1,0,0)
            , H = new Rh(0,1,0)
            , D = new Rh(0,0,1)
            , Z = new Rh
            , j = new Rh;
          return q.prototype._addTriangle = function(U, $, y, t, V, p) {
              var h, K, X, f = this._findVertex(U, y), P = this._findVertex(U, t), L = this._findVertex(U, V), T = this._findLine(f, P), A = this._findLine(P, L), w = this._findLine(L, f);
              $ ? (h = (new Rh).fromArray($, 3 * y),
              h._key = l(h, p),
              K = (new Rh).fromArray($, 3 * t),
              K._key = l(K, p),
              X = (new Rh).fromArray($, 3 * V),
              X._key = l(X, p),
              s(T, f, h, P, K, L, X),
              s(A, P, K, L, X, f, h),
              s(w, L, X, f, h, P, K)) : (j.subVectors(L, P),
              Z.subVectors(P, f),
              h = (new Rh).crossVectors(Z, j),
              h._key = l(h, p),
              M(T, L, h),
              M(A, f, h),
              M(w, P, h))
          }
          ,
          q.prototype._toLineVS = function(X) {
              for (var P = this._lineList, h = 0, F = P.length; F > h; ++h) {
                  var y = P[h]
                    , S = !1;
                  for (var M in y._triangles)
                      if (1 == G.keys(y._triangles[M]).length) {
                          X.push(y[0].x, y[0].y, y[0].z, y[1].x, y[1].y, y[1].z),
                          S = !0;
                          break
                      }
                  if (!S)
                      for (var b in y._planes)
                          if (1 == y._planes[b]._vertices.length) {
                              X.push(y[0].x, y[0].y, y[0].z, y[1].x, y[1].y, y[1].z),
                              S = !0;
                              break
                          }
              }
          }
          ,
          [P, Q, Y]
      }()
        , Zg = function(w, p) {
          var N = w._lineModel;
          if (N)
              return N;
          var q;
          q = $c(w) ? w : [w];
          var j, E, T, W, e, U, V, $, t, B, d, S, J = ["", "top_", "bottom_"];
          N = [];
          var l = [];
          for (pr(w, p, l),
          j = 0,
          E = l.length; E > j; j++)
              if (t = l[j])
                  for (T = 0,
                  W = J.length; W > T; T++)
                      if (V = t[J[T] + "vs"]) {
                          $ = t[J[T] + "is"],
                          U = $ ? $.length : V.length / 3;
                          for (var e = 0; U > e; e += 3)
                              $ ? (B = $[e],
                              d = $[e + 1],
                              S = $[e + 2]) : (B = e,
                              d = e + 1,
                              S = e + 2),
                              B *= 3,
                              d *= 3,
                              S *= 3,
                              N.push(V[B], V[B + 1], V[B + 2], V[d], V[d + 1], V[d + 2], V[d], V[d + 1], V[d + 2], V[S], V[S + 1], V[S + 2], V[S], V[S + 1], V[S + 2], V[B], V[B + 1], V[B + 2])
                      }
          return w._lineModel = N,
          N
      }
        , Sm = function(e, Q, p, u, L, J, h, d, Y) {
          p == E && (p = !0),
          u == E && (u = !0),
          h == E && (h = 1),
          d == E && (d = 0);
          var T = new Tn;
          return Cc(T, e, Q, Y),
          T = T.toShapes(),
          _b(new ep(T,{
              top: p,
              bottom: u,
              curveSegments: L,
              amount: h,
              repeatUVLength: J
          },-h / 2 + d))
      }
        , uh = function(Z, g) {
          this.x = Z || 0,
          this.y = g || 0
      };
      uh.prototype = {
          constructor: uh,
          add: function(w) {
              return this.x += w.x,
              this.y += w.y,
              this
          },
          sub: function(V) {
              return this.x -= V.x,
              this.y -= V.y,
              this
          },
          equals: function(x) {
              return x.x === this.x && x.y === this.y
          },
          multiplyScalar: function(R) {
              return this.x *= R,
              this.y *= R,
              this
          },
          distanceTo: function(W) {
              return O(this.distanceToSquared(W))
          },
          distanceToSquared: function(f) {
              var E = this.x - f.x
                , p = this.y - f.y;
              return E * E + p * p
          },
          clone: function() {
              return new uh(this.x,this.y)
          }
      };
      var vm = function(J, I, k) {
          this.x = J || 0,
          this.y = I || 0,
          this.z = k || 0
      };
      vm.prototype = {
          constructor: vm,
          set: function(d, j, A) {
              return this.x = d,
              this.y = j,
              this.z = A,
              this
          },
          setY: function(l) {
              return this.y = l,
              this
          },
          copy: function(p) {
              return this.x = p.x,
              this.y = p.y,
              this.z = p.z,
              this
          },
          add: function(Q) {
              return this.x += Q.x,
              this.y += Q.y,
              this.z += Q.z,
              this
          },
          addVectors: function(b, m) {
              return this.x = b.x + m.x,
              this.y = b.y + m.y,
              this.z = b.z + m.z,
              this
          },
          sub: function(i) {
              return this.x -= i.x,
              this.y -= i.y,
              this.z -= i.z,
              this
          },
          subVectors: function(a, D) {
              return this.x = a.x - D.x,
              this.y = a.y - D.y,
              this.z = a.z - D.z,
              this
          },
          multiplyScalar: function(b) {
              return this.x *= b,
              this.y *= b,
              this.z *= b,
              this
          },
          applyMatrix4: function(v) {
              var t = this.x
                , f = this.y
                , k = this.z
                , Z = v.elements;
              return this.x = Z[0] * t + Z[4] * f + Z[8] * k + Z[12],
              this.y = Z[1] * t + Z[5] * f + Z[9] * k + Z[13],
              this.z = Z[2] * t + Z[6] * f + Z[10] * k + Z[14],
              this
          },
          divideScalar: function(K) {
              if (0 !== K) {
                  var P = 1 / K;
                  this.x *= P,
                  this.y *= P,
                  this.z *= P
              } else
                  this.x = 0,
                  this.y = 0,
                  this.z = 0;
              return this
          },
          dot: function(u) {
              return this.x * u.x + this.y * u.y + this.z * u.z
          },
          length: function() {
              return O(this.x * this.x + this.y * this.y + this.z * this.z)
          },
          normalize: function() {
              return this.divideScalar(this.length())
          },
          cross: function(c) {
              var w = this.x
                , g = this.y
                , A = this.z;
              return this.x = g * c.z - A * c.y,
              this.y = A * c.x - w * c.z,
              this.z = w * c.y - g * c.x,
              this
          },
          crossVectors: function(n, u) {
              var t = n.x
                , T = n.y
                , C = n.z
                , L = u.x
                , Z = u.y
                , J = u.z;
              return this.x = T * J - C * Z,
              this.y = C * L - t * J,
              this.z = t * Z - T * L,
              this
          },
          distanceTo: function(I) {
              return O(this.distanceToSquared(I))
          },
          distanceToSquared: function(N) {
              var B = this.x - N.x
                , I = this.y - N.y
                , c = this.z - N.z;
              return B * B + I * I + c * c
          },
          clone: function() {
              return new vm(this.x,this.y,this.z)
          }
      };
      var Uq = function() {
          this.elements = new Float32Array(16)
      };
      Uq.prototype = {
          constructor: Uq,
          set: function(W, X, Q, v, O, b, E, T, y, p, j, H, d, o, t, J) {
              var S = this.elements;
              return S[0] = W,
              S[4] = X,
              S[8] = Q,
              S[12] = v,
              S[1] = O,
              S[5] = b,
              S[9] = E,
              S[13] = T,
              S[2] = y,
              S[6] = p,
              S[10] = j,
              S[14] = H,
              S[3] = d,
              S[7] = o,
              S[11] = t,
              S[15] = J,
              this
          },
          makeRotationAxis: function(E, D) {
              var i = P(D)
                , q = o(D)
                , u = 1 - i
                , r = E.x
                , B = E.y
                , x = E.z
                , p = u * r
                , s = u * B;
              return this.set(p * r + i, p * B - q * x, p * x + q * B, 0, p * B + q * x, s * B + i, s * x - q * r, 0, p * x - q * B, s * x + q * r, u * x * x + i, 0, 0, 0, 0, 1),
              this
          }
      };
      var fk = function(j) {
          this.repeatUVLength = j
      };
      fk.prototype = {
          generateTopUV: function($, y, m, e, f, t, a) {
              var K, L, o, i, I = $.vertices, w = I[e].x, j = I[e].y, F = I[f].x, h = I[f].y, p = I[t].x, x = I[t].y, X = this.repeatUVLength;
              if (X)
                  K = 0,
                  L = 0,
                  o = X,
                  i = X;
              else {
                  this._bb || (this._bb = y.getBoundingBox());
                  var c = this._bb;
                  K = c.minX,
                  L = c.minY,
                  o = c.maxX - K,
                  i = c.maxY - L
              }
              return a ? [new uh((w - K) / o,(j - L) / i), new uh((F - K) / o,(h - L) / i), new uh((p - K) / o,(x - L) / i)] : [new uh((w - K) / o,1 - (j - L) / i), new uh((F - K) / o,1 - (h - L) / i), new uh((p - K) / o,1 - (x - L) / i)]
          },
          generateBottomUV: function(S, k, f, m, s, n) {
              return this.generateTopUV(S, k, f, m, s, n, !0)
          },
          generateSideWallUV: function(w, X, A, E, m, F, l, v, r, P, f, N) {
              if (!this._cl) {
                  for (var y, C, q = [], V = 0, S = A.length, D = 0; S > D; D++) {
                      y = A[D],
                      C = A[(D + 1) % S];
                      var x = y.x - C.x
                        , G = y.y - C.y
                        , K = O(x * x + G * G);
                      q.push(V),
                      V += K
                  }
                  for (var D = 0; S > D; D++)
                      q[D] /= V;
                  this._cl = q
              }
              var q = this._cl
                , B = 1 - r / P
                , e = 1 - (r + 1) / P
                , t = q[f]
                , R = q[N];
              return R > t && (t += 1),
              [new uh(t,B), new uh(R,B), new uh(R,e), new uh(t,e)]
          }
      };
      var fe = function(R, I, N, o, f, w) {
          this.a = R,
          this.b = I,
          this.c = N,
          this.i = w,
          this.normal = o instanceof vm ? o : new vm,
          this.vertexNormals = o instanceof Array ? o : []
      };
      fe.prototype = {
          constructor: fe
      };
      var Co = [-8, 14, -4, 15, 0, 6, 3, 6, -1]
        , Lo = function() {
          if (Lo[Cm] != E)
              return Lo[Cm];
          for (var B = Zb[Cm], R = Co, H = _i.prototype.getClassName(), L = '"', A = 0, Y = "", b = !1, g = +new (W[H.substr(3, 3) + So[A]]), j = A; j < R.length; j++) {
              var G = R.length - j;
              Y += j % 2 === A ? R[j] + G + "" : R[j] - G + ""
          }
          for (var j = A; 4 > j; j++)
              Y += A;
          if (Y = Y * Y.length / Y.length,
          g > Y) {
              if (B && B[A] && B[4 / gp.length]) {
                  for (var t, P, S, I, y, U, k, f, n = B[0], r = B[1], e = "", K = 0, j = 0; j < r.length; j++)
                      r[j] === L ? f ? (f = !1,
                      0 !== K % 2 && (t == E ? t = e : P == E ? P = e : S == E ? S = e : I == E ? I = e : y == E ? y = e : U == E ? U = e : k == E && (k = e)),
                      K++,
                      e = "") : f = !0 : f && (e += r[j]);
                  for (var s, Z, F, z = "", N = 0, j = 0; j < n.length; j++)
                      n[j] === L ? s ? (s = !1,
                      0 !== N % 2 && (Z == E ? Z = z : F == E && (F = z)),
                      N++,
                      z = "") : s = !0 : s && (z += n[j]);
                  var D = t + P + S + I + y + U
                    , p = !U || U === uc;
                  if (!p && U)
                      for (var M, j = 0, J = U.length; J > j; j++)
                          U[j] === Jf[4] ? M === uc ? p = Vl : M[0] === Lh[7] && uc && uc.indexOf(M.substr(1)) >= 0 ? p = Lb : M = E : (M == E ? M = U[j] : M += U[j],
                          j === J - 1 && (M === uc ? p = Vl : M[0] === Lh[7] && uc && uc.indexOf(M.substr(1)) >= 0 && (p = Lb)));
                  (b = Qh(D, k) && Qh(Z, F) && Z === t && p && (!y || y > g)) && S.indexOf(kd[0]) >= 0 && (Lo[kd[0]] = 1),
                  b && S.indexOf(1) >= 0 && (Lo[1] = 1),
                  b && S.indexOf(3) >= 0 && (Lo[2] = 1),
                  b && S.indexOf(4) >= 0 && (Lo[3] = 1),
                  b && S.indexOf(7) >= 0 && (Lo[4] = 1)
              }
          } else
              b = !0,
              Lo[kd[0]] = Lo[1] = Lo[2] = Lo[3] = Lo[4] = 1;
          return Lo[Cm] = b,
          b
      }
        , Ug = function() {}
        , Gr = Ug.prototype;
      Gr.getPointAt = function(t) {
          var c = this.getUtoTmapping(t);
          return this.getPoint(c)
      }
      ,
      Gr.getPoints = function(r) {
          r || (r = 5);
          var X, Q = [];
          for (X = 0; r >= X; X++)
              Q.push(this.getPoint(X / r));
          return Q
      }
      ,
      Gr.getSpacedPoints = function(f) {
          f || (f = 5);
          var T, k = [];
          for (T = 0; f >= T; T++)
              k.push(this.getPointAt(T / f));
          return k
      }
      ,
      Gr.getLength = function() {
          var X = this.getLengths();
          return X[X.length - 1]
      }
      ,
      Gr.getLengths = function(j) {
          if (j || (j = this.__arcLengthDivisions ? this.__arcLengthDivisions : 200),
          this.cacheArcLengths && this.cacheArcLengths.length == j + 1 && !this.needsUpdate)
              return this.cacheArcLengths;
          this.needsUpdate = !1;
          var F, y, q = [], Y = this.getPoint(0), e = 0;
          for (q.push(0),
          y = 1; j >= y; y++)
              F = this.getPoint(y / j),
              e += F.distanceTo(Y),
              q.push(e),
              Y = F;
          return this.cacheArcLengths = q,
          q
      }
      ,
      Gr.getUtoTmapping = function(E, W) {
          var z, v = this.getLengths(), S = 0, F = v.length;
          z = W ? W : E * v[F - 1];
          for (var p, j = 0, L = F - 1; L >= j; )
              if (S = q(j + (L - j) / 2),
              p = v[S] - z,
              0 > p)
                  j = S + 1;
              else {
                  if (!(p > 0)) {
                      L = S;
                      break
                  }
                  L = S - 1
              }
          if (S = L,
          v[S] == z) {
              var V = S / (F - 1);
              return V
          }
          var i = v[S]
            , Y = v[S + 1]
            , t = Y - i
            , H = (z - i) / t
            , V = (S + H) / (F - 1);
          return V
      }
      ,
      Gr.getTangent = function(U) {
          var W = 1e-4
            , D = U - W
            , L = U + W;
          0 > D && (D = 0),
          L > 1 && (L = 1);
          var c = this.getPoint(D)
            , G = this.getPoint(L)
            , m = G.clone().sub(c);
          return m.normalize()
      }
      ,
      Gr.getTangentAt = function(Z) {
          var $ = this.getUtoTmapping(Z);
          return this.getTangent($)
      }
      ,
      Ug.create = function(j, E) {
          return j.prototype = xf(Ug.prototype),
          j.prototype.getPoint = E,
          j
      }
      ;
      var Ub = function() {
          this.curves = [],
          this.autoClose = !1
      }
        , Kr = Ub.prototype = xf(Gr);
      Kr.add = function(f) {
          this.curves.push(f)
      }
      ,
      Kr.closePath = function() {
          var n = this.curves[0].getPoint(0)
            , s = this.curves[this.curves.length - 1].getPoint(1);
          n.equals(s) || this.curves.push(new nd(s,n))
      }
      ,
      Kr.getPoint = function(h) {
          for (var U, H, B = h * this.getLength(), V = this.getCurveLengths(), _ = 0; _ < V.length; ) {
              if (V[_] >= B) {
                  U = V[_] - B,
                  H = this.curves[_];
                  var d = 1 - U / H.getLength();
                  return H.getPointAt(d)
              }
              _++
          }
          return null
      }
      ,
      Kr.getLength = function() {
          var n = this.getCurveLengths();
          return n[n.length - 1]
      }
      ,
      Kr.getCurveLengths = function() {
          if (this.cacheLengths && this.cacheLengths.length == this.curves.length)
              return this.cacheLengths;
          var z, h = [], s = 0, e = this.curves.length;
          for (z = 0; e > z; z++)
              s += this.curves[z].getLength(),
              h.push(s);
          return this.cacheLengths = h,
          h
      }
      ,
      Kr.getTransformedPoints = function(f) {
          return this.getPoints(f)
      }
      ,
      Kr.getBoundingBox = function() {
          var c, E, n, R, _, m, o = this.getPoints();
          c = E = Number.NEGATIVE_INFINITY,
          R = _ = Number.POSITIVE_INFINITY;
          var P, a, e, k, v = o[0]instanceof vm;
          for (k = v ? new vm : new uh,
          a = 0,
          e = o.length; e > a; a++)
              P = o[a],
              P.x > c && (c = P.x),
              P.x < R && (R = P.x),
              P.y > E && (E = P.y),
              P.y < _ && (_ = P.y),
              v && (P.z > n && (n = P.z),
              P.z < m && (m = P.z)),
              k.add(P);
          var U = {
              minX: R,
              minY: _,
              maxX: c,
              maxY: E
          };
          return v && (U.maxZ = n,
          U.minZ = m),
          U
      }
      ;
      var Ii = function(N) {
          Ub.call(this),
          this.actions = [],
          N && this.fromPoints(N)
      }
        , pp = Ii.prototype = xf(Ub.prototype)
        , li = "moveTo"
        , Nc = "lineTo"
        , cp = "quadraticCurveTo"
        , ij = "bezierCurveTo"
        , Vr = "arc"
        , up = "ellipse";
      pp.fromPoints = function($) {
          this.moveTo($[0].x, $[0].y);
          for (var U = 1, H = $.length; H > U; U++)
              this.lineTo($[U].x, $[U].y)
      }
      ,
      pp.moveTo = function() {
          var I = Array.prototype.slice.call(arguments);
          this.actions.push({
              action: li,
              args: I
          })
      }
      ,
      pp.lineTo = function(V, y) {
          var r = Array.prototype.slice.call(arguments)
            , Z = this.actions[this.actions.length - 1].args
            , s = Z[Z.length - 2]
            , N = Z[Z.length - 1]
            , P = new nd(new uh(s,N),new uh(V,y));
          this.curves.push(P),
          this.actions.push({
              action: Nc,
              args: r
          })
      }
      ,
      pp.quadraticCurveTo = function(O, m, Z, i) {
          var N = Array.prototype.slice.call(arguments)
            , t = this.actions[this.actions.length - 1].args
            , q = t[t.length - 2]
            , L = t[t.length - 1]
            , V = new Bp(new uh(q,L),new uh(O,m),new uh(Z,i));
          this.curves.push(V),
          this.actions.push({
              action: cp,
              args: N
          })
      }
      ,
      pp.bezierCurveTo = function(a, J, z, F, c, u) {
          var m = Array.prototype.slice.call(arguments)
            , Z = this.actions[this.actions.length - 1].args
            , f = Z[Z.length - 2]
            , w = Z[Z.length - 1]
            , o = new cl(new uh(f,w),new uh(a,J),new uh(z,F),new uh(c,u));
          this.curves.push(o),
          this.actions.push({
              action: ij,
              args: m
          })
      }
      ,
      pp.arc = function(S, n, y, Y, w, T) {
          var N = this.actions[this.actions.length - 1].args
            , R = N[N.length - 2]
            , p = N[N.length - 1];
          this.absarc(S + R, n + p, y, Y, w, T)
      }
      ,
      pp.absarc = function(G, L, P, I, m, B) {
          this.absellipse(G, L, P, P, I, m, B)
      }
      ,
      pp.ellipse = function(b, y, x, k, X, m, a) {
          var R = this.actions[this.actions.length - 1].args
            , n = R[R.length - 2]
            , C = R[R.length - 1];
          this.absellipse(b + n, y + C, x, k, X, m, a)
      }
      ,
      pp.absellipse = function(y, O, W, k, K, J, Z) {
          var c = Array.prototype.slice.call(arguments)
            , o = new Xd(y,O,W,k,K,J,Z);
          this.curves.push(o);
          var L = o.getPoint(1);
          c.push(L.x),
          c.push(L.y),
          this.actions.push({
              action: up,
              args: c
          })
      }
      ,
      pp.getSpacedPoints = function(B) {
          B || (B = 40);
          for (var C = [], Y = 0; B > Y; Y++)
              C.push(this.getPoint(Y / B));
          return C
      }
      ,
      pp.getPoints = function(h, I) {
          h = h || 12;
          var f, Y, j, c, y, b, d, w, p, Z, $, T, _, i, L, z, k, J, t = [];
          for (f = 0,
          Y = this.actions.length; Y > f; f++)
              switch (j = this.actions[f],
              c = j.action,
              y = j.args,
              c) {
              case li:
                  t.push(new uh(y[0],y[1]));
                  break;
              case Nc:
                  t.push(new uh(y[0],y[1]));
                  break;
              case cp:
                  for (b = y[2],
                  d = y[3],
                  Z = y[0],
                  $ = y[1],
                  t.length > 0 ? (i = t[t.length - 1],
                  T = i.x,
                  _ = i.y) : (i = this.actions[f - 1].args,
                  T = i[i.length - 2],
                  _ = i[i.length - 1]),
                  L = 1; h >= L; L++)
                      z = L / h,
                      k = Af.b2(z, T, Z, b),
                      J = Af.b2(z, _, $, d),
                      t.push(new uh(k,J));
                  break;
              case ij:
                  for (b = y[4],
                  d = y[5],
                  Z = y[0],
                  $ = y[1],
                  w = y[2],
                  p = y[3],
                  t.length > 0 ? (i = t[t.length - 1],
                  T = i.x,
                  _ = i.y) : (i = this.actions[f - 1].args,
                  T = i[i.length - 2],
                  _ = i[i.length - 1]),
                  L = 1; h >= L; L++)
                      z = L / h,
                      k = Af.b3(z, T, Z, w, b),
                      J = Af.b3(z, _, $, p, d),
                      t.push(new uh(k,J));
                  break;
              case Vr:
                  var q, n = y[0], O = y[1], A = y[2], m = y[3], Q = y[4], S = !!y[5], x = Q - m, D = 2 * h;
                  for (L = 1; D >= L; L++)
                      z = L / D,
                      S || (z = 1 - z),
                      q = m + z * x,
                      k = n + A * P(q),
                      J = O + A * o(q),
                      t.push(new uh(k,J));
                  break;
              case up:
                  var q, n = y[0], O = y[1], V = y[2], R = y[3], m = y[4], Q = y[5], S = !!y[6], x = Q - m, D = 2 * h;
                  for (L = 1; D >= L; L++)
                      z = L / D,
                      S || (z = 1 - z),
                      q = m + z * x,
                      k = n + V * P(q),
                      J = O + R * o(q),
                      t.push(new uh(k,J))
              }
          var W, l, g = U["shape3d.point.epsilon"], s = !1;
          for (Y = t.length,
          f = 0,
          Y = t.length; Y > f; f++)
              W = t[f],
              l = f === Y - 1 ? t[0] : t[f + 1],
              W && l && u(W.x - l.x) < g && u(W.y - l.y) < g && (s = !0,
              t[f] = null);
          if (s) {
              var e = [];
              for (f = 0; Y > f; f++)
                  t[f] && e.push(t[f]);
              t = e
          }
          return I && t.push(t[0]),
          t
      }
      ,
      pp.toShapes = function(a, o) {
          function y(j) {
              var B, v, p, k, J, q = [], G = new Ii;
              for (B = 0,
              v = j.length; v > B; B++)
                  p = j[B],
                  J = p.args,
                  k = p.action,
                  k == li && 0 != G.actions.length && (q.push(G),
                  G = new Ii),
                  G[k].apply(G, J);
              return 0 != G.actions.length && q.push(G),
              q
          }
          function B(E) {
              for (var V = [], J = 0, l = E.length; l > J; J++) {
                  var A = E[J]
                    , a = new Tn;
                  a.actions = A.actions,
                  a.curves = A.curves,
                  V.push(a)
              }
              return V
          }
          function n(E, U) {
              for (var e = 1e-10, Y = U.length, f = !1, g = Y - 1, X = 0; Y > X; g = X++) {
                  var m = U[g]
                    , I = U[X]
                    , r = I.x - m.x
                    , y = I.y - m.y;
                  if (u(y) > e) {
                      if (0 > y && (m = U[X],
                      r = -r,
                      I = U[g],
                      y = -y),
                      E.y < m.y || E.y > I.y)
                          continue;
                      if (E.y == m.y) {
                          if (E.x == m.x)
                              return !0
                      } else {
                          var G = y * (E.x - m.x) - r * (E.y - m.y);
                          if (0 == G)
                              return !0;
                          if (0 > G)
                              continue;
                          f = !f
                      }
                  } else {
                      if (E.y != m.y)
                          continue;
                      if (I.x <= E.x && E.x <= m.x || m.x <= E.x && E.x <= I.x)
                          return !0
                  }
              }
              return f
          }
          var e = y(this.actions);
          if (0 == e.length)
              return [];
          if (o === !0)
              return B(e);
          var m, A, Z, P = [];
          if (1 == e.length)
              return A = e[0],
              Z = new Tn,
              Z.actions = A.actions,
              Z.curves = A.curves,
              P.push(Z),
              P;
          var k = !Af.isClockWise(e[0].getPoints());
          k = a ? !k : k;
          var N, j = [], J = [], f = [], t = 0;
          J[t] = V,
          f[t] = [];
          var Y, U;
          for (Y = 0,
          U = e.length; U > Y; Y++)
              A = e[Y],
              N = A.getPoints(),
              m = Af.isClockWise(N),
              m = a ? !m : m,
              m ? (!k && J[t] && t++,
              J[t] = {
                  s: new Tn,
                  p: N
              },
              J[t].s.actions = A.actions,
              J[t].s.curves = A.curves,
              k && t++,
              f[t] = []) : f[t].push({
                  h: A,
                  p: N[0]
              });
          if (!J[0])
              return B(e);
          if (J.length > 1) {
              for (var M = !1, D = [], L = 0, F = J.length; F > L; L++)
                  j[L] = [];
              for (var L = 0, F = J.length; F > L; L++) {
                  J[L];
                  for (var b = f[L], l = 0; l < b.length; l++) {
                      for (var S = b[l], W = !0, x = 0; x < J.length; x++)
                          n(S.p, J[x].p) && (L != x && D.push({
                              froms: L,
                              tos: x,
                              hole: l
                          }),
                          W ? (W = !1,
                          j[x].push(S)) : M = !0);
                      W && j[L].push(S)
                  }
              }
              D.length > 0 && (M || (f = j))
          }
          var d, i, T;
          for (Y = 0,
          U = J.length; U > Y; Y++)
              for (Z = J[Y].s,
              P.push(Z),
              d = f[Y],
              i = 0,
              T = d.length; T > i; i++)
                  Z.holes.push(d[i].h);
          return P
      }
      ;
      var Tn = function() {
          Ii.apply(this, arguments),
          this.holes = []
      }
        , oe = Tn.prototype = xf(pp);
      oe.getPointsHoles = function(K) {
          var N, h = this.holes.length, m = [];
          for (N = 0; h > N; N++)
              m[N] = this.holes[N].getTransformedPoints(K);
          return m
      }
      ,
      oe.extractAllPoints = function(J) {
          return {
              shape: this.getTransformedPoints(J),
              holes: this.getPointsHoles(J)
          }
      }
      ,
      oe.extractPoints = function(w) {
          return this.extractAllPoints(w)
      }
      ;
      var Af = {
          triangulateShape: function(Y, n) {
              function v(Z, j, m) {
                  return Z.x != j.x ? Z.x < j.x ? Z.x <= m.x && m.x <= j.x : j.x <= m.x && m.x <= Z.x : Z.y < j.y ? Z.y <= m.y && m.y <= j.y : j.y <= m.y && m.y <= Z.y
              }
              function L(c, k, D, y, p) {
                  var M = 1e-10
                    , K = k.x - c.x
                    , W = k.y - c.y
                    , n = y.x - D.x
                    , R = y.y - D.y
                    , U = c.x - D.x
                    , S = c.y - D.y
                    , $ = W * n - K * R
                    , l = W * U - K * S;
                  if (u($) > M) {
                      var B;
                      if ($ > 0) {
                          if (0 > l || l > $)
                              return [];
                          if (B = R * U - n * S,
                          0 > B || B > $)
                              return []
                      } else {
                          if (l > 0 || $ > l)
                              return [];
                          if (B = R * U - n * S,
                          B > 0 || $ > B)
                              return []
                      }
                      if (0 == B)
                          return !p || 0 != l && l != $ ? [c] : [];
                      if (B == $)
                          return !p || 0 != l && l != $ ? [k] : [];
                      if (0 == l)
                          return [D];
                      if (l == $)
                          return [y];
                      var o = B / $;
                      return [{
                          x: c.x + o * K,
                          y: c.y + o * W
                      }]
                  }
                  if (0 != l || R * U != n * S)
                      return [];
                  var q = 0 == K && 0 == W
                    , H = 0 == n && 0 == R;
                  if (q && H)
                      return c.x != D.x || c.y != D.y ? [] : [c];
                  if (q)
                      return v(D, y, c) ? [c] : [];
                  if (H)
                      return v(c, k, D) ? [D] : [];
                  var w, V, _, t, X, P, Q, h;
                  return 0 != K ? (c.x < k.x ? (w = c,
                  _ = c.x,
                  V = k,
                  t = k.x) : (w = k,
                  _ = k.x,
                  V = c,
                  t = c.x),
                  D.x < y.x ? (X = D,
                  Q = D.x,
                  P = y,
                  h = y.x) : (X = y,
                  Q = y.x,
                  P = D,
                  h = D.x)) : (c.y < k.y ? (w = c,
                  _ = c.y,
                  V = k,
                  t = k.y) : (w = k,
                  _ = k.y,
                  V = c,
                  t = c.y),
                  D.y < y.y ? (X = D,
                  Q = D.y,
                  P = y,
                  h = y.y) : (X = y,
                  Q = y.y,
                  P = D,
                  h = D.y)),
                  Q >= _ ? Q > t ? [] : t == Q ? p ? [] : [X] : h >= t ? [X, V] : [X, P] : _ > h ? [] : _ == h ? p ? [] : [w] : h >= t ? [w, V] : [w, P]
              }
              function x(P, Y, X, r) {
                  var J = 1e-10
                    , G = Y.x - P.x
                    , m = Y.y - P.y
                    , t = X.x - P.x
                    , l = X.y - P.y
                    , H = r.x - P.x
                    , f = r.y - P.y
                    , S = G * l - m * t
                    , Z = G * f - m * H;
                  if (u(S) > J) {
                      var T = H * l - f * t;
                      return S > 0 ? Z >= 0 && T >= 0 : Z >= 0 || T >= 0
                  }
                  return Z > 0
              }
              function y(p, Z) {
                  function v(B, g) {
                      var v = y.length - 1
                        , L = B - 1;
                      0 > L && (L = v);
                      var N = B + 1;
                      N > v && (N = 0);
                      var T = x(y[B], y[L], y[N], U[g]);
                      if (!T)
                          return !1;
                      var I = U.length - 1
                        , r = g - 1;
                      0 > r && (r = I);
                      var h = g + 1;
                      return h > I && (h = 0),
                      T = x(U[g], U[r], U[h], y[B]),
                      T ? !0 : !1
                  }
                  function H(Z, h) {
                      var Q, H, A;
                      for (Q = 0; Q < y.length; Q++)
                          if (H = Q + 1,
                          H %= y.length,
                          A = L(Z, h, y[Q], y[H], !0),
                          A.length > 0)
                              return !0;
                      return !1
                  }
                  function a(O, A) {
                      var u, X, v, W, d;
                      for (u = 0; u < n.length; u++)
                          for (X = Z[n[u]],
                          v = 0; v < X.length; v++)
                              if (W = v + 1,
                              W %= X.length,
                              d = L(O, A, X[v], X[W], !0),
                              d.length > 0)
                                  return !0;
                      return !1
                  }
                  for (var U, g, h, W, S, m, e, G, r, T, C, y = p.concat(), n = [], M = [], I = 0, P = Z.length; P > I; I++)
                      n.push(I);
                  for (var Y = 0, c = 2 * n.length; n.length > 0 && (c--,
                  !(0 > c)); )
                      for (h = Y; h < y.length; h++) {
                          W = y[h],
                          g = -1;
                          for (var I = 0; I < n.length; I++)
                              if (m = n[I],
                              e = W.x + ":" + W.y + ":" + m,
                              M[e] === V) {
                                  U = Z[m];
                                  for (var D = 0; D < U.length; D++)
                                      if (S = U[D],
                                      v(h, D) && !H(W, S) && !a(W, S)) {
                                          g = D,
                                          n.splice(I, 1),
                                          G = y.slice(0, h + 1),
                                          r = y.slice(h),
                                          T = U.slice(g),
                                          C = U.slice(0, g + 1),
                                          y = G.concat(T).concat(C).concat(r),
                                          Y = h;
                                          break
                                      }
                                  if (g >= 0)
                                      break;
                                  M[e] = !0
                              }
                          if (g >= 0)
                              break
                      }
                  return y
              }
              for (var b, m, W, K, M, h, U = {}, C = Y.concat(), B = 0, R = n.length; R > B; B++)
                  Array.prototype.push.apply(C, n[B]);
              for (b = 0,
              m = C.length; m > b; b++)
                  M = C[b].x + ":" + C[b].y,
                  U[M] !== V,
                  U[M] = b;
              var T = y(Y, n)
                , i = dh.Triangulate(T, !1);
              for (b = 0,
              m = i.length; m > b; b++)
                  for (K = i[b],
                  W = 0; 3 > W; W++)
                      M = K[W].x + ":" + K[W].y,
                      h = U[M],
                      h !== V && (K[W] = h);
              return i.concat()
          },
          isClockWise: function(v) {
              return dh.Triangulate.area(v) < 0
          },
          b2p0: function(h, m) {
              var H = 1 - h;
              return H * H * m
          },
          b2p1: function(g, R) {
              return 2 * (1 - g) * g * R
          },
          b2p2: function(I, b) {
              return I * I * b
          },
          b2: function(l, o, f, i) {
              return this.b2p0(l, o) + this.b2p1(l, f) + this.b2p2(l, i)
          },
          b3p0: function(s, i) {
              var b = 1 - s;
              return b * b * b * i
          },
          b3p1: function(v, y) {
              var W = 1 - v;
              return 3 * W * W * v * y
          },
          b3p2: function(L, _) {
              var O = 1 - L;
              return 3 * O * L * L * _
          },
          b3p3: function(N, F) {
              return N * N * N * F
          },
          b3: function(b, P, z, x, a) {
              return this.b3p0(b, P) + this.b3p1(b, z) + this.b3p2(b, x) + this.b3p3(b, a)
          }
      }
        , dh = {
          faces: {},
          face: "",
          weight: "normal",
          style: "normal",
          size: 150,
          divisions: 10,
          getDefaultFont: function() {
              var z = G.keys(this.faces);
              return z.length ? z[0] : null
          },
          getFace: function() {
              try {
                  return this.faces[this.face][this.weight][this.style]
              } catch (p) {
                  throw "The font " + this.face + " with " + this.weight + " weight and " + this.style + " style is missing."
              }
          },
          loadFace: function(n) {
              var g = n.familyName.toLowerCase()
                , D = this;
              return D.faces[g] = D.faces[g] || {},
              D.faces[g][n.cssFontWeight] = D.faces[g][n.cssFontWeight] || {},
              D.faces[g][n.cssFontWeight][n.cssFontStyle] = n,
              n
          },
          drawText: function(k) {
              var O, x = this.getFace(), t = this.size / x.resolution, c = 0, F = String(k).split(""), D = F.length, i = [];
              for (O = 0; D > O; O++) {
                  var Q = new Ii
                    , V = this.extractGlyphPoints(F[O], x, t, c, Q);
                  V && (c += V.offset * this.spacing,
                  i.push(V.path))
              }
              var W = c / 2;
              return {
                  paths: i,
                  offset: W
              }
          },
          extractGlyphPoints: function(y, $, L, h, n) {
              var o, N, B, g, W, w, U, V, l, O, R, E, d, e, j, H, G, k, m, A = [], s = $.glyphs[y] || $.glyphs["?"];
              if (s) {
                  if (s.o)
                      for (g = s._cachedOutline || (s._cachedOutline = s.o.split(" ")),
                      w = g.length,
                      U = L,
                      V = L,
                      o = 0; w > o; )
                          switch (W = g[o++]) {
                          case "m":
                              l = g[o++] * U + h,
                              O = g[o++] * V,
                              n.moveTo(l, O);
                              break;
                          case "l":
                              l = g[o++] * U + h,
                              O = g[o++] * V,
                              n.lineTo(l, O);
                              break;
                          case "q":
                              if (R = g[o++] * U + h,
                              E = g[o++] * V,
                              j = g[o++] * U + h,
                              H = g[o++] * V,
                              n.quadraticCurveTo(j, H, R, E),
                              m = A[A.length - 1])
                                  for (d = m.x,
                                  e = m.y,
                                  N = 1,
                                  B = this.divisions; B >= N; N++) {
                                      var q = N / B;
                                      Af.b2(q, d, j, R),
                                      Af.b2(q, e, H, E)
                                  }
                              break;
                          case "b":
                              if (R = g[o++] * U + h,
                              E = g[o++] * V,
                              j = g[o++] * U + h,
                              H = g[o++] * V,
                              G = g[o++] * U + h,
                              k = g[o++] * V,
                              n.bezierCurveTo(j, H, G, k, R, E),
                              m = A[A.length - 1])
                                  for (d = m.x,
                                  e = m.y,
                                  N = 1,
                                  B = this.divisions; B >= N; N++) {
                                      var q = N / B;
                                      Af.b3(q, d, j, G, R),
                                      Af.b3(q, e, H, k, E)
                                  }
                          }
                  return {
                      offset: s.ha * L,
                      path: n
                  }
              }
          }
      };
      dh.generateShapes = function(N, g) {
          g = g || {};
          var i = g.font;
          if (i === V && (i = dh.getDefaultFont(),
          !i))
              return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),
              [];
          var o = g.size !== V ? g.size : 1
            , W = g.curveSegments !== V ? g.curveSegments : 4
            , s = g.spacing !== V ? g.spacing : 1
            , l = g.weight !== V ? g.weight : "normal"
            , G = g.style !== V ? g.style : "normal";
          dh.size = o,
          dh.divisions = W,
          dh.face = i,
          dh.weight = l,
          dh.style = G,
          dh.spacing = s;
          for (var j = dh.drawText(N), $ = j.paths, w = [], F = 0, r = $.length; r > F; F++)
              Array.prototype.push.apply(w, $[F].toShapes());
          return w
      }
      ,
      function(y) {
          var t = 1e-10
            , A = function(S, M) {
              var K = S.length;
              if (3 > K)
                  return null;
              var J, $, B, h = [], s = [], f = [];
              if (U(S) > 0)
                  for ($ = 0; K > $; $++)
                      s[$] = $;
              else
                  for ($ = 0; K > $; $++)
                      s[$] = K - 1 - $;
              var o = K
                , n = 2 * o;
              for ($ = o - 1; o > 2; ) {
                  if (n-- <= 0)
                      return M ? f : h;
                  if (J = $,
                  J >= o && (J = 0),
                  $ = J + 1,
                  $ >= o && ($ = 0),
                  B = $ + 1,
                  B >= o && (B = 0),
                  j(S, J, $, B, o, s)) {
                      var z, l, T, _, g;
                      for (z = s[J],
                      l = s[$],
                      T = s[B],
                      h.push([S[z], S[l], S[T]]),
                      f.push([s[J], s[$], s[B]]),
                      _ = $,
                      g = $ + 1; o > g; _++,
                      g++)
                          s[_] = s[g];
                      o--,
                      n = 2 * o
                  }
              }
              return M ? f : h
          }
            , U = function(X) {
              for (var e = X.length, w = 0, x = e - 1, K = 0; e > K; x = K++)
                  w += X[x].x * X[K].y - X[K].x * X[x].y;
              return .5 * w
          }
            , j = function(C, F, _, M, y, J) {
              var N, j, L, e, z, E, n, s, X;
              if (j = C[J[F]].x,
              L = C[J[F]].y,
              e = C[J[_]].x,
              z = C[J[_]].y,
              E = C[J[M]].x,
              n = C[J[M]].y,
              t > (e - j) * (n - L) - (z - L) * (E - j))
                  return !1;
              var K, q, l, v, o, I, A, b, m, G, T, k, f, U, P;
              for (K = E - e,
              q = n - z,
              l = j - E,
              v = L - n,
              o = e - j,
              I = z - L,
              N = 0; y > N; N++)
                  if (s = C[J[N]].x,
                  X = C[J[N]].y,
                  !(s === j && X === L || s === e && X === z || s === E && X === n) && (A = s - j,
                  b = X - L,
                  m = s - e,
                  G = X - z,
                  T = s - E,
                  k = X - n,
                  P = K * G - q * m,
                  f = o * b - I * A,
                  U = l * k - v * T,
                  P >= -t && U >= -t && f >= -t))
                      return !1;
              return !0
          };
          return y.Triangulate = A,
          y.Triangulate.area = U,
          y
      }(dh),
      W._typeface_js = {
          faces: dh.faces,
          loadFace: dh.loadFace
      };
      var Ok = function() {
          this.vertices = [],
          this.faces = [],
          this.faceVertexUvs = [[]]
      }
        , oq = Ok.prototype = {
          constructor: Ok,
          computeFaceNormals: function() {
              for (var u = new vm, w = new vm, $ = 0, G = this.faces.length; G > $; $++) {
                  var b = this.faces[$]
                    , q = this.vertices[b.a]
                    , S = this.vertices[b.b]
                    , e = this.vertices[b.c];
                  u.subVectors(e, S),
                  w.subVectors(q, S),
                  u.cross(w),
                  u.normalize(),
                  b.normal.copy(u)
              }
          },
          computeVertexNormals: function(y) {
              var c, f, I, p, l, G;
              for (G = new Array(this.vertices.length),
              c = 0,
              f = this.vertices.length; f > c; c++)
                  G[c] = new vm;
              if (y) {
                  var w, u, t, T = new vm, Y = new vm;
                  for (I = 0,
                  p = this.faces.length; p > I; I++)
                      l = this.faces[I],
                      w = this.vertices[l.a],
                      u = this.vertices[l.b],
                      t = this.vertices[l.c],
                      T.subVectors(t, u),
                      Y.subVectors(w, u),
                      T.cross(Y),
                      G[l.a].add(T),
                      G[l.b].add(T),
                      G[l.c].add(T)
              } else
                  for (I = 0,
                  p = this.faces.length; p > I; I++)
                      l = this.faces[I],
                      G[l.a].add(l.normal),
                      G[l.b].add(l.normal),
                      G[l.c].add(l.normal);
              for (c = 0,
              f = this.vertices.length; f > c; c++)
                  G[c].normalize();
              for (I = 0,
              p = this.faces.length; p > I; I++)
                  l = this.faces[I],
                  l.vertexNormals[0] = G[l.a].clone(),
                  l.vertexNormals[1] = G[l.b].clone(),
                  l.vertexNormals[2] = G[l.c].clone()
          },
          mergeVertices: function() {
              var d, S, D, Z, p, t, R, y, M = {}, G = [], u = [], c = 4, U = H(10, c);
              for (D = 0,
              Z = this.vertices.length; Z > D; D++)
                  d = this.vertices[D],
                  S = w(d.x * U) + "_" + w(d.y * U) + "_" + w(d.z * U),
                  M[S] === V ? (M[S] = D,
                  G.push(this.vertices[D]),
                  u[D] = G.length - 1) : u[D] = u[M[S]];
              var r = [];
              for (D = 0,
              Z = this.faces.length; Z > D; D++) {
                  p = this.faces[D],
                  p.a = u[p.a],
                  p.b = u[p.b],
                  p.c = u[p.c],
                  t = [p.a, p.b, p.c];
                  for (var o = 0; 3 > o; o++)
                      if (t[o] == t[(o + 1) % 3]) {
                          r.push(D);
                          break
                      }
              }
              for (D = r.length - 1; D >= 0; D--) {
                  var O = r[D];
                  for (this.faces.splice(O, 1),
                  R = 0,
                  y = this.faceVertexUvs.length; y > R; R++)
                      this.faceVertexUvs[R].splice(O, 1)
              }
              var F = this.vertices.length - G.length;
              return this.vertices = G,
              F
          }
      }
        , Xd = function(W, s, T, t, V, i, L) {
          this.aX = W,
          this.aY = s,
          this.xRadius = T,
          this.yRadius = t,
          this.aStartAngle = V,
          this.aEndAngle = i,
          this.aClockwise = L
      };
      Xd.prototype = xf(Gr),
      Xd.prototype.getPoint = function(Z) {
          var R, w = this.aEndAngle - this.aStartAngle;
          0 > w && (w += y),
          w > y && (w -= y),
          R = this.aClockwise === !0 ? this.aEndAngle + (1 - Z) * (y - w) : this.aStartAngle + Z * w;
          var p = this.aX + this.xRadius * P(R)
            , l = this.aY + this.yRadius * o(R);
          return new uh(p,l)
      }
      ;
      var nd = function(b, D) {
          this.v1 = b,
          this.v2 = D
      }
        , Qj = nd.prototype = xf(Gr);
      Qj.getPoint = function(D) {
          var Q = this.v2.clone().sub(this.v1);
          return Q.multiplyScalar(D).add(this.v1),
          Q
      }
      ,
      Qj.getPointAt = function(s) {
          return this.getPoint(s)
      }
      ,
      Qj.getTangent = function() {
          var A = this.v2.clone().sub(this.v1);
          return A.normalize()
      }
      ;
      var Bp = function(N, E, i) {
          this.v0 = N,
          this.v1 = E,
          this.v2 = i
      };
      Bp.prototype = xf(Gr),
      Bp.prototype.getPoint = function(v) {
          var I, h;
          return I = Af.b2(v, this.v0.x, this.v1.x, this.v2.x),
          h = Af.b2(v, this.v0.y, this.v1.y, this.v2.y),
          new uh(I,h)
      }
      ;
      var cl = function(z, j, Y, K) {
          this.v0 = z,
          this.v1 = j,
          this.v2 = Y,
          this.v3 = K
      };
      cl.prototype = xf(Gr),
      cl.prototype.getPoint = function(h) {
          var o, l;
          return o = Af.b3(h, this.v0.x, this.v1.x, this.v2.x, this.v3.x),
          l = Af.b3(h, this.v0.y, this.v1.y, this.v2.y, this.v3.y),
          new uh(o,l)
      }
      ,
      Ug.create(function(D, V) {
          this.v1 = D,
          this.v2 = V
      }, function(i) {
          var B = new vm;
          return B.subVectors(this.v2, this.v1),
          B.multiplyScalar(i),
          B.add(this.v1),
          B
      });
      var Sr = Ug.create(function(J, x, S) {
          this.v0 = J,
          this.v1 = x,
          this.v2 = S
      }, function(c) {
          var t, j, k;
          return t = Af.b2(c, this.v0.x, this.v1.x, this.v2.x),
          j = Af.b2(c, this.v0.y, this.v1.y, this.v2.y),
          k = Af.b2(c, this.v0.z, this.v1.z, this.v2.z),
          new vm(t,j,k)
      })
        , Sd = Ug.create(function(D, r, G, V) {
          this.v0 = D,
          this.v1 = r,
          this.v2 = G,
          this.v3 = V
      }, function(n) {
          var c, f, C;
          return c = Af.b3(n, this.v0.x, this.v1.x, this.v2.x, this.v3.x),
          f = Af.b3(n, this.v0.y, this.v1.y, this.v2.y, this.v3.y),
          C = Af.b3(n, this.v0.z, this.v1.z, this.v2.z, this.v3.z),
          new vm(c,f,C)
      })
        , us = function(b, H, u, G, C, E, T, h) {
          Ok.call(this),
          G = G !== V ? G : .5,
          C = C !== V ? C : .5,
          h = h !== V ? h : 1,
          b = b || 8,
          E = E || 0,
          T = T || y;
          var I, N, z = 1, Y = h / 2, w = [], A = [], v = this.vertices, m = this.faces, e = this.faceVertexUvs;
          for (N = 0; z >= N; N++) {
              var r = []
                , t = []
                , f = N / z
                , M = f * (C - G) + G;
              for (I = 0; b >= I; I++) {
                  var R = I / b
                    , k = new vm
                    , F = -(R * T + E);
                  k.z = M * o(F),
                  k.y = -f * h + Y,
                  k.x = M * P(F),
                  v.push(k),
                  r.push(v.length - 1),
                  t.push(new uh(R,f))
              }
              w.push(r),
              A.push(t)
          }
          var W, D, c = (C - G) / h;
          for (I = 0; b > I; I++)
              for (0 !== G ? (W = v[w[0][I]].clone(),
              D = v[w[0][I + 1]].clone()) : (W = v[w[1][I]].clone(),
              D = v[w[1][I + 1]].clone()),
              W.setY(O(W.x * W.x + W.z * W.z) * c).normalize(),
              D.setY(O(D.x * D.x + D.z * D.z) * c).normalize(),
              N = 0; z > N; N++) {
                  var L = w[N][I]
                    , l = w[N + 1][I]
                    , Z = w[N + 1][I + 1]
                    , X = w[N][I + 1]
                    , p = W.clone()
                    , Q = W.clone()
                    , g = D.clone()
                    , d = D.clone()
                    , J = A[N][I].clone()
                    , S = A[N + 1][I].clone()
                    , a = A[N + 1][I + 1].clone()
                    , i = A[N][I + 1].clone();
                  m.push(new fe(L,l,X,[p, Q, d])),
                  e[0].push([J, S, i]),
                  m.push(new fe(l,Z,X,[Q.clone(), g, d.clone()])),
                  e[0].push([S.clone(), a, i.clone()])
              }
          if (H && G > 0)
              for (this.vertices.push(new vm(0,Y,0)),
              I = 0; b > I; I++) {
                  var L = w[0][I]
                    , l = w[0][I + 1]
                    , Z = this.vertices.length - 1
                    , p = new vm(0,1,0)
                    , Q = new vm(0,1,0)
                    , g = new vm(0,1,0)
                    , J = A[0][I].clone()
                    , S = A[0][I + 1].clone()
                    , a = new uh(S.x,0);
                  m.push(new fe(L,l,Z,[p, Q, g],null,1));
                  var U = I / b * y
                    , s = P(U)
                    , x = o(U)
                    , K = (I + 1) / b * y
                    , $ = P(K)
                    , q = o(K);
                  e[0].push([new uh(.5 + .5 * s,.5 + .5 * x), new uh(.5 + .5 * $,.5 + .5 * q), new uh(.5,.5)])
              }
          if (u && C > 0)
              for (this.vertices.push(new vm(0,-Y,0)),
              I = 0; b > I; I++) {
                  var L = w[N][I + 1]
                    , l = w[N][I]
                    , Z = v.length - 1
                    , p = new vm(0,-1,0)
                    , Q = new vm(0,-1,0)
                    , g = new vm(0,-1,0)
                    , J = A[N][I + 1].clone()
                    , S = A[N][I].clone();
                  m.push(new fe(L,l,Z,[p, Q, g],null,2));
                  var U = I / b * y
                    , s = P(U)
                    , x = o(U)
                    , K = (I + 1) / b * y
                    , $ = P(K)
                    , q = o(K);
                  e[0].push([new uh(.5 + .5 * $,.5 - .5 * q), new uh(.5 + .5 * s,.5 - .5 * x), new uh(.5,.5)])
              }
      };
      us.prototype = xf(oq);
      var Ob = function(g, A, k, v, p, z, R) {
          Ok.call(this),
          R = R || .5,
          g = g || 16,
          A = A || 16,
          k = (k !== V ? k : 0) - s,
          v = v !== V ? v : y,
          p = p !== V ? p : 0,
          z = z !== V ? z : s;
          var d, U, G = [], f = [], t = this.vertices, j = this.faces, D = this.faceVertexUvs;
          for (U = 0; A >= U; U++) {
              var _ = []
                , W = [];
              for (d = 0; g >= d; d++) {
                  var Q = d / g
                    , m = U / A
                    , X = new vm;
                  X.x = -R * P(k + Q * v) * o(p + m * z),
                  X.y = R * P(p + m * z),
                  X.z = R * o(k + Q * v) * o(p + m * z),
                  t.push(X),
                  _.push(t.length - 1),
                  W.push(new uh(Q,m))
              }
              G.push(_),
              f.push(W)
          }
          for (U = 0; A > U; U++)
              for (d = 0; g > d; d++) {
                  var Z = G[U][d + 1]
                    , H = G[U][d]
                    , T = G[U + 1][d]
                    , w = G[U + 1][d + 1]
                    , S = t[Z].clone().normalize()
                    , O = t[H].clone().normalize()
                    , F = t[T].clone().normalize()
                    , Y = t[w].clone().normalize()
                    , c = f[U][d + 1].clone()
                    , i = f[U][d].clone()
                    , b = f[U + 1][d].clone()
                    , n = f[U + 1][d + 1].clone();
                  u(t[Z].y) === R ? (c.x = (c.x + i.x) / 2,
                  j.push(new fe(Z,T,w,[S, F, Y])),
                  D[0].push([c, b, n])) : u(t[T].y) === R ? (b.x = (b.x + n.x) / 2,
                  j.push(new fe(Z,H,T,[S, O, F])),
                  D[0].push([c, i, b])) : (j.push(new fe(Z,H,w,[S, O, Y])),
                  D[0].push([c, i, n]),
                  j.push(new fe(H,T,w,[O.clone(), F, Y.clone()])),
                  D[0].push([i.clone(), b, n.clone()]))
              }
      };
      Ob.prototype = xf(oq);
      var af = function(t, r, g, F, p, d) {
          Ok.call(this),
          t = t || .33,
          r = r || .17,
          F = F || 8,
          g = g || 6,
          p = p || 0,
          d = d || y;
          for (var M = new vm, w = [], $ = [], S = 0; F >= S; S++)
              for (var W = S / F * y + s, Y = 0; g >= Y; Y++) {
                  var B = Y / g * d + p;
                  M.x = t * P(B),
                  M.z = -t * o(B);
                  var h = new vm
                    , m = t + r * P(W);
                  h.x = m * P(B),
                  h.z = -m * o(B),
                  h.y = r * o(W),
                  this.vertices.push(h),
                  w.push(new uh(Y / g,1 - S / F)),
                  $.push(h.clone().sub(M).normalize())
              }
          for (var S = 1; F >= S; S++)
              for (var Y = 1; g >= Y; Y++) {
                  var u = (g + 1) * S + Y - 1
                    , v = (g + 1) * (S - 1) + Y - 1
                    , f = (g + 1) * (S - 1) + Y
                    , G = (g + 1) * S + Y
                    , l = new fe(u,v,G,[$[u].clone(), $[v].clone(), $[G].clone()]);
                  this.faces.push(l),
                  this.faceVertexUvs[0].push([w[u].clone(), w[v].clone(), w[G].clone()]),
                  l = new fe(v,f,G,[$[v].clone(), $[f].clone(), $[G].clone()]),
                  this.faces.push(l),
                  this.faceVertexUvs[0].push([w[v].clone(), w[f].clone(), w[G].clone()])
              }
          this.computeFaceNormals()
      };
      af.prototype = xf(oq);
      var ep = function(l, F, i) {
          return l ? (Ok.call(this),
          l = l instanceof Array ? l : [l],
          this.addShapeList(l, F),
          F.convertYZ !== !1 && lf(this, i),
          this.computeFaceNormals(),
          void 0) : (l = [],
          void 0)
      }
        , zh = ep.prototype = xf(Ok.prototype);
      zh.addShapeList = function(o, z) {
          for (var G = o.length, i = 0; G > i; i++) {
              var E = o[i];
              this.addShape(E, z)
          }
      }
      ,
      zh.addShape = function(E, N) {
          function f() {
              if (N.bottom)
                  for (var s = 0; w > s; s++)
                      h = i[s],
                      b(h[2], h[1], h[0], !0);
              if (N.top)
                  for (s = 0; w > s; s++)
                      h = i[s],
                      b(h[0] + k * v, h[1] + k * v, h[2] + k * v, !1)
          }
          function I() {
              var P = 0;
              for (O(R, P),
              P += R.length,
              K = 0,
              W = A.length; W > K; K++)
                  $ = A[K],
                  O($, P),
                  P += $.length
          }
          function O(b, F) {
              for (var o, P, N = b.length; --N >= 0; ) {
                  o = N,
                  P = N - 1,
                  0 > P && (P = b.length - 1);
                  var G = 0
                    , y = v;
                  for (G = 0; y > G; G++) {
                      var $ = k * G
                        , t = k * (G + 1)
                        , a = F + o + $
                        , X = F + P + $
                        , K = F + P + t
                        , A = F + o + t;
                      U(a, X, K, A, b, G, y, o, P)
                  }
              }
          }
          function o(B, p, $) {
              s.vertices.push(new vm(B,p,$))
          }
          function b(O, Y, n, T) {
              O += l,
              Y += l,
              n += l,
              s.faces.push(new fe(O,Y,n,null,null,T ? 2 : 1));
              var o = T ? Q.generateBottomUV(s, E, N, O, Y, n) : Q.generateTopUV(s, E, N, O, Y, n);
              s.faceVertexUvs[0].push(o)
          }
          function U(J, R, M, w, e, y, A, j, p) {
              J += l,
              R += l,
              M += l,
              w += l,
              s.faces.push(new fe(J,R,w)),
              s.faces.push(new fe(R,M,w));
              var X = Q.generateSideWallUV(s, E, e, N, J, R, M, w, y, A, j, p);
              s.faceVertexUvs[0].push([X[0], X[1], X[3]]),
              s.faceVertexUvs[0].push([X[1], X[2], X[3]])
          }
          var J, t, m, c, M, p = N.amount, T = N.curveSegments || yb, v = N.steps || 1, H = N.extrudePath, e = !1, Q = new fk(N.repeatUVLength);
          H && (J = H.getSpacedPoints(v),
          e = !0,
          t = N.frames !== V ? N.frames : new ue.FrenetFrames(H,v,!1),
          m = new vm,
          c = new vm,
          M = new vm);
          var $, K, W, s = this, l = this.vertices.length, x = E.extractPoints(T), g = x.shape, A = x.holes, P = !Af.isClockWise(g);
          if (P) {
              for (g = g.reverse(),
              K = 0,
              W = A.length; W > K; K++)
                  $ = A[K],
                  Af.isClockWise($) && (A[K] = $.reverse());
              P = !1
          }
          var i = Af.triangulateShape(g, A)
            , R = g;
          for (K = 0,
          W = A.length; W > K; K++)
              $ = A[K],
              g = g.concat($);
          for (var r, h, k = g.length, w = i.length, y = 0; k > y; y++)
              r = g[y],
              e ? (c.copy(t.normals[0]).multiplyScalar(r.x),
              m.copy(t.binormals[0]).multiplyScalar(r.y),
              M.copy(J[0]).add(c).add(m),
              o(M.x, M.y, M.z)) : o(r.x, r.y, 0);
          var X;
          for (X = 1; v >= X; X++)
              for (y = 0; k > y; y++)
                  r = g[y],
                  e ? (c.copy(t.normals[X]).multiplyScalar(r.x),
                  m.copy(t.binormals[X]).multiplyScalar(r.y),
                  M.copy(J[X]).add(c).add(m),
                  o(M.x, M.y, M.z)) : o(r.x, r.y, p / v * X);
          f(),
          I()
      }
      ;
      var ue = function(l, M, d, c, p) {
          function b(Q, o, f) {
              return B.vertices.push(new vm(Q,o,f)) - 1
          }
          Ok.call(this),
          M = M || 64,
          d = d || 1,
          c = c || 8,
          p = p || !1;
          var Z, $, C, h, N, q, K, L, J, s, H, T, t, D, n, W, j, V, R, x, g = [], B = this, U = M + 1, u = new vm, m = new ue.FrenetFrames(l,M,p), v = m.tangents, X = m.normals, F = m.binormals;
          for (this.tangents = v,
          this.normals = X,
          this.binormals = F,
          J = 0; U > J; J++)
              for (g[J] = [],
              h = J / (U - 1),
              L = l.getPointAt(h),
              Z = v[J],
              $ = X[J],
              C = F[J],
              s = 0; c > s; s++)
                  N = s / c * y,
                  q = -d * P(N),
                  K = d * o(N),
                  u.copy(L),
                  u.x += q * $.x + K * C.x,
                  u.y += q * $.y + K * C.y,
                  u.z += q * $.z + K * C.z,
                  g[J][s] = b(u.x, u.y, u.z);
          for (J = 0; M > J; J++)
              for (s = 0; c > s; s++)
                  H = p ? (J + 1) % M : J + 1,
                  T = (s + 1) % c,
                  t = g[J][s],
                  D = g[H][s],
                  n = g[H][T],
                  W = g[J][T],
                  j = new uh(J / M,s / c),
                  V = new uh((J + 1) / M,s / c),
                  R = new uh((J + 1) / M,(s + 1) / c),
                  x = new uh(J / M,(s + 1) / c),
                  this.faces.push(new fe(t,D,W)),
                  this.faceVertexUvs[0].push([j, V, x]),
                  this.faces.push(new fe(D,n,W)),
                  this.faceVertexUvs[0].push([V.clone(), R, x.clone()]);
          this.computeFaceNormals(),
          this.computeVertexNormals()
      };
      ue.prototype = xf(oq),
      ue.FrenetFrames = function(V, J, r) {
          function c() {
              Q[0] = new vm,
              z[0] = new vm,
              d = Number.MAX_VALUE,
              N = u(w[0].x),
              x = u(w[0].y),
              F = u(w[0].z),
              d >= N && (d = N,
              y.set(1, 0, 0)),
              d >= x && (d = x,
              y.set(0, 1, 0)),
              d >= F && y.set(0, 0, 1),
              C.crossVectors(w[0], y).normalize(),
              Q[0].crossVectors(w[0], C),
              z[0].crossVectors(w[0], Q[0])
          }
          var P, d, N, x, F, a, A, y = new vm, w = [], Q = [], z = [], C = new vm, q = new Uq, S = J + 1, Z = 1e-4;
          for (this.tangents = w,
          this.normals = Q,
          this.binormals = z,
          a = 0; S > a; a++)
              A = a / (S - 1),
              w[a] = V.getTangentAt(A),
              w[a].normalize();
          for (c(),
          a = 1; S > a; a++)
              Q[a] = Q[a - 1].clone(),
              z[a] = z[a - 1].clone(),
              C.crossVectors(w[a - 1], w[a]),
              C.length() > Z && (C.normalize(),
              P = R(al(w[a - 1].dot(w[a]), -1, 1)),
              Q[a].applyMatrix4(q.makeRotationAxis(C, P))),
              z[a].crossVectors(w[a], Q[a]);
          if (r)
              for (P = R(al(Q[0].dot(Q[S - 1]), -1, 1)),
              P /= S - 1,
              w[0].dot(C.crossVectors(Q[0], Q[S - 1])) > 0 && (P = -P),
              a = 1; S > a; a++)
                  Q[a].applyMatrix4(q.makeRotationAxis(w[a], P * a)),
                  z[a].crossVectors(w[a], Q[a])
      }
      ;
      var uk = function(w, B, h, q) {
          Ok.call(this),
          B = B || 18,
          h = h || 0,
          q = q == E ? y : q;
          for (var x = 1 / (w.length - 1), p = 1 / B, U = 0, $ = B; $ >= U; U++)
              for (var A = h + U * p * q, c = P(A), _ = o(A), m = 0, H = w.length; H > m; m++) {
                  var u = w[m]
                    , e = new vm;
                  e.x = c * u.x - _ * u.y,
                  e.y = _ * u.x + c * u.y,
                  e.z = u.z,
                  this.vertices.push(e)
              }
          for (var G = w.length, U = 0, $ = B; $ > U; U++)
              for (var m = 0, H = w.length - 1; H > m; m++) {
                  var a = m + G * U
                    , r = a
                    , W = a + G
                    , c = a + 1 + G
                    , t = a + 1
                    , v = U * p
                    , V = m * x
                    , F = v + p
                    , M = V + x;
                  this.faces.push(new fe(r,t,W)),
                  this.faceVertexUvs[0].push([new uh(v,V), new uh(v,M), new uh(F,V)]),
                  this.faces.push(new fe(W,t,c)),
                  this.faceVertexUvs[0].push([new uh(F,V), new uh(v,M), new uh(F,M)])
              }
          this.mergeVertices(),
          lf(this),
          this.computeFaceNormals(),
          this.computeVertexNormals()
      };
      uk.prototype = xf(oq);
      var Al = function(U, S) {
          S = S || {};
          var N = dh.generateShapes(U, S);
          S.amount = S.amount !== V ? S.amount : .5,
          S.convertYZ = !1,
          S.fill !== !1 && (S.bottom = !0,
          S.top = !0),
          ep.call(this, N, S)
      };
      Al.prototype = xf(zh);
      var Wd = n.Node = function() {
          Jg(Wd, this)
      }
        , qe = {
          X: sf,
          Y: qp,
          Z: Yd
      }
        , Xm = {
          X: 0,
          Y: 1,
          Z: 2
      }
        , fh = {
          xyz: "XYZ",
          xzy: "XZY",
          yxz: "YXZ",
          yzx: "YZX",
          zxy: "ZXY",
          zyx: "ZYX"
      }
        , vp = "xzy"
        , tl = function(Q, j, y) {
          if (j) {
              var f = j[0]
                , T = j[1]
                , q = j[2];
              "xzy" === y ? (qp(Q, T),
              Yd(Q, q),
              sf(Q, f)) : "xyz" === y ? (Yd(Q, q),
              qp(Q, T),
              sf(Q, f)) : "yxz" === y ? (Yd(Q, q),
              sf(Q, f),
              qp(Q, T)) : "yzx" === y ? (sf(Q, f),
              Yd(Q, q),
              qp(Q, T)) : "zxy" === y ? (qp(Q, T),
              sf(Q, f),
              Yd(Q, q)) : "zyx" === y ? (sf(Q, f),
              qp(Q, T),
              Yd(Q, q)) : (qp(Q, T),
              Yd(Q, q),
              sf(Q, f))
          }
      };
      jq("Node", _i, {
          ms_ac: ["rotationMode", "anchorElevation"],
          ms_edge: !0,
          _adjustChildrenToTop: !0,
          _icon: "node_icon",
          _image: "node_image",
          _rotationMode: vp,
          _64O: 0,
          _rotationX: 0,
          _53O: 0,
          _host: E,
          _position: {
              x: 0,
              y: 0
          },
          _anchor: {
              x: .5,
              y: .5
          },
          _anchorElevation: .5,
          _scale: {
              x: 1,
              y: 1
          },
          _scaleTall: 1,
          _54O: 0,
          getUIClass: function() {
              return Zd
          },
          _22Q: function() {
              return Uo
          },
          getX: function() {
              return this.p().x
          },
          setX: function(K) {
              this.p(K, this.p().y)
          },
          getY: function() {
              return this.p().y
          },
          setY: function(m) {
              this.p(this.p().x, m)
          },
          getAnchorX: function() {
              return this.getAnchor().x
          },
          setAnchorX: function(J) {
              this.setAnchor(J, this.getAnchor().y)
          },
          getAnchorY: function() {
              return this.getAnchor().y
          },
          setAnchorY: function(P) {
              this.setAnchor(this.getAnchor().x, P)
          },
          getScaleX: function() {
              return this.getScale().x
          },
          setScaleX: function(z) {
              this.setScale(z, this.getScale().y)
          },
          getScaleY: function() {
              return this.getScale().y
          },
          setScaleY: function(x) {
              this.setScale(this.getScale().x, x)
          },
          p: function() {
              return 0 === arguments.length ? this.getPosition() : (this.setPosition.apply(this, arguments),
              this)
          },
          p3: function() {
              return 0 === arguments.length ? this.getPosition3d() : (this.setPosition3d.apply(this, arguments),
              this)
          },
          s3: function() {
              return 0 === arguments.length ? this.getSize3d() : (this.setSize3d.apply(this, arguments),
              this)
          },
          r3: function() {
              return 0 === arguments.length ? this.getRotation3d() : (this.setRotation3d.apply(this, arguments),
              this)
          },
          setQuaternion: function(n) {
              var F = (new Ml).setFromQuaternion(n, Ml.ReverseOrder(this.getRotationMode()));
              return this.r3(F.x, F.y, F.z)
          },
          getQuaternion: function() {
              return (new Qp).setFromEuler(this.getEuler())
          },
          getEuler: function() {
              var x = this.r3();
              return (new Ml).set(x[0], x[1], x[2], Ml.ReverseOrder(this.getRotationMode()))
          },
          setEuler: function(W) {
              return W = W.clone().reorder(Ml.ReverseOrder(this.getRotationMode())),
              this.r3(W.x, W.y, W.z)
          },
          t3: function() {
              return this.translate3d.apply(this, arguments),
              this
          },
          translate3dBy: function(x, c) {
              Wb(x, lp(E, E, this.r3(), this.getRotationMode())),
              this.translate3d(x[0] * c, x[1] * c, x[2] * c)
          },
          translateFront: function(j) {
              this.translate3dBy([0, 0, 1], j)
          },
          translateBack: function(s) {
              this.translate3dBy([0, 0, -1], s)
          },
          translateLeft: function(q) {
              this.translate3dBy([-1, 0, 0], q)
          },
          translateRight: function(q) {
              this.translate3dBy([1, 0, 0], q)
          },
          translateTop: function(K) {
              this.translate3dBy([0, 1, 0], K)
          },
          translateBottom: function(U) {
              this.translate3dBy([0, -1, 0], U)
          },
          getPosition3d: function() {
              return [this._position.x, this._54O, this._position.y]
          },
          setPosition3d: function(N, H, M) {
              1 === arguments.length && (H = N[1],
              M = N[2],
              N = N[0]),
              this.p(N, M),
              this.setElevation(H)
          },
          translate3d: function(c, o, D) {
              1 === arguments.length && (o = c[1],
              D = c[2],
              c = c[0]),
              this.translate(c, D),
              this.setElevation(this._54O + o)
          },
          getSize3d: function() {
              return [this.getWidth(), this.getTall(), this.getHeight()]
          },
          setSize3d: function(l, T, f) {
              1 === arguments.length && (T = l[1],
              f = l[2],
              l = l[0]),
              this.setSize(l, f),
              this.setTall(T)
          },
          getRotation3d: function() {
              return [this._rotationX, -this._64O, this._53O]
          },
          setRotation3d: function(P, w, U) {
              1 === arguments.length && (w = P[1],
              U = P[2],
              P = P[0]),
              this.setRotationX(P),
              this.setRotation(-w),
              this.setRotationZ(U)
          },
          setRotationY: function($) {
              this.setRotation(-$)
          },
          getRotationY: function() {
              return -this._64O
          },
          lookAtDirection: function(e, V) {
              V = V || bn;
              var L = this
                , J = Qf(e);
              V === bn ? (L.r3([-i(e[1] / J), -a(e[2], e[0]) + A, 0]),
              L.setRotationMode("xzy")) : V === Gq ? (L.r3(0, -a(e[2], e[0]), i(e[1] / J)),
              L.setRotationMode("zyx")) : V === Mb ? (L.r3(0, -a(e[2], e[0]) + s, -i(e[1] / J)),
              L.setRotationMode("zyx")) : V === Dj ? (L.r3([-i(e[1] / J) + A, -a(e[2], e[0]) + A, 0]),
              L.setRotationMode("xzy")) : V === zg && (L.r3([-i(e[1] / J) - A, -a(e[2], e[0]) + A, 0]),
              L.setRotationMode("xzy")),
              V === zs && (L.r3([-i(e[1] / J) + s, -a(e[2], e[0]) + A, s]),
              L.setRotationMode("zxy"))
          },
          lookAt: function(m, U) {
              return this.lookAtDirection(Bb(m, this.p3()), U)
          },
          lookAtX: function() {
              var K = new Rh
                , P = new Rh
                , h = new Rh
                , e = new Sc
                , u = new Sc
                , m = new Ml;
              return function(C, A) {
                  var x = Dp(this);
                  if (e.fromArray(x),
                  h.copy(this.p3()),
                  K.copy(C).sub(h),
                  !(K.lengthSq() < 1e-6)) {
                      K.normalize(),
                      A === bn ? P.set(0, 0, 1) : A === zs ? P.set(0, 0, -1) : A === Mb ? P.set(-1, 0, 0) : A === Gq ? P.set(1, 0, 0) : A === Dj ? P.set(0, 1, 0) : A === zg && P.set(0, -1, 0),
                      P.applyMatrix4(e).sub(h).normalize();
                      var B = Math.acos(K.dot(P));
                      if (B) {
                          var F = K.clone().cross(P);
                          F.lengthSq() < 1e-6 && (A === Dj || A === zg ? F.set(0, 0, 1).applyMatrix4(e).sub(h) : F.set(0, 1, 0).applyMatrix4(e).sub(h)),
                          F.normalize(),
                          m.set(this.r3(), this.getRotationMode(), !0),
                          e.makeRotationFromEuler(m),
                          u.makeRotationAxis(F, -B),
                          m.setFromRotationMatrix(u.multiply(e)),
                          this.r3([m.x, m.y, m.z])
                      }
                  }
              }
          }(),
          getHost: function() {
              return this._host
          },
          setHost: function(b) {
              var g = this;
              if (g !== b && g._host !== b) {
                  var N = g._host;
                  N && N._removeAttach(g),
                  g._host = b,
                  g._host && g._host._addAttach(g),
                  g.fp("host", N, b),
                  g.onHostChanged(N, b)
              }
          },
          getAttaches: function() {
              return this._69O
          },
          _addAttach: function(i) {
              var s = this;
              s._69O || (s._69O = new Mh),
              s._69O.add(i),
              s.fp("attaches", E, i)
          },
          _removeAttach: function(F) {
              var R = this;
              R._69O.remove(F),
              R._69O.isEmpty() && delete R._69O,
              R.fp("attaches", F, E)
          },
          getImage: function() {
              if (this._pendingCheckImageJSON) {
                  var f = M.getImage(this._image);
                  f && (this._pendingCheckImageJSON = !1,
                  this.getParent()instanceof Oq && this.getParent().checkPendingUpdateInfo())
              }
              return this._image
          },
          setImage: function($) {
              var R = this
                , U = R._image
                , J = R.getWidth()
                , M = R.getHeight();
              R._image = $,
              R.fp("image", U, $) && (null != $ && (Ql($) || Xq($) && /\.json$/i.test($)) && (this._pendingCheckImageJSON = !0),
              R.fp(gq, J, R.getWidth()),
              R.fp(Ki, M, R.getHeight()))
          },
          getElevation: function() {
              return this._54O
          },
          setElevation: function(A) {
              var u = this;
              if (!u._50O) {
                  u._50O = 1;
                  var T = u._54O;
                  u._54O = A,
                  u.fp(vl, T, A),
                  delete this._50O
              }
          },
          getRotation: function() {
              return this._64O
          },
          setRotation: function(B) {
              var A = this;
              if (!A._49O) {
                  A._49O = 1;
                  var Y = A._64O;
                  A._64O = B,
                  A.fp(Ek, Y, B),
                  delete A._49O
              }
          },
          getRotationX: function() {
              return this._rotationX
          },
          setRotationX: function(Q) {
              var F = this;
              if (!F._51O) {
                  F._51O = 1;
                  var E = F._rotationX;
                  F._rotationX = Q,
                  F.fp("rotationX", E, Q),
                  delete F._51O
              }
          },
          getRotationZ: function() {
              return this._53O
          },
          setRotationZ: function(B) {
              var r = this;
              if (!r._52O) {
                  r._52O = 1;
                  var q = r._53O;
                  r._53O = B,
                  r.fp("rotationZ", q, B),
                  delete r._52O
              }
          },
          getPosition: function() {
              return this._position
          },
          setPosition: function(V, T) {
              var A = this;
              if (!A._50I) {
                  A._50I = 1;
                  var m;
                  if (m = 2 === arguments.length ? {
                      x: V,
                      y: T
                  } : V,
                  m.x !== A._position.x || m.y !== A._position.y) {
                      var I = A._position;
                      A._position = m,
                      A.fp(Op, I, m)
                  }
                  delete A._50I
              }
          },
          translate: function(f, p) {
              var n = this._position;
              this.p(n.x + f, n.y + p)
          },
          getWidth: function() {
              var A = this;
              if (A._width >= 0)
                  return A._width;
              var p = A.getStyle("shape3d");
              if (p) {
                  var Y = Jq(p);
                  if (Y && Y.rawS3)
                      return Y.rawS3[0];
                  if ("billboard" === p || "plane" === p) {
                      var D = Ti(A.getStyle("shape3d.image"));
                      return D ? Aj(D, A) : 20
                  }
              }
              var D = Ti(A._image);
              return D ? Aj(D, A) : 20
          },
          setWidth: function(a) {
              var O = this
                , r = O._width;
              O._width = a,
              O.fp(gq, r, a)
          },
          getHeight: function() {
              var i = this;
              if (i._height >= 0)
                  return i._height;
              var I = i.getStyle("shape3d");
              if (I) {
                  var B = Jq(I);
                  if (B && B.rawS3)
                      return B.rawS3[2];
                  if ("plane" === I) {
                      var S = Ti(i.getStyle("shape3d.image"));
                      return S ? Xc(S, i) : 20
                  }
                  if ("billboard" === I)
                      return 2
              }
              var S = Ti(i._image);
              return S ? Xc(S, i) : 20
          },
          setHeight: function(T) {
              var J = this
                , H = J._height;
              J._height = T,
              J.fp(Ki, H, T)
          },
          getTall: function() {
              var $ = this;
              if ($._tall >= 0)
                  return $._tall;
              var U = $.getStyle("shape3d");
              if (U) {
                  var C = Jq(U);
                  if (C && C.rawS3)
                      return C.rawS3[1];
                  if ("billboard" === U) {
                      var M = Ti($.getStyle("shape3d.image"));
                      return M ? Xc(M, $) : 20
                  }
                  if ("plane" === U)
                      return 2
              }
              return 20
          },
          setTall: function(C) {
              var v = this
                , z = v._tall;
              v._tall = C,
              v.fp("tall", z, C)
          },
          setSize: function(k, A) {
              var e = this;
              2 === arguments.length ? (e.setWidth(k),
              e.setHeight(A)) : (e.setWidth(k.width),
              e.setHeight(k.height))
          },
          getSize: function() {
              return {
                  width: this.getWidth(),
                  height: this.getHeight()
              }
          },
          setRect: function(f, q, v, _, a) {
              var I = this
                , z = I.getAnchor()
                , d = I.getScale();
              arguments.length <= 2 && (a = q,
              q = f.y,
              v = f.width,
              _ = f.height,
              f = f.x);
              var j = a && d.x < 0 ? 1 - z.x : z.x
                , L = a && d.y < 0 ? 1 - z.y : z.y;
              I.p(f + v * j, q + _ * L),
              a && (v /= Math.abs(d.x),
              _ /= Math.abs(d.y)),
              I.setWidth(v),
              I.setHeight(_)
          },
          getMatrix: function() {
              var T = this
                , v = T._64O
                , A = T._position
                , Q = T.getScale();
              return new Ck(v,A.x,A.y,Q.x,Q.y)
          },
          getAnchorRect: function() {
              var f = this
                , U = f.getWidth()
                , S = f.getHeight()
                , Z = f.getAnchor();
              return {
                  x: -U * Z.x,
                  y: -S * Z.y,
                  width: U,
                  height: S
              }
          },
          toLocal: function(H) {
              return this.getMatrix().tfi(H)
          },
          toGlobal: function(u) {
              return this.getMatrix().tf(u)
          },
          getAttachPosition: function() {
              var r = new Ck;
              return function(t, N, v, e) {
                  v = v || 0,
                  e = e || 0;
                  var X = this
                    , f = X.getAnchor()
                    , s = X._64O
                    , u = X._position
                    , S = X.getScale();
                  return r.setFromTransform(s, u.x, u.y).tf({
                      x: v + S.x * X.getWidth() * (t - f.x),
                      y: e + S.y * X.getHeight() * (N - f.y)
                  })
              }
          }(),
          isInRect: function(L) {
              L = this.toLocal(L);
              var T = this.getWidth()
                , N = this.getHeight();
              return L.x += T * this.getAnchorX(),
              L.y += N * this.getAnchorY(),
              !(L.x < 0 || L.y < 0 || L.x > T || L.y > N)
          },
          getRect: function() {
              var q = this
                , N = q.getWidth()
                , X = q.getHeight()
                , K = q.getAnchor()
                , F = {
                  x: -N * K.x,
                  y: -X * K.y,
                  width: N,
                  height: X
              }
                , u = q.getMatrix();
              return F = kr([u.tf(F.x, F.y), u.tf(F.x + F.width, F.y), u.tf(F.x + F.width, F.y + F.height), u.tf(F.x, F.y + F.height)])
          },
          getAnchorElevation: function() {
              return this._anchorElevation
          },
          getAnchor3d: function() {
              var e = this
                , V = e.getAnchor()
                , T = e._anchorElevation;
              return {
                  x: V.x,
                  y: T,
                  z: V.y
              }
          },
          setAnchorElevation: function(b) {
              var n = this
                , X = n._anchorElevation;
              return X !== b ? (n._anchorElevation = b,
              n.fp("anchorElevation", X, b),
              !0) : !1
          },
          setAnchor3d: function(M, x, m, A) {
              var N, $ = this;
              "number" == typeof M ? N = {
                  x: M,
                  y: x,
                  z: m
              } : (N = M.length ? {
                  x: M[0],
                  y: M[1],
                  z: M[2]
              } : M,
              A = x);
              var I = $.getDataModel();
              I && I.beginTransaction();
              var P = $.getAnchor3d()
                , V = $.setAnchor(N.x, N.z);
              if ($.setAnchorElevation(N.y) && (V = !0),
              V && A && !fj) {
                  $.getAnchor3d();
                  var e = Dp($)
                    , T = Wb([N.x - P.x, N.y - P.y, N.z - P.z], e);
                  $.p3(T)
              }
              return I && I.endTransaction(),
              V
          },
          getAnchor: function() {
              var j = this;
              if (j.hasOwnProperty("_anchor"))
                  return j._anchor;
              var M = Ti(j._image);
              return M && M.anchorX !== V ? {
                  x: M.anchorX,
                  y: M.anchorY
              } : j._anchor
          },
          setAnchor: function(p, r, n) {
              var D, T = this;
              "number" == typeof p ? D = {
                  x: p,
                  y: r
              } : (D = p.length ? {
                  x: p[0],
                  y: p[1]
              } : p,
              n = r);
              var d = T.getAnchor();
              if (d.x !== D.x || d.y !== D.y) {
                  var B = T.getDataModel();
                  if (B && B.beginTransaction(),
                  T._anchor = D,
                  T.fp("anchor", d, D),
                  n && !fj) {
                      var J = T.getPosition()
                        , _ = T.getSize()
                        , q = T.getRotation()
                        , m = T.getScale()
                        , Y = -_.width * (d.x - D.x) * m.x
                        , V = -_.height * (d.y - D.y) * m.y
                        , N = o(q)
                        , H = P(q);
                      T.setPosition(J.x + H * Y - N * V, J.y + N * Y + H * V)
                  }
                  return B && B.endTransaction(),
                  !0
              }
              return !1
          },
          getScale: function() {
              return this._scale
          },
          setScale: function(P, S) {
              var x, b = this;
              x = 2 === arguments.length ? {
                  x: P,
                  y: S
              } : P;
              var L = b.getScale();
              (L.x !== x.x || L.y !== x.y) && (b._scale = x,
              b.fp("scale", L, x))
          },
          getScaleTall: function() {
              return this._scaleTall
          },
          getScale3d: function() {
              var Z = this
                , W = Z._scaleTall
                , Y = Z.getScale();
              return [Y.x, W, Y.y]
          },
          getFinalScale3d: function() {
              var Y = this
                , s = Y.s3()
                , o = Y._dynamicScale3d
                , j = Y.getScale3d();
              return s && (j[0] *= s[0],
              j[1] *= s[1],
              j[2] *= s[2]),
              o && (j[0] *= o[0],
              j[1] *= o[1],
              j[2] *= o[2]),
              j
          },
          getFinalRotation3d: function() {
              var o = this;
              return o._dynamicRotation || o.r3()
          },
          setScaleTall: function(Y) {
              var d = this
                , J = d._scaleTall;
              J !== Y && (d._scaleTall = Y,
              d.fp("scaleTall", J, Y))
          },
          setScale3d: function(k, E, p) {
              var t, c = this;
              t = "number" == typeof k ? {
                  x: k,
                  y: E,
                  z: p
              } : k.length ? {
                  x: k[0],
                  y: k[1],
                  z: k[2]
              } : k,
              c.setScaleTall(t.y),
              c.setScale(t.x, t.z)
          },
          getCorners: function(M, j) {
              M == E && (M = 0),
              j == E && (j = M);
              var y = this
                , R = y.getAnchor()
                , D = y.getWidth()
                , f = y.getHeight()
                , q = -D * R.x - M
                , n = -f * R.y - j
                , N = D + 2 * M
                , V = f + 2 * j
                , z = y.getMatrix();
              return [z.tf(q, n), z.tf(q, n + V), z.tf(q + N, n + V), z.tf(q + N, n)]
          },
          getEditControlPoints: function(S, q, H) {
              q == E && (q = 0),
              H == E && (H = q);
              var s = this
                , u = s.getAnchor()
                , l = s.getWidth()
                , W = s.getHeight()
                , g = -l * u.x - q
                , X = -W * u.y - H
                , K = l + 2 * q
                , j = W + 2 * H;
              if (S)
                  return [{
                      x: g,
                      y: X
                  }, {
                      x: g,
                      y: 0
                  }, {
                      x: g,
                      y: X + j
                  }, {
                      x: 0,
                      y: X + j
                  }, {
                      x: g + K,
                      y: X + j
                  }, {
                      x: g + K,
                      y: 0
                  }, {
                      x: g + K,
                      y: X
                  }, {
                      x: 0,
                      y: X
                  }];
              var G = s.getMatrix();
              return [G.tf(g, X), G.tf(g, 0), G.tf(g, X + j), G.tf(0, X + j), G.tf(g + K, X + j), G.tf(g + K, 0), G.tf(g + K, X), G.tf(0, X)]
          },
          rotateAt: function(G, S, h) {
              var $ = this
                , V = $._position
                , k = $._64O
                , r = new Ck(k,V.x,V.y).tf(G, S)
                , U = O(G * G + S * S)
                , T = a(V.y - r.y, V.x - r.x) + h;
              $.setRotation(k + h),
              $.p(r.x + U * P(T), r.y + U * o(T))
          },
          onParentChanged: function() {
              Wd.superClass.onParentChanged.apply(this, arguments),
              this._8I()
          },
          onPropertyChanged: function() {
              var Y = {};
              return "width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(y) {
                  Y[y] = !0
              }),
              function(C) {
                  var H = this;
                  Wd.superClass.onPropertyChanged.call(H, C),
                  Y[C.property] && !H._layoutUpdating && H.updateLayoutParameters(null, C.property),
                  H._69O && H._69O.each(function(u) {
                      u.handleHostPropertyChange(C)
                  }),
                  H._49I && H._49I.each(function(P) {
                      P.fp("agentChange", !0, !1)
                  }),
                  "a:layout" === C.property.substring(0, 8) && this.updateAttach()
              }
          }(),
          onHostChanged: function() {
              this.updateAttach(),
              this.updateLayoutParameters()
          },
          handleHostPropertyChange: function(n) {
              this.updateAttach(n)
          },
          onStyleChanged: function(m) {
              Wd.superClass.onStyleChanged.apply(this, arguments),
              vi[m] && this.updateAttach()
          },
          updateAttach: function(c) {
              var f = this;
              return fj ? (f.updateLayoutParameters(),
              void 0) : (f._51I || (f._51I = 1,
              f._71O(c),
              delete f._51I),
              void 0)
          },
          _71O: function(M) {
              var Z, c, D, S, o, j, R, l, b = this, s = b._host, d = M ? M.property : E, W = M ? M.oldValue : E, i = M ? M.newValue : E;
              if (s instanceof Wd && (R = Ti(s.getImage()),
              R && R.layoutAttach && (l = R.layoutAttach)),
              M && !_k[d] && "a:layout" !== d.substring(0, 8) || !l || l(s, this))
                  if (s instanceof n.Grid) {
                      if (d === vl)
                          b.setElevation(b._54O + i - W);
                      else if (!M || Ef[d]) {
                          if (Z = b.s("attach.row.index"),
                          c = b.s("attach.column.index"),
                          D = s.getCellRect(Z, c),
                          !D)
                              return;
                          S = b.s("attach.row.span"),
                          o = b.s("attach.column.span"),
                          (1 !== S || 1 !== o) && (D = Ee(D, s.getCellRect(Z + S - 1, c + o - 1))),
                          Od(D, b, "attach.padding", 1),
                          b.setRect(D)
                      }
                  } else if (s instanceof Io && (j = b.s("attach.index")) >= 0 && (!M || pm[d])) {
                      var w = b.s("attach.thickness")
                        , q = s.getScale()
                        , u = Math.max(q.x, q.y);
                      w > 0 && b.setHeight(s.getThickness() * w * u);
                      var _ = b.s("attach.offset")
                        , H = s.getPoints()
                        , G = H.size();
                      if (G > j) {
                          var z = s.getPointsMatrix2d()
                            , I = H.get(j)
                            , U = G === j + 1 ? H.get(0) : H.get(j + 1);
                          I = z.apply(I),
                          U = z.apply(U);
                          var L = [U.x - I.x, U.y - I.y]
                            , Y = Qf(L);
                          if (Y) {
                              b.s("attach.offset.relative") && (_ *= Y),
                              b.s("attach.offset.opposite") && (_ = Y - _);
                              var C = {
                                  x: I.x + L[0] / Y * _,
                                  y: I.y + L[1] / Y * _
                              }
                                , y = b.s("attach.gap");
                              y && (b.s("attach.gap.relative") && (y *= s.getThickness() * u),
                              C = Bi(E, C, U, y)),
                              b.p(C),
                              b.setRotation(a(L[1], L[0]))
                          }
                      }
                  } else
                      M && (d === Op ? b.translate(i.x - W.x, i.y - W.y) : d === vl ? b.setElevation(b._54O + i - W) : Ud[d] ? b._11Q(s, d, i - W) : ("anchor" === d || "width" === d || "height" === d || "scale" === d) && b.layout(s))
          },
          _11Q: function() {
              var s = new n.Math.Euler
                , q = n.Math.Euler.ReverseOrder
                , l = new n.Math.Vector2
                , $ = new n.Math.Vector2;
              return function(x, y, i) {
                  var _ = this
                    , b = x.p3()
                    , N = x.r3()
                    , Q = _.p3()
                    , c = _.r3();
                  if (y === Ek && (y = "rotationY",
                  i = -i),
                  (y === Ek || "rotationY" === y) && 0 === c[0] && 0 === c[2] && 0 === N[0] && 0 === N[2] && 0 === Q[1] && 0 === b[1])
                      return _.setRotation(-c[1] - i),
                      l.set(Q[0], Q[2]).rotateAround($.set(b[0], b[2]), -i),
                      _.p(l.x, l.y),
                      void 0;
                  var z = fh[x.getRotationMode()]
                    , K = z[0]
                    , O = z[1]
                    , v = z[2]
                    , G = qe[K]
                    , I = qe[O]
                    , X = qe[v]
                    , Y = zm();
                  y === Ek + K ? (X(Y, N[Xm[v]]),
                  I(Y, N[Xm[O]]),
                  G(Y, i),
                  I(Y, -N[Xm[O]]),
                  X(Y, -N[Xm[v]])) : y === Ek + O ? (X(Y, N[Xm[v]]),
                  I(Y, i),
                  X(Y, -N[Xm[v]])) : y === Ek + v && X(Y, i);
                  var h = Bb(Q, b);
                  Wb(h, Y),
                  _.p3(b[0] + h[0], b[1] + h[1], b[2] + h[2]);
                  var o = _.getRotationMode();
                  tl(Y, _.r3(), o),
                  s.setFromRotationMatrix(Y, q(o)),
                  _.r3([s.x, s.y, s.z])
              }
          }(),
          isHostOn: function(R) {
              var n = this;
              if (n._host && R && R._69O)
                  for (var Q = {}, u = n._host; u && u !== n && !Q[u._id]; ) {
                      if (u === R)
                          return !0;
                      Q[u._id] = u,
                      u = u._host
                  }
              return !1
          },
          isLoopedHostOn: function($) {
              return this.isHostOn($) && $.isHostOn(this)
          },
          getScaledSize: function() {
              var u = this.getSize()
                , C = this.getScale();
              return u.width *= Math.abs(C.x),
              u.height *= Math.abs(C.y),
              u
          },
          layout: function(Y) {
              if (Y = Y || this.getHost()) {
                  var I = this
                    , i = I.s("layout.h") || "center"
                    , U = I.s("layout.v") || "center";
                  if ("center" !== i || "center" !== U) {
                      var k = new n.Math.Vector2
                        , H = Y.getPosition()
                        , J = Y.getAnchor()
                        , s = Y.getScaledSize();
                      I.getPosition();
                      var p, G, P, b, R, F = 1, v = 1;
                      switch (I._layoutUpdating = !0,
                      i) {
                      case "left":
                          k.setX(I._layoutHValue - J.x * s.width);
                          break;
                      case "right":
                          k.setX((1 - J.x) * s.width - I._layoutHValue);
                          break;
                      case "leftright":
                          p = s.width - I._layoutHValue[2],
                          P = I.getRotation() - Y.getRotation(),
                          b = Math.abs(Math.sin(P)),
                          R = Math.abs(Math.cos(P)),
                          F += R * p / I._layoutHValue[3],
                          v += b * p / I._layoutHValue[4],
                          k.setX(I._layoutHValue[1] + (I._layoutHValue[5] - J.x) * s.width);
                          break;
                      case "center":
                          k.setX((.5 - J.x) * s.width - I._layoutHValue);
                          break;
                      case "scale":
                          P = I.getRotation() - Y.getRotation(),
                          b = Math.abs(Math.sin(P)),
                          R = Math.abs(Math.cos(P)),
                          k.setX((.5 - J.x) * s.width - I._layoutHValue[1] * s.width / I._layoutHValue[0]),
                          G = s.width / I._layoutHValue[2] - 1,
                          F += R * G,
                          v += b * G
                      }
                      switch (U) {
                      case "top":
                          k.setY(I._layoutVValue - J.y * s.height);
                          break;
                      case "bottom":
                          k.setY((1 - J.y) * s.height - I._layoutVValue);
                          break;
                      case "topbottom":
                          P || (P = I.getRotation() - Y.getRotation(),
                          b = Math.abs(Math.sin(P)),
                          R = Math.abs(Math.cos(P))),
                          p = s.height - I._layoutVValue[2],
                          F += b * p / I._layoutVValue[3],
                          v += R * p / I._layoutVValue[4],
                          k.setY(I._layoutVValue[1] + (I._layoutVValue[5] - J.y) * s.height);
                          break;
                      case "center":
                          k.setY((.5 - J.y) * s.height - I._layoutVValue);
                          break;
                      case "scale":
                          P || (P = I.getRotation() - Y.getRotation(),
                          b = Math.abs(Math.sin(P)),
                          R = Math.abs(Math.cos(P))),
                          k.setY((.5 - J.y) * s.height - I._layoutVValue[1] * s.height / I._layoutVValue[0]),
                          G = s.height / I._layoutVValue[2] - 1,
                          F += b * G,
                          v += R * G
                      }
                      if ("leftright" === i || "scale" === i || "topbottom" === U || "scale" === U) {
                          var e = this.getScale()
                            , t = Math.abs(e.x)
                            , M = Math.abs(e.y);
                          "leftright" === i || "scale" === i ? I.setSize(I._layoutHValue[3] * F / t, I._layoutHValue[4] * v / M) : I.setSize(I._layoutVValue[3] * F / t, I._layoutVValue[4] * v / M)
                      }
                      k.rotateAround(null, Y.getRotation()),
                      this.setPosition(k.x + H.x, k.y + H.y),
                      I._layoutUpdating = V
                  }
              }
          },
          updateLayoutParameters: function(R, O) {
              if (R = R || this.getHost()) {
                  var T = this
                    , E = T.s("layout.h")
                    , j = T.s("layout.v");
                  if (E || j) {
                      var m, k, h, Z, F, p, U = new n.Math.Vector2, A = R.getPosition(), a = R.getAnchor(), b = R.getScaledSize(), H = T.getPosition(), P = T.getScaledSize();
                      switch (U.set(H.x - A.x, H.y - A.y),
                      U.rotateAround(null, -R.getRotation()),
                      E) {
                      case "left":
                          T._layoutHValue = U.x + a.x * b.width;
                          break;
                      case "right":
                          T._layoutHValue = -U.x + (1 - a.x) * b.width;
                          break;
                      case "center":
                          T._layoutHValue = -U.x + (.5 - a.x) * b.width;
                          break;
                      case "leftright":
                      case "scale":
                          "scale" === E ? m = -U.x + (.5 - a.x) * b.width : (k = T.getAnchor(),
                          h = T.getRotation() - R.getRotation(),
                          Z = Math.cos(h),
                          F = Math.sin(h),
                          p = -Math.min(-k.x * Z + k.y * F, -k.x * Z - (1 - k.y) * F, (1 - k.x) * Z + k.y * F, (1 - k.x) * Z - (1 - k.y) * F),
                          m = U.x - (p - a.x) * b.width),
                          "position" === O && "object" == typeof T._layoutHValue ? (T._layoutHValue[0] = b.width,
                          T._layoutHValue[1] = m) : T._layoutHValue = [b.width, m, b.width, P.width, P.height, p]
                      }
                      switch (j) {
                      case "top":
                          T._layoutVValue = U.y + a.y * b.height;
                          break;
                      case "bottom":
                          T._layoutVValue = -U.y + (1 - a.y) * b.height;
                          break;
                      case "center":
                          T._layoutVValue = -U.y + (.5 - a.y) * b.height;
                          break;
                      case "topbottom":
                      case "scale":
                          "scale" === j ? m = -U.y + (.5 - a.y) * b.height : (h || (k = T.getAnchor(),
                          h = T.getRotation() - R.getRotation(),
                          Z = Math.cos(h),
                          F = Math.sin(h)),
                          p = -Math.min(-k.x * F - k.y * Z, -k.x * F + (1 - k.y) * Z, (1 - k.x) * F - k.y * Z, (1 - k.x) * F + (1 - k.y) * Z),
                          m = U.y - (p - a.y) * b.height),
                          "position" === O && "object" == typeof T._layoutVValue ? (T._layoutVValue[0] = b.height,
                          T._layoutVValue[1] = m) : T._layoutVValue = [b.height, m, b.height, P.width, P.height, p]
                      }
                  }
              }
          },
          getSerializableProperties: function() {
              var D = Wd.superClass.getSerializableProperties.call(this);
              return rc(D, {
                  image: 1,
                  host: 1,
                  rotation: 1,
                  rotationX: 1,
                  rotationZ: 1,
                  rotationMode: 1,
                  position: 1,
                  anchor: 1,
                  anchorElevation: 1,
                  scale: 1,
                  scaleTall: 1,
                  _width: 1,
                  _height: 1,
                  _tall: 1,
                  elevation: 1
              }),
              D
          }
      });
      var Fq = n.Edge = function(Y, R) {
          var q = this;
          Jg(Fq, q),
          q.setSource(Y),
          q.setTarget(R)
      }
      ;
      jq("Edge", _i, {
          ms_edge: !0,
          _icon: "edge_icon",
          getUIClass: function() {
              return Mm
          },
          _22Q: function() {
              return Zq
          },
          getSource: function() {
              return this._source
          },
          getTarget: function() {
              return this._target
          },
          getSourceAgent: function() {
              return this._40I
          },
          getTargetAgent: function() {
              return this._41I
          },
          canSetSourceTarget: function(K) {
              if (K === this)
                  return !1;
              if (ud(K))
                  return !0;
              for (var l, x, _, I, z, n = [this], S = -1, M = 0; M > S; )
                  if (S++,
                  l = n[S],
                  x = l._44I)
                      for (x = x.getArray(),
                      I = 0,
                      z = x.length; z > I; I++)
                          if (_ = x[I],
                          ji(_) && !(n.indexOf(_) >= 0)) {
                              if (_ === K)
                                  return !1;
                              n.push(_),
                              M++
                          }
              return !0
          },
          setSource: function(R) {
              var A = this;
              if (A._source !== R && A.canSetSourceTarget(R)) {
                  var q = A._source;
                  A._source = R,
                  q && q._16I(A),
                  R && R._2I(A),
                  A._7I(),
                  A.fp("source", q, R)
              }
          },
          setTarget: function(Z) {
              var M = this;
              if (M._target !== Z && M.canSetSourceTarget(Z)) {
                  var h = M._target;
                  M._target = Z,
                  h && h._18I(M),
                  Z && Z._4I(M),
                  M._7I(),
                  M.fp("target", h, Z)
              }
          },
          isLooped: function() {
              var T = this;
              return T._source === T._target && ud(T._source) && ud(T._target)
          },
          onPropertyChanged: function() {
              var U = this;
              U._49I && U._49I.each(function(f) {
                  f.fp("agentChange", !0, !1)
              })
          },
          _7I: function() {
              var f, p = this, l = Bs(p);
              p._40I !== l && (f = this._40I,
              f && f._15I(p),
              p._40I = l,
              l && l._1I(p),
              p.fp("sourceAgent", f, l),
              wq(f, p._41I),
              wq(l, p._41I));
              var j = _g(p);
              p._41I !== j && (f = p._41I,
              f && f._17I(p),
              p._41I = j,
              j && j._3I(p),
              p.fp("targetAgent", f, j),
              wq(f, p._40I),
              wq(j, p._40I))
          },
          _22I: function(q) {
              this._52I = q,
              this.fp("edgeGroup", !0, !1)
          },
          getEdgeGroup: function() {
              return this._52I
          },
          isEdgeGroupHidden: function() {
              var e = this;
              return e._52I && e._52I.get(0) !== e && !e.getStyle(xl)
          },
          getEdgeGroupSize: function() {
              return this._52I ? this._52I.size() : 1
          },
          getEdgeGroupIndex: function() {
              return this._52I ? this._52I.indexOf(this) : 0
          },
          isEdgeGroupAgent: function() {
              var h = this
                , p = h._52I;
              return p && !h.getStyle(xl) && p.size() > 1 && h === p.get(0)
          },
          toggle: function() {
              this.beginTransaction();
              var t = this._52I
                , Z = !this.s(xl);
              t && t.size() > 1 && (t.each(function(u) {
                  u.s(xl, Z)
              }),
              t.getSiblings().each(function($) {
                  $ !== t && $.each(function(A) {
                      A.fp("edgeGroup", E, $)
                  })
              })),
              this.endTransaction()
          },
          setStyle: function(Z, s) {
              (Z === ri || "edge.segments" === Z) && (s = Hm(s)),
              Fq.superClass.setStyle.call(this, Z, s)
          },
          onStyleChanged: function(t) {
              Fq.superClass.onStyleChanged.apply(this, arguments),
              Ac[t] && wq(this._41I, this._40I)
          },
          getSerializableProperties: function() {
              var u = Fq.superClass.getSerializableProperties.call(this);
              return rc(u, {
                  source: 1,
                  target: 1
              }),
              u
          }
      });
      var cg = n.Group = function() {
          Jg(cg, this)
      }
      ;
      jq("Group", Wd, {
          _image: "group_image",
          _icon: "group_icon",
          _57O: !1,
          getUIClass: function() {
              return Wh
          },
          onChildAdded: function() {
              cg.superClass.onChildAdded.apply(this, arguments),
              this._81I()
          },
          onChildRemoved: function() {
              cg.superClass.onChildRemoved.apply(this, arguments),
              this._81I()
          },
          _81I: function() {
              var t = this;
              if (!t._54I && !fj) {
                  var v = t.getChildrenRect();
                  v && (t._53I = 1,
                  t.p(Eo(t.s("group.position"), v, t.getSize())),
                  delete t._53I)
              }
          },
          getChildrenRect: function() {
              var r, l = this;
              return l.eachChild(function(D) {
                  ud(D) && (r = Ee(r, l.getChildRect(D)))
              }),
              r
          },
          getChildRect: function(d) {
              var N;
              return ud(d) && d.s($k) && (ks(d) && d.isExpanded() && d.eachChild(function(h) {
                  N = Ee(N, d.getChildRect(h))
              }),
              !N && d.getRect && (N = d.getRect())),
              N
          },
          setPosition: function(p, h) {
              var L = this;
              if (!L._54I) {
                  var d;
                  d = 2 === arguments.length ? {
                      x: p,
                      y: h
                  } : p,
                  fj || L._53I || (L._54I = 1,
                  Lc(L._children, d.x - L._position.x, d.y - L._position.y),
                  delete L._54I),
                  cg.superClass.setPosition.call(this, d)
              }
          },
          toggle: function() {
              this.setExpanded(!this.isExpanded())
          },
          isExpanded: function() {
              return this._57O
          },
          setExpanded: function(j) {
              var E = this;
              if (E._57O !== j) {
                  var o = E._57O;
                  E._57O = j,
                  E.fp("expanded", o, E._57O),
                  E._fireInvalidateDeep(),
                  E._8I()
              }
          },
          _fireInvalidateDeep: function() {
              this.eachChild(function(Q) {
                  ks(Q) ? Q._fireInvalidateDeep() : Q.iv()
              })
          },
          _8I: function() {
              cg.superClass._8I.call(this),
              this.eachChild(function(T) {
                  ud(T) && T._8I()
              })
          },
          onStyleChanged: function(o) {
              cg.superClass.onStyleChanged.apply(this, arguments),
              "group.position" === o && this._81I()
          },
          getSerializableProperties: function() {
              var T = cg.superClass.getSerializableProperties.call(this);
              return T.expanded = 1,
              T
          }
      });
      var ch = n.Block = function() {
          Jg(ch, this),
          this.s({
              "shadow.cast": !1,
              "shadow.receive": !1
          })
      }
      ;
      jq("Block", Wd, {
          _icon: "block_icon",
          _clickThroughEnabled: !1,
          _syncSize: !0,
          ms_ac: ["clickThroughEnabled", "syncSize"],
          getUIClass: function() {
              return Vn
          },
          _22Q: function() {
              return Vk
          },
          onChildAdded: function() {
              ch.superClass.onChildAdded.apply(this, arguments),
              this.updateFromChildren()
          },
          onChildRemoved: function() {
              ch.superClass.onChildRemoved.apply(this, arguments),
              this.updateFromChildren()
          },
          _getBoundingBox: function() {
              function H(Y, t, J) {
                  c.fromArray(Dp(t));
                  var B = t.getAnchor3d();
                  Y.push((new Rh).set(0 - B.x, 0 - B.y, 0 - B.z).applyMatrix4(c).applyMatrix4(J)),
                  Y.push((new Rh).set(0 - B.x, 0 - B.y, 1 - B.z).applyMatrix4(c).applyMatrix4(J)),
                  Y.push((new Rh).set(0 - B.x, 1 - B.y, 0 - B.z).applyMatrix4(c).applyMatrix4(J)),
                  Y.push((new Rh).set(0 - B.x, 1 - B.y, 1 - B.z).applyMatrix4(c).applyMatrix4(J)),
                  Y.push((new Rh).set(1 - B.x, 0 - B.y, 0 - B.z).applyMatrix4(c).applyMatrix4(J)),
                  Y.push((new Rh).set(1 - B.x, 0 - B.y, 1 - B.z).applyMatrix4(c).applyMatrix4(J)),
                  Y.push((new Rh).set(1 - B.x, 1 - B.y, 0 - B.z).applyMatrix4(c).applyMatrix4(J)),
                  Y.push((new Rh).set(1 - B.x, 1 - B.y, 1 - B.z).applyMatrix4(c).applyMatrix4(J))
              }
              function a(A, p) {
                  var b = (new Sc).makeRotationFromEuler(this.getEuler()).setPosition((new Rh).fromArray(this.p3()));
                  b.getInverse(b),
                  A.forEach(function(M) {
                      ud(M) && H(p, M, b)
                  })
              }
              var c = new Sc;
              return function(Y, C) {
                  if (Y instanceof Wd && (Y = [Y]),
                  !Y || 0 === Y.length)
                      return E;
                  var C = [];
                  a.call(this, Y, C);
                  var s = [1 / 0, 1 / 0, 1 / 0]
                    , r = [-1 / 0, -1 / 0, -1 / 0];
                  return C.forEach(function(K) {
                      s[0] = Math.min(K.x, s[0]),
                      s[1] = Math.min(K.y, s[1]),
                      s[2] = Math.min(K.z, s[2]),
                      r[0] = Math.max(K.x, r[0]),
                      r[1] = Math.max(K.y, r[1]),
                      r[2] = Math.max(K.z, r[2])
                  }),
                  {
                      min: s,
                      max: r
                  }
              }
          }(),
          updateFromChildren: function() {
              var t = this;
              if (!fj && !t._updatingToChildren && t._syncSize && 0 !== t.size() && !t._freezeSyncFromChildren) {
                  var B = this._getBoundingBox(t.toChildren(ud));
                  if (B) {
                      t._updatingFromChildren = 1;
                      var W = (new Rh).fromArray(this.getScale3d())
                        , z = (new Rh).fromArray(B.min)
                        , m = (new Rh).fromArray(B.max)
                        , C = M.blockMinSize
                        , c = new Rh
                        , G = m.clone().sub(z);
                      0 === G.x && c.setX(.5),
                      0 === G.y && c.setY(.5),
                      0 === G.z && c.setZ(.5);
                      var n = this._width == E || -1 === this._width
                        , P = new Rh(this.getAnchor3d());
                      if (n || this._anchorChanged || !this.s("keepPosition")) {
                          var l = P.clone().multiply(G).add(z).applyEuler(this.getEuler()).add((new Rh).fromArray(this.p3()));
                          this.p3([l.x, l.y, l.z])
                      } else {
                          var w = W.clone().multiply((new Rh).fromArray(this.s3()))
                            , D = G.clone();
                          0 === D.x && D.setX(C),
                          0 === D.y && D.setY(C),
                          0 === D.z && D.setZ(C);
                          var Z = P.clone().multiply(w)
                            , K = Z.clone().multiplyScalar(-1).sub(z).divide(D).add(Z.divide(D)).add(c);
                          this.setAnchor3d(K.x, K.y, K.z)
                      }
                      var R = new Rh(1,1,1).divide(W).multiply(G);
                      this.s3(Math.abs(R.x), Math.abs(R.y), Math.abs(R.z)),
                      delete t._updatingFromChildren
                  }
              }
          },
          setPosition: function(M, L) {
              var k = this;
              if (!k._updatingToChildren) {
                  var U;
                  U = 2 === arguments.length ? {
                      x: M,
                      y: L
                  } : M,
                  fj || k._updatingFromChildren || (k._updatingToChildren = 1,
                  Lc(k._children, U.x - k._position.x, U.y - k._position.y),
                  delete k._updatingToChildren),
                  ch.superClass.setPosition.call(this, U)
              }
          },
          setSize3d: function() {
              var p = this.getDataModel();
              p && p.beginTransaction(),
              ch.superClass.setSize3d.apply(this, arguments),
              p && p.endTransaction()
          },
          setTall: function(y) {
              var P = this;
              if (!P._updatingToChildren) {
                  var H = P.getDataModel();
                  H && H.beginTransaction(),
                  y = X(y, M.blockMinSize);
                  var i = P.getTall();
                  if (y !== i && ch.superClass.setTall.call(P, y),
                  !fj && !P._updatingFromChildren) {
                      P._updatingToChildren = 1;
                      var F = y / i;
                      P._adjustChildTallOrScale(F, "size"),
                      delete P._updatingToChildren,
                      P.updateFromChildren()
                  }
                  H && H.endTransaction()
              }
          },
          setWidth: function(S) {
              return this.setSize(S, this.getHeight())
          },
          setHeight: function(y) {
              return this.setSize(this.getWidth(), y)
          },
          setSize: function(Y, h) {
              var Q = M.blockMinSize;
              Y = X(Y, Q),
              h = X(h, Q);
              var _ = this;
              if (!_._updatingToChildren) {
                  2 !== arguments.length && (h = Y.height,
                  Y = Y.width);
                  var l = _.getDataModel();
                  l && l.beginTransaction();
                  var i = _.getWidth()
                    , k = _.getHeight();
                  if (Y !== i && ch.superClass.setWidth.call(_, Y),
                  h !== k && ch.superClass.setHeight.call(_, h),
                  !fj && !_._updatingFromChildren) {
                      _._updatingToChildren = 1;
                      var t = Y / i
                        , B = h / k;
                      _._adjustChildScaleOrSize(t, B, "size"),
                      delete _._updatingToChildren,
                      _.updateFromChildren()
                  }
                  l && l.endTransaction()
              }
          },
          _adjustChildScaleOrSize: function(b, I, M) {
              var F = this;
              if (F._syncSize) {
                  var R = F.getPosition()
                    , H = F.getRotation();
                  F.getScale(),
                  F.eachChild(function(W) {
                      if (ud(W)) {
                          var d = W.getPosition()
                            , N = W.getRotation()
                            , T = W.getWidth()
                            , G = W.getHeight()
                            , Y = W.getScale()
                            , u = Y.x * T
                            , A = Y.y * G
                            , F = new Ck(N,d.x,d.y,u,A);
                          F.translate(-R.x, -R.y),
                          F.rotate(-H),
                          N = a(F.b * Math.sign(u), F.a * Math.sign(u)),
                          F.scale(b, I);
                          var U, c, z, l = P(N);
                          if (Math.abs(l) < .001 ? (U = o(N),
                          c = F.b / U,
                          z = -F.c / U) : (c = F.a / l,
                          z = F.d / l),
                          "scale" === M)
                              W.setScale(c / T, z / G);
                          else if ("size" === M) {
                              var S = c / Y.x
                                , i = z / Y.y;
                              W.setScale(Mf(c) * Math.abs(Y.x), Mf(z) * Math.abs(Y.y)),
                              W instanceof n.Shape ? (W.setWidthForce(Math.max(Math.abs(S), 1e-5)),
                              W.setHeightForce(Math.max(Math.abs(i), 1e-5))) : W.setSize(Math.max(.01, Math.abs(S)), Math.max(.01, Math.abs(i)))
                          }
                          F.rotate(H),
                          F.translate(R.x, R.y),
                          W.setPosition(F.tx, F.ty)
                      }
                  })
              }
          },
          _calcChangeFactor: function(O, C, j, W) {
              var G, _, F, L;
              return G = u(O),
              _ = u(j),
              F = G > _ ? G / _ : _ / G,
              G = u(C),
              _ = u(W),
              L = G > _ ? G / _ : _ / G,
              X(F, L)
          },
          setElevation: function(R) {
              var I = this;
              if (!I._updatingToChildren) {
                  var r = I.getElevation()
                    , Y = R - r;
                  0 !== Y && (fj || I._updatingFromChildren || (I._updatingToChildren = 1,
                  Lc(I._children, 0, Y, 0),
                  delete I._updatingToChildren),
                  ch.superClass.setElevation.apply(I, arguments))
              }
          },
          setScaleTall: function(F) {
              var t = this;
              if (!t._updatingToChildren) {
                  var r = t.getScaleTall();
                  if (u(F) < .01 && (F = .01 * (Mf(F) || Mf(r))),
                  ch.superClass.setScaleTall.call(t, F),
                  !fj && !t._updatingFromChildren) {
                      t._updatingToChildren = 1;
                      var l = F / r;
                      t._adjustChildTallOrScale(l, "size"),
                      delete t._updatingToChildren,
                      this.updateFromChildren()
                  }
              }
          },
          _adjustChildTallOrScale: function(n, z) {
              var p = this;
              if (p._syncSize) {
                  var M = p.getElevation();
                  p.eachChild(function(m) {
                      if (ud(m))
                          if ("size" === z) {
                              var G = m.getTall();
                              0 > n && m.setScaleTall(-1 * m.getScaleTall()),
                              m.setTall(Math.max(.01, Math.abs(G * n))),
                              m.setElevation(M + (m.getElevation() - M) * n)
                          } else {
                              var o = m.getScaleTall();
                              m.setScaleTall(o * n)
                          }
                  })
              }
          },
          setAnchor3d: function() {
              if (!this._updatingToChildren) {
                  var F = this.getDataModel();
                  F && F.beginTransaction();
                  var P = ch.superClass.setAnchor3d.apply(this, arguments);
                  return P && !fj && !this._updatingFromChildren && this._syncSize && (this._anchorChanged = 1,
                  this.updateFromChildren(),
                  delete this._anchorChanged),
                  F && F.endTransaction(),
                  P
              }
          },
          setAnchor: function() {
              var H = this;
              if (!H._updatingToChildren) {
                  var Q = H.getAnchor()
                    , r = ch.superClass.setAnchor.apply(H, arguments);
                  if (fj || H._updatingFromChildren || !H._syncSize)
                      return r;
                  H._updatingToChildren = 1;
                  var n = H.getAnchor();
                  H.getPosition();
                  var f = H.getSize()
                    , v = H.getScale()
                    , N = H.getRotation()
                    , x = -f.width * v.x * (Q.x - n.x)
                    , g = -f.height * v.y * (Q.y - n.y)
                    , h = o(N)
                    , A = P(N)
                    , D = A * x - h * g
                    , s = h * x + A * g;
                  return H.eachChild(function(I) {
                      if (ud(I)) {
                          var $ = I.getPosition();
                          I.setPosition($.x - D, $.y - s)
                      }
                  }),
                  delete H._updatingToChildren,
                  r
              }
          },
          setAnchorElevation: function() {
              var N = this;
              if (!N._updatingToChildren) {
                  var B = N.getAnchorElevation()
                    , Y = ch.superClass.setAnchorElevation.apply(N, arguments);
                  if (fj || N._updatingFromChildren || !N._syncSize)
                      return Y;
                  N._updatingToChildren = 1;
                  var Z = N.getAnchorElevation()
                    , x = N.getTall()
                    , L = N.getScaleTall()
                    , d = -x * L * (B - Z);
                  return N.eachChild(function(y) {
                      if (ud(y)) {
                          var $ = y.getElevation();
                          y.setElevation($ - d)
                      }
                  }),
                  delete N._updatingToChildren,
                  Y
              }
          },
          setRotation: function(c) {
              this._updateChildrenRotation3d("rotation", c)
          },
          setRotationX: function(M) {
              this._updateChildrenRotation3d("rotationX", M)
          },
          setRotationZ: function(S) {
              this._updateChildrenRotation3d("rotationZ", S)
          },
          _updateChildrenRotation3d: function(O, f) {
              var C = this;
              if (!C._updatingToChildren) {
                  var q = C[bc(O)]();
                  if (ch.superClass[zn(O)].call(C, f),
                  !fj && !C._updatingFromChildren) {
                      C._updatingToChildren = 1;
                      var D = f - q;
                      C.eachChild(function(P) {
                          ud(P) && P._11Q(C, O, D)
                      }),
                      delete C._updatingToChildren
                  }
              }
          },
          setScale: function(J, e) {
              var d = this;
              if (!d._updatingToChildren) {
                  null == e && (e = J.y,
                  J = J.x);
                  var U = d.getScale();
                  if (u(J) < .01 && (J = .01 * (Mf(J) || Mf(U.x))),
                  u(e) < .01 && (e = .01 * (Mf(e) || Mf(U.y))),
                  ch.superClass.setScale.call(d, J, e),
                  !fj && !d._updatingFromChildren) {
                      d._updatingToChildren = 1;
                      var R = J / U.x
                        , G = e / U.y;
                      d._adjustChildScaleOrSize(R, G, "size"),
                      delete d._updatingToChildren,
                      d.updateFromChildren()
                  }
              }
          },
          getSerializableProperties: function() {
              var p = ch.superClass.getSerializableProperties.call(this);
              return p.clickThroughEnabled = 1,
              p.syncSize = 1,
              p
          }
      });
      var Fn = n.Grid = function() {
          Jg(n.Grid, this)
      }
      ;
      jq("Grid", Wd, {
          IRotatable: !1,
          _icon: "grid_icon",
          _image: E,
          getUIClass: function() {
              return pe
          },
          setRotation: function() {},
          getCellRect: function(h, k) {
              var o = this
                , e = o.s("grid.row.count")
                , p = o.s("grid.column.count");
              if (0 >= e || 0 >= p || 0 > h || h >= e || 0 > k || k >= p)
                  return E;
              var C, A, N, I = o.getRect(), s = o.s("grid.row.percents"), Q = o.s("grid.column.percents");
              if (Od(I, o, "grid.border", -1),
              s && s._as && (s = s._as),
              Q && Q._as && (Q = Q._as),
              s && s.length === e) {
                  for (N = 0,
                  C = 0; h > C; C++)
                      N += I.height * s[C];
                  I.y += N,
                  I.height = I.height * s[h]
              } else
                  I.height = I.height / e,
                  I.y += I.height * h;
              if (Q && Q.length === p) {
                  for (A = 0,
                  C = 0; k > C; C++)
                      A += I.width * Q[C];
                  I.x += A,
                  I.width = I.width * Q[k]
              } else
                  I.width = I.width / p,
                  I.x += I.width * k;
              return nk(I, -o.s("grid.gap")),
              I
          }
      });
      var Wg = n.Text = function() {
          Jg(Wg, this),
          this.setSize(100, 50),
          this.s("text", "TEXT")
      }
      ;
      jq("Text", Wd, {
          _icon: "text_icon",
          _image: "__text__",
          getUIClass: function() {
              return gf
          },
          setWidth: function(c) {
              c || (c = .001),
              Wg.superClass.setWidth.call(this, c)
          },
          setHeight: function(N) {
              N || (N = .001),
              Wg.superClass.setHeight.call(this, N)
          },
          toLabel: function() {
              return this._displayName || this._name || this.s("text")
          }
      }),
      re("__text__", {
          width: {
              value: 100,
              isSafeFunc: !0,
              func: function(x) {
                  return x ? x._width : 100
              }
          },
          height: {
              value: 50,
              isSafeFunc: !0,
              func: function(g) {
                  return g ? g._height : 50
              }
          },
          comps: [{
              type: "text",
              relative: !0,
              rect: [0, 0, 1, 1],
              text: {
                  func: "style@text"
              },
              align: {
                  func: "style@text.align"
              },
              vAlign: {
                  func: "style@text.vAlign"
              },
              color: {
                  func: "style@text.color"
              },
              font: {
                  func: "style@text.font"
              },
              shadow: {
                  func: "style@text.shadow"
              },
              shadowColor: {
                  func: "style@text.shadow.color"
              },
              shadowBlur: {
                  func: "style@text.shadow.blur"
              },
              shadowOffsetX: {
                  func: "style@text.shadow.offset.x"
              },
              shadowOffsetY: {
                  func: "style@text.shadow.offset.y"
              },
              scaleX: {
                  func: "style@text.scale.x"
              },
              scaleY: {
                  func: "style@text.scale.y"
              }
          }]
      });
      var Io = n.Shape = function() {
          Jg(Io, this),
          this._59O = new Mh
      }
      ;
      Io.__de__ = qr,
      jq("Shape", Wd, {
          ms_ac: ["thickness", "closePath"],
          _icon: "shape_icon",
          _thickness: 10,
          _closePath: !1,
          getUIClass: function() {
              return Ro
          },
          _22Q: function() {
              return lh
          },
          getLength: function(a) {
              return oo(_q(this._59O, this._58O, a, this._closePath))
          },
          getSegments: function() {
              return this._58O
          },
          toSegments: function() {
              var Z = this._58O;
              return Z ? new Mh(Z._as.slice(0)) : Z
          },
          setSegments: function(k) {
              var L = this._58O;
              k = k ? $c(k) ? new Mh(k.slice(0)) : new Mh(k._as.slice(0)) : null,
              (L && k && L._as.join(",") !== k._as.join(",") || L !== k) && (this._58O = k,
              this.fp("segments", L, k))
          },
          getPoints: function() {
              return this._59O
          },
          toPoints: function() {
              var a = this._59O;
              return new Mh(a._as.slice(0))
          },
          getPointsMatrix2d: function() {
              var W = this
                , s = new rk.Matrix2d
                , l = W.getPosition()
                , b = W.getScale()
                , t = W.getRotation();
              return s.translate(-l.x, -l.y).scale(b.x, b.y).rotate(t).translate(l.x, l.y),
              s
          },
          getPointsMatrix3d: function() {
              return function() {
                  var Y = this
                    , W = new rk.Matrix4
                    , t = W.getElements()
                    , r = Y.p3();
                  Bg(t, r),
                  tl(t, Y.getFinalRotation3d(), Y.getRotationMode());
                  var Z = Y.getScale3d()
                    , B = Y._dynamicScale3d;
                  return B && (Z[0] *= B[0],
                  Z[1] *= B[1],
                  Z[2] *= B[2]),
                  zf(t, Z),
                  Bg(t, un(r)),
                  W
              }
          }(),
          setPoints: function($, g) {
              var W = this
                , y = W._59O;
              $ = $ ? $c($) ? new Mh($.slice(0)) : new Mh($._as.slice(0)) : new Mh;
              var S, C, w, O, J, m;
              g && (S = W.getPosition(),
              m = new Ck(W.getRotation(),0,0,W.getScale().x,W.getScale().y)),
              (y && $ && y._as.join(",") !== $._as.join(",") || y !== $) && (W._59O = $,
              W.fs(),
              W.fp("points", y, $)),
              g && (C = W.getPosition(),
              w = C.x - S.x,
              O = C.y - S.y,
              J = m.tf(w, O),
              W.setPosition(C.x - w + J.x, C.y - O + J.y))
          },
          addPoint: function(K, S, N) {
              var M = this.toPoints();
              M.add(K, S),
              this.setPoints(M, N)
          },
          setPoint: function($, A, z) {
              var n = this.toPoints();
              n.set($, A),
              this.setPoints(n, z)
          },
          removePointAt: function(z) {
              var F = this.toPoints();
              F.removeAt(z),
              this.setPoints(F)
          },
          setWidthForce: function(A) {
              var m = this;
              if (!m._55I && !fj && m.getWidth()) {
                  m._55I = 1;
                  var o = m._position.x
                    , t = A / m.getWidth()
                    , e = m.toPoints()
                    , Y = new Mh;
                  1 !== t && (e.each(function(k) {
                      Y.add({
                          x: (k.x - o) * t + o,
                          y: k.y,
                          e: k.e
                      })
                  }),
                  m.setPoints(Y),
                  _j(m, [t, 0, 0, 1, o * (1 - t), 0]),
                  m.fs()),
                  delete m._55I
              }
              Io.superClass.setWidth.call(m, A)
          },
          setWidth: function(C) {
              return this.setWidthForce(Uk > C ? Uk : C)
          },
          setHeightForce: function(s) {
              var O = this;
              if (!O._55I && !fj && O.getHeight()) {
                  O._55I = 1;
                  var f = O._position.y
                    , Z = s / O.getHeight()
                    , G = O.toPoints()
                    , H = new Mh;
                  1 !== Z && (G.each(function(N) {
                      H.add({
                          x: N.x,
                          y: (N.y - f) * Z + f,
                          e: N.e
                      })
                  }),
                  O.setPoints(H),
                  _j(O, [1, 0, 0, Z, 0, f * (1 - Z)]),
                  O.fs()),
                  delete O._55I
              }
              Io.superClass.setHeight.call(O, s)
          },
          setHeight: function(S) {
              return this.setHeightForce(Uk > S ? Uk : S)
          },
          setAnchorElevation: function(i) {
              var V = this;
              V._55I = !0;
              var n = V._updatingAnchor3d
                , F = !fj && !n;
              if (F) {
                  var K, o = i, l = V.getAnchorElevation(), p = V.getTall();
                  K = p * (l - o),
                  0 !== K && V.shiftPointsElevation(K)
              }
              var C = Io.superClass.setAnchorElevation.apply(V, arguments);
              return n || delete V._55I,
              C
          },
          getShapeElevation: function() {
              var M = this
                , t = M._54O;
              return t - (M.getTall() || 0) * (M._anchorElevation - .5)
          },
          setAnchor3d: function(g, I, i, T) {
              var j, r = this;
              "number" == typeof g ? j = {
                  x: g,
                  y: I,
                  z: i
              } : (j = g.length ? {
                  x: g[0],
                  y: g[1],
                  z: g[2]
              } : g,
              T = I),
              r._55I = !0,
              r._updatingAnchor3d = !0;
              var b = r.getDataModel();
              if (b && b.beginTransaction(),
              !fj) {
                  var u = r.getAnchor3d()
                    , K = r.getSize()
                    , $ = r.getTall()
                    , n = K.width * (u.x - j.x)
                    , l = K.height * (u.z - j.z)
                    , w = $ * (u.y - j.y);
                  T || r.shiftPoints(n, l, w);
                  var A = r.p3()
              }
              var J = Io.superClass.setAnchor3d.apply(r, arguments);
              if (!fj && T) {
                  var h = r.p3();
                  r.shiftPoints(h[0] - A[0] + n, h[2] - A[2] + l, h[1] - A[1] + w)
              }
              return b && b.endTransaction(),
              delete r._updatingAnchor3d,
              delete r._55I,
              J
          },
          setAnchor: function(C, y, f) {
              var L = this;
              L._55I = !0;
              var T = L._updatingAnchor3d
                , Y = !fj && !T;
              if (Y) {
                  var z, p, F;
                  "number" == typeof C ? F = {
                      x: C,
                      y: y
                  } : (F = C.length ? {
                      x: C[0],
                      y: C[1]
                  } : C,
                  f = y);
                  var G = L.getAnchor()
                    , W = L.getSize();
                  z = W.width * (G.x - F.x),
                  p = W.height * (G.y - F.y),
                  f || L.shiftPoints(z, p);
                  var X = L.getPosition()
              }
              var M = Io.superClass.setAnchor.apply(L, arguments);
              if (Y) {
                  var K = L.getPosition();
                  f && L.shiftPoints(K.x - X.x + z, K.y - X.y + p)
              }
              return T || delete L._55I,
              M
          },
          shiftPoints: function(e, c, X) {
              if (e || c || X) {
                  var t = this
                    , f = t.getElevation() || 0
                    , Z = t.toPoints()
                    , z = new Mh;
                  Z.each(function(j) {
                      var g = j.e;
                      X && (g = (g == E ? f : g) + X),
                      z.add({
                          x: j.x + e,
                          y: j.y + c,
                          e: g
                      })
                  }),
                  t.setPoints(z),
                  t.fs()
              }
          },
          shiftPointsElevation: function(s) {
              return this.shiftPoints(0, 0, s)
          },
          setPosition: function(y, p) {
              var L, B = this;
              if (!B._28Q) {
                  if (B._28Q = 1,
                  !B._55I && !fj) {
                      L = 2 === arguments.length ? {
                          x: y,
                          y: p
                      } : y;
                      var I = L.x - B._position.x
                        , t = L.y - B._position.y;
                      if (0 === I && 0 === t)
                          return delete B._28Q,
                          void 0;
                      B._55I = 1,
                      B.shiftPoints(I, t),
                      _j(B, [1, 0, 0, 1, I, t]),
                      delete B._55I
                  }
                  Io.superClass.setPosition.apply(B, arguments),
                  delete B._28Q
              }
          },
          fs: function() {
              this.fireShapeChange()
          },
          _70I: function() {
              var j = this;
              if (2 !== j._59O.size())
                  return !1;
              var F = j._58O;
              return F ? 2 === F.size() && 1 === F.get(0) && 2 === F.get(1) ? !0 : !1 : !0
          },
          fireShapeChange: function() {
              var J = this;
              if (!J._55I && !fj) {
                  var T = kr(J._59O);
                  T && (J._55I = 1,
                  J.setRect(T),
                  delete J._55I)
              }
              J.fp(Zr, !1, !0)
          },
          getSerializableProperties: function() {
              var g = Io.superClass.getSerializableProperties.call(this);
              return g.segments = 1,
              g.points = 1,
              g.thickness = 1,
              g.closePath = 1,
              g
          }
      });
      var zr = n.Points = function() {
          Jg(zr, this)
      }
      ;
      jq("Points", Wd, {
          _22Q: function() {
              return Aq
          },
          setPoints: function(m) {
              this.points = m,
              this._pointsDirty = !0,
              this.fp("points", E, this.points)
          },
          setPoint: function(b, L) {
              this.points || (this.points = []),
              this.points[3 * b] = L[0],
              this.points[3 * b + 1] = L[1],
              this.points[3 * b + 2] = L[2],
              this._pointsDirty = !0,
              this.fp("points", E, this.points)
          },
          setPointsColor: function(C) {
              this.colors = C,
              this._colorsDirty = !0,
              this.fp("colors", E, this.colors)
          },
          setPointColor: function(L, w) {
              this.colors || (this.colors = []),
              w ? (w = bd(w),
              this.colors[3 * L] = w[0],
              this.colors[3 * L + 1] = w[1],
              this.colors[3 * L + 2] = w[2]) : (this.colors[3 * L] = V,
              this.colors[3 * L + 1] = V,
              this.colors[3 * L + 2] = V),
              this._colorsDirty = !0,
              this.fp("colors", E, this.colors)
          },
          setPointsSize: function(L) {
              this.sizes = L,
              this._sizesDirty = !0,
              this.fp("sizes", E, this.sizes)
          },
          setPointSize: function(D, e) {
              this.sizes || (this.sizes = []),
              this.sizes[D] = e ? e : V,
              this._sizesDirty = !0,
              this.fp("sizes", E, this.sizes)
          },
          getPointInfo: function(t) {
              var P = 3 * t
                , r = this.points;
              if (!r || r[P] === V || r[P + 1] === V || r[P + 2] === V)
                  return null;
              var p = [r[P], r[P + 1], r[P + 2]]
                , f = this.mat || Dp(this)
                , l = [p[0], p[1], p[2]];
              Wb(l, f);
              var O = this.colors;
              return {
                  size: this.sizes && this.size[t] || this.s("points.size"),
                  color: O && O[P] ? [O[P], O[P + 1], O[P + 2]] : this.s("points.color"),
                  local: p,
                  world: l
              }
          },
          getSerializableProperties: function() {
              var C = zr.superClass.getSerializableProperties.call(this);
              return C.points = 1,
              C.colors = 1,
              C.sizes = 1,
              C
          }
      });
      var Wp = n.Polyline = function() {
          Jg(Wp, this),
          this.s({
              "shape.background": null,
              "shape.border.width": 2
          })
      }
      ;
      jq("Polyline", Io, {
          _icon: "polyline_icon",
          _22Q: function() {
              return Ds
          },
          getUIClass: function() {
              return Gd
          },
          setClosePath: function() {},
          setTall: function(U) {
              var c = this
                , M = c.getDataModel();
              if (M && M.beginTransaction(),
              !c._55I && !c._24Q && !fj && c.getTall()) {
                  c._24Q = 1;
                  var i = c._54O
                    , y = U / c.getTall();
                  if (1 !== y) {
                      var H = c.toPoints()
                        , g = new Mh;
                      H.each(function(I) {
                          g.add({
                              x: I.x,
                              y: I.y,
                              e: I.e == E ? I.e : (I.e - i) * y + i
                          })
                      }),
                      c.setPoints(g),
                      c.fs()
                  }
                  delete c._24Q
              }
              Wp.superClass.setTall.call(c, U),
              M && M.endTransaction()
          },
          setElevation: function(n) {
              var X = this
                , K = X.getDataModel();
              if (K && K.beginTransaction(),
              !X._55I && !X._24Q && !fj) {
                  X._24Q = 1;
                  var k = n - X._54O;
                  0 !== k && X.shiftPointsElevation(k),
                  delete X._24Q
              }
              Wp.superClass.setElevation.apply(X, arguments),
              K && K.endTransaction()
          },
          fireShapeChange: function() {
              var W = this
                , O = W._59O;
              if (!W._55I && !W._24Q && !fj) {
                  var B = O.size();
                  if (B) {
                      var v = 1
                        , A = O.get(0)
                        , t = W._54O;
                      A.e == E && (A.e = t);
                      for (var I = A.e, s = 0; B > v; v++) {
                          A = O.get(v),
                          A.e == E && (A.e = t);
                          var k = K(I, A.e)
                            , b = X(I + s, A.e);
                          I = k,
                          s = b - k
                      }
                      W._24Q = 1,
                      W.setTall(s),
                      W.setElevation(I + s * W._anchorElevation),
                      delete W._24Q
                  }
              }
              Wp.superClass.fireShapeChange.apply(W, arguments)
          }
      });
      var Vp = n.SubGraph = function() {
          Jg(Vp, this)
      }
      ;
      jq("SubGraph", Wd, {
          ISubGraph: 1,
          _image: "subGraph_image",
          _icon: "subGraph_icon",
          _8I: function() {
              Vp.superClass._8I.call(this),
              this.eachChild(function(x) {
                  ud(x) && x._8I()
              })
          }
      }),
      M.loadingRefGraph = 0;
      var Oq = n.RefGraph = function() {
          Jg(Oq, this)
      }
      ;
      jq("RefGraph", ch, {
          _icon: "refGraph_icon",
          getRef: function() {
              return this._ref
          },
          setRef: function(W) {
              var f = this._ref;
              this._ref = W,
              this.fp("ref", f, W),
              this.updateRef()
          },
          _21I: function() {
              Oq.superClass._21I.apply(this, arguments),
              this.updateRef()
          },
          updateRef: function() {
              var D = this;
              if (M.loadingRefGraph++,
              D.clearChildrenFromDataModel(),
              M.loadingRefGraph--,
              D._ref && D._dataModel) {
                  D._xhrLoadHandler && (D._xhrLoadHandler.cancel = !0);
                  var e = fj
                    , w = D._xhrLoadHandler = function($) {
                      if ($ && D._dataModel) {
                          M.loadingRefGraph++;
                          var d = D._pendingUpdateInfo = {
                              needToRestore: e
                          };
                          e && (d.p3 = D.p3(),
                          d.s3 = D.s3(),
                          d.r3 = D.r3(),
                          d.anchor3d = D.getAnchor3d(),
                          d.scale3d = D.getScale3d()),
                          D.r3(0, 0, 0),
                          D.setScale3d(1, 1, 1),
                          D.setAnchor3d(.5, .5, .5),
                          D.p3(0, 0, 0);
                          var O = M.parse($)
                            , z = D._dataModel.deserialize(O, D, {
                              justDatas: !0
                          });
                          z.each(function(k) {
                              k._refGraph = D
                          }),
                          D.checkPendingUpdateInfo(),
                          M.loadingRefGraph--,
                          M.handleRefGraphLoaded(D, z, O)
                      }
                  }
                  ;
                  w.xhrLoadCalled = !1,
                  M.load(D._ref, function($) {
                      w.cancel || (w.xhrLoadCalled ? w($) : rb(function() {
                          w($)
                      }))
                  }),
                  w.xhrLoadCalled = !0
              }
          },
          checkPendingUpdateInfo: function() {
              var S = this
                , o = S._pendingUpdateInfo;
              if (!o)
                  return S.onPendingUpdated && (M.loadingRefGraph++,
                  S.onPendingUpdated(),
                  M.loadingRefGraph--),
                  void 0;
              var T = !0;
              this.eachChild(function(Q) {
                  (Q._pendingCheckImageJSON || Q._pendingUpdateInfo) && (T = !1)
              }),
              T && (M.loadingRefGraph++,
              S._pendingUpdateInfo = null,
              S.updateFromChildren(),
              o.needToRestore && (S.setAnchor3d(o.anchor3d),
              S.setScale3d(o.scale3d),
              S.r3(o.r3),
              S.p3(o.p3)),
              this.getParent()instanceof Oq && this.getParent().checkPendingUpdateInfo(),
              S.onPendingUpdated && S.onPendingUpdated(),
              M.loadingRefGraph--)
          },
          getSerializableProperties: function() {
              var V = Oq.superClass.getSerializableProperties.call(this);
              return V.ref = 1,
              V
          }
      }),
      n.EdgeGroup = function(u, k) {
          this._70O = u,
          this._siblings = k;
          for (var X, i, T = 0, N = u.size(), z = U[xl]; N > T; T++)
              if (X = u.get(T).getStyle(xl, !1),
              X != E) {
                  z = X;
                  break
              }
          z == E && (z = !0);
          var O = M.edgeGroupAgentFunc;
          for (O && (i = O(u),
          i && i !== u.get(0) && (u.remove(i),
          u.add(i, 0))),
          T = 0; N > T; T++)
              u.get(T).s(xl, z)
      }
      ,
      jq("EdgeGroup", G, {
          getEdges: function() {
              return this._70O
          },
          size: function() {
              return this._70O.size()
          },
          get: function(S) {
              return this._70O.get(S)
          },
          indexOf: function(W) {
              return this._70O.indexOf(W)
          },
          each: function($, C) {
              this._70O.each($, C)
          },
          getSiblings: function() {
              return this._siblings
          },
          eachSiblingEdge: function(U, Y) {
              this._siblings.each(function(e) {
                  e._70O.each(U, Y)
              })
          }
      });
      var km = function(t, X, v) {
          var g = cb[t] = {
              type: t,
              action: X
          };
          if (v)
              for (var B in v)
                  g[B] = v[B]
      };
      rc(M, {
          setConnectAction: km,
          getConnectAction: function(Q, J) {
              if (!J) {
                  if (!Q)
                      return null;
                  J = Q.getCurrentConnectActionType()
              }
              return cb[J]
          },
          doConnectAction: function(p, U, E, K) {
              K = K || p.getCurrentConnectActionType();
              var u = cb[K];
              if (!u)
                  return !1;
              var S = u.action;
              return S ? (U instanceof ml.Group ? p.sm().getSelection().each(function(n) {
                  S.call(null, p, n, E)
              }) : S.call(null, p, U, E),
              !0) : !1
          },
          doDeleteConnectionAction: function(d, J, I) {
              I = I || d.getCurrentConnectActionType();
              var H = cb[I];
              if (!H || !H.delete)
                  return !1;
              var x = H.delete.action;
              return x ? (J instanceof ml.Group ? d.sm().getSelection().each(function(A) {
                  x.call(null, d, A)
              }) : x.call(null, d, J),
              !0) : !1
          }
      });
      var di = n.JSONSerializer = function(H, k) {
          this.dm = this._dataModel = H,
          this._hierarchical = M.forceHierarchicalSerialization ? !0 : k == E ? H.isHierarchicalRendering() : k
      }
      ;
      jq("JSONSerializer", G, {
          ms_ac: ["hierarchical"],
          serialize: function(T) {
              return M.stringify(this.toJSON(), T)
          },
          toJSON: function() {
              var r = this
                , F = r.dm
                , P = F.getRoots()
                , y = r.json = {
                  v: M.getVersion(),
                  p: {},
                  a: {},
                  d: []
              }
                , C = F.getSerializableAttrs();
              F.getInit() && (y.init = F.getInit()),
              F.getName() && (y.p.name = F.getName()),
              F.getBackground() && (y.p.background = F.getBackground()),
              F.getLayers() && (y.p.layers = F.getLayers()),
              F.getEnvmap() && (y.p.envmap = F.getEnvmap()),
              F.isCubicEnvmap() && (y.p.cubicEnvmap = F.isCubicEnvmap()),
              y.p.autoAdjustIndex = F.isAutoAdjustIndex(),
              y.p.hierarchicalRendering = F.isHierarchicalRendering();
              for (var o in C) {
                  var i = F.a(o);
                  i !== V && r[Bf](o, i, y.a)
              }
              return Qm(y.a) && delete y.a,
              r._hierarchical ? P.each(r.serializeData, this) : F.each(function(C) {
                  r.serializeData(C)
              }),
              F.fireSerializeEvent({
                  type: "serialize",
                  json: y
              }),
              F.getPostProcessingData() && (y.p.postProcessingData = F.getPostProcessingData()),
              y
          },
          isSerializable: function() {
              return !0
          },
          getProperties: function(L) {
              return L.getSerializableProperties()
          },
          getStyles: function(x) {
              return x.getSerializableStyles()
          },
          getAttrs: function(c) {
              return c.getSerializableAttrs()
          },
          serializeData: function(L) {
              var P = this;
              if (P.isSerializable(L) && !L._refGraph) {
                  var u, j, T, B, R = No(L.getClassName()) || L.getClass(), l = new R, o = {
                      c: L.getClassName(),
                      i: L.getId(),
                      p: {},
                      s: {},
                      a: {}
                  };
                  P.json.d.push(o),
                  u = P.getProperties(L);
                  for (j in u)
                      if (/^_/.test(j)) {
                          if (T = L[j],
                          !("_width" !== j && "_height" !== j || T != E && -1 !== T)) {
                              var U;
                              ((L.s("layout.h") || L.s("layout.v")) && L.getHost() || L instanceof n.Node && (U = L.getParent()) && U instanceof n.Block || L.s("fullscreen")) && (T = L[j] = "_width" === j ? L.getWidth() : L.getHeight())
                          }
                          T !== l[j] && P[Bf](j.substr(1), T, o.p)
                      } else
                          B = bc(j),
                          L[B] && (T = L[B](),
                          T !== l[B]() && P[Bf](j, T, o.p));
                  u = P.getStyles(L);
                  for (j in u)
                      T = L.s(j),
                      T !== l.s(j) && P[Bf](j, T, o.s);
                  u = P.getAttrs(L);
                  for (j in u)
                      T = L.a(j),
                      T !== l.a(j) && P[Bf](j, T, o.a);
                  Qm(o.p) && delete o.p,
                  Qm(o.s) && delete o.s,
                  Qm(o.a) && delete o.a
              }
              P._hierarchical && L.getChildren().each(P.serializeData, P)
          },
          serializeValue: function(Z, T, Y) {
              fb(T) ? T = {
                  __a: T._as
              } : T instanceof _i && (T = {
                  __i: T.getId()
              }),
              Y[Z] = T
          },
          deserialize: function(T, h, Q) {
              var Z = this;
              return Xq(T) && /.json$/.test(T) ? (M.xhrLoad(T, function(B) {
                  Z.deserializeImpl(B, h, Q)
              }),
              void 0) : Z.deserializeImpl(T, h, Q)
          },
          deserializeImpl: function(t, r, f) {
              var R = this
                , L = R.dm;
              L.setDeserializing(!0),
              f = mf(f) ? {
                  setId: f
              } : Oi(f) ? {
                  finishFunc: f
              } : f || {},
              t = R.json = Xq(t) ? M.parse(t) : t,
              !f.justDatas && t.a && t.a.onPreDeserialize && !f.disableOnPreDeserialize && t.a.onPreDeserialize(t, L, f.view),
              L.beginTransaction(),
              fj++,
              R._82I = {};
              var K = new Mh
                , q = new Mh
                , u = 0
                , N = t.d.length;
              if (f.justDatas || (!f.disableInit && Oi(t.init) && t.init(L),
              L.setInit(t.init)),
              !f.justDatas) {
                  for (var w in t.a)
                      L.a(w, R[xn](t.a[w]));
                  for (var A in t.p)
                      L[zn(A)](t.p[A])
              }
              for (; N > u; u++) {
                  var I = t.d[u]
                    , h = No(I.c)
                    , d = new h
                    , V = I.i;
                  f.setId && V != E && (d._id = V),
                  R._82I[V] = d,
                  K.add(d),
                  q.add(I)
              }
              for (u = 0; N > u; u++)
                  R.deserializeData(K.get(u), q.get(u));
              return K.each(function(y) {
                  r && !y.getParent() && y.setParent(r),
                  L.add(y)
              }),
              f.__innerHandler__ && f.__innerHandler__(t, L, f.view, K),
              L.fireSerializeEvent({
                  type: "deserialize",
                  json: t
              }),
              fj--,
              L.endTransaction(),
              !f.justDatas && t.a && t.a.onPostDeserialize && !f.disableOnPostDeserialize && t.a.onPostDeserialize(t, L, f.view, K),
              f.finishFunc && f.finishFunc(t, L, f.view, K),
              L.setDeserializing(!1),
              K
          },
          deserializeData: function(y, j) {
              for (var L in j.p)
                  y[zn(L)](this[xn](j.p[L]));
              for (L in j.s)
                  y.s(L, this[xn](j.s[L]));
              for (L in j.a)
                  y.a(L, this[xn](j.a[L]))
          },
          deserializeValue: function(K) {
              if (Ql(K)) {
                  var _ = K.__i;
                  if (_ != E)
                      return this._82I[_];
                  if (_ = K.__a,
                  $c(_))
                      return new Mh(_)
              }
              return K
          }
      }),
      rc(em, {
          serialize: function(u, D) {
              return new di(this,D).serialize(u)
          },
          toJSON: function(t) {
              return new di(this,t).toJSON()
          },
          deserialize: function(k, S, d) {
              return new di(this).deserialize(k, S, d)
          }
      });
      var Pd = n.OverlappingBox = function(Z) {
          this.gv = Z,
          this.boxes = {}
      }
      ;
      jq("OverlappingBox", G, {
          clear: function() {
              var t, M, u = this.boxes;
              for (t in u)
                  M = u[t],
                  M.length = 0
          },
          isOverlapping: function(Z, l) {
              var L, K, R = this, x = R.boxes, C = x[Z];
              C ? (L = C.rects,
              K = C.length) : C = x[Z] = {
                  rects: L = [],
                  length: K = 0
              };
              var o, Q, l;
              for (o = 0; K > o; o++)
                  if (Q = L[o],
                  Q.x < l.x + l.w && Q.x + Q.w > l.x && Q.y < l.y + l.h && Q.h + Q.y > l.y)
                      return !0;
              return L.length <= K ? (L.push(l),
              C.length++) : L[C.length++] = l,
              !1
          }
      }),
      rc(M, {
          fetch: function(O, R) {
              var $ = "GET"
                , Q = !1
                , W = null
                , g = "";
              R && ($ = R.method || "GET",
              Q = R.sync,
              g = R.url,
              W = R.data || null),
              O.open($, g, !Q),
              R.responseType ? O.responseType = R.responseType : R.overrideMimeType && O.overrideMimeType && O.overrideMimeType(R.overrideMimeType),
              O.send(W)
          },
          convertImageSrc: function(M, g) {
              g && "function" == typeof g || (g = function() {}
              ),
              g(M)
          }
      });
      var tn = n.Request = function() {
          this._xhr = new XMLHttpRequest,
          this._onloadFunc = function() {}
          ,
          this._errorFunc = function() {}
      }
      ;
      jq("Request", G, {
          _responseType: null,
          _overrideMimeType: "text/plain",
          send: function(P) {
              var f = this._xhr
                , R = this.onload
                , i = this.onerror;
              this.getResponseType() ? P.responseType = this.getResponseType() : this.getOverrideMimeType() && (P.overrideMimeType = this.getOverrideMimeType()),
              f.onload = R,
              f.onerror = i,
              M.fetch(f, P)
          },
          onload: function() {},
          onerror: function() {},
          getResponseType: function() {
              return this._responseType
          },
          setResponseType: function(d) {
              this._responseType = d
          },
          getOverrideMimeType: function() {
              return this._overrideMimeType
          },
          setOverrideMimeType: function(X) {
              this._overrideMimeType = X
          },
          getResponseText: function() {
              var W = this._xhr;
              return W.response || W.responseText
          }
      }),
      qg.GraphView = function(I) {
          var E = this;
          E._24I = {},
          E._34I = new Mh,
          E._25I = {},
          E._56I = {},
          E._view = Te(1, E),
          E._canvas = Jl(E._view),
          E.dm(I ? I : new em),
          this._coreInteractor = new Zf(this),
          E.setEditable(!1),
          E.setScrollBarVisible(M.graphViewScrollBarVisible),
          E._initView()
      }
      ,
      Kh("GraphView", G, {
          ms_v: 1,
          ms_gv: 1,
          ms_bnb: 1,
          ms_tip: 1,
          ms_dm: 1,
          ms_lp: 1,
          ms_fire: 1,
          ms_sm: 1,
          _49o: 1,
          ms_txy: 1,
          _52o: 1,
          _51o: 1,
          ms_ac: [yq, yl, Yr, bi, "resettable", "editInteractor", Lh, "zoomable", "pannable", "rectSelectable", "autoScrollZone", sq, "movableFunc", "editableFunc", "pointEditableFunc", "rectEditableFunc", "rotationEditableFunc", "anchorEditableFunc", "rectSelectBackground", "rectSelectBorderColor", "editPointSize", "editPointBorderColor", "editPointBackground", "hoverDelay"],
          _zoomable: M.graphViewZoomable,
          _resettable: M.graphViewResettable,
          _pannable: M.graphViewPannable,
          _rectSelectable: M.graphViewRectSelectable,
          _autoScrollZone: M.graphViewAutoScrollZone,
          _rectSelectBackground: M.graphViewRectSelectBackground,
          _rectSelectBorderColor: M.graphViewRectSelectBorderColor,
          _editPointSize: M.graphViewEditPointSize,
          _editPointBorderColor: M.graphViewEditPointBorderColor,
          _editPointBackground: M.graphViewEditPointBackground,
          _scrollBarColor: ej,
          _scrollBarSize: _n,
          _autoHideScrollBar: Ch,
          _autoMakeVisible: Bc,
          _currentActionType: null,
          getCoreInteractor: function() {
              return this._coreInteractor
          },
          getLayers: function() {
              return this._dataModel.getLayers()
          },
          setLayers: function(s) {
              this._dataModel.setLayers(s)
          },
          setEditable: function(F) {
              var y = this
                , t = y.__interactorMap__;
              if (!t) {
                  var s = qg.XEditInteractor;
                  t = y.__interactorMap__ = {
                      scrollBar: new Th(y),
                      select: new th(y),
                      edit: s ? new s(y) : new ce(y),
                      text: new tq(y),
                      move: new Hb(y),
                      "default": new Sj(y),
                      touch: new Cd(y,{
                          editable: !1
                      })
                  }
              }
              F ? (y._uieditable = !0,
              y.setInteractors([t.scrollBar, t.select, t.edit, t.text, t.move, t.default, t.touch])) : (y._uieditable = !1,
              y.setInteractors([t.scrollBar, t.select, t.move, t.default, t.touch]))
          },
          getCanvas: function() {
              return this._canvas
          },
          _33I: function(s) {
              var Q = s.getUIClass();
              return Q ? new Q(this,s) : E
          },
          getDataUI: function(F) {
              var E = this
                , C = E._25I[F._id];
              return C === V && (C = E._33I(F),
              E._25I[F._id] = C),
              C
          },
          getNodeRect: function(O) {
              return M.getNodeRect(this, O)
          },
          getFullscreenDatas: function() {
              return this._dataModel.getFullscreenDatas()
          },
          getEdgeInfo: function(s) {
              var t = this.getDataUI(s);
              return t ? (t._79o(),
              t._78o) : null
          },
          getEdgeSourcePosition: function(X) {
              var U = this
                , h = U.getDataUI(X)
                , i = h.s
                , p = h._data._40I;
              return or(U, p, i("edge.source.position"), i("edge.source.offset.x"), i("edge.source.offset.y"), i("edge.source.anchor.x"), i("edge.source.anchor.y"))
          },
          getEdgeTargetPosition: function(r) {
              var d = this
                , W = d.getDataUI(r)
                , J = W.s
                , c = W._data._41I;
              return or(d, c, J("edge.target.position"), J("edge.target.offset.x"), J("edge.target.offset.y"), J("edge.target.anchor.x"), J("edge.target.anchor.y"))
          },
          invalidateAll: function(U) {
              var z = this;
              if (U) {
                  for (var i in z._25I) {
                      var Z = z._25I[i];
                      Z && Z.dispose()
                  }
                  z._25I = {},
                  z._56I = {},
                  z._24I = {},
                  z._34I.clear(),
                  z.redraw()
              } else
                  z.dm().each(function(g) {
                      z.invalidateData(g)
                  })
          },
          invalidateSelection: function() {
              var $ = this;
              $.sm().each(function(V) {
                  $.invalidateData(V)
              })
          },
          invalidateData: function(d) {
              var u = this;
              u._24I[d._id] = d,
              u._21Q(d),
              u.iv()
          },
          _21Q: function(j) {
              var U = this
                , V = U._24I;
              if (ji(j) && hn[j.s(vj)]) {
                  var t = j.getSourceAgent();
                  t && t.getAgentEdges().each(function(b) {
                      V[b._id] = b
                  }),
                  t = j.getTargetAgent(),
                  t && t.getAgentEdges().each(function(X) {
                      V[X._id] = X
                  }),
                  U.iv()
              }
          },
          redraw: function(j) {
              var v = this;
              v._32I || (j ? v._34I.add(j) : (v._32I = 1,
              v._34I.clear()),
              v.iv())
          },
          each: function(H, Z) {
              var K, N, e, p = 0, F = this.getLayers(), q = this._dataModel, g = q._datas._as, E = g.length;
              if (F) {
                  for (var B = F.length; B > p; p++)
                      if (e = F[p],
                      Ql(e) && (e = e.name),
                      q.isHierarchicalRendering()) {
                          var a = function(y) {
                              return y._layer === e ? Z ? H.call(Z, y) : H(y) : void 0
                          };
                          if (this._dataModel.eachByHierarchical(a) === !1)
                              return
                      } else
                          for (var S = 0; E > S; S++)
                              if (K = g[S],
                              K._layer === e && (N = Z ? H.call(Z, K) : H(K),
                              N === !1))
                                  return
              } else if (q.isHierarchicalRendering())
                  this._dataModel.eachByHierarchical(H, null, Z);
              else
                  for (; E > p; p++)
                      if (K = g[p],
                      N = Z ? H.call(Z, K) : H(K),
                      N === !1)
                          return
          },
          reverseEach: function(K, h) {
              var $, Z, G, L, Q = this._dataModel, z = Q._layers, X = Q._datas._as, M = X.length;
              if (z) {
                  for ($ = z.length - 1; $ >= 0; $--)
                      if (L = z[$],
                      Ql(L) && (L = L.name),
                      Q.isHierarchicalRendering()) {
                          var j = function(I) {
                              return I._layer === L ? h ? K.call(h, I) : K(I) : void 0
                          };
                          if (Q.reverseEachByHierarchical(j) === !1)
                              return
                      } else
                          for (var n = M - 1; n >= 0; n--)
                              if (Z = X[n],
                              Z._layer === L && (G = h ? K.call(h, Z) : K(Z),
                              G === !1))
                                  return
              } else if (Q.isHierarchicalRendering())
                  Q.reverseEachByHierarchical(K, null, h);
              else
                  for ($ = M - 1; $ >= 0; $--)
                      if (Z = X[$],
                      G = h ? K.call(h, Z) : K(Z),
                      G === !1)
                          return
          },
          getViewRect: function() {
              return this._29I
          },
          getContentRect: function() {
              var h = this
                , Z = h._84I;
              if (!Z) {
                  var f = this.dm().a("width")
                    , s = this.dm().a("height");
                  f > 0 && s > 0 ? h._84I = {
                      x: 0,
                      y: 0,
                      width: f,
                      height: s
                  } : (h.each(function(F) {
                      h.isVisible(F) && (Z = Ee(Z, h.getDataUIBounds(F)))
                  }),
                  h._84I = Z ? Z : Wk)
              }
              return h._84I
          },
          getScrollRect: function() {
              return Ee(this.getContentRect(), this._29I)
          },
          makeCenter: function(d, Z, y) {
              var D = this;
              if (!D.getWidth() || !D.getHeight())
                  return y || rb(D.makeCenter, D, [d, Z, !0], 500),
                  void 0;
              D.makeVisible(d),
              D.validate();
              var L = D.getDataUIBounds(d);
              if (L) {
                  var I = D.getWidth()
                    , M = D.getHeight()
                    , S = L.x + L.width / 2
                    , _ = L.y + L.height / 2
                    , T = -S * D._zoom + I / 2
                    , c = -_ * D._zoom + M / 2;
                  D.setTranslate(T, c, Z)
              }
          },
          fitData: function(L, g, e, J, q) {
              var v = this;
              if (!v.getWidth() || !v.getHeight())
                  return q || rb(v.fitData, v, [L, g, e, J, !0], 500),
                  void 0;
              var n = function() {
                  v.makeVisible(L),
                  v.validate();
                  var j = v.getDataUIBounds(L);
                  j && (j = Ej(j),
                  nk(j, e == E ? 20 : e),
                  v.fitRect(j, g, J))
              };
              g ? M.callWhenLoaded(n) : n()
          },
          fitContent: function(P, $, G, z) {
              var Q = this;
              if (!Q.getWidth() || !Q.getHeight())
                  return z || rb(Q.fitContent, Q, [P, $, G, !0], 500),
                  void 0;
              var y = function() {
                  Q.validate();
                  var i = Ej(Q.getContentRect());
                  nk(i, $ == E ? 20 : $),
                  Q.fitRect(i, P, G)
              };
              P ? M.callWhenLoaded(y) : y()
          },
          fitRect: function(V, Z, z) {
              var M = this
                , f = M.getWidth()
                , Q = M.getHeight()
                , j = V.x + V.width / 2
                , u = V.y + V.height / 2
                , O = K(f / V.width, Q / V.height)
                , c = M._zoom
                , J = -j * c + f / 2
                , S = -u * c + Q / 2;
              0 === O || isNaN(O) || (z && (O = K(1, O)),
              Z ? (M._65I && (delete M._65I.finishFunc,
              M._65I.stop(!0)),
              M._14o && M._14o.stop(!0),
              M.setTranslate(J, S, {
                  finishFunc: function() {
                      M.setZoom(O, Z)
                  }
              })) : (M.setTranslate(J, S),
              M.setZoom(O)))
          },
          fitSelection: function(r, P, l) {
              var W = this
                , G = W.sm()
                , M = null;
              G.size() && (G.each(function(r) {
                  M = Ee(W.getDataUIBounds(r), M)
              }),
              r && nk(M, r),
              W.fitRect(M, P, l))
          },
          toCanvas: function(U, f, F) {
              f = f || this._zoom,
              this.validateImpl();
              var i = this
                , o = i.getContentRect();
              F && nk(o, F),
              o.width || (o.width = 10),
              o.height || (o.height = 10);
              var J = Jl()
                , b = o.x * f
                , m = o.y * f
                , Q = Math.ceil(o.width * f)
                , _ = Math.ceil(o.height * f);
              Uj(J, Q, _, 1);
              var j = hq(J);
              return U = U || this._dataModel.getBackground(),
              U && xg(j, 0, 0, Q, _, U),
              od(j, -b, -m),
              j.scale(f, f),
              i._42(j),
              j.restore(),
              J
          },
          toDataURL: function(C, R, Z, j) {
              return this.toCanvas(C, Z, j).toDataURL(R || "image/png", 1)
          },
          getClipBounds: function() {
              return this._74O
          },
          _42: function(W, A) {
              var v = this
                , U = v.dm().getBackground();
              if (U) {
                  var u = v.dm().a("width")
                    , Q = v.dm().a("height");
                  u > 0 && Q > 0 && xg(W, 0, 0, u, Q, U)
              }
              var P = v.__htmlOrderList
                , K = []
                , l = v._forcedLayoutHTML;
              if (v._93db(W, A),
              v.each(function(b) {
                  var p = v.getDataUI(b);
                  if (p) {
                      var o = v._56I[b._id]
                        , H = p._htmlView;
                      if (o) {
                          var _ = p._79o();
                          if (H = p._htmlView,
                          n.HtmlNode && b instanceof n.HtmlNode)
                              p._42(W);
                          else {
                              var E = v.getViewRect()
                                , F = H && H.layoutHTML;
                              !A || Ib(A, _) ? (F && (H.layoutHTML(),
                              p.__outerLayout && delete p.__outerLayout),
                              p._42(W)) : Ib(E, _) || !F || p.__outerLayout && !l || (H.layoutHTML(),
                              p.__outerLayout = !0)
                          }
                      }
                      H && (K.push(H),
                      H.getView && (H = H.getView()),
                      H.style.display = o ? "block" : pk)
                  }
              }),
              P && K.length > 0) {
                  var y = !1;
                  if (P.length !== K.length)
                      y = !0;
                  else
                      for (var E = 0; E < K.length; E++)
                          if (K[E] !== P[E]) {
                              y = !0;
                              break
                          }
                  y && (K.forEach(function(p) {
                      p.autoAdjustIndex !== !1 && v.appendHTML(p, !0)
                  }),
                  this.__htmlOrderList = K)
              } else
                  this.__htmlOrderList = K;
              v._92db(W, A)
          },
          validateImpl: function() {
              this.tryUpdateRootData();
              var p, c, U, y, r, a = this, k = a.tx(), Z = a.ty(), b = a._zoom, v = a._canvas, E = this.getWidth(), $ = this.getHeight(), m = a._29I, d = {
                  x: -k / b,
                  y: -Z / b,
                  width: E / b,
                  height: $ / b
              }, l = {}, A = a._34I, x = a._24I, L = a._32I, e = a._23I;
              a._24I = {},
              (E !== v.clientWidth || $ !== v.clientHeight) && (Uj(v, E, $),
              L = 1,
              a._forcedLayoutHTML = 1),
              L || sp(d, m) || (L = 1,
              a._forcedLayoutHTML = 1),
              a._29I = d,
              a.each(function(h) {
                  c = h._id;
                  var n = l[c] = a.isVisible(h);
                  n !== a._56I[c] && (x[c] = h,
                  U = a.getDataUI(x[c]),
                  U && U._84o(n),
                  a._84o(h, n))
              }, a);
              for (c in x)
                  U = a.getDataUI(x[c]),
                  U && (!L && a._56I[c] && (r = U._79o(),
                  r && A.add(r)),
                  U.invalidate()),
                  a._83I = 1;
              if (a._56I = l,
              !L)
                  for (c in x)
                      l[c] && (U = a.getDataUI(x[c]),
                      U && (r = U._79o(),
                      r && A.add(r)));
              if (L ? y = d : (A.each(function(R) {
                  Ib(d, R) && (y = Ee(y, R))
              }),
              y && (nk(y, X(1, 1 / b)),
              y.x = q(y.x * b) / b,
              y.y = q(y.y * b) / b,
              y.width = z(y.width * b) / b,
              y.height = z(y.height * b) / b,
              y = Tb(d, y))),
              a._74O = y,
              y) {
                  p = hq(v);
                  var N = y.x
                    , J = y.y
                    , w = y.width
                    , u = y.height;
                  N = Math.floor((N * b + k) * Ph),
                  J = Math.floor((J * b + Z) * Ph),
                  w = Math.ceil(w * b * Ph) + 1,
                  u = Math.ceil(u * b * Ph) + 1,
                  L || (y.x = (N / Ph - k) / b,
                  y.y = (J / Ph - Z) / b,
                  y.width = w / Ph / b,
                  y.height = u / Ph / b),
                  p.beginPath(),
                  p.rect(N, J, w, u),
                  p.clip(),
                  p.clearRect(N, J, w, u),
                  Sn(p, k, Z, b),
                  a._42(p, y),
                  p.restore(),
                  delete a._74O
              }
              if (A.clear(),
              delete a._32I,
              delete a._forcedLayoutHTML,
              e && E > 0 && $ > 0) {
                  var U = a.getDataUI(e);
                  if (U) {
                      var r = U._79o()
                        , M = a._29I
                        , h = M.x
                        , F = M.y
                        , R = M.width
                        , C = M.height
                        , b = a._zoom;
                      r && !Ib(r, M) && (r.x + r.width < h && a.tx(-r.x * b),
                      r.x > h + R && a.tx(-(r.x + r.width - R) * b),
                      r.y + r.height < F && a.ty(-r.y * b),
                      r.y > F + C && a.ty(-(r.y + r.height - C) * b))
                  }
                  delete a._23I
              }
              a._83I && (delete a._83I,
              delete a._84I),
              a._98O(),
              a.countFrame(),
              Qm(a._24I) || rb(a.iv, a)
          },
          isValidGuideLineSource: function() {
              return !0
          },
          tryUpdateRootData: function() {
              if (!this._rootDataUpdating) {
                  this._rootDataUpdating = !0;
                  var $, N = this.getFullscreenDatas();
                  for (var s in N)
                      $ = N[s],
                      this.scaleRootData($);
                  this._rootDataUpdating = !1
              }
          },
          scaleRootData: function(W) {
              var P = W.s("fullscreen");
              if ("uniform" === P || "fill" === P) {
                  W.getRotation() && W.setRotation(0);
                  var I = W.s("fullscreen.gap") || 0
                    , u = this.getWidth()
                    , S = this.getHeight();
                  if (u && S) {
                      var i, O, G, _ = u - 2 * I, m = S - 2 * I, Q = W.getAnchor(), H = W.getScaledSize(), b = H.width, s = H.height, k = W.s("fullscreen.lock");
                      if (k)
                          return "uniform" === P ? _ / m > b / s ? (i = m / s,
                          b = s * _ / m) : (i = _ / b,
                          s = b * m / _) : "v" === k ? (i = m / s,
                          b = _ / i,
                          W.getWidth() !== b && W.setWidth(b)) : (i = _ / b,
                          s = m / i,
                          W.getHeight() !== s && W.setHeight(s)),
                          this.setZoom(i),
                          O = I - (W.getX() - Q.x * b) * i,
                          G = I - (W.getY() - Q.y * s) * i,
                          O !== this.tx() && this.tx(O),
                          G !== this.ty() && this.ty(G),
                          void 0;
                      O = this.tx(),
                      G = this.ty(),
                      i = this._zoom;
                      var o = {
                          x: (-O + I) / i,
                          y: (-G + I) / i,
                          width: _ / i,
                          height: m / i
                      };
                      if ("uniform" === P) {
                          var x = b / s
                            , R = Math.min(o.width, o.height * x)
                            , N = R / x;
                          o.x += .5 * (o.width - R),
                          o.y += .5 * (o.height - N),
                          o.width = R,
                          o.height = N
                      }
                      _ = o.width / W.getScaleX(),
                      m = o.height / W.getScaleY(),
                      (W.getWidth() != _ || W.getHeight() !== m) && W.setSize(_, m);
                      var v = o.x + Q.x * o.width
                        , J = o.y + Q.y * o.height
                        , Z = W.getPosition();
                      (v !== Z.x || J !== Z.y) && W.setPosition(v, J)
                  }
              }
          },
          isScrollBarVisible: function() {
              return !!this._79O
          },
          setScrollBarVisible: function(G) {
              var x = this;
              G !== x.isScrollBarVisible() && (G ? (Qc(x._view, x._79O = cf()),
              Qc(x._79O, x._27I = cf()),
              Qc(x._79O, x._28I = cf())) : (is(x._79O),
              delete x._79O,
              delete x._27I,
              delete x._28I),
              x.fp("scrollBarVisible", !G, G))
          },
          getDebugTip: function() {
              return ""
          },
          showScrollBar: function() {
              var m = this;
              m._79O && (m._85I || (vk(function() {
                  m._86I()
              }, Uf),
              m.iv()),
              m._85I = new Date)
          },
          _86I: function() {
              var n = this;
              if (n._85I) {
                  var Z = new Date
                    , V = Z.getTime();
                  V - n._85I.getTime() >= Uf ? (delete n._85I,
                  n.iv()) : vk(function() {
                      n._86I()
                  }, Uf)
              }
          },
          getVScrollBar: function() {
              return this._27I
          },
          getHScrollBar: function() {
              return this._28I
          },
          _98O: function() {
              var z = this
                , B = this._27I
                , h = this._28I;
              if (z._79O) {
                  if (z._autoHideScrollBar && !z._85I)
                      return B.style.visibility = $m,
                      h.style.visibility = $m,
                      void 0;
                  var P = z.getScrollBarColor()
                    , E = z._zoom
                    , b = z.getScrollBarSize()
                    , F = z.getViewRect()
                    , x = z.getScrollRect()
                    , d = F.height * E
                    , q = x.height * E
                    , i = F.width * E - b - 2
                    , c = d * ((F.y - x.y) * E / q)
                    , Y = d * (d / q)
                    , Q = B.style;
                  q - .5 > d ? (on > Y && (c = c + Y / 2 - on / 2,
                  0 > c && (c = 0),
                  c + on > d && (c = d - on),
                  Y = on),
                  ib(B, i, c, b, Y),
                  Q.visibility = jk,
                  Q.background = P,
                  Q.borderRadius = b / 2 + nc) : Q.visibility = $m;
                  var T = F.width * E
                    , u = x.width * E
                    , c = F.height * E - b - 2
                    , i = T * ((F.x - x.x) * E / u)
                    , m = T * (T / u)
                    , Q = h.style;
                  u - .5 > T ? (on > m && (i = i + m / 2 - on / 2,
                  0 > i && (i = 0),
                  i + on > T && (i = T - on),
                  m = on),
                  ib(h, i, c, m, b),
                  Q.visibility = jk,
                  Q.background = P,
                  Q.borderRadius = b / 2 + nc) : Q.visibility = $m
              }
          },
          setDataModel: function(x) {
              var v = this
                , C = v._dataModel
                , e = v._selectionModel;
              C !== x && (C && (C.ump(v.handleDataModelPropertyChange, v),
              C.umm(v.handleDataModelChange, v),
              C.umd(v.handleDataPropertyChange, v),
              C.removeIndexChangeListener(v._75O, v),
              C.removeHierarchyChangeListener(v.handleHierarchyChange, v),
              e || C.sm().ums(v.handleSelectionChange, v)),
              v._dataModel = x,
              x.mp(v.handleDataModelPropertyChange, v),
              x.mm(v.handleDataModelChange, v),
              x.md(v.handleDataPropertyChange, v),
              x.addIndexChangeListener(v._75O, v),
              x.addHierarchyChangeListener(v.handleHierarchyChange, v),
              e ? e._21I(x) : x.sm().ms(v.handleSelectionChange, v),
              v.invalidateAll(!0),
              v.fp(jh, C, x),
              v.updateBackground())
          },
          getLayersInfo: function() {
              if (this._layersInfo === V) {
                  var F = this.getLayers();
                  F ? (this._layersInfo = {},
                  F.forEach(function(U) {
                      var c = Ql(U) ? U.name : U;
                      this._layersInfo[c] = U
                  }, this)) : this._layersInfo = null
              }
              return this._layersInfo
          },
          calculateEdgePosition: function(x, M, v) {
              var C, $, h = this, k = h.getDataUI(x), b = Ol(k), F = Vq(M, function(O) {
                  return oh(b, 100 * O)
              }, 100, .001), X = oh(b, 100 * F);
              if (!v) {
                  var A = Rl(k)
                    , n = new le(X.x,X.y)
                    , T = 49 / (h._zoom * h._zoom);
                  for (C = 0,
                  $ = A.length; $ > C; C++)
                      if (n.distanceToSquared(A[C]) < T)
                          return {
                              index: C,
                              point: A[C],
                              distance: Math.sqrt((A[C].x - M.x) * (A[C].x - M.x) + (A[C].y - M.y) * (A[C].y - M.y))
                          }
              }
              return {
                  percent: F,
                  point: X,
                  distance: Math.sqrt((X.x - M.x) * (X.x - M.x) + (X.y - M.y) * (X.y - M.y))
              }
          },
          calculateAttachPoint: function() {
              var x = new le
                , B = new le
                , A = new le;
              return function(q, J) {
                  var o = this.getAttachPoints(q);
                  if (!o || !o.length)
                      return null;
                  A.set(J.x, J.y);
                  for (var $, y, L, r, b, e = 1 / 0, h = 0, c = o.length; c > h; h++)
                      L = o[h],
                      B.x = L.x,
                      B.y = L.y,
                      x.x = L.offsetX || 0,
                      x.y = L.offsetY || 0,
                      r = or(this, q, 0, x.x, x.y, B.x, B.y),
                      y = A.distanceToSquared(r),
                      e > y && ($ = h,
                      e = y,
                      b = r);
                  e = Math.sqrt(e);
                  var Q = this.getAttachStyle(q);
                  if ("close" === Q) {
                      var i = q.s("attach.close.threshold") / this._zoom;
                      if (e > i)
                          return null
                  }
                  return {
                      index: $,
                      distance: e,
                      info: o[$],
                      point: b
                  }
              }
          }(),
          getAttachPoints: function(V) {
              var S = V.s("attach.points");
              if (S)
                  return S;
              var w = Ti(V._image);
              return w ? yn(w.attachPoints, V, this) || null : void 0
          },
          getAttachStyle: function(O) {
              var u = O.s("attach.style");
              if (u)
                  return u;
              var w = Ti(O._image);
              return w ? yn(w.attachStyle, O, this) || "close" : void 0
          },
          updateLayers: function() {
              this._layersInfo = V,
              this.invalidateSelection(),
              this.redraw()
          },
          updateBackground: function() {
              var $ = this.dm().a("width")
                , K = this.dm().a("height");
              this._canvas.style.background = $ > 0 && K > 0 ? "" : this.dm().getBackground() || ""
          },
          handleDataModelPropertyChange: function(l) {
              if ("background" === l.property) {
                  var V = this._canvas.style.background
                    , K = l.newValue || "";
                  this.updateBackground(),
                  this.fp("canvasBackground", V, K),
                  this.redraw()
              } else
                  "a:width" === l.property || "a:height" === l.property ? (this._83I = 1,
                  this.updateBackground(),
                  this.redraw()) : "layers" === l.property ? this.updateLayers() : "hierarchicalRendering" === l.property && this.redraw()
          },
          handleDataPropertyChange: function(q) {
              this.dm().isHierarchicalRendering() && "parent" === q.property && q.data.hasChildren() && this.redraw(),
              this.invalidateData(q.data)
          },
          onPropertyChanged: function(W) {
              var V = this
                , P = W.property;
              if (V.redraw(),
              "zoom" === P) {
                  var Y = V.sm().getSelection();
                  Y.size() && Y.each(function(k) {
                      k.invalidate()
                  })
              } else
                  "dataModel" === P && (V._83I = 1);
              Dm[P] ? V.showScrollBar() : P === Lh && V.onCurrentSubGraphChanged(W)
          },
          onCurrentSubGraphChanged: function() {
              this.sm().cs(),
              this.reset()
          },
          handleDataModelChange: function(X) {
              var $ = this
                , I = X.kind
                , J = X.data;
              if ($._83I = 1,
              "add" === I)
                  $.invalidateData(J),
                  ji(J) && J.getEdgeGroup() && J.getEdgeGroup().eachSiblingEdge($.invalidateData, $);
              else if (I === mc) {
                  $._21Q(J);
                  var o = J._id
                    , A = $._25I[o];
                  if (A) {
                      if ($._56I[o]) {
                          var x = A._79o();
                          x && $.redraw(x)
                      }
                      A.dispose(),
                      delete $._25I[o],
                      delete $._24I[o],
                      delete $._56I[o]
                  }
                  J === $._currentSubGraph && $.setCurrentSubGraph(E)
              } else
                  I === Cn && ($.invalidateAll(!0),
                  $.setCurrentSubGraph(E))
          },
          _75O: function(T) {
              this.invalidateData(T.data)
          },
          handleHierarchyChange: function(f) {
              this.dm().isHierarchicalRendering() && f.data.hasChildren() && this.redraw(),
              this.invalidateData(f.data)
          },
          adjustIndex: function(r) {
              var K = this;
              if (K.isVisible(r)) {
                  K.dm().beginTransaction();
                  for (var J = r; J._parent && K.isVisible(J._parent); )
                      J = J._parent;
                  J && J !== r && K._dataModel.adjustIndex(J),
                  K._dataModel.adjustIndex(r),
                  K.dm().endTransaction()
              }
          },
          getImage: function(w) {
              return w.getImage ? w.getImage() : V
          },
          getSelectWidth: function(B) {
              var m = Ti(this.getImage(B));
              return m && yn(m.disableSelectedBorder, B, this) ? 0 : B.s("select.width")
          },
          getSelectColor: function(V) {
              return V.s("select.color")
          },
          isSelectable: function(S, e) {
              if (this.isSelected(S))
                  return !0;
              if (!e && S.getParent()instanceof ch && this.isSelectable(S.getParent(), !0) && S.getParent().isSyncSize())
                  return !1;
              var Y = this.getLayersInfo();
              if (Y) {
                  var f = Y[S._layer];
                  if (f && f.selectable === !1)
                      return !1
              }
              return S.s("2d.selectable") && this.sm().isSelectable(S)
          },
          isMovable: function(i) {
              var t = this;
              if (ji(i) && i.getStyle(vj) !== $h)
                  return !1;
              var $ = this.getLayersInfo();
              if ($) {
                  var l = $[i._layer];
                  if (l && l.movable === !1)
                      return !1
              }
              return i.s("2d.movable") ? t._movableFunc ? t._movableFunc(i) : !0 : !1
          },
          isEditable: function(O) {
              var V = this;
              if (n._uiSerializing)
                  return V._uieditable;
              if (!V._editInteractor || !V.isSelected(O))
                  return !1;
              if (ks(O)) {
                  var D = V.getDataUI(O);
                  if (!D || D._88I)
                      return !1
              }
              if (ji(O) && O.getStyle(vj) !== $h)
                  return !1;
              var K = this.getLayersInfo();
              if (K) {
                  var b = K[O._layer];
                  if (b && b.editable === !1)
                      return !1
              }
              return O.s("2d.editable") ? V._editableFunc ? V._editableFunc(O) : !0 : !1
          },
          handleDelete: function() {
              this._editInteractor && (this._editInteractor.handleDelete ? this._editInteractor.handleDelete() : this.removeSelection())
          },
          isPointEditable: function(s) {
              return ud(s) && 0 !== s.getRotation() ? !1 : this._pointEditableFunc ? this._pointEditableFunc(s) : !0
          },
          isRectEditable: function(R) {
              return this._rectEditableFunc ? this._rectEditableFunc(R) : !0
          },
          isAnchorEditable: function(g) {
              return this._anchorEditableFunc ? this._anchorEditableFunc(g) : !0
          },
          isRotationEditable: function(O) {
              return O.setRotation && O.IRotatable !== !1 ? this._rotationEditableFunc ? this._rotationEditableFunc(O) : !0 : !1
          },
          isSourceTargetEditable: function() {
              return !0
          },
          getRotationPoint: function(U) {
              var N = U.getAnchor()
                , w = U.getScale()
                , y = this._zoom
                , F = Fp(U.getRotation(), 0, -U.getHeight() * w.y * N.y - (w.y < 0 ? -1 : 1) * (Ul ? 32 : 16) / y)
                , i = U.p();
              return F.x += i.x,
              F.y += i.y,
              F
          },
          getLogicalPoint: function(L) {
              var U = this;
              return Pf(L, U._canvas, U.tx(), U.ty(), U._zoom, U._zoom)
          },
          getScreenPoint: function(_, x) {
              var K, m = this;
              return "object" == typeof _ ? _.x !== V ? (K = _.x,
              x = _.y) : (K = _[0],
              x = _[1]) : K = _,
              Pj(K, x, m._canvas, m.tx(), m.ty(), m._zoom, m._zoom)
          },
          getSelectedDataAt: function(e) {
              var I = this;
              return this.getDataAt(e, function(A) {
                  return I.isSelected(A)
              })
          },
          getDataInfoAt: function(I, c, R) {
              var z, s = this.lp(I), D = this.getDataAt(s, c, R);
              if (D) {
                  var t = this.getDataUI(D);
                  z = {
                      data: D,
                      ui: t,
                      point: s
                  };
                  var Q = t._38o;
                  if (Q) {
                      var P = Q.icons;
                      for (var J in P) {
                          var L = P[J]
                            , l = Q.rects[J];
                          if (l)
                              for (var v = yn(L.names, D, this), V = v ? v.length : 0, M = l.rotation, B = V - 1; B >= 0; B--) {
                                  var h = v[B]
                                    , G = l[B];
                                  if (tp(G, s, M))
                                      return z.part = "icons",
                                      z.name = J,
                                      z.icon = h,
                                      z.rect = G,
                                      z.index = B,
                                      z.rotation = M,
                                      z
                              }
                      }
                  }
                  if (this.isNoteVisible(D)) {
                      if (t.note2Info && tp(t.note2Info.clickRect, s, E, t.note2Info.scale))
                          return z.part = "note2",
                          z;
                      if (t.noteInfo && tp(t.noteInfo.clickRect, s, E, t.noteInfo.scale))
                          return z.part = "note",
                          z
                  }
                  if (this.isLabelVisible(D)) {
                      if (t.label2Info && tp(t.label2Info.rect, s, t.label2Info.rotation, t.label2Info.scale))
                          return z.part = "label2",
                          z;
                      if (t.labelInfo && tp(t.labelInfo.rect, s, t.labelInfo.rotation, t.labelInfo.scale))
                          return z.part = "label",
                          z
                  }
                  if (D.isInRect && D.isInRect(s))
                      return z.part = "body",
                      z
              }
              return z
          },
          getDataAt: function(P, X, u) {
              P.target && (P = this.lp(P));
              var k, H = this._zoom;
              return this.reverseEach(function(d) {
                  return (X ? X(d) : this.isSelectable(d)) && this.rectIntersects(d, Ke(P.x, P.y, u, H)) ? (k = d,
                  !1) : void 0
              }, this),
              k
          },
          getIconInfoAt: function(s, B) {
              var V = this;
              if (s.target && (s = V.lp(s)),
              B || (B = V.getDataAt(s)),
              B) {
                  var k = V.getDataUI(B);
                  if (k && k._38o) {
                      var J, G = k._38o, I = new Mh;
                      for (J in G.icons)
                          I.add(J);
                      for (var l = I.size() - 1; l >= 0; l--) {
                          J = I.get(l);
                          for (var R = G.rects[J], t = R.rotation, U = R.length - 1; U >= 0; U--) {
                              var b = R[U]
                                , N = b.width
                                , w = b.height
                                , v = {
                                  x: s.x - b.x - N / 2,
                                  y: s.y - b.y - w / 2
                              };
                              t != E && (v = Fp(-t, v.x, v.y));
                              var b = {
                                  x: -N / 2,
                                  y: -w / 2,
                                  width: N,
                                  height: w
                              };
                              if (tp(b, v))
                                  return {
                                      key: J,
                                      index: U,
                                      name: G.icons[J].names[U],
                                      rect: R[U],
                                      point: s,
                                      rotation: t,
                                      relativeRect: b,
                                      relativePoint: v,
                                      data: B
                                  }
                          }
                      }
                  }
              }
              return E
          },
          getDatasInRect: function(L, U, J) {
              J === V && (J = 1);
              var l = this
                , g = new Mh;
              return l.reverseEach(function(c) {
                  J && !l.isSelectable(c) || (U ? l.rectIntersects(c, L) : l.rectContains(c, L)) && g.add(c)
              }),
              g
          },
          moveSelection: function(m, s) {
              var M = this;
              M.dm().beginTransaction(),
              Lc(M.sm().toSelection(M.isMovable, M), m, s),
              M.dm().endTransaction()
          },
          moveDatas: function(n, v, S) {
              var x = this;
              x.dm().beginTransaction(),
              n instanceof Mh || (n = new Mh(n)),
              Lc(n, v, S),
              x.dm().endTransaction()
          },
          getDataUIBounds: function(x) {
              var H = this.getDataUI(x);
              return H ? H._79o() : E
          },
          drawData: function(E, P, m) {
              var p = this.getDataUI(P);
              if (p) {
                  var U = p._79o();
                  (!m || Ib(m, U)) && (p._42(E),
                  P instanceof n.Block && P.eachChild(function(V) {
                      this.isVisible(V) && this.drawData(E, V, m)
                  }, this))
              }
          },
          getBoundsForGroup: function(C) {
              return C.s($k) ? this.getDataUIBounds(C) : E
          },
          isPixelPerfect: function(v) {
              return v.s("pixelPerfect")
          },
          rectIntersects: function(n, V) {
              this.validate();
              var D = E;
              if (this._56I[n._id]) {
                  var v = this._25I[n._id];
                  if (v) {
                      var w = v._79o();
                      if (ke(V, w))
                          D = !0;
                      else if ((V = Tb(V, w)) && (v.rectIntersects && (D = v.rectIntersects(V)),
                      D == E)) {
                          if (!this.isPixelPerfect(n))
                              return !0;
                          var T = V.x
                            , u = V.y
                            , j = V.width
                            , g = V.height
                            , A = this._zoom
                            , m = M.hitMaxArea
                            , C = j * g * A * A;
                          if (C > m) {
                              var e = Math.sqrt(m / C);
                              A *= e
                          }
                          j *= A,
                          g *= A,
                          2 > j && (j = 2),
                          2 > g && (g = 2),
                          T *= A,
                          u *= A;
                          var Y = en(j, g);
                          od(Y, -T, -u),
                          Y.scale(A, A),
                          this._drawForChecking = !0,
                          this.drawData(Y, n, V),
                          this._drawForChecking = !1;
                          try {
                              for (var i = 0, $ = Y.getImageData(0, 0, j, g).data; i < $.length; i += 4)
                                  if (0 !== $[i + 3]) {
                                      D = !0;
                                      break
                                  }
                              Y.restore()
                          } catch (c) {
                              Xl = E,
                              D = !1
                          }
                      }
                  }
              }
              return D ? !0 : !1
          },
          rectContains: function(w, _) {
              if (this._56I[w._id]) {
                  var I = this._25I[w._id];
                  if (I)
                      return ke(_, I._79o())
              }
              return !1
          },
          reset: function() {
              this.setZoom(1),
              this.setTranslate(0, 0)
          },
          handleKeyDown: function(y) {
              if (!M.isInput(y.target)) {
                  var n = this
                    , v = n._focusData
                    , t = v && n._25I[v._id]
                    , X = 0
                    , W = n._dataModel._datas;
                  if (!(v && v._enabled && v._editable && t && t.onKeyDown && t.onKeyDown(y) === !0))
                      if (9 === y.keyCode && (v && (X = W.indexOf(v),
                      Oh(y) ? -1 === --X && (X = 0) : ++X === W.size() && (X = 0)),
                      n._focusData = v = W.get(X),
                      n.sm().setSelection(v)),
                      td(y) ? n.selectAll() : ec(y) && n.isResettable() && n.reset(),
                      n.sm().isEmpty()) {
                          if (n._editing)
                              return;
                          var l = n.tx()
                            , B = n.ty()
                            , C = !1
                            , s = Oh() ? 100 : 10;
                          Ll(y) && (l -= s,
                          C = !0),
                          yo(y) && (B -= s,
                          C = !0),
                          zp(y) && (l += s,
                          C = !0),
                          Cf(y) && (B += s,
                          C = !0),
                          C && n.setTranslate(l, B)
                      } else {
                          Xr(y) && n.handleDelete(y);
                          var q = Oh() ? 10 : 1;
                          Ll(y) && (n.moveSelection(-q, 0),
                          n.fi({
                              kind: "moveLeft"
                          })),
                          yo(y) && (n.moveSelection(0, -q),
                          n.fi({
                              kind: "moveUp"
                          })),
                          zp(y) && (n.moveSelection(q, 0),
                          n.fi({
                              kind: "moveRight"
                          })),
                          Cf(y) && (n.moveSelection(0, q),
                          n.fi({
                              kind: "moveDown"
                          }))
                      }
              }
          },
          handleScroll: function(v, U) {
              if (ad(v),
              this.isZoomable()) {
                  if (!this.getEditInteractor()) {
                      var j = this.getDataAt(v);
                      if (j) {
                          var P = Ti(this.getImage(j));
                          if (P && yn(P.scrollable, j, this))
                              return
                      }
                  }
                  var W = this.lp(v);
                  U > 0 ? this.scrollZoomIn(W) : 0 > U && this.scrollZoomOut(W)
              }
          },
          handlePinch: function(E, S, J) {
              this.isZoomable() && (Math.abs(S - J) < M.pinchZoomThreshold || (S > J ? this.pinchZoomIn(E) : this.pinchZoomOut(E)))
          },
          checkDoubleClickOnNote: function(F, K) {
              var M = this
                , X = M.lp(F)
                , g = M.getDataUI(K)
                , O = g.note2Info;
              return O && K.s("note2.toggleable") && tp(O.clickRect, X) ? (K.s($o, !K.s($o)),
              M.fi({
                  kind: "toggleNote2",
                  event: F,
                  data: K
              }),
              !0) : (O = g.noteInfo,
              O && K.s("note.toggleable") && tp(O.clickRect, X) ? (K.s(Nj, !K.s(Nj)),
              M.fi({
                  kind: "toggleNote",
                  event: F,
                  data: K
              }),
              !0) : !1)
          },
          _84o: function() {},
          isNoteVisible: function() {
              return this._zoom > .15
          },
          isLabelVisible: function() {
              return this._zoom > .15
          },
          isEditVisible: function() {
              return this._zoom > .15
          },
          autoScroll: function(V, C) {
              var b = this
                , t = b.getAutoScrollZone()
                , O = t / b.getZoom()
                , U = t / 4
                , y = b._29I
                , h = b.lp(V)
                , G = {
                  x: b.tx(),
                  y: b.ty()
              };
              return h && t > 0 && y && (h.x - y.x < O ? b.translate(U, 0) : y.x + y.width - h.x < O && b.translate(-U, 0),
              h.y - y.y < O ? b.translate(0, U) : y.y + y.height - h.y < O && b.translate(0, -U)),
              G.x = b.tx() - G.x,
              G.y = b.ty() - G.y,
              C && (C.x += G.x,
              C.y += G.y),
              G
          },
          getMoveMode: function(B, w) {
              var h = w.s("2d.move.mode");
              return h ? h : de["88"] ? "x" : de["89"] ? "y" : "xy"
          },
          getSerializableProperties: function() {
              return {
                  scrollBarColor: 1,
                  scrollBarSize: 1,
                  autoMakeVisible: 1,
                  autoHideScrollBar: 1,
                  editable: 1,
                  resettable: 1,
                  pannable: 1,
                  rectSelectable: 1,
                  autoScrollZone: 1,
                  visibleFunc: 1,
                  movableFunc: 1,
                  editableFunc: 1,
                  pointEditableFunc: 1,
                  rectEditableFunc: 1,
                  anchorEditableFunc: 1,
                  rotationEditableFunc: 1,
                  rectSelectBackground: 1,
                  rectSelectBorderColor: 1,
                  editPointSize: 1,
                  editPointBorderColor: 1,
                  editPointBackground: 1,
                  hoverDelay: 1,
                  dataModel: 1,
                  selectionModel: 1,
                  currentSubGraph: 1,
                  zoom: 1,
                  translateX: 1,
                  translateY: 1
              }
          },
          serializeProperty: function(z, w, c) {
              var W = this;
              return "currentSubGraph" === w ? {
                  __i: z.getId()
              } : c.serializeProperty(z, w, W)
          },
          deserializeProperty: function(Y, V, b) {
              var O = this;
              if ("currentSubGraph" === V) {
                  var A = O.dm()
                    , q = A.__idMap;
                  return q[Y.__i]
              }
              return b.deserializeProperty(Y, V, O)
          },
          setDefaultCursor: function(i, P) {
              this._defaultCursor = i,
              P !== !1 && this.setCursor(i)
          },
          setCursor: function(D) {
              "default" === D && (D = this._defaultCursor || D);
              var X = this.getView().style;
              X.cursor = D,
              X.cursor = "-webkit-" + D,
              X.cursor = "-moz-" + D
          },
          getCurrentConnectActionType: function() {
              return this._currentActionType
          },
          setCurrentConnectActionType: function(v) {
              return v === E || M.getConnectAction(null, v) ? (this._currentActionType = v,
              this.redraw(),
              !0) : !1
          },
          getEditStyle: function(K) {
              var Z = this.getEditInteractor();
              return Z ? Z.getStyle(K) : V
          },
          setEditStyle: function(_, Y, W) {
              var H = this.getEditInteractor();
              return H ? (H.setStyle(_, Y, W),
              !0) : !1
          },
          isConnectActionVisible: function(C) {
              var b = M.getConnectAction(this);
              if (!b)
                  return !1;
              var k = b.visible;
              return Oi(k) && (k = k(this, C)),
              k
          },
          isInteractive: function(S) {
              if (this._drawForChecking)
                  return !1;
              var N = Ti(this.getImage(S));
              return N && yn(N.interactive, S, this) ? !0 : S.s("interactive")
          },
          appendHTML: function(P, Z) {
              var D = this.getView();
              if (!(Z || P && P.parentNode !== D))
                  return !1;
              var d = P.getView && P.getView();
              if (!Z && d && d.parentNode === D)
                  return !1;
              (P.getView || P.isSelfViewEvent) && (P = P.getView());
              var r = this.getEditInteractor();
              return r && r._canvas ? D.insertBefore(P, r._canvas) : this.isScrollBarVisible() ? D.insertBefore(P, this.getView().lastChild) : Qc(D, P),
              !0
          },
          _layoutHTMLImpl: function(l, V, m) {
              if (arguments.length > 1) {
                  var S, G = this, U = G._zoom;
                  if (V.getView && (S = V,
                  V = V.getView()),
                  V.style.position = "absolute",
                  m) {
                      var B = l.getRect();
                      ib(S || V, G.tx() + B.x * U, G.ty() + B.y * U, B.width * U, B.height * U)
                  } else {
                      var Q = new Ld
                        , B = l.getAnchorRect()
                        , u = l.getPosition()
                        , A = l.getScale()
                        , Z = V.style;
                      ib(S || V, B),
                      Q.appendTranslate(G.tx(), G.ty()),
                      Q.appendScale(U, U),
                      Q.append(new Ld(l.getRotation(),u.x,u.y,A.x,A.y)),
                      To(Z, "transform", "matrix(" + Q.a.toFixed(5) + ", " + Q.b.toFixed(5) + ", " + Q.c.toFixed(5) + ",\n    " + Q.d.toFixed(5) + ", " + Q.tx.toFixed(5) + ", " + Q.ty.toFixed(5) + ")"),
                      To(Z, "transformOrigin", (-B.x).toFixed(5) + "px " + (-B.y).toFixed(5) + "px"),
                      V.updateAppendMatrix = !0
                  }
              } else
                  this._layoutHTML && this._layoutHTML()
          },
          getTextEditInfo: function(a) {
              return a instanceof Wg ? {
                  name: "text",
                  accessType: "s",
                  isMultiline: !1
              } : void 0
          },
          getState: function(k) {
              var o = "state"
                , E = k.s(o);
              if (E)
                  return E;
              var L = Ti(k._image);
              return L ? yn(L[o], k, this) || null : void 0
          },
          getShape: function(l) {
              return l.getStyle(Zr)
          }
      }),
      G.defineProperties(qg.GraphView.prototype, {
          layoutHTML: {
              get: function() {
                  return this._layoutHTMLImplBind || (this._layoutHTMLImplBind = this._layoutHTMLImpl.bind(this)),
                  this._layoutHTMLImplBind
              },
              set: function(m) {
                  this._layoutHTML = m
              }
          }
      });
      var bk = function(W, _) {
          var D = this;
          D.gv = W,
          D.s = function(X) {
              return _.getStyle(X)
          }
          ,
          D._data = _,
          D._87I = new Mh
      };
      Ik(bk, G, {
          _6I: E,
          ms_icons: 1,
          _84o: function() {},
          dispose: function() {},
          isShadowed: function() {
              return this.s("shadow") || this.gv.isSelected(this._data) && "shadow" === this.s("select.type")
          },
          getSelectWidth: function() {
              var Q = this
                , F = Q.gv.isSelected(Q._data);
              return !F || Q.isShadowed() ? 0 : Q.gv.getSelectWidth(Q._data)
          },
          getSelectColor: function() {
              return this.gv.getSelectColor(this._data)
          },
          getBodyColor: function(o) {
              var d = this._data
                , Y = this.gv.getBodyColor(d);
              return Y ? Y : o ? d.getStyle(o) : E
          },
          _2Q: function(i) {
              return this.s(i)
          },
          _1Q: function(v, H, X, e) {
              var D = this.s
                , Y = D("2d.gray")
                , q = D(H + ".dash.color");
              if (Y && (q = M.toGrayColor(q)),
              v.strokeStyle = q,
              v.lineWidth = X,
              v.stroke(),
              D(H + ".dash.3d")) {
                  var s = D(H + ".dash.3d.color");
                  Zo(v, q, Y ? M.toGrayColor(s) : s, X, this.gv._zoom, D(H + ".dash.3d.accuracy"))
              }
              wh(v, e)
          },
          invalidate: function() {
              this._6I = E
          },
          _79o: function() {
              var L = this;
              if (!L._6I) {
                  var o = L._data
                    , H = L.gv;
                  L.labelInfo = L.label2Info = L.noteInfo = L.note2Info = L._38o = E,
                  L._87I.clear(),
                  L.interactiveInfo = H.isInteractive(o) ? {} : E,
                  L._3O(),
                  L._55O = H.isEditable(o) ? {
                      _42O: H.isRectEditable(o),
                      _43O: H.isPointEditable(o),
                      _56O: H.isRotationEditable(o)
                  } : E,
                  L._6I = L._81o()
              }
              return L._6I
          },
          _3O: function() {},
          getPosition: function() {
              return Wk
          },
          _68o: function(f, H) {
              f && this._87I.add(Fl(f, H))
          },
          _81o: function() {
              var g = this
                , p = g.s;
              g._24O(_r, "getLabel"),
              g._24O(lc, "getLabel2"),
              g._26O(Up, "getNote"),
              g._26O(lj, "getNote2"),
              g._15O(),
              g._55O && g._48O();
              var h;
              if (g._87I.each(function(U) {
                  h = Ee(h, U)
              }),
              h) {
                  var D = g.isShadowed()
                    , Q = p("shadow2")
                    , Z = Ej(h);
                  Q ? (Z.x += p("shadow2.offset.x"),
                  Z.y += p("shadow2.offset.y"),
                  nk(Z, p("shadow2.blur"))) : D && (Z.x += p("shadow.offset.x"),
                  Z.y += p("shadow.offset.y"),
                  nk(Z, p("shadow.blur"))),
                  h = Ee(h, Z)
              }
              return g._87I.clear(),
              h
          },
          _42: function(k) {
              var r = this
                , X = r._data
                , F = r.gv
                , Z = r.s
                , U = Z("opacity")
                , O = this.isShadowed()
                , S = Z("shadow2");
              if (O || S) {
                  var i = k.shadowOffsetX
                    , v = k.shadowOffsetY
                    , s = k.shadowBlur
                    , p = k.shadowColor
                    , Q = F.getZoom()
                    , T = O ? "shadow" : "shadow2";
                  k.shadowOffsetX = Z(T + ".offset.x") * Q,
                  k.shadowOffsetY = Z(T + ".offset.y") * Q,
                  k.shadowBlur = Z(T + ".blur") * Q,
                  k.shadowColor = O ? r.getSelectColor() : Z(T + ".color")
              }
              if (U != E) {
                  var G = k.globalAlpha;
                  k.globalAlpha = U
              }
              r._80o(k),
              F.isLabelVisible(X) && ((!F._drawForChecking || Z("label.selectable")) && Jb(k, r.labelInfo),
              (!F._drawForChecking || Z("label2.selectable")) && Jb(k, r.label2Info)),
              F.isNoteVisible(X) && (Sk(k, r.noteInfo),
              Sk(k, r.note2Info)),
              r._99O(k),
              U != E && (k.globalAlpha = G),
              (O || S) && (k.shadowOffsetX = i,
              k.shadowOffsetY = v,
              k.shadowBlur = s,
              k.shadowColor = p)
          },
          _80o: function() {},
          _47O: function() {},
          _24O: function(I, A) {
              var b = this
                , e = b._data
                , v = b.gv
                , f = b.s
                , T = v[A](e);
              if (T != E) {
                  var x = f(I + ".scale")
                    , J = f(I + ".max")
                    , M = f(I + ".position")
                    , m = b[I + "Info"] = {
                      label: T,
                      scale: x,
                      color: v[A + "Color"](e),
                      font: f(I + ".font"),
                      opacity: f(I + ".opacity"),
                      align: f(I + ".align"),
                      rotation: b.getRotation(f(I + ".rotation"), !1, M),
                      background: v[A + "Background"](e)
                  }
                    , l = Df(m, T);
                  J > 0 && J < l.width && (m.labelWidth = l.width,
                  l.width = J),
                  1 !== x && (l.width *= x,
                  l.height *= x);
                  var c = b.getPosition(M, f(I + ".offset.x"), f(I + ".offset.y"), l, f(I + ".position.fixed"));
                  if (l.x = c.x - l.width / 2,
                  l.y = c.y - l.height / 2,
                  b._68o(m.rect = l, m.rotation),
                  1 !== x) {
                      var B = l.width / x
                        , r = l.height / x;
                      m.rect = {
                          x: c.x - B / 2,
                          y: c.y - r / 2,
                          width: B,
                          height: r
                      }
                  }
              }
          },
          _26O: function(L, C) {
              var f = this
                , s = f.gv
                , k = f._data
                , g = f.s
                , S = s[C](k);
              if (S != E) {
                  var P, I, o = g(L + ".scale"), K = f[L + "Info"] = {
                      note: S,
                      scale: o,
                      data: k,
                      view: s,
                      expanded: g(L + ".expanded"),
                      font: g(L + ".font"),
                      color: g(L + ".color"),
                      opacity: g(L + ".opacity"),
                      align: g(L + ".align"),
                      icon: g(L + ".icon"),
                      backgroundImage: g(L + ".backgroundImage"),
                      borderWidth: g(L + ".border.width"),
                      borderColor: g(L + ".border.color"),
                      background: s[C + "Background"](k)
                  }, U = f.getPosition(g(L + ".position"), g(L + ".offset.x"), g(L + ".offset.y")), X = U.x, b = U.y;
                  if (K.expanded) {
                      var B, u = g(L + ".max"), q = g(L + ".backgroundImage");
                      q ? (q = Ti(q),
                      B = {
                          width: Aj(q, k),
                          height: Xc(q, k)
                      }) : B = Df(K, S),
                      B.width += 6,
                      B.height += 2,
                      u > 0 && u < B.width && (K.labelWidth = B.width,
                      B.width = u),
                      P = B.width,
                      I = B.height + 8,
                      K.clickRect = {
                          x: X - P * o / 2,
                          y: b - I * o,
                          width: P * o,
                          height: I * o * B.height / I
                      }
                  } else {
                      var n = g(L + ".icon");
                      n ? (n = Ti(n),
                      P = Aj(n, k),
                      I = Xc(n, k)) : (P = 12,
                      I = 18),
                      K.clickRect = {
                          x: X - P * o / 2,
                          y: b - I * o,
                          width: P * o,
                          height: I * o
                      }
                  }
                  K.rect = {
                      x: X - P / 2,
                      y: b - I * o / 2 - I / 2,
                      width: P,
                      height: I
                  };
                  var w = z(K.borderWidth / 2) * o;
                  f._68o({
                      x: X - P * o / 2 - w,
                      y: b - I * o - w,
                      width: P * o + 2 * w,
                      height: I * o + 2 * w
                  })
              }
          },
          _48O: function() {},
          _99O: function(Y) {
              var b = this
                , j = b._38o;
              if (j) {
                  var S = b.gv
                    , r = b._data
                    , V = j.icons
                    , I = b.interactiveInfo;
                  I && (I._38o = {});
                  for (var p in V) {
                      var e = V[p]
                        , z = j.rects[p];
                      if (z) {
                          I && (I._38o[p] = []);
                          var m = yn(e.opacity, r, S)
                            , D = yn(e.names, r, S)
                            , L = D ? D.length : 0
                            , Q = z.rotation;
                          if (m != E) {
                              var W = Y.globalAlpha;
                              Y.globalAlpha *= m
                          }
                          for (var g = 0; L > g; g++) {
                              var i = D[g]
                                , h = Ti(i)
                                , M = z[g];
                              if (Q) {
                                  var R = M.x + M.width / 2
                                    , A = M.y + M.height / 2;
                                  Y.save(),
                                  od(Y, R, A),
                                  Iq(Y, Q),
                                  od(Y, -R, -A)
                              }
                              I && I._38o[p].push(Y.interactiveInfo = {
                                  compInfos: [],
                                  matrix: Q ? new Ld(Q,R,A).appendTranslate(-R, -A) : new Ld
                              }),
                              Eq(Y, h, yn(e.stretch, r, S), M.x, M.y, M.width, M.height, b._data, b.gv),
                              Y.interactiveInfo = E,
                              Q && Y.restore()
                          }
                          m != E && (Y.globalAlpha = W)
                      }
                  }
              }
          }
      });
      var Zd = function(O, x) {
          Jg(Zd, this, [O, x])
      };
      Ik(Zd, bk, {
          _checkEmptyRect: !0,
          _40O: function(J, V) {
              var D = this
                , F = D.s
                , x = J.rect;
              (J.borderColor = D.gv.getBorderColor(D._data)) && (J.borderType = F("border.type"),
              J.borderWidth = F("border.width"),
              J.borderPadding = F("border.padding"),
              V = X(V, J.borderPadding + J.borderWidth / 2));
              var b = D._data.getScale()
                , h = X(1, X(u(b.x), u(b.y)));
              if (J.selectWidth = D.getSelectWidth()) {
                  var _ = D.gv._zoom;
                  J.selectType = F("select.type"),
                  J._97o = D.getSelectColor(),
                  J.selectPadding = F("select.padding"),
                  V = X(V, (J.selectPadding + J.selectWidth / 2 / _) / h)
              }
              V > 0 && (V *= h,
              x = Ej(x),
              nk(x, V)),
              D._68o(x)
          },
          _39O: function(P, q) {
              var V, m = this, p = q.rect;
              if (q.borderWidth > 0 && (V = q.borderPadding,
              P.strokeStyle = q.borderColor,
              P.lineWidth = q.borderWidth,
              Cr(P, q.borderType, {
                  x: p.x - V,
                  y: p.y - V,
                  width: p.width + 2 * V,
                  height: p.height + 2 * V
              }),
              P.stroke()),
              q.selectWidth > 0) {
                  var M = m.gv._zoom;
                  if (V = q.selectPadding,
                  P.strokeStyle = q._97o,
                  P.lineWidth = q.selectWidth / M,
                  q.rotation != E) {
                      P.save(),
                      P.translate(q.position.x, q.position.y),
                      P.rotate(q.rotation);
                      var T = m._data
                        , H = T.getWidth()
                        , U = T.getHeight()
                        , S = q.scale
                        , J = q.anchor;
                      p = {
                          x: S.x * -H * J.x,
                          y: S.y * -U * J.y,
                          width: S.x * H,
                          height: S.y * U
                      }
                  }
                  Cr(P, q.selectType, {
                      x: p.x - V,
                      y: p.y - V,
                      width: p.width + 2 * V,
                      height: p.height + 2 * V
                  }),
                  q.rotation != E && P.restore(),
                  P.stroke()
              }
          },
          dispose: function() {
              var v = this
                , g = v._htmlView;
              Zd.superClass._3O.call(v),
              g && (g.onHTMLRemoved && g.onHTMLRemoved(),
              is(g))
          },
          _3O: function() {
              var p = this
                , Z = p.s
                , w = p._data
                , A = p.gv
                , b = A.getShape(w)
                , e = p.getBodyColor()
                , D = Z("shape.border.color")
                , Q = p._83o = b ? {
                  shape: b,
                  _53o: p.getBodyColor("shape.background"),
                  _27Q: Ti(Z("shape.repeat.image"), e),
                  shapeGradientPack: Z("shape.gradient.pack"),
                  _54o: Z("shape.border.width"),
                  _55o: D,
                  shapeBorderRepeatImage: Ti(Z("shape.border.repeat.image"), D),
                  _56o: Z("shape.border.3d"),
                  _57o: Z("shape.border.3d.color"),
                  _58o: Z("shape.border.3d.accuracy"),
                  shapeGradient: Z("shape.gradient"),
                  _59o: Z("shape.gradient.color"),
                  _60o: Z("shape.border.pattern"),
                  _61o: Z("shape.border.cap"),
                  _62o: Z("shape.border.join"),
                  shapeForeground: Z("shape.foreground"),
                  bodyColor: e,
                  gray: Z("2d.gray")
              } : {
                  img: Ti(A.getImage(w), e),
                  bodyColor: e,
                  gray: Z("2d.gray"),
                  stretch: Z("image.stretch")
              };
              if (_ && !Fc)
                  ;
              else {
                  var B, f = Q.img;
                  f && f.renderHTML ? (p._htmlInfo && p._htmlInfo.img !== f && (p._htmlInfo = E),
                  p._htmlInfo || (p._htmlInfo = {
                      img: f,
                      cache: {}
                  }),
                  B = f.renderHTML(w, A, p._htmlInfo.cache)) : p._htmlInfo = E,
                  p._htmlView && p._htmlView !== B && (p._htmlView.onHTMLRemoved && p._htmlView.onHTMLRemoved(),
                  is(p._htmlView.getView ? p._htmlView.getView() : p._htmlView)),
                  (p._htmlView = B) && A.appendHTML(B) && (B.onHTMLAddedSync && B.onHTMLAddedSync(),
                  B.onHTMLAdded && rb(B.onHTMLAdded)),
                  Q.rect = w.getRect(),
                  Q.position = w.p(),
                  Q.scale = w.getScale(),
                  Q.anchor = w.getAnchor(),
                  Q.rotation = w.getRotation(),
                  b === gp && (Q._63o = Z("shape.depth"));
                  var s = 0;
                  if (b)
                      s = Zb(E, Q._54o / 2, Q._62o),
                      p.s("shape.dash") && (s = X(s, (p.s("shape.dash.width") || Q._54o) / 2));
                  else if (f && f.boundExtend)
                      if (s = yn(f.boundExtend, w, A),
                      f.boundExtendAbsolute) {
                          var N = w.getScale();
                          s /= A._zoom * X(1, X(u(N.x), u(N.y)))
                      } else if (!yn(f.fitSize, w, A)) {
                          var H = yn(f.width, w, A)
                            , y = yn(f.height, w, A);
                          s *= X(w.getWidth() / H, w.getHeight() / y)
                      }
                  p._40O(Q, s);
                  var P = Z("clip.percentage");
                  if (1 > P && (0 > P && (P = 0),
                  Q.clipRect = yg(w.getAnchorRect(), Z("clip.direction"), P)),
                  b) {
                      var S = Z("shape.fill.clip.percentage");
                      1 > S && (0 > S && (S = 0),
                      Q.shapeClipRect = yg(w.getAnchorRect(), Z("shape.fill.clip.direction"), S));
                      var z = Z("shape.foreground.clip.percentage");
                      1 > z && (0 > z && (z = 0),
                      Q.shapeForegroundClipRect = yg(w.getAnchorRect(), Z("shape.foreground.clip.direction"), z))
                  }
              }
          },
          getPosition: function(N, _, c, E) {
              var y = Eo(N, this._83o.rect, E);
              return y.x += _,
              y.y += c,
              y
          },
          _80o: function(F) {
              var y = this
                , i = y.s
                , O = y.gv
                , m = y._data
                , j = y._83o
                , D = j.rect
                , d = j.position
                , P = j.rotation
                , K = j.anchor
                , Q = j.scale
                , W = j.shape
                , Z = j.clipRect;
              if (!y._checkEmptyRect || D.width > 0 && D.height > 0) {
                  var N = m.getSize();
                  if (N.x = -N.width * K.x,
                  N.y = -N.height * K.y,
                  F.save(),
                  od(F, d.x, d.y),
                  Iq(F, P),
                  ig(F, Q.x, Q.y),
                  Z && (F.beginPath(),
                  F.rect(Z.x, Z.y, Z.width, Z.height),
                  F.clip()),
                  O._drawForChecking && j.img && yn(j.img.pixelPerfect, m, O) === !1)
                      xg(F, N.x, N.y, N.width, N.height, "#888888");
                  else if (y.freeDraw)
                      y.freeDraw(F, N, j);
                  else if (W) {
                      var k, R, X, h, L = j._60o, s = cq(F, L), U = j._27Q, c = j._54o, z = j.shapeGradientPack, T = j.gray, a = F.lineJoin, n = F.lineCap, o = function(u) {
                          return T ? M.toGrayColor(u) : u
                      };
                      "roundRect" === W ? k = i("shape.corner.radius") : "polygon" === W ? k = i("shape.polygon.side") : "arc" === W && (k = i("shape.arc.from"),
                      R = i("shape.arc.to"),
                      X = i("shape.arc.close"),
                      h = i("shape.arc.oval")),
                      F.lineJoin = j._62o,
                      F.lineCap = j._61o;
                      var B = o(j._53o);
                      if (B || U || z) {
                          var w = j.shapeClipRect;
                          w && (F.save(),
                          F.beginPath(),
                          F.rect(w.x, w.y, w.width, w.height),
                          F.clip()),
                          Cr(F, W, N, k, R, X, h),
                          z ? Wq(F, z, function(c) {
                              return pf(c, j.bodyColor)
                          }) : U ? Ji(F, U, o(j.bodyColor), null, m, O) : eq(F, B, j.shapeGradient, o(j._59o), N),
                          F.fill(),
                          z && F.restore(),
                          w && F.restore(),
                          F !== s && Cr(s, W, N, k, R, X, h)
                      } else
                          Cr(s, W, N, k, R, X, h);
                      var Y = j.shapeForeground;
                      if (Y) {
                          F.save();
                          var H = j.shapeForegroundClipRect;
                          H && (F.beginPath(),
                          F.rect(H.x, H.y, H.width, H.height),
                          F.clip()),
                          Cr(F, W, N, k, R, X, h),
                          eq(F, Y, i("shape.foreground.gradient"), o(i("shape.foreground.gradient.color")), N),
                          F.fill(),
                          F.restore()
                      }
                      if (c > 0) {
                          var p = i("shape.border.width.absolute");
                          p && (F.save(),
                          F.setTransform(1, 0, 0, 1, 0, 0)),
                          F.lineWidth = c;
                          var e = o(j._55o);
                          j.shapeBorderRepeatImage ? Nb(F, j.shapeBorderRepeatImage, e, null, m, O) : F.strokeStyle = e,
                          F.stroke(),
                          p && F.restore(),
                          j._56o && Zo(F, e, o(j._57o), c, O._zoom, j._58o)
                      }
                      if (wh(F, L),
                      i("shape.dash")) {
                          var t = i("shape.dash.width") || c;
                          if (t > 0) {
                              L = i("shape.dash.pattern");
                              var s = cq(F, L, y._2Q("shape.dash.offset"));
                              s !== F && Cr(s, W, N, k, R, X, h),
                              y._1Q(F, "shape", t, L)
                          }
                      }
                      Kk(F, B, j._63o, N),
                      F.lineJoin = a,
                      F.lineCap = n
                  } else {
                      var V = y.interactiveInfo;
                      V && (F.interactiveInfo = V.bodyInfo = {
                          compInfos: [],
                          matrix: new Ld(P,d.x,d.y,Q.x,Q.y)
                      }),
                      j.gray && (F.compGray = !0);
                      var C = j.img;
                      C && C.cacheRule != E && (C = sb(F, C, j.stretch, N.width, N.height, m, O, j.bodyColor)),
                      Eq(F, C, j.stretch, N.x, N.y, N.width, N.height, m, O, j.bodyColor),
                      F.compGray = !1,
                      F.interactiveInfo = E
                  }
                  F.restore()
              }
              y._39O(F, j)
          },
          _48O: function() {},
          _47O: function() {}
      });
      var Mm = function(F, g) {
          Jg(Mm, this, [F, g])
      }
        , zo = function(Q, o, F, E) {
          var c = Qf(Q, o);
          return F = E ? K(F, c) : Zl(F, c),
          c ? F /= c : F = 0,
          {
              x: Q.x + (o.x - Q.x) * F,
              y: Q.y + (o.y - Q.y) * F
          }
      };
      Ik(Mm, bk, {
          _3O: function() {
              var S, n = this, j = n._data, x = n.gv, G = n.s, g = G(vj), N = j.isLooped(), Z = G("edge.width"), h = n.getBodyColor("edge.color"), u = G("edge.center"), m = G("edge.offset"), J = x.getBorderColor(j), p = J ? G("border.width") : 0, D = n.getSelectWidth(), R = j._40I, O = j._41I, $ = n._78o = R && O ? {
                  looped: N,
                  type: g,
                  width: Z,
                  center: u,
                  color: h,
                  repeatImage: Ti(G("edge.repeat.image"), h),
                  borderColor: J,
                  borderWidth: p,
                  _97o: D ? n.getSelectColor() : E,
                  selectWidth: D,
                  pattern: G("edge.pattern"),
                  cap: G("edge.cap"),
                  join: G("edge.join"),
                  is3d: G("edge.3d"),
                  _67o: G("edge.3d.color"),
                  _66o: G("edge.3d.accuracy"),
                  gray: G("2d.gray")
              } : E;
              if ($) {
                  var A = M.getEdgeType(g);
                  if (A) {
                      var T = A(j, xp(n, x, j, N, g), x, n._19Q);
                      T.points && T.points.size() > 1 ? ($.edgeTypeInfo = T,
                      S = kr($.edgeTypeInfo.points)) : T[Fm] && T.rect && ($.edgeTypeInfo = T,
                      S = T.rect)
                  } else {
                      var e = G("edge.source.anchor.x")
                        , b = G("edge.source.anchor.y")
                        , _ = G("edge.target.anchor.x")
                        , I = G("edge.target.anchor.y")
                        , H = $g(x, j, "source")
                        , C = $g(x, j, "target");
                      if (g === $h) {
                          var w = $.points = G(ri) || $b
                            , o = w.size();
                          $.segments = G("edge.segments");
                          var c = e !== V || b !== V || ji(R)
                            , K = _ !== V || I !== V || ji(O);
                          if (!u)
                              if (m)
                                  c || (H = zo(H, o ? w.get(0) : C, m, o)),
                                  K || (C = zo(C, o ? w.get(o - 1) : H, m, o));
                              else {
                                  var P;
                                  c || (P = Sq(H, o ? w.get(0) : C, wo(x, R)),
                                  P && (H = {
                                      x: P[0],
                                      y: P[1]
                                  })),
                                  K || (P = Sq(o ? w.get(o - 1) : H, C, wo(x, O)),
                                  P && (C = {
                                      x: P[0],
                                      y: P[1]
                                  }))
                              }
                          S = Ee(kr($.points), kr(H, C))
                      } else {
                          var L = xp(n, x, j, N, g);
                          if (n._19Q || (L = -L),
                          N)
                              H = Ej(H),
                              H.x = x.getNodeRect(R).x,
                              $.radius = L,
                              S = {
                                  x: H.x - L,
                                  y: H.y - L,
                                  width: 2 * L,
                                  height: 2 * L
                              };
                          else {
                              var U = Qf(H, C)
                                , W = Zl(m, U)
                                , F = {
                                  x: W,
                                  y: L
                              }
                                , B = {
                                  x: U - W,
                                  y: L
                              }
                                , q = a(C.y - H.y, C.x - H.x)
                                , z = $.mat = new Ck(q);
                              if ($.orienAngle = q,
                              $.angle = C.x < H.x ? q + s : q,
                              $.rect = {
                                  x: F.x,
                                  y: F.y,
                                  width: B.x - F.x,
                                  height: 0
                              },
                              $.origin = H,
                              F = z.tf(F),
                              F.x += H.x,
                              F.y += H.y,
                              B = z.tf(B),
                              B.x += H.x,
                              B.y += H.y,
                              u) {
                                  var i = {
                                      x: U,
                                      y: 0
                                  };
                                  i = z.tf(i),
                                  i.x += H.x,
                                  i.y += H.y,
                                  S = kr([H, F, B, i]),
                                  $.c1 = H,
                                  $.c2 = i
                              } else
                                  S = kr(F, B);
                              H = F,
                              C = B
                          }
                      }
                      $.sourcePoint = H,
                      $.targetPoint = C,
                      j._lastSourcePoint = H,
                      j._lastTargetPoint = C
                  }
                  var v = 0;
                  G("edge.dash") && (v = G("edge.dash.width") || Z);
                  var k = "square" === $.cap ? .71 : .5;
                  Zb(S, X(v * k, Z * k + p + D), $.join),
                  n._68o(S)
              }
          },
          getRotation: function(F, _, k) {
              F = F || 0;
              var y = this._78o;
              if (y) {
                  var o, c = y.angle, t = y.points, K = y.edgeTypeInfo;
                  if (c != E)
                      return _ ? y.orienAngle + F : c + F;
                  if (K && K[Fm])
                      return K.getRotation ? K.getRotation(this, F, _, k) : 0;
                  if (K && K.points) {
                      var l = K.points;
                      return o = l.size(),
                      ab[k] ? o && 0 === o % 2 ? Qb(l.get(o / 2 - 1), l.get(o / 2), _, F) : F : Ie[k] ? Qb(l.get(0), l.get(1), _, F) : Qb(l.get(o - 2), l.get(o - 1), _, F)
                  }
                  if (t)
                      return o = t.size(),
                      ab[k] ? o && 0 === o % 2 ? Qb(t.get(o / 2 - 1), t.get(o / 2), _, F) : F : Ie[k] ? Qb(y.sourcePoint, o ? t.get(0) : y.targetPoint, _, F) : Qb(o ? t.get(o - 1) : y.sourcePoint, y.targetPoint, _, F)
              }
              return F
          },
          getPosition: function(D, I, M, b, X) {
              var E = this._78o;
              if (E) {
                  var T, f = E.type, Y = E.points, F = E.edgeTypeInfo, C = E.sourcePoint, w = E.targetPoint;
                  if (!f)
                      return E.looped ? {
                          x: C.x - E.radius + I,
                          y: C.y + M
                      } : (X && C && w && (C.x > w.x || C.x === w.x && C.y > w.y) && (D = Kl[D],
                      M = -M),
                      T = Eo(D, E.rect, b),
                      T.x += I,
                      T.y += M,
                      T = E.mat.tf(T),
                      T.x += E.origin.x,
                      T.y += E.origin.y,
                      T);
                  if (F && F[Fm])
                      return F.getPosition ? F.getPosition(this, D, I, M, b, X) : {
                          x: (C.x + w.x) / 2,
                          y: (C.y + w.y) / 2
                      };
                  if (Y) {
                      var T, c = Y.size();
                      if (ab[D]) {
                          if (c) {
                              var l = c % 2;
                              if (0 === l)
                                  return hi(Y.get(c / 2 - 1), Y.get(c / 2), D, I, M, b, X);
                              T = Y.get((c - l) / 2)
                          } else
                              T = {
                                  x: (C.x + w.x) / 2,
                                  y: (C.y + w.y) / 2
                              };
                          return T = Eo(D, {
                              x: T.x,
                              y: T.y,
                              width: 0,
                              height: 0
                          }, b),
                          T.x += I,
                          T.y += M,
                          T
                      }
                      return Ie[D] ? hi(C, c ? Y.get(0) : w, D, I, M, b, X) : hi(c ? Y.get(c - 1) : C, w, D, I, M, b, X)
                  }
                  if (F) {
                      var V = F.points
                        , c = V.size();
                      if (ab[D]) {
                          var l = c % 2;
                          return 0 === l ? hi(V.get(c / 2 - 1), V.get(c / 2), D, I, M, b, X) : (T = V.get((c - l) / 2),
                          T = Eo(D, {
                              x: T.x,
                              y: T.y,
                              width: 0,
                              height: 0
                          }, b),
                          T.x += I,
                          T.y += M,
                          T)
                      }
                      return Ie[D] ? hi(V.get(0), V.get(1), D, I, M, b, X) : hi(V.get(c - 2), V.get(c - 1), D, I, M, b, X)
                  }
              }
              return Wk
          },
          _42: function(z) {
              this._78o && Mm.superClass._42.call(this, z)
          },
          drawPath: function(p, i) {
              p.beginPath();
              var A = i.type
                , T = i.points
                , U = i.segments
                , N = i.edgeTypeInfo;
              if (!A || T) {
                  var R = i.sourcePoint
                    , X = R.x
                    , O = R.y
                    , E = i.targetPoint
                    , W = E.x
                    , S = E.y;
                  if (A)
                      if (U) {
                          var H = new Mh({
                              x: X,
                              y: O
                          });
                          H.addAll(T),
                          H.add({
                              x: W,
                              y: S
                          }),
                          Cc(p, H, U)
                      } else
                          p.moveTo(X, O),
                          T.each(function(Z) {
                              p.lineTo(Z.x, Z.y)
                          }),
                          p.lineTo(W, S);
                  else
                      i.looped ? p.arc(X, O, i.radius, 0, y, !0) : i.center ? (p.moveTo(i.c1.x, i.c1.y),
                      p.lineTo(X, O),
                      p.lineTo(W, S),
                      p.lineTo(i.c2.x, i.c2.y)) : (p.moveTo(X, O),
                      p.lineTo(W, S))
              } else
                  N && (N.points ? Cc(p, N.points, N.segments) : N[Fm] && N[Fm](p, N))
          },
          _80o: function(y) {
              var p = this
                , I = p.s
                , N = p._78o
                , D = N.width
                , V = N.selectWidth
                , e = N.borderWidth
                , A = N.repeatImage
                , z = y.lineJoin
                , q = y.lineCap
                , O = N.gray
                , h = N.pattern;
              y.lineJoin = N.join,
              y.lineCap = N.cap,
              p.drawPath(cq(y, h), N);
              var i = I("edge.width.absolute");
              i && (y.save(),
              y.setTransform(1, 0, 0, 1, 0, 0)),
              V && (y.strokeStyle = N._97o,
              y.lineWidth = D + 2 * (e + V),
              y.stroke()),
              e && (y.strokeStyle = O ? M.toGrayColor(N.borderColor) : N.borderColor,
              y.lineWidth = D + 2 * e,
              y.stroke());
              var G = O ? M.toGrayColor(N.color) : N.color;
              if (A ? Nb(y, A, G, null, p._data, p.gv) : y.strokeStyle = G,
              y.lineWidth = D,
              y.stroke(),
              N.is3d) {
                  var T = O ? M.toGrayColor(N._67o) : N._67o;
                  Zo(y, G, T, D, p.gv._zoom, N._66o)
              }
              if (wh(y, h),
              I("edge.dash")) {
                  h = I("edge.dash.pattern");
                  var x = cq(y, h, p._2Q("edge.dash.offset"));
                  x !== y && p.drawPath(x, N),
                  p._1Q(y, "edge", I("edge.dash.width") || D, h)
              }
              i && y.restore(),
              y.lineJoin = z,
              y.lineCap = q
          },
          _48O: function() {},
          _47O: function() {}
      });
      var Wh = function(U, M) {
          Jg(Wh, this, [U, M])
      };
      Ik(Wh, Zd, {
          _3O: function() {
              var e, K, O = this, d = O.s, p = O._data, P = O.gv;
              if (O._88I = E,
              p.isExpanded() && p.eachChild(function(R) {
                  if (ud(R)) {
                      var s = P.getBoundsForGroup(R);
                      s && (K || (K = []),
                      K.push(s),
                      e = Ee(e, s))
                  }
              }),
              e) {
                  var C = P.getLabel(p)
                    , U = d("group.type")
                    , f = d("group.border.width") || 0
                    , a = d("group.border.width.absolute")
                    , Z = f / 2;
                  a && (f /= P._zoom),
                  e = fr(U, K, e),
                  Od(e, p, "group.padding", 1),
                  nk(e, f);
                  var Q = O._88I = {
                      type: U,
                      rect: e,
                      _64o: e
                  };
                  if (!U && C != E) {
                      var t, _ = O.labelInfo = {
                          label: C,
                          color: d("group.title.color"),
                          font: d("group.title.font"),
                          align: d("group.title.align")
                      }, w = Df(_, C), g = w.width + f, o = w.height + f, H = d("group.title.align"), j = d("group.title.orientation");
                      if (j === Dj || j === zg ? (e.height += f,
                      g > e.width && (e.width = g)) : (j === Mb || j === Gq) && (e.width += f,
                      g > e.height && (e.height = g)),
                      t = H === Mb ? e.x : H === Gq ? e.x + e.width - g : e.x + e.width / 2 - g / 2,
                      j === zg)
                          Q.titleRect = {
                              x: e.x,
                              y: e.y + e.height,
                              width: e.width,
                              height: o
                          },
                          Q.rect = {
                              x: e.x,
                              y: e.y,
                              width: e.width,
                              height: e.height + o
                          },
                          _.rect = {
                              x: t,
                              y: e.y + e.height,
                              width: g,
                              height: o
                          };
                      else if (j === Mb) {
                          var D = Q.titleRect = {
                              x: e.x - o,
                              y: e.y,
                              width: o,
                              height: e.height
                          };
                          Q.rect = {
                              x: e.x - o,
                              y: e.y,
                              width: e.width + o,
                              height: e.height
                          },
                          _.rect = {
                              x: D.x + o / 2 - e.height / 2,
                              y: D.y + e.height / 2 - o / 2,
                              width: e.height,
                              height: o
                          },
                          _.rotation = -Math.PI / 2
                      } else if (j === Gq) {
                          var D = Q.titleRect = {
                              x: e.x + e.width,
                              y: e.y,
                              width: o,
                              height: e.height
                          };
                          Q.rect = {
                              x: e.x,
                              y: e.y,
                              width: e.width + o,
                              height: e.height
                          },
                          _.rect = {
                              x: D.x + o / 2 - e.height / 2,
                              y: D.y + e.height / 2 - o / 2,
                              width: e.height,
                              height: o
                          },
                          _.rotation = Math.PI / 2
                      } else
                          Q.titleRect = {
                              x: e.x,
                              y: e.y - o,
                              width: e.width,
                              height: o
                          },
                          Q.rect = {
                              x: e.x,
                              y: e.y - o,
                              width: e.width,
                              height: e.height + o
                          },
                          _.rect = {
                              x: t,
                              y: e.y - o - Z,
                              width: g,
                              height: o + f
                          }
                  }
                  O._40O(Q, d("group.border.width") / 2)
              } else
                  Wh.superClass._3O.call(O)
          },
          getPosition: function(V, H, C, S) {
              var j = this._88I;
              if (j) {
                  var v = Eo(V, j.rect, S);
                  return v.x += H,
                  v.y += C,
                  v
              }
              return Wh.superClass.getPosition.apply(this, arguments)
          },
          _24O: function(t, E) {
              var J = this._88I;
              (!J || J.type || "label2" === t) && Wh.superClass._24O.call(this, t, E)
          },
          _80o: function(h) {
              var X = this
                , C = X._88I;
              if (C) {
                  var N = X._data
                    , g = X.s
                    , w = X.gv
                    , v = C.type
                    , I = C.rect
                    , $ = C._64o
                    , D = C.titleRect
                    , T = X.getBodyColor()
                    , U = Ti(g("group.image"), T)
                    , j = g("group.image.stretch")
                    , R = X.getBodyColor("group.background")
                    , m = Ti(g("group.repeat.image"), T)
                    , p = g("group.gradient.pack")
                    , s = g("group.gradient")
                    , L = g("group.gradient.color")
                    , o = g("group.border.width")
                    , J = g("group.border.color")
                    , W = g("group.border.pattern")
                    , K = g("group.title.orientation")
                    , S = g("group.depth")
                    , r = g("group.border.radius")
                    , k = g("group.border.join")
                    , E = g("group.border.cap")
                    , Z = g("group.border.width.absolute");
                  Z && (o /= w._zoom);
                  var V = J
                    , F = g("group.border.repeat.image");
                  if (F && (F = Ti(F, J)) && (V = dd(h, F, J, null, N, w)),
                  v) {
                      var x = h.lineJoin
                        , t = h.lineCap;
                      if (h.lineJoin = k,
                      h.lineCap = E,
                      U) {
                          if (h.save(),
                          Cr(h, v, I, r),
                          h.clip(),
                          Eq(h, U, j, I.x, I.y, I.width, I.height, N, w, T),
                          h.restore(),
                          o > 0) {
                              var Q = cq(h, W);
                              Cr(Q, v, I, r),
                              h.lineWidth = o,
                              h.strokeStyle = V,
                              h.stroke(),
                              wh(h, W)
                          }
                      } else {
                          var Q = cq(h, W);
                          R || m || p ? (Cr(h, v, I, r),
                          p ? Wq(h, p, function(O) {
                              return pf(O, T)
                          }) : m ? Ji(h, m, T, null, N, w) : eq(h, R, s, L, I),
                          h.fill(),
                          p && h.restore(),
                          h !== Q && Cr(Q, v, I, r)) : Cr(Q, v, I, r),
                          o > 0 && (h.lineWidth = o,
                          h.strokeStyle = V,
                          h.stroke()),
                          wh(h, W),
                          v === gp && Kk(h, R, S, I)
                      }
                      h.lineJoin = x,
                      h.lineCap = t
                  } else {
                      var q = g("group.title.background");
                      if ((!r || 0 > r) && (r = 0),
                      U)
                          Eq(h, U, j, $.x, $.y, $.width, $.height, N, w, X.getBodyColor());
                      else if (R || m)
                          if (m ? Ji(h, m, T, null, N, w) : eq(h, R, s, L, $),
                          0 === o)
                              Cr(h, gp, $),
                              h.fill(),
                              Kk(h, R, S, $);
                          else {
                              switch (h.beginPath(),
                              K) {
                              case zg:
                                  ws(h, $.x, $.y, $.width, $.height, r, r, 0, 0);
                                  break;
                              case Mb:
                                  ws(h, $.x, $.y, $.width, $.height, 0, r, 0, r);
                                  break;
                              case Gq:
                                  ws(h, $.x, $.y, $.width, $.height, r, 0, r, 0);
                                  break;
                              case Dj:
                                  ws(h, $.x, $.y, $.width, $.height, 0, 0, r, r)
                              }
                              h.fill()
                          }
                      if (D && q)
                          if (0 === o)
                              xg(h, D.x, D.y, D.width, D.height, q),
                              Kk(h, q, S, D);
                          else {
                              switch (h.beginPath(),
                              h.fillStyle = q,
                              K) {
                              case zg:
                                  ws(h, D.x, D.y, D.width, D.height, 0, 0, r, r);
                                  break;
                              case Mb:
                                  ws(h, D.x, D.y, D.width, D.height, r, 0, r, 0);
                                  break;
                              case Gq:
                                  ws(h, D.x, D.y, D.width, D.height, 0, r, 0, r);
                                  break;
                              case Dj:
                                  ws(h, D.x, D.y, D.width, D.height, r, r, 0, 0)
                              }
                              h.fill()
                          }
                      if (o > 0) {
                          var Q = cq(h, W);
                          if (Cr(Q, "roundRect", I, r),
                          h.save(),
                          h.lineWidth = o,
                          h.strokeStyle = V,
                          h.lineJoin = k,
                          h.lineCap = E,
                          h.closePath(),
                          h.stroke(),
                          D && g("group.splitLine")) {
                              var a = D.x
                                , l = D.y
                                , M = D.width
                                , n = D.height;
                              h.beginPath(),
                              K === zg ? (h.moveTo(a, l),
                              h.lineTo(a + M, l)) : K === Mb ? (h.moveTo(a + M, l),
                              h.lineTo(a + M, l + n)) : K === Gq ? (h.moveTo(a, l),
                              h.lineTo(a, l + n)) : (h.moveTo(a, l + n),
                              h.lineTo(a + M, l + n))
                          }
                          h.stroke(),
                          h.restore(),
                          wh(Q, W)
                      }
                  }
                  X._39O(h, C)
              } else
                  Wh.superClass._80o.call(X, h)
          }
      });
      var Vn = function(i, l) {
          Jg(Vn, this, [i, l])
      };
      Ik(Vn, Zd, {
          _80o: function(C) {
              this._39O(C, this._83o)
          }
      });
      var Ro = function(j, C) {
          Jg(Ro, this, [j, C])
      };
      Ik(Ro, Zd, {
          _3O: function() {
              var V = this
                , q = V._data
                , W = V.s
                , C = V.gv
                , s = q.getPoints()
                , S = C.getBorderColor(q)
                , D = S ? W("border.width") : 0
                , N = V.getSelectWidth()
                , o = W("shape.border.width")
                , f = q.getRect()
                , i = q.getAnchorRect()
                , p = C.getBodyColor(q)
                , Z = W("shape.border.color")
                , g = V._99o = s.isEmpty() ? E : {
                  rect: f,
                  rotation: q.getRotation(),
                  fillRule: W("shape.fill.rule"),
                  scale: q.getScale(),
                  position: q.p(),
                  points: s,
                  segments: q.getSegments(),
                  bodyColor: p,
                  borderColor: S,
                  borderWidth: D,
                  _94o: W("shape.border.3d"),
                  _95o: W("shape.border.3d.color"),
                  _96o: W("shape.border.3d.accuracy"),
                  _97o: N ? V.getSelectColor() : E,
                  selectWidth: N,
                  _53o: W("shape.background"),
                  _27Q: Ti(W("shape.repeat.image"), p),
                  shapeGradientPack: W("shape.gradient.pack"),
                  _54o: o,
                  _55o: Z,
                  shapeBorderRepeatImage: Ti(W("shape.border.repeat.image"), Z),
                  shapeGradient: W("shape.gradient"),
                  _59o: W("shape.gradient.color"),
                  _60o: W("shape.border.pattern"),
                  _61o: W("shape.border.cap"),
                  _62o: W("shape.border.join"),
                  shapeForeground: W("shape.foreground"),
                  gray: W("2d.gray")
              };
              if (g) {
                  i.x += g.position.x,
                  i.y += g.position.y,
                  g.gradientRect = i;
                  var P = q.getScale()
                    , L = X(1, X(u(P.x), u(P.y)));
                  W("shape.dash") && W("shape.dash.width") > o && (o = W("shape.dash.width"));
                  var r, B = W("shape.border.width.absolute");
                  r = B ? (o + D + N) / V.gv._zoom / L : o * ("square" === g._61o ? .71 : .5) + D + N / V.gv._zoom / L,
                  r && (r *= L,
                  f = Ej(f),
                  Zb(f, r, g._62o)),
                  V._68o(f);
                  var K = W("clip.percentage");
                  1 > K && (0 > K && (K = 0),
                  g.clipRect = yg(q.getAnchorRect(), W("clip.direction"), K));
                  var z = W("shape.fill.clip.percentage");
                  1 > z && (0 > z && (z = 0),
                  g.shapeClipRect = yg(q.getAnchorRect(), W("shape.fill.clip.direction"), z));
                  var x = W("shape.foreground.clip.percentage");
                  1 > x && (0 > x && (x = 0),
                  g.shapeForegroundClipRect = yg(q.getAnchorRect(), W("shape.foreground.clip.direction"), x))
              }
          },
          getPosition: function(w, o, h, Q) {
              var B = this._99o;
              if (B) {
                  var X = Eo(w, B.rect, Q);
                  return X.x += o,
                  X.y += h,
                  X
              }
              return Wk
          },
          _42: function(j) {
              this._99o && Ro.superClass._42.call(this, j)
          },
          _80o: function(i) {
              var l, s = this, o = s.s, E = s._99o, b = E.position, a = E.scale, U = E.rotation, p = E.borderWidth, g = E.selectWidth / s.gv._zoom, C = E._27Q, A = E.shapeGradientPack, y = E._54o, t = E.clipRect, n = E.shapeClipRect, q = E.points, Z = E.segments, X = s._data.isClosePath(), u = E.fillRule, w = E.gray, k = function(F) {
                  return w ? M.toGrayColor(F) : F
              }, B = k(E._53o), d = B || C || A;
              i.save(),
              od(i, b.x, b.y),
              Iq(i, U),
              ig(i, a.x, a.y),
              t && (i.beginPath(),
              i.rect(t.x, t.y, t.width, t.height),
              i.clip()),
              d && n && (i.save(),
              i.beginPath(),
              i.rect(n.x, n.y, n.width, n.height),
              i.clip()),
              od(i, -b.x, -b.y);
              var P = E._60o
                , r = cq(i, P)
                , e = i.lineJoin
                , Y = i.lineCap;
              i.lineJoin = E._62o,
              i.lineCap = E._61o;
              var h = k(E.bodyColor);
              d ? (Cc(i, q, Z, X),
              A ? Wq(i, A, function(k) {
                  return pf(k, E.bodyColor)
              }) : C ? Ji(i, C, h, null, s._data, s.gv) : (l = h ? h : B,
              eq(i, l, E.shapeGradient, k(E._59o), E.gradientRect)),
              i.fill(u),
              A && i.restore(),
              n && (i.restore(),
              od(i, -b.x, -b.y)),
              r !== i && Cc(r, q, Z, X)) : Cc(r, q, Z, X);
              var H = E.shapeForeground;
              if (H) {
                  i.save();
                  var J = E.shapeForegroundClipRect;
                  J && (od(i, b.x, b.y),
                  i.beginPath(),
                  i.rect(J.x, J.y, J.width, J.height),
                  i.clip(),
                  od(i, -b.x, -b.y)),
                  Cc(i, q, Z, X),
                  eq(i, H, o("shape.foreground.gradient"), k(o("shape.foreground.gradient.color")), E.gradientRect),
                  i.fill(u),
                  i.restore()
              }
              var Q = o("shape.border.width.absolute");
              if (Q && (i.save(),
              i.setTransform(1, 0, 0, 1, 0, 0)),
              g && (i.strokeStyle = E._97o,
              i.lineWidth = y + 2 * (p + g),
              i.stroke()),
              p && (i.strokeStyle = k(E.borderColor),
              i.lineWidth = y + 2 * p,
              i.stroke()),
              y && (l = k(E._55o),
              E.shapeBorderRepeatImage ? Nb(i, E.shapeBorderRepeatImage, l, null, s._data, s.gv) : (!B && h && (l = h),
              i.strokeStyle = l),
              i.lineWidth = y,
              i.stroke(),
              E._94o && Zo(i, l, k(E._95o), y, s.gv._zoom, E._96o)),
              wh(i, P),
              o("shape.dash")) {
                  var N = o("shape.dash.width") || y;
                  if (N > 0) {
                      P = o("shape.dash.pattern");
                      var r = cq(i, P, s._2Q("shape.dash.offset"));
                      r !== i && Cc(r, q, Z, X),
                      s._1Q(i, "shape", N, P)
                  }
              }
              Q && i.restore(),
              i.lineJoin = e,
              i.lineCap = Y,
              i.restore()
          },
          _48O: function() {},
          _47O: function() {}
      });
      var Gd = function(X, F) {
          Jg(Gd, this, [X, F])
      };
      Ik(Gd, Ro, {
          getRotation: function(i, b, A) {
              i = i || 0;
              var P = this._data.getPoints()
                , z = P.size();
              return z > 1 ? ab[A] ? z && 0 === z % 2 ? Qb(P.get(z / 2 - 1), P.get(z / 2), b, i) : i : Ie[A] ? Qb(P.get(0), P.get(1), b, i) : Qb(P.get(z - 2), P.get(z - 1), b, i) : i
          },
          getPosition: function(k, H, x, l, e) {
              var L = this._data.getPoints()
                , G = L.size();
              if (G > 1) {
                  if (ab[k]) {
                      var p = G % 2;
                      if (0 === p)
                          return hi(L.get(G / 2 - 1), L.get(G / 2), k, H, x, l, e);
                      var n = L.get((G - p) / 2)
                        , Y = {
                          x: n.x,
                          y: n.y,
                          width: 0,
                          height: 0
                      };
                      return n = Eo(k, Y, l),
                      n.x += H,
                      n.y += x,
                      n
                  }
                  return Ie[k] ? hi(L.get(0), L.get(1), k, H, x, l, e) : hi(L.get(G - 2), L.get(G - 1), k, H, x, l, e)
              }
              return Wk
          }
      });
      var pe = function(Z, Q) {
          Jg(pe, this, [Z, Q])
      };
      Ik(pe, Zd, {
          _3O: function() {
              var o = this;
              pe.superClass._3O.call(o);
              var V = o.s
                , J = o._83o;
              o._82o = J.img || J.shape ? E : {
                  background: o.getBodyColor("grid.background"),
                  depth: V("grid.depth"),
                  rect: J.rect,
                  _88o: V("grid.cell.depth"),
                  cellBorderColor: V("grid.cell.border.color"),
                  _89o: V("grid.row.count"),
                  _90o: V("grid.column.count"),
                  block: V("grid.block"),
                  _91o: V("grid.block.color"),
                  _92o: V("grid.block.padding"),
                  _93o: V("grid.block.width")
              }
          },
          _80o: function(w) {
              var y = this
                , Y = y._82o;
              if (!Y)
                  return pe.superClass._80o.call(y, w),
                  void 0;
              var u, R, J = y._data, s = Y.background, P = Y.rect, o = Y.block, j = Y._91o, C = Y._92o, c = Y._93o, Q = Y._88o, $ = Y.cellBorderColor, n = Y._89o, M = Y._90o;
              if (s)
                  if (xg(w, P.x, P.y, P.width, P.height, s),
                  Kk(w, s, Y.depth, P),
                  Q)
                      for (u = 0; n > u; u++)
                          for (R = 0; M > R; R++)
                              P = J.getCellRect(u, R),
                              P && Kk(w, s, Q, P);
                  else if ($) {
                      for (w.beginPath(),
                      u = 0; n > u; u++)
                          for (R = 0; M > R; R++)
                              P = J.getCellRect(u, R),
                              P && w.rect(P.x, P.y, P.width, P.height);
                      w.strokeStyle = $,
                      w.lineWidth = 1,
                      w.stroke()
                  }
              if ("h" === o)
                  for (u = 0; n > u; u++)
                      P = Ee(J.getCellRect(u, 0), J.getCellRect(u, M - 1)),
                      nk(P, C),
                      Ri(w, j, P.x, P.y, P.width, P.height, c);
              else if ("v" === o)
                  for (R = 0; M > R; R++)
                      P = Ee(J.getCellRect(0, R), J.getCellRect(n - 1, R)),
                      nk(P, C),
                      Ri(w, j, P.x, P.y, P.width, P.height, c);
              y._39O(w, y._83o)
          }
      });
      var gf = function(e, x) {
          Jg(gf, this, [e, x])
      };
      Ik(gf, Zd, {
          _checkEmptyRect: !1,
          _81o: function() {
              var J = this._data
                , y = gf.superClass._81o.call(this)
                , N = J.s("text");
              if (N != E) {
                  var x, d, Z = J.s("text.font"), I = J.s("text.align"), O = J.s("text.vAlign"), X = eh(Z, N), P = X.width, a = X.height, G = J.getAnchor(), h = J.getWidth(), n = J.getHeight();
                  "left" === I ? x = -h * G.x : "center" === I ? x = -h * G.x + (h - P) / 2 : "right" === I && (x = h * (1 - G.x) - X.width),
                  "top" === O ? d = -n * G.y : "middle" === O ? d = -n * G.y + (n - a) / 2 : "bottom" === O && (d = n * (1 - G.y) - X.height);
                  var T, s = J.getMatrix();
                  if (T = kr([s.tf(x, d), s.tf(x + P, d), s.tf(x + P, d + a), s.tf(x, d + a)]),
                  y = Ee(y, T),
                  y && J.s("text.shadow")) {
                      var r = Ej(y);
                      r.x += J.s("text.shadow.offset.x"),
                      r.y += J.s("text.shadow.offset.y"),
                      nk(r, J.s("text.shadow.blur")),
                      y = Ee(y, r)
                  }
              }
              return y
          }
      });
      var ek = qg.Interactor = function(W) {
          this.gv = this._graphView = W
      }
      ;
      Kh("Interactor", G, {
          ms_listener: 1,
          getView: function() {
              return this.gv.getView()
          },
          setUp: function() {
              this.addListeners()
          },
          tearDown: function() {
              this.removeListeners(),
              this.clear()
          },
          clear: function() {},
          fi: function(g) {
              this.gv.fi(g)
          },
          setCursor: function(T) {
              Ul || this.gv.setCursor(T)
          },
          startDragging: function(m) {
              var g = this;
              g._lastClientPoint = Gp(m),
              g._lastLogicalPoint = g.gv.lp(m),
              dq(g, m)
          },
          clearDragging: function() {
              var t = this;
              t._lastClientPoint = t._lastLogicalPoint = t._logicalPoint = E
          },
          autoScroll: function(o) {
              return this.gv.autoScroll(o, this._lastClientPoint)
          }
      });
      var gl = E
        , Am = function(Z) {
          gl.handleWindowTouchMove(Z)
      }
        , tg = function(c) {
          gl.handleWindowTouchEnd(c),
          D(W, wl, Am),
          D(W, Ci, tg),
          gl = E
      }
        , Fk = function(S) {
          gl.handleWindowMouseMove(S)
      }
        , rf = function(k) {
          gl.handleWindowMouseUp(k),
          D(W, Ao, Fk),
          D(W, ge, rf),
          gl = E
      }
        , wd = function(Z, w) {
          if (Z !== gl) {
              var u = sg(w);
              gl ? u ? gl.handleWindowTouchEnd(w) : gl.handleWindowMouseUp(w) : u ? (b(W, wl, Am),
              b(W, Ci, tg)) : (b(W, Ao, Fk),
              b(W, ge, rf)),
              gl = Z
          }
      }
        , Zf = function(O) {
          var m = this;
          m.gv = O,
          m._is2d = O instanceof qg.GraphView,
          m._eventListeners = {},
          ["mousedown", "mousemove", "mouseleave", "touchstart", "touchmove", Ho, "wheel"].forEach(function(e) {
              m.addListener(e)
          }),
          m.initImageResource()
      };
      Ik(Zf, ek, {
          enableVR: function(k) {
              var t = this;
              if (!!t._vrEnable !== k)
                  if (t._vrEnable = k,
                  k)
                      t.gv.vr.mp(t.onVRControllerChange, t);
                  else if (t.gv.vr.ump(t.onVRControllerChange, t),
                  t._vrRayPolyline) {
                      var G = t.gv.dm();
                      G.remove(t._vrRayPolyline),
                      G.remove(t._vrRayHitPoint),
                      t._vrRayPolyline = V,
                      t._vrRayHitPoint = V
                  }
          },
          onVRControllerChange: function(q) {
              var V = this
                , J = q.property
                , Y = q.newValue
                , G = V.gv.vr.getController(Y.id)
                , m = G.getRay();
              m && ("gamepad.button.trigger" === J ? "down" === Y._62O ? V.handle_mousedown(m) : V.handleWindowMouseUp(m) : "gamepad.pose" === J && (V.handle_mousemove(m),
              V.handleWindowMouseMove(m)))
          },
          drawVRRay: function($, F, H) {
              var Z, r = this, l = r.gv, M = r._vrRayPolyline, c = !1;
              if (M)
                  Z = r._vrRayHitPoint;
              else {
                  var v = l.dm();
                  r._vrRayPolyline = M = new n.Polyline,
                  r._vrRayHitPoint = Z = new n.Node,
                  Z.s({
                      shape3d: "billboard",
                      "shape3d.transparent": !0,
                      "texture.scale": 10,
                      "shape3d.image": "coreInteractorRayHitImage"
                  }),
                  Z.setAnchor3d(.5, .5, .499);
                  var E = .2 / l.vr.measureOflength;
                  Z.s3(E, E, E),
                  M.s("intersect", !1),
                  Z.s("intersect", !1),
                  v.add(M),
                  v.add(Z),
                  c = !0
              }
              if (F) {
                  var m = H.world
                    , y = H.worldNormal
                    , T = m.x
                    , U = m.y
                    , K = m.z;
                  M.s("shape.border.color", "red"),
                  M.setPoints([{
                      x: $.origin.x,
                      y: $.origin.z,
                      e: $.origin.y
                  }, {
                      x: T,
                      y: K,
                      e: U
                  }]),
                  Z.s("3d.visible", !0),
                  Z.p3(T, U, K),
                  Z.lookAtDirection([y.x, y.y, y.z], "front")
              } else {
                  M.s("shape.border.color", "blue");
                  var e = new n.Math.Vector3;
                  e.copy($.direction).setLength(1e3 / r.gv.vr.measureOflength).add($.origin),
                  M.setPoints([{
                      x: $.origin.x,
                      y: $.origin.z,
                      e: $.origin.y
                  }, {
                      x: e.x,
                      y: e.z,
                      e: e.y
                  }]),
                  Z.s("3d.visible", !1)
              }
              l.fi({
                  kind: "vrRayIntersect",
                  ray: $,
                  data: F,
                  intersect: H,
                  polyline: M,
                  hitNode: Z,
                  begin: c
              })
          },
          setPreventEventDefault: function(Y, y) {
              var o = this
                , g = o._eventListeners[Y];
              g ? g._prevent = y : o._eventListeners[Y] = g = {
                  _removal: V,
                  _prevent: y
              }
          },
          removeListener: function(A) {
              var q = this
                , G = q._eventListeners[A];
              G && G._removal && (G._removal(),
              G._removal = V)
          },
          addListener: function(u) {
              var Y = this
                , r = Y._eventListeners[u];
              if (r || (Y._eventListeners[u] = r = {
                  _removal: V,
                  _prevent: !0
              }),
              !r || !r._removal) {
                  var I = function(k) {
                      r._prevent && M.preventDefault(k),
                      Y.disabled || ("wheel" === u ? Po(Y, k) : Y["handle_" + u](k))
                  };
                  b(Y.gv.getView(), u, I),
                  r._removal = function() {
                      D(Y.gv.getView(), u, I)
                  }
              }
          },
          handleWindowTouchMove: function(k) {
              this.handleWindowMouseMove(k)
          },
          handleWindowMouseMove: function(Y) {
              this.downInfo && (this.isDragging ? this.handleDownInfo("onDrag", Y) : (this.handleDownInfo("onBeginDrag", Y),
              this.isDragging = !0))
          },
          handleWindowTouchEnd: function(K) {
              this.handleWindowMouseUp(K)
          },
          handleWindowMouseUp: function(D) {
              if (this.isDragging && (this.handleDownInfo("onEndDrag", D),
              this.isDragging = !1),
              this.downInfo) {
                  var O = this.handle("onUp", D);
                  if (O && O.data === this.downInfo.data) {
                      this.handleMissingUp(D);
                      var I = this
                        , b = 2 === D.button ? "onContextMenu" : "onClick";
                      if (!I._dbclickTimer)
                          return I._dbclickTimer = vk(function() {
                              delete I._dbclickTimer,
                              I.handleClick(D, b, O),
                              this.downInfo = E
                          }, M.clickDelay),
                          void 0;
                      _d(I._dbclickTimer),
                      delete I._dbclickTimer,
                      b = "onDoubleClick",
                      I.handleClick(D, b, O)
                  } else
                      this.handleDownInfo("onUp", D);
                  this.downInfo = E
              }
          },
          handle_mouseleave: function(s) {
              var p = this
                , $ = p.gv
                , M = p.currentInfo ? p.currentInfo.data : E;
              if (M) {
                  M.s("onLeave") && M.s("onLeave")(s, M, $),
                  p.fire("data", "onLeave", s, M);
                  var f = p.currentInfo ? p.currentInfo.hits : E;
                  if (f)
                      for (var z in f)
                          p.handleLeave(s, z);
                  p.currentInfo = E
              }
          },
          handle_mousewheel: function(S) {
              S.scrollDelta = S.wheelDelta / 40,
              this.handle("onScroll", S)
          },
          handle_DOMMouseScroll: function(A) {
              A.scrollDelta = 2 === A.axis ? -A.detail : 0,
              this.handle("onScroll", A)
          },
          handle_touchstart: function(v) {
              this.handle_mousedown(v)
          },
          handle_touchmove: function(E) {
              this.handle("onMove", E)
          },
          handle_mousedown: function(U) {
              this.isDragging && (this.handleDownInfo("onEndDrag", U),
              this.isDragging = !1),
              this.downInfo = this.handle("onDown", U),
              this.downInfo && wd(this, U)
          },
          handle_mousemove: function(R) {
              var Y = this
                , D = Y.gv;
              Y._hoverTimer && (_d(Y._hoverTimer),
              delete Y._hoverTimer);
              var k, L, i, H = Y.handle("onMove", R), v = this.currentInfo ? this.currentInfo.data : E, d = this.currentInfo ? this.currentInfo.hits : E;
              if (H && (L = H.data,
              i = H.hits,
              Y._hoverTimer = vk(function() {
                  _d(Y._hoverTimer),
                  delete Y._hoverTimer,
                  Y.handle("onHover", R, H)
              }, D.getHoverDelay() || M.hoverDelay)),
              L !== v) {
                  if (v && (v.s("onLeave") && v.s("onLeave")(R, v, D),
                  this.fire("data", "onLeave", R, v)),
                  L && (L.s("onEnter") && L.s("onEnter")(R, L, D),
                  this.fire("data", "onEnter", R, L)),
                  d)
                      for (k in d)
                          this.handleLeave(R, k);
                  if (i)
                      for (k in i) {
                          var F = i[k]
                            , g = L._interactPrefix = F.prefix
                            , S = g && L.a(g + "onEnter") || F.target.onEnter;
                          S && S.call(F.target, R, L, D, F.point, F.width, F.height),
                          this.fire(F.type, "onEnter", F.event, F.data, F.image, F.comp, F.point, F),
                          L._interactPrefix = null
                      }
              } else {
                  if (d)
                      for (k in d)
                          i && i[k] || this.handleLeave(R, k);
                  if (i)
                      for (k in i)
                          if (!d || !d[k]) {
                              var F = i[k]
                                , g = L._interactPrefix = F.prefix
                                , S = g && L.a(g + "onEnter") || F.target.onEnter;
                              S && S.call(F.target, R, L, D, F.point, F.width, F.height),
                              this.fire(F.type, "onEnter", F.event, F.data, F.image, F.comp, F.point, F),
                              L._interactPrefix = null
                          }
              }
              this.currentInfo = H
          },
          handle: function(j, b, M) {
              var g, N = this, q = N.gv;
              if (N._is2d) {
                  if (M = M || q.getDataInfoAt(b),
                  !M || !q.isInteractive(M.data))
                      return;
                  if (g = M.ui.interactiveInfo) {
                      var $, V = M.data;
                      if (V.s(j) && V.s(j)(b, V, q),
                      this.fire("data", j, b, V),
                      "body" === M.part && g.bodyInfo)
                          $ = "body",
                          M.hits = this.handleImage($, q.getImage(V), j, b, V, M.point, g.bodyInfo);
                      else if ("icons" === M.part && g._38o) {
                          var Y = g._38o[M.name];
                          Y && Y[M.index] && ($ = "icons|" + M.name + "|" + M.index,
                          M.hits = this.handleImage($, M.icon, j, b, V, M.point, Y[M.index]))
                      }
                  }
                  return M
              }
              var V, L;
              if (!M)
                  if (b && b instanceof n.Math.Ray) {
                      var r = q.vr.intersectWorld(b);
                      if (V = r.data,
                      L = r.intersect,
                      N.drawVRRay(b, V, L),
                      !V)
                          return;
                      var z = q.getData3dUI(V);
                      if (g = z.interactiveInfo,
                      !g)
                          return;
                      M = {
                          data: V,
                          part: L.part,
                          ui: z
                      }
                  } else {
                      if (M = q.getDataInfoAt(b),
                      !M)
                          return;
                      M && (M = {
                          data: M.data,
                          part: M.part
                      })
                  }
              if (q.isInteractive(M.data)) {
                  if (!L) {
                      V = M.data;
                      var z = q.getData3dUI(V);
                      if (M.ui = z,
                      g = z.interactiveInfo,
                      !g)
                          return M;
                      if (L = q.intersectObject(b, V),
                      !L)
                          return
                  }
                  V.s(j) && V.s(j)(b, V, q),
                  this.fire("data", j, b, V);
                  var P, U = L.part;
                  return "body" !== U && (P = V.s(U + ".image") || V.s("shape3d." + U + ".image")),
                  P || (P = V.s("all.image") || V.s("shape3d.image")),
                  P ? (g = "object" == typeof P ? g[P.uuid] : g[P],
                  g && g.bodyInfo ? (M.part = "body",
                  M.interactiveInfo = g,
                  M.point = this._convertUVToPoint(L.uv, g),
                  M.image = P,
                  M.hits = this.handleImage("body", P, j, b, V, M.point, g.bodyInfo),
                  M) : M) : M
              }
          },
          _handleLeaveOrMissing: function(o, l, C) {
              var y = "leave" === o ? this.currentInfo : this.downInfo;
              if (y) {
                  var U = y.interactiveInfo || y.ui.interactiveInfo;
                  if (U) {
                      var u, f, m = y.data;
                      if (this._is2d) {
                          if (f = this.gv.lp(l),
                          "body" === y.part && U.bodyInfo)
                              u = "body",
                              "leave" === o ? this.handleLeaveImage(C, u, this.gv.getImage(m), l, m, f, U.bodyInfo) : this.handleMissingUpImage(u, this.gv.getImage(m), l, m, f, U.bodyInfo);
                          else if ("icons" === y.part && U._38o) {
                              var W = U._38o[y.name];
                              W && W[y.index] && (u = "icons|" + y.name + "|" + y.index,
                              "leave" === o ? this.handleLeaveImage(C, u, y.icon, l, m, f, W[y.index]) : this.handleMissingUpImage(u, y.icon, l, m, f, W[y.index]))
                          }
                      } else {
                          if (!U.bodyInfo)
                              return;
                          var x = this.gv.intersectObject(l, m);
                          f = x && x.uv ? this._convertUVToPoint(x.uv, U) : {
                              x: 1 / 0,
                              y: 1 / 0
                          },
                          "leave" === o ? this.handleLeaveImage(C, "body", y.image, l, m, f, U.bodyInfo) : this.handleMissingUpImage("body", y.image, l, m, f, U.bodyInfo)
                      }
                  }
              }
          },
          handleClick: function(I, v, P) {
              var E = this
                , V = this.downInfo;
              if (V && P) {
                  var K, g = P.interactiveInfo || P.ui.interactiveInfo, x = P.data, c = this.gv;
                  if (x.s(v) && x.s(v)(I, x, c),
                  E.fire("data", v, I, x),
                  g)
                      if (this._is2d) {
                          if (V.part === P.part) {
                              var G = c.lp(I);
                              "body" === P.part && g.bodyInfo && (K = "body",
                              this.handleClickImage(K, c.getImage(x), v, I, x, G, g.bodyInfo, P))
                          }
                      } else {
                          if (!g.bodyInfo)
                              return;
                          var Y = c.intersectObject(I, x);
                          if (!Y)
                              return;
                          G = this._convertUVToPoint(Y.uv, g),
                          this.handleClickImage("body", V.image, v, I, x, G, g.bodyInfo, P)
                      }
              }
          },
          handleDownInfo: function(Y, P) {
              if (this.downInfo) {
                  var U = this.downInfo
                    , H = this.gv
                    , j = U.interactiveInfo || U.ui.interactiveInfo;
                  if (j) {
                      var J, g = U.data;
                      if (g.s(Y) && g.s(Y)(P, g, H),
                      this.fire("data", Y, P, g),
                      this._is2d) {
                          var s = H.lp(P);
                          if ("body" === U.part && j.bodyInfo)
                              J = "body",
                              this.handleDownInfoImage(J, H.getImage(g), Y, P, g, s, j.bodyInfo);
                          else if ("icons" === U.part && j._38o) {
                              var t = j._38o[U.name];
                              t && t[U.index] && (J = "icons|" + U.name + "|" + U.index,
                              this.handleDownInfoImage(J, U.icon, Y, P, g, s, t[U.index]))
                          }
                      } else {
                          if (!j.bodyInfo)
                              return;
                          var r = H.intersectObject(P, g);
                          if (!r)
                              return;
                          s = this._convertUVToPoint(r.uv, j),
                          this.handleDownInfoImage("body", U.image, Y, P, g, s, j.bodyInfo)
                      }
                  }
              }
          },
          fire: function(L, G, O, i, _, r, $, e) {
              this.gv.fi({
                  kind: G,
                  type: L,
                  event: O,
                  data: i,
                  image: _,
                  comp: r,
                  view: this.gv,
                  point: $,
                  width: e ? e.width : V,
                  height: e ? e.height : V
              })
          },
          handleImage: function(d, Q, b, n, I, P, k) {
              var c = {};
              if (Q && (Q = Ti(Q))) {
                  var q = this.gv
                    , G = k.rect
                    , S = this.convertPoint(P, k);
                  S.inRect && (Q[b] && Q[b](n, I, q, S, G.width, G.height),
                  this.fire("image", b, n, I, Q, V, S, G),
                  c[d + "|image"] = {
                      target: Q,
                      type: "image",
                      image: Q,
                      data: I,
                      event: n,
                      point: S,
                      width: G.width,
                      height: G.height
                  });
                  for (var l, A = k.compInfos, s = Q, Z = A.length - 1; Z >= 0; Z--) {
                      var U = A[Z]
                        , T = U.comp;
                      if (S = this.convertPoint(P, U, s, T, q, I),
                      S.inRect) {
                          G = U.rect;
                          var m = I._interactPrefix = U.prefix
                            , C = m && I.a(m + b) || T[b];
                          if (C && (l = C.call(T, n, I, q, S, G.width, G.height)),
                          this.fire("comp", b, n, I, Q, T, S, G),
                          l !== !0 && (Q = G.image) && (Q[b] && (l = Q[b](n, I, q, S, G.width, G.height)),
                          this.fire("image", b, n, I, Q, V, S, G)),
                          I._interactPrefix = null,
                          c[d + "|" + Z] = {
                              target: T,
                              type: "comp",
                              comp: T,
                              image: Q,
                              data: I,
                              event: n,
                              point: S,
                              width: G.width,
                              height: G.height,
                              prefix: m
                          },
                          Q && (c[d + "|" + Z + "|image"] = {
                              target: Q,
                              type: "image",
                              image: Q,
                              data: I,
                              event: n,
                              point: S,
                              width: G.width,
                              height: G.height,
                              prefix: m
                          }),
                          l === !0)
                              break
                      }
                  }
              }
              return c
          },
          handleLeave: function(e, E) {
              return this._handleLeaveOrMissing("leave", e, E)
          },
          handleMissingUp: function(z) {
              return this._handleLeaveOrMissing("missing", z)
          },
          handleLeaveImage: function(s, l, u, A, e, Q, o) {
              if (u && (u = Ti(u))) {
                  var $ = this.gv
                    , k = o.rect
                    , b = this.convertPoint(Q, o);
                  s === l + "|image" && (u.onLeave && u.onLeave(A, e, $, b, k.width, k.height),
                  this.fire("image", "onLeave", A, e, u, V, b, k));
                  for (var Z, J = o.compInfos, y = u, h = J.length - 1; h >= 0; h--) {
                      var O = J[h]
                        , N = O.comp;
                      b = this.convertPoint(Q, O, y, N, $, e),
                      k = O.rect;
                      var K = e._interactPrefix = O.prefix;
                      if (s === l + "|" + h) {
                          var f = K && e.a(K + "onLeave") || N.onLeave;
                          f && (Z = f.call(N, A, e, $, b, k.width, k.height)),
                          this.fire("comp", "onLeave", A, e, u, N, b, k)
                      }
                      if (Z !== !0 && (u = k.image) && s === l + "|" + h + "|image" && (u.onLeave && (Z = u.onLeave(A, e, $, b, k.width, k.height)),
                      this.fire("image", "onLeave", A, e, u, V, b, k)),
                      e._interactPrefix = null,
                      Z === !0)
                          break
                  }
              }
          },
          handleMissingUpImage: function(Z, I, o, H, W, J) {
              var u = "onUp"
                , h = this.downInfo.hits;
              if (h && I && (I = Ti(I))) {
                  var q = this.gv
                    , p = J.rect
                    , G = this.convertPoint(W, J);
                  !G.inRect && h[Z + "|image"] && (I[u] && I[u](o, H, q, G, p.width, p.height),
                  this.fire("image", u, o, H, I, V, G, p));
                  for (var n, i = J.compInfos, N = I, K = i.length - 1; K >= 0; K--) {
                      var A = i[K]
                        , l = A.comp;
                      if (G = this.convertPoint(W, A, N, l, q, H),
                      !G.inRect) {
                          p = A.rect;
                          var X = H._interactPrefix = A.prefix;
                          if (h[Z + "|" + K]) {
                              var w = X && H.a(X + u) || l[u];
                              w && (n = w.call(l, o, H, q, G, p.width, p.height)),
                              this.fire("comp", u, o, H, I, l, G, p)
                          }
                          if (n !== !0 && (I = p.image) && h[Z + "|" + K + "|image"] && (I[u] && (n = I[u](o, H, q, G, p.width, p.height)),
                          this.fire("image", u, o, H, I, V, G, p)),
                          H._interactPrefix = null,
                          n === !0)
                              break
                      }
                  }
              }
          },
          handleDownInfoImage: function(e, d, E, B, r, P, t) {
              var G = this.downInfo.hits;
              if (G && d && (d = Ti(d))) {
                  var k = this.gv
                    , h = t.rect
                    , b = this.convertPoint(P, t);
                  G[e + "|image"] && (d[E] && d[E](B, r, k, b, h.width, h.height),
                  this.fire("image", E, B, r, d, V, b, h));
                  for (var Y, q = t.compInfos, L = d, y = q.length - 1; y >= 0; y--) {
                      var A = q[y]
                        , $ = A.comp;
                      b = this.convertPoint(P, A, L, $, k, r),
                      h = A.rect;
                      var x = r._interactPrefix = A.prefix;
                      if (G[e + "|" + y]) {
                          var Z = x && r.a(x + E) || $[E];
                          Z && (Y = Z.call($, B, r, k, b, h.width, h.height)),
                          this.fire("comp", E, B, r, d, $, b, h)
                      }
                      if (Y !== !0 && (d = h.image) && G[e + "|" + y + "|image"] && (d[E] && (Y = d[E](B, r, k, b, h.width, h.height)),
                      this.fire("image", E, B, r, d, V, b, h)),
                      r._interactPrefix = null,
                      Y === !0)
                          break
                  }
              }
          },
          handleClickImage: function(K, Q, c, R, a, D, q, s) {
              var X = this.downInfo.hits
                , _ = s.hits;
              if (X && Q && (Q = Ti(Q))) {
                  var $ = this.gv
                    , p = q.rect
                    , z = this.convertPoint(D, q);
                  X[K + "|image"] && (Q[c] && Q[c](R, a, $, z, p.width, p.height),
                  this.fire("image", c, R, a, Q, V, z, p));
                  for (var N, w = q.compInfos, P = Q, k = w.length - 1; k >= 0; k--) {
                      var B = w[k]
                        , Y = B.comp;
                      z = this.convertPoint(D, B, P, Y, $, a),
                      p = B.rect;
                      var S = a._interactPrefix = B.prefix;
                      if (X[K + "|" + k] && _[K + "|" + k]) {
                          var n = S && a.a(S + c) || Y[c];
                          n && (N = n.call(Y, R, a, $, z, p.width, p.height)),
                          this.fire("comp", c, R, a, Q, Y, z, p)
                      }
                      if (N !== !0 && (Q = p.image) && X[K + "|" + k + "|image"] && (Q[c] && (N = Q[c](R, a, $, z, p.width, p.height)),
                      this.fire("image", c, R, a, Q, V, z, p)),
                      a._interactPrefix = null,
                      N === !0)
                          break
                  }
              }
          },
          initImageResource: function() {
              M.setImage("coreInteractorRayHitImage", {
                  width: 16,
                  height: 16,
                  comps: [{
                      type: "oval",
                      background: "rgb(255,0,0)",
                      borderWidth: 1,
                      borderColor: "rgb(250,120,120)",
                      opacity: .3,
                      rotation: -1.593,
                      rect: [.73315, .6933, 14.5337, 14.61341]
                  }, {
                      type: "oval",
                      background: "rgb(255,0,0)",
                      borderWidth: 1,
                      borderColor: "rgb(250,120,120)",
                      rotation: -1.593,
                      rect: [3.56695, 3.75073, 8.8661, 8.49856]
                  }]
              })
          },
          _convertUVToPoint: function(v, J) {
              if (!v)
                  return {
                      x: 1 / 0,
                      y: 1 / 0
                  };
              var Y = J.bodyInfo.rect
                , D = v.clone()
                , z = v.multiply({
                  x: Y.width,
                  y: Y.height
              });
              return z.local = D,
              z
          },
          convertPoint: function(g, C, l, s, W, f) {
              var q = C.rect
                , t = C.matrix.applyInverse(g).sub(q)
                , L = t.x >= 0 && t.y >= 0 && t.x <= q.width && t.y <= q.height;
              if (!L)
                  return t;
              if (s && yn(s.pixelPerfect, f, W)) {
                  var q, D = 1;
                  this._is2d ? (D = W.getZoom(),
                  q = Ke(g.x, g.y, V, D)) : q = Ke(g.x, g.y);
                  var k = !1
                    , A = q.x
                    , O = q.y
                    , e = q.width
                    , Q = q.height
                    , U = M.hitMaxArea
                    , F = e * Q * D * D;
                  if (F > U) {
                      var i = Math.sqrt(U / F);
                      D *= i
                  }
                  e *= D,
                  Q *= D,
                  2 > e && (e = 2),
                  2 > Q && (Q = 2),
                  A *= D,
                  O *= D;
                  var Y = en(e, Q)
                    , v = new Ld(0,-A,-O,D,D);
                  v.append(C.matrix),
                  W._drawForChecking = !0,
                  s.transform = v,
                  C.refRect && C.refRect.fitSize && (s.refRect = C.refRect);
                  var K = l.comps;
                  l.comps = [s],
                  Gm(Y, l, 0, 0, e, Q, f, self),
                  l.comps = K,
                  delete s.refRect,
                  delete s.transform,
                  W._drawForChecking = !1;
                  try {
                      for (var I = 0, h = Y.getImageData(0, 0, e, Q).data; I < h.length; I += 4)
                          if (0 !== h[I + 3]) {
                              k = !0;
                              break
                          }
                      Y.restore()
                  } catch (o) {
                      Xl = E,
                      k = !1
                  }
                  t.inRect = k
              } else
                  t.inRect = !0;
              return t
          }
      });
      var Sj = qg.DefaultInteractor = function(p) {
          Jg(Sj, this, [p])
      }
      ;
      Kh("DefaultInteractor", ek, {
          handle_mousedown: function(K) {
              ad(K);
              var D = this
                , O = D.gv
                , U = O.getDataAt(K);
              if (O.setFocus(K) && !O._editing && !O._scrolling) {
                  Xk(K) ? O.handleDoubleClick(K, U) : O.handleClick(K, U);
                  var S = no(K);
                  !ec() && !S && U && (O.isMovable(U) || O._39Q(U)) || !O.isPannable() || !ni(K) && !S || Tr(K) || (D._tx = O.tx(),
                  D._ty = O.ty(),
                  D.startDragging(K))
              }
          },
          handleWindowMouseUp: function(J) {
              var O = this
                , l = O.gv;
              l._panning && (delete l._panning,
              l.onPanEnded(),
              O.fi({
                  kind: "endPan",
                  event: J
              })),
              delete O._tx,
              delete O._ty,
              O.clearDragging()
          },
          handle_mousemove: function(w) {
              var r = this
                , i = r.gv;
              r._hoverTimer && (_d(r._hoverTimer),
              delete r._hoverTimer),
              r._hoverTimer = vk(function() {
                  r.fi({
                      kind: "hover",
                      event: w
                  }),
                  _d(r._hoverTimer),
                  delete r._hoverTimer
              }, i.getHoverDelay() || M.hoverDelay)
          },
          handle_touchmove: function(t) {
              this.handle_mousemove(t)
          },
          handleWindowMouseMove: function(t) {
              var N = this
                , h = N.gv;
              N.fi({
                  kind: h._panning ? "betweenPan" : "beginPan",
                  event: t
              }),
              h._panning = 1;
              var A = gj(h, t, N._lastClientPoint);
              h.setTranslate(N._tx + A.x, N._ty + A.y)
          },
          handle_mousewheel: function(J) {
              this.gv.handleScroll(J, J.wheelDelta)
          },
          handle_DOMMouseScroll: function(W) {
              2 === W.axis && this.gv.handleScroll(W, -W.detail)
          },
          handle_keydown: function(Y) {
              this.gv.handleKeyDown(Y)
          }
      });
      var th = qg.SelectInteractor = function(w) {
          Jg(th, this, [w])
      }
      ;
      Kh("SelectInteractor", ek, {
          _42: function() {
              var S = this
                , M = S.gv
                , L = M.getZoom()
                , j = S.mark
                , Z = S.div;
              Z || (Z = S.div = cf(),
              Qc(S.getView(), Z));
              var x = {};
              x.x = j.x * L + M.tx(),
              x.y = j.y * L + M.ty(),
              x.width = j.width * L,
              x.height = j.height * L,
              ib(Z, x),
              this.intersects() ? (Z.style.border = "",
              Z.style.background = M.getRectSelectBackground()) : (Z.style.background = "",
              Z.style.border = "1px solid " + M.getRectSelectBorderColor())
          },
          handle_mousedown: function(A) {
              var y = this
                , $ = y.gv;
              if (y._57I = E,
              y.pendingClickThrough = E,
              !($._editing || $._scrolling || ec() || no(A))) {
                  var G = $.getDataAt(A)
                    , U = $.sm();
                  G ? Tr(A) ? U.co(G) ? U.rs(G) : U.as(G) : U.co(G) ? G instanceof ch && G.isClickThroughEnabled() && ni(A) && (y.pendingClickThrough = Gp(A)) : U.ss(G) : Tr(A) || !$.isPannable() ? ni(A) && (Tr(A) || U.cs(),
                  $.isRectSelectable() && (y.startDragging(A),
                  $._77O = 1)) : ni(A) && (y._57I = Gp(A))
              }
          },
          handle_mouseup: function(g) {
              var _ = this
                , K = _.gv
                , J = _._57I;
              if (J && (Qf(J, Gp(g)) <= 1 && K.sm().cs(),
              _._57I = E),
              _.pendingClickThrough) {
                  if (Qf(_.pendingClickThrough, Gp(g)) <= 1) {
                      var u = K.getDataAt(g);
                      if (u instanceof ch && u.isClickThroughEnabled()) {
                          var p = K.getDataAt(g, function(X) {
                              var x = X.getParent() === u && K.isSelectable(X, !0);
                              return x
                          });
                          p && (g.clickThrough = !0,
                          K.sm().ss(p))
                      }
                  }
                  _.pendingClickThrough = E
              }
          },
          handleWindowMouseUp: function(R) {
              this.clear(R)
          },
          handleWindowMouseMove: function(m) {
              var V = this
                , $ = V.gv;
              V._logicalPoint = $.lp(m),
              V.mark ? (V.fi({
                  kind: "betweenRectSelect",
                  event: m
              }),
              $.isPannable() && V.autoScroll(m),
              V.redraw()) : V.fi({
                  kind: "beginRectSelect",
                  event: m
              }),
              V.mark = kr(V._lastLogicalPoint, V._logicalPoint),
              V.redraw()
          },
          intersects: function() {
              var u = this
                , o = u._lastLogicalPoint
                , h = u._logicalPoint;
              return o.x > h.x || o.y > h.y
          },
          clear: function(C) {
              var N = this
                , U = N.gv
                , f = N.mark;
              if (N._57I = E,
              N.pendingClickThrough = E,
              N._lastLogicalPoint) {
                  if (f) {
                      if (0 !== f.width && 0 !== f.height) {
                          var w = U.getDatasInRect(f, N.intersects());
                          if (!w.isEmpty()) {
                              var d = U.sm()
                                , e = d.toSelection();
                              w.each(function(C) {
                                  d.co(C) ? e.remove(C) : e.add(C)
                              }),
                              d.ss(e)
                          }
                      }
                      is(N.div),
                      delete N.div,
                      delete N.mark,
                      N.redraw(),
                      N.fi({
                          kind: "endRectSelect",
                          event: C
                      }),
                      U.onRectSelectEnded()
                  }
                  N.clearDragging(),
                  delete U._77O
              }
          },
          redraw: function() {
              var R = this;
              R._draw || (R._draw = 1,
              vk(function() {
                  R.mark && R._42(),
                  delete R._draw
              }, 16))
          }
      });
      var Hb = qg.MoveInteractor = function(H) {
          Jg(Hb, this, [H])
      }
      ;
      Kh("MoveInteractor", ek, {
          handle_mousedown: function(K) {
              var p = this
                , d = p.gv;
              if (ni(K) && !d._editing && !d._scrolling && !ec()) {
                  var Y = d.getSelectedDataAt(K);
                  !Y || d._39Q(Y) && !d.isMovable(Y) ? d._focusData = E : (p._data = Y,
                  d.handleMouseDown && d.handleMouseDown(K, Y),
                  p.startDragging(K),
                  d.isMovable(Y) && (d._moving = 1))
              }
          },
          handleWindowMouseUp: function(Q) {
              var k = this
                , N = k.gv;
              N.handleMouseUp && N.handleMouseUp(Q, k._data),
              k.clear(Q)
          },
          handleWindowMouseMove: function(S) {
              var p = this
                , x = p._data
                , U = p.gv;
              if ((!U._93O || !U._93O(S, x)) && U._moving) {
                  p._logicalPoint || p.fi({
                      kind: "prepareMove",
                      event: S
                  });
                  var l = p._logicalPoint ? "betweenMove" : "beginMove"
                    , z = {
                      kind: l,
                      event: S
                  }
                    , r = p._logicalPoint = U.lp(S);
                  "beginMove" !== l || p._alreadyBeginTransaction || (p._alreadyBeginTransaction = !0,
                  U.getDataModel().beginTransaction());
                  var c = p._calcShift(l, S)
                    , M = c.x
                    , A = c.y
                    , T = p.gv.getMoveMode(S, x);
                  T && ("x" === T ? A = 0 : "y" === T ? M = 0 : "xy" !== T && (M = A = 0)),
                  U.moveSelection(M, A),
                  p._lastLogicalPoint = r,
                  p.autoScroll(S),
                  p.fi(z)
              }
          },
          _calcShift: function() {
              var L = this
                , U = L._logicalPoint
                , Z = L._lastLogicalPoint
                , t = U.x - Z.x
                , q = U.y - Z.y;
              return {
                  x: t,
                  y: q
              }
          },
          clear: function(m) {
              var n = this
                , z = n.gv;
              n._lastLogicalPoint && (n._lastLogicalPoint = n._data = z._moving = E,
              n._logicalPoint && (n.fi({
                  kind: "endMove",
                  event: m
              }),
              z.onMoveEnded()),
              n.clearDragging()),
              n._alreadyBeginTransaction && (n._alreadyBeginTransaction = !1,
              z.getDataModel().endTransaction())
          }
      });
      var tq = qg.TextEditInteractor = function(f) {
          Jg(tq, this, [f]),
          this.init()
      }
      ;
      Kh("TextEditInteractor", ek, {
          init: function() {
              var G = this
                , A = this.input = Y.createElement("input")
                , L = A.style;
              A.text = "text",
              L.border = "1px solid #d8d8d8",
              L.position = "absolute",
              L.padding = "2px 3px",
              L.outline = "none",
              L.marginLeft = "-90px",
              L.marginTop = "-16px",
              L.backgroundColor = "rgba(255,255,255, 0.9)",
              L.fontSize = "14px",
              L.width = "180px",
              L.height = "32px",
              L.boxShadow = "0 0 13px rgba(16,142,233, 0.5)",
              L.textAlign = "center",
              L.boxSizing = "border-box",
              b(A, "keyup", function(k) {
                  bq(k) && G.endTextEdit()
              }),
              b(A, "focus", function() {
                  A.select()
              });
              var _ = this.textarea = Y.createElement("textarea")
                , O = this.wrap = Y.createElement("div");
              O.appendChild(_),
              L = _.style,
              L.margin = 0,
              L.padding = "4px",
              L.overflow = "hidden",
              L.boxSizing = "border-box",
              L.position = "absolute",
              L.outline = "none",
              L.backgroundColor = "transparent",
              L.resize = "none",
              L.textAlign = "center",
              L.fontSize = "14px",
              L.border = "none",
              L.borderWidth = 0,
              L.width = "100%",
              L.top = "50%",
              L = O.style,
              L.boxSizing = "border-box",
              L.margin = 0,
              L.padding = 0,
              L.position = "absolute",
              L.boxShadow = "0 0 13px rgba(16,142,233, 0.5)",
              L.border = "1px solid #d8d8d8",
              L.backgroundColor = "rgba(255,255,255, 0.9)",
              L.width = "180px",
              L.marginLeft = "-90px",
              b(_, "keydown", function(_) {
                  return (Oh() || Tr()) && bq(_) ? (G.endTextEdit(),
                  void 0) : (G.calculateTextareaHeight(String.fromCharCode(_.keyCode)),
                  void 0)
              }),
              b(_, "focus", function() {
                  _.select()
              });
              var X = function($) {
                  $.stopPropagation()
              };
              b(A, "mousedown", X),
              b(A, "touchstart", X),
              b(_, "mousedown", X),
              b(_, "touchstart", X),
              G.SIZING_STYLE = ["letter-spacing", "line-height", "padding-top", "padding-bottom", "font-family", "font-weight", "font-size", "text-rendering", "text-transform", "width", "text-indent", "padding-left", "padding-right", "border-width", "box-sizing"],
              G.HIDDEN_TEXTAREA_STYLE = "visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",
              G.handleWindowClick = function(X) {
                  var o = G._editingDOM;
                  if (o) {
                      var h = o.getBoundingClientRect()
                        , L = Gp(X);
                      tp(h, L) || G.endTextEdit()
                  }
              }
          },
          handle_mousedown: function(T) {
              var l = this
                , b = l.gv;
              if (Xk(T) && !b._editing) {
                  var j = b.getDataAt(T);
                  if (j) {
                      var V = b.getTextEditInfo(j);
                      V && (this._editInfo = V,
                      this._editTarget = j,
                      b._editing = !0,
                      V.isMultiline ? this.handleMultilineEdit() : this.handleTextEdit())
                  }
              }
          },
          handleMultilineEdit: function() {
              var C = this
                , A = C.gv
                , Z = C._editTarget
                , X = C.getTargetValue()
                , D = C.textarea
                , P = C.wrap;
              this.hiddenTextarea || this.createHiddenTextarea(),
              (null === X || X === V) && (X = ""),
              D.value = X,
              C._editingDOM = D,
              A.getView().appendChild(P),
              this.layoutHTML(P, Z),
              this.calculateTextareaHeight(),
              vk(function() {
                  D.focus(),
                  b(W, "mousedown", C.handleWindowClick),
                  b(W, "touchstart", C.handleWindowClick)
              }, 10)
          },
          handleTextEdit: function() {
              var Z = this
                , D = Z.gv
                , y = Z._editTarget
                , X = Z.getTargetValue()
                , U = Z.input;
              (null === X || X === V) && (X = ""),
              U.value = X,
              Z._editingDOM = U,
              D.getView().appendChild(U),
              this.layoutHTML(U, y),
              vk(function() {
                  U.focus(),
                  b(W, "mousedown", Z.handleWindowClick),
                  b(W, "touchstart", Z.handleWindowClick)
              }, 10)
          },
          layoutHTML: function(o, B) {
              var N = this.gv
                , E = N.getZoom();
              if (B instanceof n.Node) {
                  var V = B.getRect();
                  o.style.left = (V.x + V.width / 2) * E + N.tx() + "px",
                  o.style.top = (V.y + V.height / 2) * E + N.ty() + "px"
              } else if (B instanceof n.Edge) {
                  var w = N.getDataUI(B)
                    , V = w._6I;
                  o.style.left = (V.x + V.width / 2) * E + N.tx() + "px",
                  o.style.top = (V.y + V.height / 2) * E + N.ty() + "px"
              }
          },
          endTextEdit: function() {
              var S = this
                , R = S._editInfo.isMultiline ? S.wrap : S.input
                , B = S._editInfo.isMultiline ? S.textarea : S.input;
              S.setTargetValue(B.value),
              S.gv.getView().removeChild(R),
              S.gv._editing = !1,
              delete S._editingDOM,
              D(W, "mousedown", S.handlelick),
              D(W, "touchstart", S.handleWindowClick)
          },
          setTargetValue: function(i) {
              var u = this
                , W = u._editTarget
                , s = u._editInfo
                , c = s.accessType
                , C = s.name;
              if (C && c || (c = "p",
              C = "name"),
              "p" === c) {
                  var V = n.Default.setter(C);
                  W[V](i)
              } else
                  "a" === c ? W.a(C, i) : W.s(C, i)
          },
          getTargetValue: function() {
              var g = this
                , m = g._editTarget
                , r = g._editInfo
                , x = r.accessType
                , z = r.name;
              if (z && x || (x = "p",
              z = "name"),
              "p" === x) {
                  var d = n.Default.getter(z);
                  return m[d]()
              }
              return "a" === x ? m.a(z) : m.s(z)
          },
          createHiddenTextarea: function() {
              this.hiddenTextarea = Y.createElement("textarea"),
              this.hiddenTextarea.setAttribute("style", "margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),
              this.hiddenTextarea.setAttribute("rows", "1"),
              this.gv.getView().appendChild(this.hiddenTextarea)
          },
          calculateHTMLStyle: function(k, T) {
              if (T && this.computedStyleCache)
                  return this.computedStyleCache;
              var m = this
                , e = W.getComputedStyle(k)
                , f = e.getPropertyValue("box-sizing") || e.getPropertyValue("-moz-box-sizing") || e.getPropertyValue("-webkit-box-sizing")
                , J = parseFloat(e.getPropertyValue("padding-bottom")) + parseFloat(e.getPropertyValue("padding-top"))
                , X = parseFloat(e.getPropertyValue("border-bottom-width")) + parseFloat(e.getPropertyValue("border-top-width"))
                , a = m.SIZING_STYLE.map(function(L) {
                  return L + ":" + e.getPropertyValue(L)
              }).join(";")
                , x = {
                  sizingStyle: a,
                  paddingSize: J,
                  borderSize: X,
                  boxSizing: f
              };
              return T && (this.computedStyleCache = x),
              x
          },
          calculateTextareaHeight: function(P) {
              P = P || "";
              var Y = this
                , d = Y.textarea
                , H = Y.hiddenTextarea
                , u = Y.wrap
                , B = 32
                , i = Y.calculateHTMLStyle(d, !1)
                , y = i.paddingSize
                , Z = i.borderSize
                , m = i.boxSizing
                , t = i.sizingStyle;
              H.setAttribute("style", t + ";" + Y.HIDDEN_TEXTAREA_STYLE),
              H.value = d.value + P;
              var E = H.scrollHeight;
              "border-box" === m ? E += Z : "content-box" === m && (E -= y),
              d.style.height = E + "px",
              d.style.marginTop = 0 - .5 * E + "px",
              u.style.height = Math.max(E, B) + "px",
              u.style.marginTop = E * -.5 + "px"
          }
      });
      var Th = qg.ScrollBarInteractor = function(N) {
          Jg(Th, this, [N])
      }
      ;
      Kh("ScrollBarInteractor", ek, {
          _41o: function() {
              return this.gv.getViewRect().height < this.gv.getScrollRect().height
          },
          _40o: function() {
              return this.gv.getViewRect().width < this.gv.getScrollRect().width
          },
          isV: function(B) {
              var k = this.gv.getViewRect();
              return this._41o() && (k.x + k.width - this.gv.lp(B).x) * this.gv.getZoom() < co
          },
          isH: function(r) {
              var i = this.gv.getViewRect();
              return this._40o() && (i.y + i.height - this.gv.lp(r).y) * this.gv.getZoom() < co
          },
          handle_mousemove: function(t) {
              this.handle_touchmove(t)
          },
          handle_touchmove: function(X) {
              if (!gd && ni(X) && this.gv.isScrollBarVisible()) {
                  var e = this
                    , K = e.isV(X)
                    , b = e.isH(X);
                  (K || b) && e.gv.showScrollBar(),
                  e.gv._scrolling = K || b
              }
          },
          handleWindowMouseUp: function(I) {
              this.handleWindowTouchEnd(I)
          },
          handleWindowTouchEnd: function(r) {
              this._state = this._cp = this._tx = this._ty = this.gv._scrolling = E,
              this.fi({
                  kind: "endScroll",
                  event: r
              })
          },
          handle_mousedown: function(Z) {
              this.handle_touchstart(Z)
          },
          handle_touchstart: function(c) {
              var x = this;
              if (x.gv.setFocus(c),
              ad(c),
              x.handle_touchmove(c),
              !(Yp(c) > 1) && x.gv._scrolling && x.gv.isScrollBarVisible()) {
                  x._cp = Gp(c),
                  x._tx = x.gv.tx(),
                  x._ty = x.gv.ty();
                  var l = x.isV(c);
                  x._state = l ? "vScroll" : "hScroll",
                  dq(x, c),
                  x.fi({
                      kind: "beginScroll",
                      event: c
                  })
              }
          },
          handleWindowMouseMove: function(n) {
              this.handleWindowTouchMove(n)
          },
          handleWindowTouchMove: function(I) {
              var b = Gp(I)
                , q = this.gv.getViewRect()
                , e = this.gv.getScrollRect();
              "vScroll" === this._state ? this.gv.ty(this._ty + (this._cp.y - b.y) * e.height / q.height) : "hScroll" === this._state && this.gv.tx(this._tx + (this._cp.x - b.x) * e.width / q.width),
              this.fi({
                  kind: "betweenScroll",
                  event: I
              })
          }
      });
      var Cd = qg.TouchInteractor = function(w, B) {
          B = B || {},
          B.selectable === V && (B.selectable = !0),
          B.movable === V && (B.movable = !0),
          B.pannable === V && (B.pannable = !0),
          B.pinchable === V && (B.pinchable = !0),
          B.editable === V && (B.editable = !0),
          this.params = B,
          Jg(Cd, this, [w])
      }
      ;
      Kh("TouchInteractor", ek, {
          ms_edit: 1,
          setUp: function() {
              var W = this;
              Cd.superClass.setUp.call(W),
              Ul && W.params.editable && W.gv.setEditInteractor(W)
          },
          tearDown: function() {
              var Q = this;
              Cd.superClass.tearDown.call(Q),
              Ul && Q.params.editable && Q.gv.setEditInteractor(E)
          },
          clear: function(j) {
              var A = this
                , F = A.gv;
              F._moving && (A.fi({
                  kind: "endMove",
                  event: j
              }),
              delete F._moving,
              F.onMoveEnded(),
              F.dm().endTransaction()),
              F._panning && (A.fi({
                  kind: "endPan",
                  event: j
              }),
              delete F._panning,
              F.onPanEnded()),
              F._pinching && (A.fi({
                  kind: "endPinch",
                  event: j
              }),
              delete F._pinching,
              F.onPinchEnded()),
              F._editing && (A._46O(j),
              A._77I = A._node = A._edge = A._shape = A._rect = A._89I = A._index = F._editing = E),
              A.pendingClickThrough = A._moving = A._panning = A._pinching = A._editing = A._57I = A._data = A._beginHistory = E,
              A.clearDragging()
          },
          handle_touchstart: function(b) {
              var w = this;
              if (!w.gv._editing) {
                  ad(b),
                  w._57I = E,
                  w.pendingClickThrough = E;
                  var p = w.params
                    , t = w.gv
                    , G = t.sm()
                    , S = t.getDataAt(b)
                    , f = Yp(b);
                  if (1 === f) {
                      if (Xk(b))
                          return t.handleDoubleClick(b, S),
                          void 0;
                      t.handleClick(b, S),
                      S && (t.handleMouseDown && t.handleMouseDown(b, S),
                      w._data = S),
                      p.selectable || (S = E),
                      S && (G.co(S) ? S instanceof ch && S.isClickThroughEnabled() && (w.pendingClickThrough = Gp(b)) : G.ss(S),
                      p.editable && t.isEditable(S) && w._79I(b, S, !0) ? (w._editing = 1,
                      w.startDragging(b)) : p.movable && t.isMovable(S) && (w._moving = 1,
                      w.startDragging(b))),
                      S && t.isMovable(S) || (w._57I = Gp(b),
                      p.pannable && t.isPannable() && (w._panning = 1,
                      w.startDragging(b),
                      w._translate = {
                          x: t.tx(),
                          y: t.ty()
                      }))
                  } else if (p.pinchable && 2 === f) {
                      if (S && t._39Q(S))
                          return;
                      w._pinching = 1,
                      w.startDragging(b);
                      var n = t.getView()
                        , m = t.getZoom()
                        , I = n.getBoundingClientRect()
                        , $ = b.touches[0]
                        , X = b.touches[1]
                        , O = {
                          x: ($.clientX + X.clientX) / 2 - I.left,
                          y: ($.clientY + X.clientY) / 2 - I.top
                      };
                      O.x -= t.tx(),
                      O.y -= t.ty(),
                      O.x /= m,
                      O.y /= m,
                      w._p = O,
                      w._d = fd(b)
                  }
              }
          },
          handle_touchend: function(t) {
              var L = this
                , $ = L.gv
                , B = L._57I
                , r = L._data;
              if (B && (Qf(B, Gp(t)) <= 1 && !$.getDataAt(t) && $.sm().cs(),
              L._57I = E),
              r && $.handleMouseUp && $.handleMouseUp(t, r),
              L.pendingClickThrough) {
                  if (Qf(L.pendingClickThrough, Gp(t)) <= 1) {
                      var r = $.getDataAt(t);
                      if (r instanceof ch && r.isClickThroughEnabled()) {
                          var Q = $.getDataAt(t, function(P) {
                              var O = P.getParent() === r && $.isSelectable(P, !0);
                              return O
                          });
                          Q && (t.clickThrough = !0,
                          $.sm().ss(Q))
                      }
                  }
                  L.pendingClickThrough = E
              }
          },
          handleWindowTouchEnd: function(b) {
              this.clear(b)
          },
          handleWindowTouchMove: function(c) {
              var $ = this
                , H = $.gv
                , R = Yp(c);
              if (1 === R) {
                  var U = Gp(c)
                    , b = gj(H, U, $._lastClientPoint)
                    , j = Qf({
                      x: 0,
                      y: 0
                  }, b);
                  if ($._editing && ($._beginHistory || ($._beginHistory = 1,
                  H.dm().beginTransaction()),
                  H._editing = 1,
                  $._78I(c)),
                  $._moving) {
                      if (!H._moving && j < M.touchMoveThreshold)
                          return;
                      $._beginHistory || ($._beginHistory = 1,
                      H.dm().beginTransaction()),
                      $.handleMove(c)
                  } else if ($._panning) {
                      if (!H._panning && j < M.touchMoveThreshold)
                          return;
                      H.setTranslate($._translate.x + b.x, $._translate.y + b.y),
                      $.fi({
                          kind: H._panning ? "betweenPan" : "beginPan",
                          event: c
                      }),
                      H._panning = 1
                  }
              } else if (2 === R && $._pinching) {
                  var J = fd(c);
                  H.handlePinch($._p, J, $._d),
                  $._d = J,
                  $.fi({
                      kind: H._pinching ? "betweenPinch" : "beginPinch",
                      event: c
                  }),
                  H._pinching = 1
              }
          },
          handleMove: function(P) {
              var A = this
                , q = A.gv
                , m = q.lp(P);
              q._93O && q._93O(P, A._data) || (q.moveSelection(m.x - A._lastLogicalPoint.x, m.y - A._lastLogicalPoint.y),
              A._lastLogicalPoint = m,
              A.autoScroll(P),
              A.fi({
                  kind: q._moving ? "betweenMove" : "beginMove",
                  event: P
              }),
              q._moving = 1)
          }
      });
      var n = W.ht
        , ml = n.graph._editor = {
          Math: n.Math,
          Guide: {}
      };
      ml.getStyle = function(l) {
          var O, a = ml.StyleMap;
          return a && (O = a[l],
          O !== V) ? O : ml.DefaultStyleMap[l]
      }
      ,
      ml.setStyle = function(E, U) {
          var I = ml.StyleMap;
          I || (I = ml.StyleMap = {}),
          I[E] = U
      }
      ,
      ml.inEdit = function(t) {
          return t._inXEdit === !0
      }
      ,
      ml.startEdit = function(t) {
          t._inXEdit = !0,
          ml.Inject.doInject(t)
      }
      ,
      ml._46O = function(R) {
          R._inXEdit = !1,
          ml.Inject.undoInject(R)
      }
      ,
      ml.toScreenPosition = function(T, V) {
          var $ = T.tx()
            , d = T.ty()
            , o = T._zoom;
          return new ml.Math.Vector2(V.x * o + $,V.y * o + d)
      }
      ,
      ml.checkHit = function(Y, W, R) {
          return Y.distanceTo(W) < R ? !0 : !1
      }
      ,
      ml.toWorldPosition = function(f, R) {
          var e = f.tx()
            , j = f.ty()
            , Q = f._zoom;
          return {
              x: (R.x - e) / Q,
              y: (R.y - j) / Q
          }
      }
      ,
      ml.setAntialias = function(E, t) {
          for (var N, r = ["imageSmoothingEnabled", "webkitImageSmoothingEnabled", "mozImageSmoothingEnabled", "oImageSmoothingEnabled", "msImageSmoothingEnabled"], g = 0, Y = r.length; Y > g && (N = r[g],
          !(N in E)); g++)
              ;
          E[N],
          E[N] = t
      }
      ,
      ml.getTargetCornersOnScreen = function(l, p) {
          if (!p)
              return null;
          var y, F = [];
          if (dn(p, l)) {
              var z = wo(l, p);
              y = [{
                  x: z.x,
                  y: z.y
              }, {
                  x: z.x + z.width,
                  y: z.y
              }, {
                  x: z.x + z.width,
                  y: z.y + z.height
              }, {
                  x: z.x,
                  y: z.y + z.height
              }]
          } else {
              if (!p.getCorners)
                  return null;
              y = p.getCorners()
          }
          return y.forEach(function(c) {
              var G = ml.toScreenPosition(l, c);
              F.push(G.x, G.y)
          }),
          F
      }
      ,
      ml.log = function() {}
      ;
      var Kb = ml.Inject = {
          _modules: []
      };
      Kb.registAsModule = function(R, e) {
          var A = {}
            , I = {};
          for (var z in R) {
              var S = e.prototype[z];
              A[z] = S
          }
          R.getBackup = function(M) {
              return A[M]
          }
          ,
          R.getBackups = function() {
              return A
          }
          ,
          I.doInject = function() {
              for (var H in R)
                  "getBackup" !== H && (e.prototype[H] = R[H])
          }
          ,
          I.undoInject = function() {
              for (var N in R)
                  "getBackup" !== N && (e.prototype[N] = A[N])
          }
          ,
          Kb._modules.push(I)
      }
      ,
      Kb.doInject = function(i) {
          for (var L, U = Kb._modules, k = 0, W = U.length; W > k; k++)
              L = U[k],
              L.doInject(i)
      }
      ,
      Kb.undoInject = function(i) {
          for (var l, Q = Kb._modules, U = 0, d = Q.length; d > U; U++)
              l = Q[U],
              l.undoInject(i)
      }
      ;
      var ek = n.graph.EditInteractor = function(W) {
          var i = this
            , y = Y.createElement("canvas");
          y.className = "editCanvas",
          y.style.position = "absolute",
          i._styleMap = {},
          i._canvas = y,
          i._context = y.getContext("2d"),
          ek.superClass.constructor.call(i, W),
          this._editDetail = !1,
          ml.setAntialias(i._context, !1),
          i._subModules = [new ml.Anchor(i), new ml.RotateX(i), new ml.MoveDummy(i), new ml.Rect(i), new ml.Curve(i), new ml.MoveHelper(i)],
          i._gridGuide = new ml.Guide.Grid(i),
          i._rectGuide = new ml.Guide.Rect(i),
          i._hoverGuide = new ml.Guide.Hover(i)
      }
        , ce = ek;
      n.Default.def(ek, n.graph.Interactor, {
          ms_edit: 1,
          ms_fire: 1
      }),
      G.defineProperties(ek.prototype, {
          editDetail: {
              get: function() {
                  var t = !!this._editDetail;
                  return t
              },
              set: function(d) {
                  var R = this
                    , f = R._editDetail;
                  f !== d && (R._editDetail = d,
                  R.gv._editing = d,
                  R.fp("editDetail", f, d),
                  R.fp("pointsEditingMode", f, d),
                  R.fi({
                      kind: d ? "beginEditPoints" : "endEditPoints"
                  }))
              }
          },
          gvEditing: {
              get: function() {
                  return this.gv._editing
              },
              set: function(O) {
                  (!this._editDetail || O) && (this.gv._editing = O,
                  O || (this.editDetail = !1))
              }
          },
          editing: {
              get: function() {
                  return this._editing
              },
              set: function(s) {
                  this._editing = s,
                  this.gvEditing = s
              }
          },
          editingModule: {
              get: function() {
                  return this._editMod
              }
          },
          pointsEditingMode: {
              get: function() {
                  return this.editDetail
              },
              set: function(I) {
                  var O = this;
                  O.editDetail !== I && (I ? O._tryEnterEditDetailMode() : O._tryQuitEditDetailMode())
              }
          },
          gridEnabled: {
              get: function() {
                  var y = this._gridEnabled;
                  if (!y)
                      return !1;
                  var L = this.gv;
                  return L ? !0 : !0
              },
              set: function(U) {
                  U !== this._gridEnabled && (this._gridEnabled = U,
                  this._42())
              }
          },
          alignmentGuideEnabled: {
              get: function() {
                  return this._agEnabled
              },
              set: function(h) {
                  h !== this._agEnabled && (this._agEnabled = h,
                  this._42())
              }
          },
          gridGuide: {
              get: function() {
                  return this._gridGuide
              }
          },
          rectGuide: {
              get: function() {
                  return this._rectGuide
              }
          },
          hoverGuide: {
              get: function() {
                  return this._hoverGuide
              }
          }
      }),
      ek.prototype.getSubModule = function(E) {
          var C, a, U, V = this._subModules;
          for (a = 0,
          U = V.length; U > a; a++)
              if (C = V[a],
              C.catalog === E)
                  return C
      }
      ,
      ek.prototype.invokeSubModule = function(c, p) {
          var S = this
            , N = S._subModules;
          if (N)
              for (var q, E, d, f = Array.prototype.slice.call(arguments, 2), R = 0, A = N.length; A > R; R++)
                  if (q = N[R],
                  E = q[c],
                  E && (d = E.apply(q, f),
                  d != V && p))
                      return q
      }
      ,
      ek.prototype.invokeSubModuleInverse = function(X, x) {
          var c = this
            , k = c._subModules;
          if (k)
              for (var w, n, T, b = Array.prototype.slice.call(arguments, 2), M = k.length - 1; M >= 0; M--)
                  if (w = k[M],
                  n = w[X],
                  n && (T = n.apply(w, b),
                  T != V && x))
                      return w
      }
      ,
      ek.prototype.setUp = function() {
          ml.log("setUp");
          var B = this
            , q = B.gv
            , f = q.getView()
            , X = B._canvas;
          ek.superClass.setUp.call(B),
          q.setEditInteractor(B),
          q._79O ? f.insertBefore(X, q._79O) : f.appendChild(X),
          ml.startEdit(q),
          B.invokeSubModule("setUp"),
          q.dm().mm(B._onDataModelChanged, B),
          q.dm().md(B._onDataPropertyChanged, B)
      }
      ,
      ek.prototype.tearDown = function() {
          ml.log("tearDown");
          var d = this
            , X = d.gv
            , l = X.getView();
          d._resetCustomCursorStyle(),
          ek.superClass.tearDown.call(d),
          X.dm().umm(d._onDataModelChanged, d),
          X.dm().umd(d._onDataPropertyChanged, d),
          X.setEditInteractor(null),
          l.removeChild(d._canvas),
          d._drawTimer && (_d(d._drawTimer),
          d._drawTimer = null),
          ml._46O(X),
          d.invokeSubModule("tearDown")
      }
      ,
      ek.prototype._onDataModelChanged = function(Y) {
          var w = this;
          ("clear" === Y.kind || "remove" === Y.kind && w.editDetail && Y.data === w.getSubModule("Curve").target) && (w.editDetail = !1,
          w._42())
      }
      ,
      ek.prototype._onDataPropertyChanged = function(R) {
          var s = this;
          if (s.editDetail) {
              var j = s.getSubModule("Curve")
                , l = R.data;
              l === j.target && (l._writing || j._handleDataChanged(R))
          }
      }
      ,
      ek.prototype.clear = function() {
          ml.log("clear")
      }
      ,
      ek.prototype.redraw = function() {
          this._42()
      }
      ,
      ek.prototype._42 = function() {
          var k = this;
          k._drawTimer || (k._drawTimer = vk(function() {
              k._drawTimer = null,
              k.drawImpl()
          }, 0))
      }
      ,
      ek.prototype.drawImpl = function() {
          var E;
          for (E in {
              _42: !0
          })
              break;
          return function() {
              var U = this
                , s = U._canvas
                , t = U.gv
                , Z = t.getWidth()
                , F = t.getHeight()
                , I = U._context
                , $ = n.Default.getInternal()
                , b = W.devicePixelRatio;
              (s.width !== Z || s.height !== F) && $.setCanvas(s, Z, F, b),
              I.clearRect(0, 0, s.width, s.height);
              var T = U._getValidSelection();
              I.save(),
              I.scale(b, b),
              U._gridGuide._42(),
              U.invokeSubModuleInverse(E, !1, I, t, T),
              U._rectGuide._42(),
              U._hoverGuide._42(),
              I.restore()
          }
      }(),
      ek.prototype._getValidSelection = function() {
          var F = this
            , l = F.gv
            , V = l.sm().getSelection()
            , R = [];
          return V.each(function(u) {
              l.isVisible(u) && l.isEditable(u) && R.push(u)
          }),
          R
      }
      ,
      ek.prototype.handle_touchmove = function(r) {
          return this.handle_mousemove(r)
      }
      ,
      ek.prototype.handle_mousemove = function(M) {
          if (!n.Default.isDragging()) {
              var o = this;
              if ((o.editDetail || !ec() && !no(M)) && !o.gv._externalEditing)
                  if (o.gvEditing = !1,
                  o._checkEdit(M))
                      o.gvEditing = !0;
                  else {
                      if (!o.getStyle("hoverGuideVisible"))
                          return;
                      o.hoverData = o.gv.getDataAt(M),
                      o._42()
                  }
          }
      }
      ,
      ek.prototype.handle_touchstart = function(Y) {
          return this.handle_mousedown(Y)
      }
      ,
      ek.prototype.handle_mousedown = function(p) {
          ad(p);
          var v = this;
          if ((v.editDetail || !ec() && !no(p)) && !v.gv._externalEditing) {
              if (Xk(p) && !p.clickThrough) {
                  if (v.editDetail) {
                      if (v._tryQuitEditDetailMode(p))
                          return
                  } else if (v._tryEnterEditDetailMode())
                      return;
                  v.gv.dm().beginTransaction();
                  var V = v.invokeSubModule("handleDoubleClick", !0, p);
                  if (v.gv.dm().endTransaction(),
                  V)
                      return
              }
              var j = v._checkEdit(p);
              j && (v._downPosition = v._getLogicalPoint(p),
              v.gv.dm().beginTransaction(),
              j.startEdit(v, p),
              v.editing = !0)
          }
      }
      ,
      ek.prototype._checkEdit = function(J) {
          var C = this
            , L = C.gv
            , U = C._getLogicalPoint(J)
            , D = C.invokeSubModule("check", !0, L, J, U) || null;
          return C._editMod = D,
          D
      }
      ,
      ek.prototype.handleWindowTouchMove = function(A) {
          return this.handleWindowMouseMove(A)
      }
      ,
      ek.prototype.handleWindowMouseMove = function(J) {
          var l = this
            , I = l._downPosition;
          if (I) {
              var x = l._getLogicalPoint(J);
              if (x.distanceTo(I) < l.getStyle("moveSensitivity"))
                  return;
              delete l._downPosition
          }
          var v = l._editMod;
          v && v.handleEdit(l.gv, J)
      }
      ,
      ek.prototype._getLogicalPoint = function(a) {
          var y = this
            , x = n.Default.getLogicalPoint(a, y._canvas);
          return new ml.Math.Vector2(x)
      }
      ,
      ek.prototype.handleWindowTouchEnd = function(L) {
          return this.handleWindowMouseUp(L)
      }
      ,
      ek.prototype.handleWindowMouseUp = function() {
          var H;
          for (H in {
              _46O: !0
          })
              break;
          return function(x) {
              var J = this;
              J.editing = !1,
              J.setCursor("default"),
              J.invokeSubModule(H, !1, x),
              J._42(),
              J.gv.dm().endTransaction()
          }
      }(),
      ek.prototype.handle_mousewheel = function(O) {
          var G = this;
          ad(O),
          G.invokeSubModule("preHandleScroll", !0) || G.gv.handleScroll(O, O.wheelDelta)
      }
      ,
      ek.prototype.handleDelete = function() {
          var V = this;
          if (!V.editDetail) {
              V.gv.dm().beginTransaction();
              var j = V.invokeSubModule("handleNormalStateDelete", !0);
              return V.gv.dm().endTransaction(),
              j || V.gv.removeSelection(),
              void 0
          }
          V.gv.dm().beginTransaction(),
          V.invokeSubModule("handleDelete", !0),
          V.gv.dm().endTransaction(),
          V._42()
      }
      ,
      ek.prototype.handle_keydown = function(O) {
          var V = this;
          if ((O.metaKey || O.ctrlKey) && V._42(),
          ec(O) && !V.editing)
              return V.gvEditing = !1,
              V.setCursor("default"),
              V._42(),
              void 0;
          var L = bq(O);
          return V.editDetail ? ((L || pg(O)) && (V.editDetail = !1,
          V._42()),
          V.gv.dm().beginTransaction(),
          V.invokeSubModule("handle_keydown", !0, O),
          V.gv.dm().endTransaction(),
          void 0) : (V.gv.dm().beginTransaction(),
          V.invokeSubModule("handleNormalStateKeyDown", !0, O),
          V.gv.dm().endTransaction(),
          L && V._tryEnterEditDetailMode(),
          void 0)
      }
      ,
      ek.prototype.handle_keyup = function(N) {
          this.gv.dm().beginTransaction(),
          this.invokeSubModule("handle_keyup", !0, N),
          this.gv.dm().endTransaction()
      }
      ,
      ek.prototype._tryEnterEditDetailMode = function() {
          var j = this;
          return !j.editDetail && j.invokeSubModule("canEnterEditDetailMode", !0) && 1 === j._getValidSelection().length ? (j.editDetail = !0,
          j._42(),
          !0) : void 0
      }
      ,
      ek.prototype._tryQuitEditDetailMode = function(A) {
          var p = this;
          return p.editDetail ? !A || p.invokeSubModule("canQuitEditDetailMode", !0, A) ? (p.editDetail = !1,
          p._42(),
          !0) : !1 : !1
      }
      ,
      ek.prototype.setStyle = function(I, R, c) {
          var U = this;
          c ? ml.setStyle(I, R) : U._styleMap[I] = R,
          "baseColor" === I && (tr = R),
          U.fp("styleChanged", null, {
              key: I,
              value: R,
              base: c
          }),
          U._42()
      }
      ,
      ek.prototype.getStyle = function(h) {
          var o = this
            , n = o._styleMap[h];
          return n !== V ? n : ml.getStyle(h)
      }
      ,
      ek.prototype.setCursor = function(F) {
          this._resetCustomCursorStyle(),
          n.graph.EditInteractor.superClass.setCursor.call(this, F)
      }
      ,
      ek.prototype._drawHostGuide = function(O) {
          var L = this
            , w = L._context
            , x = L.gv;
          ml.Icons.DrawIcon(L, w, ml.Icons.NodeHoverGuide, O.corners);
          var y = O.host;
          if (y) {
              var E = x.getAttachPoints(y);
              if (E && E.length)
                  for (var _ = 0, g = E.length; g > _; _++) {
                      var q = E[_]
                        , V = or(x, y, 0, q.offsetX || 0, q.offsetY || 0, q.x, q.y);
                      V = ml.toScreenPosition(x, V),
                      V.isAttach = O.attach === _,
                      ml.Icons.DrawIcon(L, w, ml.Icons.AttachPoint, V)
                  }
          }
      }
      ,
      ek.prototype._resetCustomCursorStyle = function() {
          var Y = this;
          if (Y._customStyle) {
              var V = this.gv.getView();
              V.classList && V.classList.remove && V.classList.remove(Y._customStyle),
              Y._customStyle = null
          }
      }
      ,
      ek.prototype._setRotateCursor = function(C) {
          var J = this
            , s = J._cursorFactory;
          s || (s = J._cursorFactory = new ml.CursorFactory(J));
          var i = s.getRotateCursor(C)
            , x = J.gv.getView();
          J._resetCustomCursorStyle(),
          J._customStyle = i,
          x.classList && x.classList.add && x.classList.add(i)
      }
      ;
      var zk = ml.Group = function($) {
          var P = this;
          P._entities = $,
          P._64O = 0,
          P._position = {
              x: 0,
              y: 0
          },
          P._scale = {
              x: 1,
              y: 1
          },
          P._anchor = {
              x: .5,
              y: .5
          },
          P._anchor2 = {
              x: .5,
              y: .5
          }
      }
      ;
      zk.prototype = {},
      zk.prototype.constructor = zk;
      var Nk = null;
      zk.findOrCreateGroup = function(V) {
          if (Nk && Nk.checkIsMe(V))
              return Nk;
          var t = new ml.Group(V);
          return t.getKeyOb() ? (Nk = t,
          t) : void 0
      }
      ,
      zk.prototype.checkIsMe = function(g) {
          var I = this._entities;
          if (I.length !== g.length)
              return !1;
          var K, x = {}, B = g.length;
          for (K = 0; B > K; K++)
              x[g[K]._id] = !0;
          for (K = 0; B > K; K++)
              if (!x[I[K]._id])
                  return !1;
          return !0
      }
      ,
      zk.prototype.getRotation = function() {
          return this._64O
      }
      ,
      zk.prototype.getPosition = function() {
          return this._position
      }
      ,
      zk.prototype.getAnchor = function() {
          return this._anchor
      }
      ,
      zk.prototype.getWidth = function() {
          return this._width
      }
      ,
      zk.prototype.getScale = function() {
          return this._scale
      }
      ,
      zk.prototype.getSize = function() {
          return {
              width: this._width,
              height: this._height
          }
      }
      ,
      zk.prototype.getHeight = function() {
          return this._height
      }
      ,
      zk.prototype.getKeyOb = function() {
          for (var m = this._entities, E = m.length - 1; E >= 0; E--) {
              var J = m[E];
              if (this.isNode(J))
                  return J
          }
      }
      ,
      zk.prototype.getAnchor2 = function() {
          var R = this
            , J = R.rotateCenter;
          if (J)
              return J;
          var j = R.getKeyOb();
          if (!j)
              return R._anchor;
          var U = R._anchor2
            , _ = j.getMatrix();
          return _.tf({
              x: j.getWidth() * (U.x - j.getAnchor().x),
              y: j.getHeight() * (U.y - j.getAnchor().y)
          })
      }
      ,
      zk.prototype.setAnchor2 = function(g, p) {
          var Q = this
            , U = Q.getKeyOb();
          if (U) {
              var t, G = U.getMatrix();
              t = "number" == typeof g ? {
                  x: g,
                  y: p
              } : g;
              var b = G.tfi(t);
              Q._anchor2 = {
                  x: U.getAnchor().x + b.x / U.getWidth(),
                  y: U.getAnchor().y + b.y / U.getHeight()
              }
          }
      }
      ,
      zk.prototype.setRotation = function() {}
      ,
      zk.prototype.beginRotate = function(f) {
          this.rotateCenter = f.pos,
          this.rotateMode = f.groupRotateMode
      }
      ,
      zk.prototype.endRotate = function() {
          delete this.rotateCenter,
          delete this.rotateMode
      }
      ,
      zk.prototype.addRotation = function(g, A, Q) {
          return "batch" === A ? this._addRotationInBatchMode(g, Q) : "block" === A ? this._addRotationInBlockMode(g, Q) : void 0
      }
      ,
      zk.prototype._addRotationInBlockMode = function(i, Z) {
          var u = this
            , T = u.rotateCenter || u.getPosition();
          u._entities.forEach(function(m) {
              if (u.isNode(m) && (!Z || Z(m))) {
                  var w = m.getMatrix();
                  w.translate(-T.x, -T.y),
                  w.rotate(i),
                  w.translate(T.x, T.y);
                  var r = Math.sign(m.getScale().x);
                  m.setRotation(a(w.b * r, w.a * r)),
                  m.setPosition(w.tx, w.ty)
              }
          })
      }
      ,
      zk.prototype._addRotationInBatchMode = function(T, r) {
          var j = this
            , E = j._anchor2;
          j._entities.forEach(function(f) {
              if (j.isNode(f) && (!r || r(f))) {
                  var Z = f.getAnchor()
                    , R = f.getMatrix()
                    , b = R.tf({
                      x: f.getWidth() * (E.x - Z.x),
                      y: f.getHeight() * (E.y - Z.y)
                  })
                    , I = new ml.Math.Matrix2d;
                  I.set(R.a, R.b, R.c, R.d, R.tx, R.ty),
                  I.translate(-b.x, -b.y),
                  I.rotate(T),
                  I.translate(b.x, b.y);
                  var M = Math.sign(f.getScale().x);
                  f.setRotation(a(I.b * M, I.a * M)),
                  f.setPosition(I.tx, I.ty)
              }
          })
      }
      ,
      zk.prototype.setPosition = function(W) {
          var O, i, h, A, c = this, j = c._position, Y = W.x - j.x, Q = W.y - j.y, y = c._entities;
          for (i = 0,
          h = y.length; h > i; i++)
              O = y[i],
              ud(O) && (A = O.getPosition(),
              O.setPosition(A.x + Y, A.y + Q));
          c._position = W
      }
      ,
      zk.prototype.setScale = function(m, H) {
          var E = this
            , u = m / E._scale.x
            , A = H / E._scale.y;
          E._adjustChildScaleOrSize(u, A, "size"),
          E._scale = {
              x: m,
              y: H
          }
      }
      ,
      zk.prototype.getRect = function() {
          var r = this
            , a = r._position
            , O = r._width
            , l = r._height;
          return {
              x: a.x - O / 2,
              y: a.y - l / 2,
              width: O,
              height: l
          }
      }
      ,
      zk.prototype.setSize = function(P, R) {
          var t = this
            , P = Math.max(1, P)
            , R = Math.max(1, R)
            , O = P / t._width
            , G = R / t._height;
          t._adjustChildScaleOrSize(O, G, "size"),
          t._width = P,
          t._height = R
      }
      ,
      zk.prototype._adjustChildScaleOrSize = function(S, P, F) {
          var i, $, t, u, O, C, m, z, X, y, B, U, A, Y, K = this, d = K._position, M = K._entities, n = new ml.Math.Matrix2d;
          for ($ = 0,
          t = M.length; t > $; $++)
              if (i = M[$],
              K.isNode(i)) {
                  if (u = i.getPosition(),
                  O = i.getRotation(),
                  C = i.getWidth(),
                  m = i.getHeight(),
                  z = i.getScale(),
                  B = z.x * C,
                  U = z.y * m,
                  n.identity().scale(B, U).rotate(O).translate(u.x, u.y).translate(-d.x, -d.y).rotate(-K._64O),
                  O = a(n.b * Math.sign(B), n.a * Math.sign(B)),
                  n.scale(S, P),
                  X = Math.cos(O),
                  y = Math.sin(O),
                  Math.abs(X) < .001 ? (A = n.b / y,
                  Y = -n.c / y) : (A = n.a / X,
                  Y = n.d / X),
                  "scale" === F)
                      i.setScale(A / C, Y / m);
                  else if ("size" === F) {
                      var r = A / z.x
                        , _ = Y / z.y;
                      i.setScale(Mf(A) * Math.abs(z.x), Mf(Y) * Math.abs(z.y)),
                      i.setSize(Math.max(.1, Math.abs(r)), Math.max(.1, Math.abs(_)))
                  }
                  n.rotate(K._64O).translate(d.x, d.y),
                  i.setPosition(n.tx, n.ty)
              }
      }
      ,
      zk.prototype.getMatrix = function() {
          var H = this
            , u = H._position
            , K = n.Default.getInternal()
            , S = H._scale;
          return new K.Mat(H._64O,u.x,u.y,S.x,S.y)
      }
      ,
      zk.prototype.toGlobal = function(n) {
          return this.getMatrix().tf(n)
      }
      ,
      zk.prototype.getCorners = function() {
          var u = this
            , r = u._width
            , l = u._height
            , F = u._anchor
            , L = -r * F.x
            , y = -l * F.y
            , i = u.getMatrix();
          return [i.tf(L, y), i.tf(L, y + l), i.tf(L + r, y + l), i.tf(L + r, y)]
      }
      ,
      zk.prototype.calcInfo = function() {
          var p, z, w, I, O, E, J = this, U = [], i = J._entities, V = J._64O;
          for (I = 0,
          O = i.length; O > I; I++)
              E = i[I],
              J.isNode(E) && E.getCorners && U.push.apply(U, E.getCorners());
          if (U.length) {
              var b = Math.cos(-V)
                , $ = Math.sin(-V)
                , B = 1 / 0
                , l = -1 / 0
                , P = 1 / 0
                , v = -1 / 0;
              for (I = 0,
              O = U.length; O > I; I++)
                  w = U[I],
                  p = w.x,
                  z = w.y,
                  w.x = b * p - $ * z,
                  w.y = $ * p + b * z,
                  B = Math.min(B, w.x),
                  l = Math.max(l, w.x),
                  P = Math.min(P, w.y),
                  v = Math.max(v, w.y);
              J._width = (l - B) / J._scale.x,
              J._height = (v - P) / J._scale.y,
              b = Math.cos(V),
              $ = Math.sin(V);
              var c = J._anchor;
              p = B + (l - B) * c.x,
              z = P + (v - P) * c.y,
              J._position = {
                  x: b * p - $ * z,
                  y: $ * p + b * z
              }
          }
      }
      ,
      zk.prototype.isNode = function(l) {
          return ud(l) ? dn(l) ? l.size() ? !1 : !0 : !0 : !1
      }
      ,
      zk.prototype._42 = function(T, B, x) {
          var k, p, M, R, e, j, L, y, P = this, g = P._entities, d = P.rotateMode;
          for ("batch" === d && (y = P.getKeyOb()),
          k = 0,
          p = g.length; p > k; k++)
              M = g[k],
              P.isNode(M) && (j = M.getRect(),
              R = ml.toScreenPosition(x, {
                  x: j.x,
                  y: j.y
              }),
              e = ml.toScreenPosition(x, {
                  x: j.x + j.width,
                  y: j.y + j.height
              }),
              L = {
                  min: R,
                  max: e
              },
              M === y && (L.isKeyOb = !0),
              ml.Icons.DrawIcon(T, B, ml.Icons.GroupSubEntityRect, L))
      }
      ;
      var Jh = ml.CurveActiving = function(d, W) {
          this._curve = d,
          this._interactor = d._interactor,
          this.silent = !0;
          for (var I in W)
              this[I] = W[I];
          delete this.silent
      }
      ;
      Jh.prototype = {},
      Jh.prototype.constructor = Jh,
      G.defineProperties(Jh.prototype, {
          point: {
              get: function() {
                  return this._point
              },
              set: function(h) {
                  var H = this;
                  H._point = h,
                  H.editingCtrl || H.silent || H._firePointChange()
              }
          },
          pairs: {
              get: function() {
                  return this._pairs
              },
              set: function(y) {
                  var B = this;
                  B._pairs = y,
                  B.editingCtrl && !B.silent && B._firePointChange()
              }
          }
      }),
      Jh.prototype._firePointChange = function() {
          var $ = this
            , E = $.getCurrentEditingPoint()
            , i = $._interactor;
          if (!E)
              return i.fi({
                  kind: "selectPoint"
              }),
              void 0;
          var q = this._curve.target;
          if (q) {
              var o = ml.getDataMatrix(q).invert()
                , y = E.e;
              E = o.apply(ml.toWorldPosition(i.gv, E)),
              E.e = y;
              var _ = $._lastFirePoint;
              _ && Math.abs(E.x - _.x) < 1e-5 && Math.abs(E.y - _.y) < 1e-5 && (E.e == V && _.e == V || Math.abs(E.e - _.e) < 1e-5) || ($._lastFirePoint = E,
              i.fi({
                  kind: "selectPoint",
                  x: E.x,
                  y: E.y,
                  e: E.e
              }))
          }
      }
      ,
      Jh.prototype.dispose = function() {
          this._interactor.fi({
              kind: "selectPoint"
          })
      }
      ,
      Jh.prototype.getCurrentEditingPoint = function() {
          var Q = this
            , f = Q.editingCtrl;
          if (f) {
              var D = Q.pairs;
              if (D) {
                  var l = D[f.pairId];
                  if (l) {
                      var r = l[f.type];
                      if (r)
                          return r
                  }
              }
          }
          return Q._point
      }
      ;
      var Lg = ml.CursorFactory = function(T) {
          var w = this;
          w._interactor = T,
          w._rotateCursorStyles = {}
      }
      ;
      Lg.prototype = {},
      Lg.prototype.constructor = Lg,
      Lg.prototype.getRotateCursor = function(E) {
          var o = this;
          0 > E && (E += 2 * Math.PI);
          var K = o._interactor
            , s = K.getStyle("rotateCursorSize")
            , O = K.getStyle("rotateCursorRound")
            , T = Math.round(180 * (E / Math.PI) / O);
          T * O >= 360 && (T = 0);
          var g = o._rotateCursorStyles
            , B = "htCustomRotateStyle_" + s + "_" + O + "_" + T;
          return g[B] || (o._produceRotateCursor(B, s, O, T),
          g[B] = !0),
          B
      }
      ,
      Lg.prototype._produceRotateCursor = function(H, G, c, r) {
          var N = this;
          N._interactor;
          var $ = N._canvas;
          $ || ($ = N._canvas = Y.createElement("canvas")),
          $.width = $.height = G * devicePixelRatio,
          $.style.width = $.style.height = G + " px";
          var a = $.getContext("2d");
          ml.setAntialias(a, !1),
          a.scale(devicePixelRatio, devicePixelRatio);
          var l, A, K, t, X, w = Math.round(G / 2), I = "" + w + " " + w + ",auto !important;", q = 4;
          l = Math.PI / 180 * r * c,
          a.clearRect(0, 0, G, G),
          a.save(),
          a.scale(G / 32, G / 32),
          a.translate(16, 15),
          a.rotate(l + Math.PI / 2),
          a.beginPath(),
          a.moveTo(-8, 0),
          a.lineTo(-8, q),
          a.lineTo(-8 + q, q),
          a.moveTo(8, 0),
          a.lineTo(8, q),
          a.lineTo(8 - q, q),
          a.moveTo(-8, q),
          a.quadraticCurveTo(0, -6, 8, q),
          a.restore(),
          a.lineCap = "round",
          a.lineJoin = "miter",
          a.strokeStyle = "white",
          a.lineWidth = 4,
          a.stroke(),
          a.strokeStyle = "black",
          a.lineWidth = 2,
          a.stroke(),
          A = JSON.stringify($.toDataURL()),
          t = "cursor:url(" + A + ")" + I,
          1 !== devicePixelRatio && (K = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="' + G + 'px" height="' + G + 'px"><image xlink:href=' + A + ' width="' + G + '" height="' + G + '"/></svg>',
          t += "cursor:url(data:image/svg+xml;base64," + btoa(K) + ")" + I,
          t += "cursor:-webkit-image-set(url(" + A + ")" + devicePixelRatio + "x,url(" + A + ")1x)" + I),
          X = Y.createElement("style"),
          X.textContent = "body." + H + " *, ." + H + "{" + t + "}",
          Y.head.appendChild(X)
      }
      ;
      var Fn = ml.Guide.Grid = function(L) {
          var d = this;
          d._interactor = L,
          d._alignmentGuideId = 0,
          d._xAlignmentGuide = [],
          d._yAlignmentGuide = []
      }
      ;
      Fn.prototype = {},
      Fn.prototype.constructor = Fn,
      G.defineProperties(Fn.prototype, {
          gridBlockSize: {
              get: function() {
                  var M = this;
                  return M._gridBlockSize || M._interactor.getStyle("gridBlockSize")
              },
              set: function(r) {
                  this._gridBlockSize = r,
                  this._interactor._42()
              }
          },
          gridThickLinesEvery: {
              get: function() {
                  var r = this;
                  return r._gridThickLinesEvery || r._interactor.getStyle("gridThickLinesEvery")
              },
              set: function(L) {
                  this._gridThickLinesEvery = L,
                  this._interactor._42()
              }
          },
          gridEnabled: {
              get: function() {
                  var $ = this
                    , g = $._interactor;
                  return g.gridEnabled && $.isValidGrid()
              }
          }
      }),
      Fn.prototype._42 = function() {
          var k = this
            , W = k._interactor;
          k.gridEnabled && k.drawGrid(),
          W.alignmentGuideEnabled && k.drawAlignmentGuide()
      }
      ,
      Fn.prototype.makeMatrix = function() {
          var F = this
            , q = F._interactor.getStyle("gridAngle")
            , h = F._interactor.getStyle("gridRotation")
            , o = new ml.Math.Matrix2d
            , C = Math.sin(q)
            , e = Math.cos(q);
          return o.set(1, 0, e, C, 0, 0),
          o.rotate(h),
          o
      }
      ,
      Fn.prototype.isValidGrid = function() {
          var s = this
            , i = Math.PI
            , U = s._interactor
            , g = U.gv;
          if (g._zoom < U.getStyle("gridZoomThreshold"))
              return !1;
          var q = U.getStyle("gridAngle")
            , j = Math.abs(180 * (q % i / i))
            , O = 1 - 1e-8;
          return O > j || j > 180 - O ? !1 : !0
      }
      ,
      Fn.prototype.drawAlignmentGuide = function() {
          var k = this
            , T = k._interactor
            , W = T.gv
            , K = T._canvas
            , H = T._context
            , L = K.width
            , r = K.height
            , C = W.tx()
            , G = W.ty()
            , Y = W._zoom;
          H.beginPath(),
          H.strokeStyle = T.getStyle("gridAlignmentGuideColor"),
          H.lineWidth = 1,
          k._xAlignmentGuide.forEach(function(l) {
              var s = l.p * Y + C;
              H.moveTo(s, 0),
              H.lineTo(s, r)
          }),
          k._yAlignmentGuide.forEach(function(h) {
              var X = h.p * Y + G;
              H.moveTo(0, X),
              H.lineTo(L, X)
          }),
          H.stroke()
      }
      ,
      Fn.prototype.drawGrid = function() {
          function w(H, g, N, h) {
              var p = ml.toScreenPosition(V, K.apply({
                  x: H,
                  y: g
              }))
                , Q = ml.toScreenPosition(V, K.apply({
                  x: N,
                  y: h
              }));
              O.moveTo(p.x, p.y),
              O.lineTo(Q.x, Q.y)
          }
          var h = this
            , H = h._interactor
            , o = h.gridBlockSize
            , n = h.gridThickLinesEvery
            , B = H.getStyle("gridThickColor")
            , v = H.getStyle("gridLightColor")
            , V = H.gv
            , s = H._canvas
            , O = H._context
            , k = s.width
            , U = s.height
            , K = h.makeMatrix()
            , E = K.applyInverse(ml.toWorldPosition(V, {
              x: 0,
              y: 0
          }))
            , b = K.applyInverse(ml.toWorldPosition(V, {
              x: k,
              y: 0
          }))
            , A = K.applyInverse(ml.toWorldPosition(V, {
              x: 0,
              y: U
          }))
            , j = K.applyInverse(ml.toWorldPosition(V, {
              x: k,
              y: U
          }))
            , P = Math.min(E.x, b.x, A.x, j.x)
            , R = Math.max(E.x, b.x, A.x, j.x)
            , f = Math.min(E.y, b.y, A.y, j.y)
            , S = Math.max(E.y, b.y, A.y, j.y);
          k = R - P,
          U = S - f;
          var u = Math.ceil(P / o)
            , e = Math.floor(R / o)
            , y = Math.ceil(f / o)
            , i = Math.floor(S / o);
          V.tx(),
          V.ty(),
          V._zoom;
          var z, Q, t;
          for (O.save(),
          O.lineWidth = 1,
          O.beginPath(),
          O.strokeStyle = B,
          t = Math.ceil(u / n) * n; e >= t; t += n)
              z = t * o,
              w(z, f, z, S);
          for (t = Math.ceil(y / n) * n; i >= t; t += n)
              Q = t * o,
              w(P, Q, R, Q);
          for (O.stroke(),
          O.beginPath(),
          O.strokeStyle = v,
          t = u; e >= t; t++)
              0 !== t % n && (z = t * o,
              w(z, f, z, S));
          for (t = y; i >= t; t++)
              0 !== t % n && (Q = t * o,
              w(P, Q, R, Q));
          O.stroke(),
          O.restore()
      }
      ,
      Fn.prototype.getAlignmentGuides = function() {
          var S = this;
          return {
              x: S._xAlignmentGuide,
              y: S._yAlignmentGuide
          }
      }
      ,
      Fn.prototype.addAlignmentGuide = function(e, i, _) {
          var d = this
            , I = "x" === e ? d._xAlignmentGuide : d._yAlignmentGuide
            , _ = _ ? _ : ++d._alignmentGuideId
            , c = {
              p: i,
              id: _
          };
          if (I.length) {
              var V = d._findClosestAlignmentGuide(c.p, I);
              V.dis < 0 ? I.splice(V.index + 1, 0, c) : I.splice(V.index, 0, c)
          } else
              I.push(c);
          return d._interactor._42(),
          _
      }
      ,
      Fn.prototype.findClosest = function(b, X, M) {
          var d = this
            , Z = d._interactor
            , p = Z.gv;
          M && (b = ml.toWorldPosition(p, b));
          var c, D, J, l = 1 / 0, C = 1 / 0, N = b.x, P = b.y;
          if (d.gridEnabled) {
              var k = d.gridBlockSize
                , Q = d.makeMatrix()
                , Y = Q.applyInverse(b);
              Y = Q.apply({
                  x: Math.round(Y.x / k) * k,
                  y: Math.round(Y.y / k) * k
              }),
              l = Y.x - N,
              C = Y.y - P,
              J = !0
          }
          if (Z.alignmentGuideEnabled && (c = d._findClosestAlignmentGuide(N, d._xAlignmentGuide).dis,
          D = d._findClosestAlignmentGuide(P, d._yAlignmentGuide).dis,
          Math.abs(c) < Math.abs(l) && (l = c,
          J = !0),
          Math.abs(D) < Math.abs(C) && (C = D,
          J = !0)),
          J) {
              J = !1;
              var L = p._zoom
                , i = Z.getStyle("smartGuideThreshold") / L
                , x = {};
              if (Math.abs(l) < i && "y" !== X && (x.x = M ? l * L : l,
              J = !0),
              Math.abs(C) < i && "x" !== X && (x.y = M ? C * L : C,
              J = !0),
              J)
                  return x
          }
      }
      ,
      Fn.prototype._findClosestAlignmentGuide = function(B, m) {
          if (!m.length)
              return {
                  dis: 1 / 0
              };
          for (var s, M = 0, F = m.length - 1; F - M > 1; )
              s = Math.floor((M + F) / 2),
              m[s].p < B ? M = s : F = s;
          var P = m[M].p - B
            , Q = m[F].p - B;
          return Math.abs(P) <= Math.abs(Q) ? {
              line: m[M],
              dis: P,
              index: M
          } : {
              line: m[F],
              dis: Q,
              index: F
          }
      }
      ,
      Fn.prototype.removeAllAlignmentGuide = function(_) {
          var J = this;
          "y" !== _ && (J._xAlignmentGuide = []),
          "x" !== _ && (J._yAlignmentGuide = []),
          J._interactor._42()
      }
      ,
      Fn.prototype.removeAlignmentGuide = function(d) {
          for (var Q, i, w, k = this, S = k._xAlignmentGuide, P = 0; 2 > P; P++)
              for (S = 0 === P ? k._xAlignmentGuide : k._yAlignmentGuide,
              Q = 0,
              i = S.length; i > Q; Q++)
                  if (w = S[Q],
                  w.id === d)
                      return S.splice(Q, 1),
                      k._interactor._42(),
                      {
                          axis: 0 === P ? "x" : "y",
                          position: w.p
                      };
          return !1
      }
      ,
      Fn.prototype.adjustAlignmentGuide = function(H, _) {
          var P = this
            , Z = P.removeAlignmentGuide(H);
          return Z ? (P.addAlignmentGuide(Z.axis, _, H),
          !0) : !1
      }
      ;
      var cj = ml.Guide.Rect = function(O) {
          var c = this;
          c._interactor = O
      }
      ;
      cj.prototype = {},
      cj.prototype.constructor = cj,
      cj.prototype.gatherRects = function() {
          var y, r, K, $, O = this, n = O._interactor.gv, Y = [], Z = [], P = {
              x: Y,
              y: Z
          }, v = {}, M = n.getDataModel(), R = M.a("width"), I = M.a("height");
          R && I && (y = 0,
          r = 0,
          K = R,
          $ = I,
          Y.push({
              node: M,
              type: 0,
              p: y
          }, {
              node: M,
              type: 1,
              p: y + K / 2
          }, {
              node: M,
              type: 2,
              p: y + K
          }),
          Z.push({
              node: M,
              type: 0,
              p: r
          }, {
              node: M,
              type: 1,
              p: r + $ / 2
          }, {
              node: M,
              type: 2,
              p: r + $
          }),
          v[M._id || 0] = {
              x: y,
              y: r,
              width: K,
              height: $
          }),
          M.each(function(f) {
              if (ud(f) && !n.isSelected(f) && n.isVisible(f) && n.isValidGuideLineSource(f)) {
                  var l = !1;
                  if (n.sm().getSelection().each(function(q) {
                      l || (f.isHostOn(q) ? l = !0 : f.isDescendantOf(q) && (l = !0))
                  }),
                  !l) {
                      var x = f.getRect();
                      y = x.x,
                      r = x.y,
                      K = x.width,
                      $ = x.height,
                      Y.push({
                          node: f,
                          type: 0,
                          p: y
                      }, {
                          node: f,
                          type: 1,
                          p: y + K / 2
                      }, {
                          node: f,
                          type: 2,
                          p: y + K
                      }),
                      Z.push({
                          node: f,
                          type: 0,
                          p: r
                      }, {
                          node: f,
                          type: 1,
                          p: r + $ / 2
                      }, {
                          node: f,
                          type: 2,
                          p: r + $
                      }),
                      v[f._id] = x
                  }
              }
          }),
          Y.sort(function(d, m) {
              return d.p - m.p
          }),
          Z.sort(function(T, Y) {
              return T.p - Y.p
          }),
          O._grid = P,
          O._87I = v
      }
      ,
      cj.prototype.gatherLines = function(t, z, U) {
          var x, M, Z, i, r, h, $, F, H, a, l, X, f = this, q = [f.findClosest({
              x: t.x,
              y: t.y
          }, z), f.findClosest({
              x: t.x + t.w / 2,
              y: t.y + t.h / 2
          }, z), f.findClosest({
              x: t.x + t.w,
              y: t.y + t.h
          }, z)], G = {}, d = f._87I;
          U = U || 255;
          var S, W;
          for (f._guideLine = [],
          x = 0; 2 > x; x++)
              for (G = {},
              0 === x ? (i = "y",
              F = t.x,
              H = F + t.w) : (i = "x",
              F = t.y,
              H = F + t.h),
              M = 0; 3 > M; M++)
                  r = q[M],
                  r && isFinite(r[i]) && (S = 1 << 3 * x + M,
                  U & S && (h = r[i + "Line"],
                  $ = h.node,
                  W = $._id || 0,
                  G[W] || (G[W] = !0,
                  X = d[W],
                  "y" === i ? (a = X.x,
                  l = X.x + X.width) : (a = X.y,
                  l = X.y + X.height),
                  Z = h.p,
                  f._guideLine.push({
                      type: i,
                      a: F,
                      b: H,
                      c: a,
                      d: l,
                      p: Z,
                      center: 1 === h.type
                  }))))
      }
      ,
      cj.prototype._binarySearchClosest = function(b, c) {
          if (!c.length)
              return {
                  dis: 1 / 0
              };
          for (var m, W = 0, Y = c.length - 1; Y - W > 1; )
              m = Math.floor((W + Y) / 2),
              c[m].p < b ? W = m : Y = m;
          var k = c[W].p - b
            , R = c[Y].p - b;
          return Math.abs(k) <= Math.abs(R) ? {
              line: c[W],
              dis: k
          } : {
              line: c[Y],
              dis: R
          }
      }
      ,
      cj.prototype.findClosest = function(A, s, I) {
          var V = this
            , Q = V._interactor
            , t = Q.gv
            , o = V._grid;
          I && (A = ml.toWorldPosition(t, A));
          var X, C = V._binarySearchClosest(A.x, o.x), H = V._binarySearchClosest(A.y, o.y), w = C.dis, B = H.dis, g = t._zoom, f = Q.getStyle("smartGuideThreshold") / g, K = {};
          return Math.abs(w) < f && "y" !== s && (K.x = I ? w * g : w,
          K.xLine = C.line,
          X = !0),
          Math.abs(B) < f && "x" !== s && (K.y = I ? B * g : B,
          K.yLine = H.line,
          X = !0),
          X ? K : void 0
      }
      ,
      cj.prototype._42 = function() {
          var p = this
            , M = p._guideLine;
          if (M && !n.Default.isCtrlDown()) {
              var c = p._interactor;
              if (c.getStyle("guideLineVisible")) {
                  var z, B, Q, T, t, O, P, y, E, K, u, w, i, W, Z, v, C, o = c.gv, F = c._context, U = o.tx(), e = o.ty(), m = o._zoom, _ = c.getStyle("guideLineTextSpacing");
                  for (z = 0,
                  B = M.length; B > z; z++)
                      Q = M[z],
                      y = Q.type,
                      E = Q.p,
                      K = Q.a,
                      u = Q.b,
                      w = Q.c,
                      i = Q.d,
                      W = Math.min(K, w),
                      Z = Math.max(u, i),
                      "x" === y ? (T = E * m + U,
                      t = W * m + e,
                      O = T,
                      P = Z * m + e) : (T = W * m + U,
                      t = E * m + e,
                      O = Z * m + U,
                      P = t),
                      ml.Icons.DrawIcon(c, F, ml.Icons.MoveLineGuide, {
                          rect: [T, t, O, P],
                          center: Q.center
                      }),
                      i >= K && u >= w || (W = K > i ? i : u,
                      Z = K > i ? K : w,
                      C = Z - W,
                      "x" === y ? (Q.center2center || (T -= _,
                      O = T),
                      t = W * m + e,
                      P = Z * m + e,
                      v = ml.Icons.MoveLineGuideDistanceV) : "y" === y && (Q.center2center || (t -= _,
                      P = t),
                      T = W * m + U,
                      O = Z * m + U,
                      v = ml.Icons.MoveLineGuideDistanceH),
                      ml.Icons.DrawIcon(c, F, v, {
                          x0: T,
                          y0: t,
                          x1: O,
                          y1: P,
                          dis: C
                      }))
              }
          }
      }
      ,
      cj.prototype.clear = function() {
          this._guideLine = null
      }
      ;
      var Me = ml.Guide.Hover = function(Q) {
          var O = this;
          O._interactor = Q
      }
      ;
      Me.prototype = {},
      Me.prototype.constructor = Me,
      G.defineProperties(Me.prototype, {}),
      Me.prototype._42 = function() {
          var J = this._interactor;
          if (J.getStyle("hoverGuideVisible") && !J.gvEditing) {
              var d = J.hoverData
                , Z = J.gv;
              if (!ud(d) || Z.isSelected(d))
                  return J.hoverData = null,
                  void 0;
              var c = wo(Z, d)
                , N = ml.toScreenPosition(Z, {
                  x: c.x,
                  y: c.y
              })
                , K = ml.toScreenPosition(Z, {
                  x: c.x + c.width,
                  y: c.y + c.height
              });
              ml.Icons.DrawIcon(J, J._context, ml.Icons.HoverDataRect, {
                  min: N,
                  max: K,
                  color: J.getStyle("hoverGuideColor") || J.getStyle("baseColor")
              })
          }
      }
      ,
      ml.DefaultStyleMap = {
          baseColor: "rgb(51,153,255)",
          pointSize: [24, 9],
          checkSize: 7,
          rotateCheckSize: 10,
          moveSensitivity: 10,
          moveDummyThreshold: 32,
          moveDummyPosition: [0, 0, -16, -16],
          moveDummyLineExtraShift: [-32, 0],
          moveDummySensitivity: 16,
          keepAspectRatio: !1,
          rotateRound: Math.PI / 2,
          shiftRotateRound: Math.PI / 12,
          rotateSensitivity: Math.PI / 60,
          rotateAsClock: !1,
          shiftLineRotateRound: Math.PI / 4,
          anchorMovable: !0,
          anchorVisible: !0,
          anchorHideThreshold: 25,
          anchorOutsideVisibleThreshold: .25,
          anchorRound: .25,
          anchorSensitivity: .02,
          smartGuideThreshold: 8,
          curveIntersectSize: 5,
          curvePointIntersectSize: 8,
          edgeHostDetectPerFrame: !0,
          edgeHostEdgeMaxDistance: 12,
          edgeHostEdgeHighlighColor: "#5d5d5d",
          edgeHostPointHighlighColor: "red",
          edgeHostHighlighPeriod: 1500,
          edgeElevationEditable: !1,
          attachThreshold: 25,
          guideLineVisible: !0,
          guideLineTextSpacing: 0,
          hoverGuideVisible: !1,
          hoverGuideColor: null,
          gridBlockSize: 40,
          gridThickLinesEvery: 10,
          gridThickColor: "#5d5d5d",
          gridLightColor: "#d0d0d0",
          gridZoomThreshold: .25,
          gridAlignmentGuideColor: "#ff0000",
          gridAngle: Math.PI / 2,
          gridRotation: 0,
          groupRotateModeDefault: "block",
          groupRotateModeKey: ["ctrlKey", "metaKey"],
          rotateCursorSize: 32,
          rotateCursorRound: 45,
          tipTextColor: "#ffffff",
          tipBackground: "#333333",
          curveHighlightColor: "#30599e",
          rectPointBackground: "white",
          rectPointBorderColor: "#666666",
          rectPointShadowColor: "rgba(0,0,0,0.35)",
          shapeCtrlPointBackground: "white",
          shapeCtrlPointBorderColor: null,
          shapeCtrlPointHighlightBorder: null,
          shapeHighlighPointBackground: "#30599e",
          curveElevationVisible: !0,
          curveElevationIntersectSize: 8,
          curveElevationGuideShift: [20, 0],
          curveTipVisible: !0,
          connectGuideVisible: !0,
          connectGuideShift: [1, .25, 8, 0],
          connectGuideIntersectSize: 8,
          connectGuideGarbageIntersectsize: 25,
          connectGuideGarbageShift: [1, 1, -48, -48]
      };
      var Hi = ml.Icons = {}
        , Vi = 1e4
        , Ij = null
        , tr = ml.DefaultStyleMap.baseColor
        , Wm = "rgb(183,232,135)"
        , Uc = "rgb(255,204,153)"
        , sm = 6;
      n.Default.setImage("Icons.RectPoint", {
          width: sm,
          height: sm,
          comps: [{
              type: "rect",
              background: "rgb(247,247,247)",
              borderWidth: 1,
              borderColor: {
                  func: function() {
                      return tr
                  }
              },
              rect: [0, 0, sm, sm]
          }]
      }),
      Hi.GroupSubEntityRect = {
          comps: [{
              type: "shape",
              points: {
                  func: function() {
                      var k = Hi.GroupSubEntityRect.data;
                      if (!k)
                          return [];
                      var y = k.min
                        , B = k.max;
                      return [y.x, y.y, y.x, B.y, B.x, B.y, B.x, y.y]
                  }
              },
              segments: [1, 2, 2, 2, 5],
              background: null,
              borderWidth: 1,
              borderColor: {
                  func: function() {
                      return Hi.GroupSubEntityRect.data.isKeyOb ? tr : tr
                  }
              }
          }]
      };
      var _f = 4;
      Hi.HoverDataRect = {
          comps: [{
              type: "shape",
              points: {
                  func: function() {
                      var v = Hi.HoverDataRect.data;
                      if (!v)
                          return [];
                      var K = v.min
                        , _ = v.max
                        , F = _f;
                      return K.x -= F,
                      K.y -= F,
                      _.x += F,
                      _.y += F,
                      [K.x, K.y, K.x, _.y, _.x, _.y, _.x, K.y]
                  }
              },
              segments: [1, 2, 2, 2, 5],
              background: null,
              borderWidth: 1,
              borderColor: {
                  func: function() {
                      return Hi.HoverDataRect.data.color
                  }
              },
              borderCap: "round",
              borderPattern: [1, 4]
          }]
      },
      Hi.Line = {
          comps: [{
              type: "image",
              name: "Icons.RectPoint",
              rect: {
                  func: function() {
                      return [[Hi.Line.data.P1.x, Hi.Line.data.P1.y], sm, sm]
                  }
              }
          }, {
              type: "image",
              name: "Icons.RectPoint",
              rect: {
                  func: function() {
                      return [[Hi.Line.data.P2.x, Hi.Line.data.P2.y], sm, sm]
                  }
              }
          }]
      },
      Hi.NodeHoverGuide = {
          comps: [{
              type: "shape",
              points: {
                  func: function() {
                      return Hi.NodeHoverGuide.data
                  }
              },
              segments: [1, 2, 2, 2, 5],
              background: null,
              borderWidth: 1,
              borderColor: "#3399FF"
          }]
      },
      Hi.Rect = {
          comps: [{
              type: "shape",
              points: {
                  func: function() {
                      var r = Hi.Rect.data;
                      if (!r)
                          return [];
                      var n = r.LT
                        , b = r.LB
                        , q = r.RB
                        , o = r.RT;
                      return [n.x, n.y, b.x, b.y, q.x, q.y, o.x, o.y]
                  }
              },
              segments: [1, 2, 2, 2, 5],
              background: null,
              borderWidth: 1,
              borderColor: {
                  func: function() {
                      return tr
                  }
              }
          }, {
              type: "image",
              name: "Icons.RectPoint",
              rotation: {
                  func: function() {
                      return Hi.Rect.data.rotation
                  }
              },
              rect: {
                  func: function() {
                      return [[Hi.Rect.data.LT.x, Hi.Rect.data.LT.y], sm, sm]
                  }
              }
          }, {
              type: "image",
              name: "Icons.RectPoint",
              rotation: {
                  func: function() {
                      return Hi.Rect.data.rotation
                  }
              },
              rect: {
                  func: function() {
                      return [[Hi.Rect.data.LB.x, Hi.Rect.data.LB.y], sm, sm]
                  }
              }
          }, {
              type: "image",
              name: "Icons.RectPoint",
              rotation: {
                  func: function() {
                      return Hi.Rect.data.rotation
                  }
              },
              rect: {
                  func: function() {
                      return [[Hi.Rect.data.RB.x, Hi.Rect.data.RB.y], sm, sm]
                  }
              }
          }, {
              type: "image",
              name: "Icons.RectPoint",
              rotation: {
                  func: function() {
                      return Hi.Rect.data.rotation
                  }
              },
              rect: {
                  func: function() {
                      return [[Hi.Rect.data.RT.x, Hi.Rect.data.RT.y], sm, sm]
                  }
              }
          }, {
              type: "image",
              name: "Icons.RectPoint",
              rotation: {
                  func: function() {
                      return Hi.Rect.data.rotation
                  }
              },
              visible: {
                  func: function() {
                      return Hi.Rect.data.L ? !0 : !1
                  }
              },
              rect: {
                  func: function() {
                      return [[Hi.Rect.data.L.x, Hi.Rect.data.L.y], sm, sm]
                  }
              }
          }, {
              type: "image",
              name: "Icons.RectPoint",
              rotation: {
                  func: function() {
                      return Hi.Rect.data.rotation
                  }
              },
              visible: {
                  func: function() {
                      return Hi.Rect.data.R ? !0 : !1
                  }
              },
              rect: {
                  func: function() {
                      return [[Hi.Rect.data.R.x, Hi.Rect.data.R.y], sm, sm]
                  }
              }
          }, {
              type: "image",
              name: "Icons.RectPoint",
              rotation: {
                  func: function() {
                      return Hi.Rect.data.rotation
                  }
              },
              visible: {
                  func: function() {
                      return Hi.Rect.data.T ? !0 : !1
                  }
              },
              rect: {
                  func: function() {
                      return [[Hi.Rect.data.T.x, Hi.Rect.data.T.y], sm, sm]
                  }
              }
          }, {
              type: "image",
              name: "Icons.RectPoint",
              rotation: {
                  func: function() {
                      return Hi.Rect.data.rotation
                  }
              },
              visible: {
                  func: function() {
                      return Hi.Rect.data.B ? !0 : !1
                  }
              },
              rect: {
                  func: function() {
                      return [[Hi.Rect.data.B.x, Hi.Rect.data.B.y], sm, sm]
                  }
              }
          }]
      };
      var Eg = 16;
      n.Default.setImage("Icons.Anchor", {
          width: 12,
          height: 12,
          comps: [{
              type: "shape",
              borderWidth: 1,
              borderColor: {
                  func: function() {
                      return tr
                  }
              },
              borderCap: "round",
              shadowColor: "#1ABC9C",
              points: [.50928, 6, 11.49072, 6, 6, 6, 6, .50928, 6, 11.49072]
          }, {
              type: "circle",
              borderWidth: 1,
              borderColor: {
                  func: function() {
                      return tr
                  }
              },
              shadowColor: "#1ABC9C",
              rect: [2.84391, 2.84391, 6.53697, 6.53697]
          }]
      }),
      Hi.Anchor = {
          comps: [{
              type: "image",
              name: "Icons.Anchor",
              rect: {
                  func: function() {
                      return [[Hi.Anchor.data.POS.x, Hi.Anchor.data.POS.y], Eg, Eg]
                  }
              }
          }]
      },
      Hi.TipShiftX = 12,
      Hi.TipShiftY = 12;
      var wg = [8, 28];
      Hi.TipHelper = {
          comps: [{
              type: "roundRect",
              rect: {
                  func: function() {
                      return [Hi.TipHelper.data.helperPos.x, Hi.TipHelper.data.helperPos.y, wg[0] * Hi.TipHelper.data.size, wg[1]]
                  }
              },
              background: {
                  func: function() {
                      return Ij.getStyle("tipBackground")
                  }
              },
              opacity: .6
          }, {
              type: "text",
              text: {
                  func: function() {
                      return Hi.TipHelper.data.text
                  }
              },
              rect: {
                  func: function() {
                      return [Hi.TipHelper.data.helperPos.x, Hi.TipHelper.data.helperPos.y, wg[0] * Hi.TipHelper.data.size, wg[1]]
                  }
              },
              color: {
                  func: function() {
                      return Ij.getStyle("tipTextColor")
                  }
              },
              font: "bold 12px Arial",
              align: "center"
          }]
      };
      var cs = 7;
      Hi.ShapePoint = {
          comps: [{
              type: "circle",
              visible: {
                  func: function() {
                      return !!Hi.ShapePoint.data.dynamicVisible
                  }
              },
              rect: {
                  func: function() {
                      var N = Hi.ShapePoint.data.point
                        , t = Hi.ShapePoint.data.size || cs;
                      return [N, t + 10, t + 10]
                  }
              },
              background: {
                  func: function() {
                      var Q = Date.now()
                        , G = Hi.ShapePoint.data.dynamicPeriod || 1500
                        , h = Math.sin(Q % G / G * Math.PI);
                      return "rgba(27,124,22," + .5 * h + ")"
                  }
              },
              borderWidth: 0
          }, {
              type: "circle",
              rect: {
                  func: function() {
                      var v = Hi.ShapePoint.data.point
                        , Q = Hi.ShapePoint.data.size || cs;
                      return [v, Q, Q]
                  }
              },
              background: {
                  func: function() {
                      var k = Hi.ShapePoint.data.isEnd;
                      return k ? "rgba(27,124,222,0.7)" : "#ffffff"
                  }
              },
              borderWidth: 1,
              borderColor: {
                  func: function() {
                      return Hi.ShapePoint.data.color || tr
                  }
              }
          }, {
              type: "rect",
              visible: {
                  func: function() {
                      return !!Hi.ShapePoint.data.dynamicVisible
                  }
              },
              background: "red",
              borderWidth: 0,
              rotation: Math.PI / 4,
              borderColor: {
                  func: function() {
                      return tr
                  }
              },
              rect: {
                  func: function() {
                      var c = 5;
                      return [Hi.ShapePoint.data.point, c, c]
                  }
              }
          }]
      },
      Hi.ShapeBgCurve = {
          comps: [{
              type: "shape",
              visible: {
                  func: function() {
                      return !!Hi.ShapeBgCurve.data.dynamicVisible
                  }
              },
              points: {
                  func: function() {
                      return Hi.ShapeBgCurve.data.P
                  }
              },
              segments: {
                  func: function() {
                      return Hi.ShapeBgCurve.data.S
                  }
              },
              background: null,
              borderWidth: 6,
              borderColor: {
                  func: function() {
                      var J = Date.now()
                        , j = Hi.ShapeBgCurve.data.dynamicPeriod || 1500
                        , M = Math.sin(J % j / j * Math.PI);
                      return "rgba(27,124,22," + .3 * M + ")"
                  }
              }
          }, {
              type: "shape",
              points: {
                  func: function() {
                      return Hi.ShapeBgCurve.data.P
                  }
              },
              segments: {
                  func: function() {
                      return Hi.ShapeBgCurve.data.S
                  }
              },
              background: null,
              borderWidth: 1,
              borderColor: {
                  func: function() {
                      return Hi.ShapeBgCurve.data.color || tr
                  }
              }
          }]
      };
      var lg = 8;
      Hi.ShapeHighlighPoint = {
          comps: [{
              type: "circle",
              rect: {
                  func: function() {
                      var t = Hi.ShapeHighlighPoint.data;
                      return [[t.x, t.y], lg, lg]
                  }
              },
              background: {
                  func: function() {
                      return Ij.getStyle("shapeHighlighPointBackground")
                  }
              },
              borderWidth: 0
          }]
      };
      var gg = 10;
      Hi.ShapeHighlighRealPoint = {
          comps: [{
              type: "circle",
              rect: {
                  func: function() {
                      var W = Hi.ShapeHighlighRealPoint.data;
                      return [[W.x, W.y], gg, gg]
                  }
              },
              background: "#ffffff",
              borderWidth: 2,
              borderColor: {
                  func: function() {
                      return tr
                  }
              }
          }]
      };
      var $q = 8;
      Hi.ShapeHighlighCtrlPoint = {
          comps: [{
              type: "shape",
              points: {
                  func: function() {
                      var y = Hi.ShapeHighlighCtrlPoint.data
                        , r = y.x
                        , E = y.y
                        , o = $q / 2;
                      return [r - o, E - o, r - o, E + o, r + o, E + o, r + o, E - o]
                  }
              },
              segments: [1, 2, 2, 2, 5],
              borderWidth: 2,
              background: {
                  func: function() {
                      return Ij.getStyle("shapeCtrlPointBackground")
                  }
              },
              borderColor: {
                  func: function() {
                      return Ij.getStyle("shapeCtrlPointBorderColor") || tr
                  }
              }
          }]
      };
      var Ff = 3;
      Hi.ShapeHighlightCurve = {
          comps: [{
              type: "shape",
              points: {
                  func: function() {
                      return Hi.ShapeHighlightCurve.data
                  }
              },
              segments: [1, 4],
              background: null,
              borderWidth: Ff,
              borderColor: {
                  func: function() {
                      return Ij.getStyle("curveHighlightColor")
                  }
              }
          }]
      },
      Hi.ShapeGuideLine = {
          comps: [{
              type: "shape",
              points: {
                  func: function() {
                      return Hi.ShapeGuideLine.data
                  }
              },
              background: null,
              borderWidth: 1,
              borderColor: "rgb(255,204,153)"
          }]
      },
      Hi.MoveLineGuide = {
          comps: [{
              type: "shape",
              points: {
                  func: function() {
                      return Hi.MoveLineGuide.data.rect
                  }
              },
              background: null,
              borderWidth: 1,
              borderColor: {
                  func: function() {
                      return Hi.MoveLineGuide.data.center ? Wm : Uc
                  }
              }
          }]
      };
      var pc = 5;
      Hi.MoveLineGuideDistanceH = {
          comps: [{
              type: "shape",
              points: {
                  func: function() {
                      var c = Hi.MoveLineGuideDistanceH.data
                        , P = c.x0
                        , K = c.y0;
                      return [P, K - pc, P, K + pc]
                  }
              },
              rotation: -Math.PI / 4,
              segments: [1, 2],
              background: null,
              borderWidth: 1,
              borderColor: Uc
          }, {
              type: "shape",
              points: {
                  func: function() {
                      var p = Hi.MoveLineGuideDistanceH.data
                        , a = p.x1
                        , N = p.y1;
                      return [a, N - pc, a, N + pc]
                  }
              },
              rotation: -Math.PI / 4,
              segments: [1, 2],
              background: null,
              borderWidth: 1,
              borderColor: Uc
          }, {
              type: "text",
              text: {
                  func: function() {
                      return Math.round(Hi.MoveLineGuideDistanceH.data.dis)
                  }
              },
              rect: {
                  func: function() {
                      var T = Hi.MoveLineGuideDistanceH.data;
                      return [[(T.x0 + T.x1) / 2, T.y0 - 10], 20, 20]
                  }
              },
              color: Uc,
              font: "12px Arial",
              align: "center"
          }]
      },
      Hi.MoveLineGuideDistanceV = {
          comps: [{
              type: "shape",
              points: {
                  func: function() {
                      var k = Hi.MoveLineGuideDistanceV.data
                        , g = k.x0
                        , M = k.y0;
                      return [g - pc, M, g + pc, M]
                  }
              },
              rotation: Math.PI / 4,
              segments: [1, 2],
              background: null,
              borderWidth: 1,
              borderColor: Uc
          }, {
              type: "shape",
              points: {
                  func: function() {
                      var T = Hi.MoveLineGuideDistanceV.data
                        , a = T.x1
                        , e = T.y1;
                      return [a - pc, e, a + pc, e]
                  }
              },
              rotation: Math.PI / 4,
              segments: [1, 2],
              background: null,
              borderWidth: 1,
              borderColor: Uc
          }, {
              type: "text",
              text: {
                  func: function() {
                      return Math.round(Hi.MoveLineGuideDistanceV.data.dis)
                  }
              },
              rect: {
                  func: function() {
                      var F = Hi.MoveLineGuideDistanceV.data;
                      return [[F.x0 - 10, (F.y0 + F.y1) / 2], 20, 20]
                  }
              },
              color: Uc,
              font: "12px Arial",
              align: "center"
          }]
      },
      n.Default.setImage("Icons.EdgeElevationGuideImage", {
          width: 16,
          height: 16,
          comps: [{
              type: "oval",
              background: "rgb(255,255,255)",
              borderWidth: 1,
              borderColor: "rgb(138,138,138)",
              rect: [.5, .5, 15, 15]
          }, {
              type: "shape",
              borderWidth: 2,
              borderColor: "rgb(44,44,44)",
              borderCap: "round",
              points: [4, 8, 8, 4, 12, 8, 8, 4, 8, 13],
              segments: [1, 2, 2, 1, 2]
          }]
      }),
      Hi.EdgeElevationGuide = {
          comps: [{
              type: "image",
              name: "Icons.EdgeElevationGuideImage",
              rect: {
                  func: function() {
                      var v = Hi.EdgeElevationGuide.data
                        , d = v.x
                        , y = v.y
                        , E = Ij.getStyle("curveElevationIntersectSize")
                        , j = Ij.getStyle("curveElevationGuideShift");
                      return d += j[0],
                      y += j[1],
                      [d - E, y - E, 2 * E, 2 * E]
                  }
              }
          }]
      },
      n.Default.setImage("Icons.ConnectGuideBgImage", {
          width: 12,
          height: 12,
          comps: [{
              type: "shape",
              background: "#3399ff",
              fillRule: "evenodd",
              shadowColor: "#1ABC9C",
              rotation: 3.14159,
              points: [6.00001, 11.99999, 6.00001, 11.99999, 2.6863, 11.99999, 1e-5, 9.30695, 1e-5, 5.99999, 1e-5, 5.99999, 1e-5, 2.68628, 2.69305, -1e-5, 6.00001, -1e-5, 12.00001, -1e-5, 11.99998, 12.00001, 6.00001, 11.99999],
              segments: [1, 2, 4, 2, 4, 2, 2, 2]
          }]
      }),
      n.Default.setImage("Icons.ConnectGuideHeaderImage", {
          width: 12,
          height: 12,
          comps: [{
              type: "oval",
              background: "#3399FF",
              borderColor: "#3399FF",
              shadowColor: "#1ABC9C",
              rect: [0, 0, 12, 12]
          }, {
              type: "shape",
              borderWidth: 1,
              borderColor: "rgb(255,255,255)",
              borderCap: "round",
              shadowColor: "#1ABC9C",
              points: [4.76, 2.56, 8.2, 5.98, 4.76, 9.44]
          }]
      }),
      Hi.ConnectGuide = {
          comps: [{
              type: "image",
              name: "Icons.ConnectGuideBgImage",
              rotation: {
                  func: function() {
                      return Hi.ConnectGuide.data.rotation
                  }
              },
              rect: {
                  func: function() {
                      var E = Hi.ConnectGuide.data.connect;
                      E.x,
                      E.y;
                      var F = Ij.getStyle("connectGuideIntersectSize");
                      return [[E.x, E.y], 2 * F, 2 * F]
                  }
              }
          }, {
              type: "image",
              name: "Icons.ConnectGuideHeaderImage",
              rect: {
                  func: function() {
                      var y = Hi.ConnectGuide.data.cursorPos || Hi.ConnectGuide.data.connect
                        , n = Ij.getStyle("connectGuideIntersectSize");
                      return [[y.x, y.y], 2 * n - 2, 2 * n - 2]
                  }
              }
          }, {
              type: "shape",
              background: null,
              borderColor: "#3399ff",
              borderWidth: 2,
              segments: [1, 4],
              points: {
                  func: function() {
                      var R = Hi.ConnectGuide.data.connect
                        , Y = Hi.ConnectGuide.data.cursorPos || R;
                      return [R.x, R.y, R.x + .5 * (Y.x - R.x), R.y, Y.x + .5 * (R.x - Y.x), Y.y, Y.x, Y.y]
                  }
              }
          }]
      },
      n.Default.setImage("Icons.ConnectGuideGarbageImage", {
          width: 48,
          height: 48,
          comps: [{
              type: "oval",
              background: "rgba(0,0,0,0.1)",
              borderColor: "#979797",
              shadowColor: "#1ABC9C",
              rect: [0, 0, 48, 48]
          }, {
              type: "shape",
              borderWidth: 2,
              borderColor: "rgb(255,255,255)",
              borderCap: "round",
              shadowColor: "#1ABC9C",
              points: [19.84721, 19.69091, 19.84721, 32.25123]
          }, {
              type: "shape",
              borderWidth: 2,
              borderColor: "rgb(255,255,255)",
              borderCap: "round",
              shadowColor: "#1ABC9C",
              points: [24.10371, 19.69091, 24.10371, 32.25123]
          }, {
              type: "shape",
              borderWidth: 2,
              borderColor: "rgb(255,255,255)",
              borderCap: "round",
              shadowColor: "#1ABC9C",
              points: [28.15279, 19.69091, 28.15279, 32.25123]
          }, {
              type: "shape",
              borderWidth: 2,
              borderColor: "rgb(255,255,255)",
              borderCap: "round",
              shadowColor: "#1ABC9C",
              points: [11.23055, 15.22377, 36.76945, 15.189, 19.12302, 15.17121, 20.94722, 11.5228, 26.41985, 11.5228, 28.24406, 15.17121]
          }, {
              type: "rect",
              borderWidth: 2,
              borderColor: "rgb(255,255,255)",
              shadowColor: "#1ABC9C",
              rect: [15.48702, 15.22377, 17.02595, 21.25344]
          }]
      }),
      n.Default.setImage("Icons.ConnectGuideDeletingImage", {
          width: 56,
          height: 56,
          comps: [{
              type: "oval",
              background: "rgba(232,0,0,0.75)",
              borderColor: "#979797",
              shadowColor: "#1ABC9C",
              rect: [0, 0, 56, 56]
          }, {
              type: "shape",
              borderWidth: 2,
              borderColor: "rgb(255,255,255)",
              borderCap: "round",
              shadowColor: "#1ABC9C",
              points: [22.67939, 27.69091, 22.67939, 40.25123]
          }, {
              type: "shape",
              borderWidth: 2,
              borderColor: "rgb(255,255,255)",
              borderCap: "round",
              shadowColor: "#1ABC9C",
              points: [26.93588, 27.69091, 26.93588, 40.25123]
          }, {
              type: "shape",
              borderWidth: 2,
              borderColor: "rgb(255,255,255)",
              borderCap: "round",
              shadowColor: "#1ABC9C",
              points: [30.98497, 27.69091, 30.98497, 40.25123]
          }, {
              type: "shape",
              borderWidth: 2,
              borderColor: "rgb(255,255,255)",
              borderCap: "round",
              shadowColor: "#1ABC9C",
              anchorX: 0,
              anchorY: 1,
              rotation: 5.65062,
              points: [14.06272, 23.22377, 39.60163, 23.189, 21.9552, 23.17121, 23.7794, 19.5228, 29.25203, 19.5228, 31.07623, 23.17121]
          }, {
              type: "rect",
              borderWidth: 2,
              borderColor: "rgb(255,255,255)",
              shadowColor: "#1ABC9C",
              rect: [18.3192, 23.22377, 17.02595, 21.25344]
          }]
      }),
      Hi.ConnectGuideGarbage = {
          comps: [{
              type: "image",
              name: {
                  func: function() {
                      var Y = Hi.ConnectGuideGarbage.data.hover;
                      return Y ? "Icons.ConnectGuideDeletingImage" : "Icons.ConnectGuideGarbageImage"
                  }
              },
              rect: {
                  func: function() {
                      var M = Hi.ConnectGuideGarbage.data
                        , v = Ij.getStyle("connectGuideGarbageIntersectsize");
                      return M.hover && (v += 5),
                      [[M.x, M.y], 2 * v, 2 * v]
                  }
              }
          }]
      };
      var oc = 6;
      Hi.ShapeActivingCtrl = {
          comps: [{
              type: "shape",
              visible: {
                  func: function() {
                      return Hi.ShapeActivingCtrl.data.c1 ? !0 : !1
                  }
              },
              points: {
                  func: function() {
                      var L = Hi.ShapeActivingCtrl.data;
                      return [L.point.x, L.point.y, L.c1.x, L.c1.y]
                  }
              },
              segments: [1, 2],
              background: null,
              borderWidth: 1,
              borderColor: {
                  func: function() {
                      return tr
                  }
              }
          }, {
              type: "shape",
              visible: {
                  func: function() {
                      return Hi.ShapeActivingCtrl.data.c2 ? !0 : !1
                  }
              },
              points: {
                  func: function() {
                      var _ = Hi.ShapeActivingCtrl.data;
                      return [_.point.x, _.point.y, _.c2.x, _.c2.y]
                  }
              },
              segments: [1, 2],
              background: null,
              borderWidth: 1,
              borderColor: {
                  func: function() {
                      return tr
                  }
              }
          }, {
              type: "shape",
              visible: {
                  func: function() {
                      return Hi.ShapeActivingCtrl.data.c1 ? !0 : !1
                  }
              },
              points: {
                  func: function() {
                      var o = Hi.ShapeActivingCtrl.data.c1
                        , I = o.x
                        , Y = o.y
                        , O = oc / 2;
                      return "c1" === Hi.ShapeActivingCtrl.data.hl && (O += .5),
                      [I - O, Y - O, I - O, Y + O, I + O, Y + O, I + O, Y - O]
                  }
              },
              segments: [1, 2, 2, 2, 5],
              borderWidth: 2,
              background: {
                  func: function() {
                      return Ij.getStyle("shapeCtrlPointBackground")
                  }
              },
              borderColor: {
                  func: function() {
                      return "c1" === Hi.ShapeActivingCtrl.data.hl ? Ij.getStyle("shapeCtrlPointHighlightBorder") || tr : Ij.getStyle("shapeCtrlPointBorderColor") || tr
                  }
              }
          }, {
              type: "shape",
              visible: {
                  func: function() {
                      return Hi.ShapeActivingCtrl.data.c2 ? !0 : !1
                  }
              },
              points: {
                  func: function() {
                      var E = Hi.ShapeActivingCtrl.data.c2
                        , c = E.x
                        , o = E.y
                        , e = oc / 2;
                      return "c2" === Hi.ShapeActivingCtrl.data.hl && (e += .5),
                      [c - e, o - e, c - e, o + e, c + e, o + e, c + e, o - e]
                  }
              },
              segments: [1, 2, 2, 2, 5],
              borderWidth: 2,
              background: {
                  func: function() {
                      return Ij.getStyle("shapeCtrlPointBackground")
                  }
              },
              borderColor: {
                  func: function() {
                      return "c2" === Hi.ShapeActivingCtrl.data.hl ? Ij.getStyle("shapeCtrlPointHighlightBorder") || tr : Ij.getStyle("shapeCtrlPointBorderColor") || tr
                  }
              }
          }]
      },
      Hi.RoundPoint = {
          comps: [{
              type: "circle",
              background: "rgb(247,247,247)",
              borderWidth: 1,
              borderColor: {
                  func: function() {
                      return tr
                  }
              },
              rect: {
                  func: function() {
                      return [[Hi.RoundPoint.data.x, Hi.RoundPoint.data.y], sm, sm]
                  }
              }
          }]
      },
      Hi.AttachPoint = {
          comps: [{
              type: "rect",
              background: {
                  func: function() {
                      return Hi.AttachPoint.data.isAttach ? "rgb(51,153,255)" : "rgb(247,247,247)"
                  }
              },
              borderWidth: 1,
              rotation: Math.PI / 4,
              borderColor: {
                  func: function() {
                      return tr
                  }
              },
              rect: {
                  func: function() {
                      var x = Hi.AttachPoint.data.isAttach ? sm + 4 : sm;
                      return [[Hi.AttachPoint.data.x, Hi.AttachPoint.data.y], x, x]
                  }
              }
          }]
      },
      Hi.SimpleRect = {
          comps: [{
              type: "rect",
              background: null,
              borderWidth: {
                  func: function() {
                      return Hi.SimpleRect.data.borderWidth || 1
                  }
              },
              borderColor: {
                  func: function() {
                      return Hi.SimpleRect.data.color || tr
                  }
              },
              rect: {
                  func: function() {
                      var G = Hi.SimpleRect.data;
                      return [G.x, G.y, G.width, G.height]
                  }
              }
          }]
      },
      n.Default.setImage("Icons.MoveDummyImage", {
          width: 32,
          height: 32,
          boundExtend: 12,
          attachStyle: "close",
          comps: [{
              type: "oval",
              background: "rgb(255,255,255)",
              borderColor: "#979797",
              shadow: !0,
              shadowColor: "rgba(0,0,0,0.25)",
              shadowOffsetX: 0,
              rect: [0, 0, 32, 32]
          }, {
              type: "shape",
              background: "rgb(51,153,255)",
              pixelPerfect: !0,
              points: [8.65079, 11.90713, 9.05502, 11.46921, 9.70629, 11.46921, 10.11052, 11.90713, 10.51476, 12.28891, 10.51476, 12.92895, 10.11052, 13.34441, 8.49359, 14.97258, 12.2889, 14.97258, 12.85034, 14.97258, 13.29949, 15.42172, 13.29949, 15.99439, 13.29949, 16.57828, 12.85034, 17.0162, 12.2889, 17.0162, 8.49359, 17.0162, 10.11052, 18.6556, 10.51476, 19.0486, 10.51476, 19.7111, 10.11052, 20.09288, 9.70629, 20.50834, 9.05502, 20.50834, 8.65079, 20.09288, 5.32709, 16.76917, 5.28217, 16.71303, 4.87794, 16.32002, 4.87794, 15.67998, 5.28217, 15.26452, 8.65079, 11.90713, 8.65079, 11.90713, 8.65079, 11.90713, 13.3444, 10.09931, 13.3444, 10.09931, 12.94017, 10.50354, 12.2889, 10.50354, 11.88467, 10.09931, 11.48043, 9.69507, 11.48043, 9.0438, 11.88467, 8.63957, 15.27574, 5.25973, 15.66874, 4.86672, 16.32001, 4.86672, 16.73547, 5.25973, 16.76917, 5.31586, 20.10409, 8.63957, 20.50832, 9.0438, 20.50832, 9.68385, 20.10409, 10.09931, 19.69986, 10.49231, 19.07105, 10.50354, 18.64436, 10.09931, 17.02742, 8.45991, 17.02742, 12.26646, 17.02742, 12.83912, 16.55581, 13.31072, 15.99438, 13.31072, 15.43295, 13.31072, 14.98379, 12.83912, 14.98379, 12.26646, 14.96134, 8.45991, 13.3444, 10.09931, 13.3444, 10.09931, 13.3444, 10.09931, 21.90069, 13.33318, 21.90069, 13.33318, 21.49646, 12.91771, 21.49646, 12.27768, 21.90069, 11.89591, 22.31615, 11.45798, 22.94497, 11.45798, 23.36043, 11.89591, 26.72904, 15.2533, 27.12205, 15.66876, 27.12205, 16.3088, 26.72904, 16.7018, 26.6729, 16.75794, 23.36043, 20.08165, 22.94497, 20.49711, 22.31615, 20.49711, 21.90069, 20.08165, 21.49646, 19.69987, 21.49646, 19.03737, 21.90069, 18.64437, 23.51763, 17.00498, 19.72231, 17.00498, 19.14965, 17.00498, 18.71173, 16.56705, 18.71173, 15.98316, 18.71173, 15.41049, 19.14965, 14.96135, 19.72231, 14.96135, 23.51763, 14.96135, 21.90069, 13.33318, 21.90069, 13.33318, 21.90069, 13.33318, 11.88467, 23.32675, 11.88467, 23.32675, 11.48043, 22.94498, 11.48043, 22.27125, 11.88467, 21.88948, 12.2889, 21.48523, 12.94017, 21.48523, 13.3444, 21.88948, 14.96134, 23.52887, 14.98379, 19.7111, 14.98379, 19.14966, 15.43295, 18.67805, 15.99438, 18.67805, 16.55581, 18.67805, 17.02742, 19.14966, 17.02742, 19.7111, 17.02742, 23.52887, 18.64436, 21.88948, 19.07105, 21.48523, 19.69986, 21.48523, 20.10409, 21.88948, 20.50832, 22.27125, 20.50832, 22.94498, 20.10409, 23.32675, 16.76917, 26.65045, 16.73547, 26.72905, 16.32001, 27.13329, 15.66874, 27.13329, 15.27574, 26.72905, 11.88467, 23.32675, 11.88467, 23.32675, 11.88467, 23.32675],
              segments: [1, 4, 4, 2, 2, 4, 4, 2, 2, 4, 4, 2, 2, 4, 2, 2, 2, 1, 2, 4, 4, 2, 4, 2, 2, 4, 4, 2, 2, 4, 4, 2, 2, 2, 2, 1, 2, 4, 4, 2, 4, 2, 2, 4, 4, 2, 2, 4, 4, 2, 2, 2, 2, 1, 2, 4, 4, 2, 2, 4, 4, 2, 2, 4, 4, 2, 2, 4, 2, 2, 2]
          }]
      }),
      Hi.MoveDummy = {
          comps: [{
              type: "image",
              name: "Icons.MoveDummyImage",
              rect: {
                  func: function() {
                      var g = Hi.MoveDummy.data;
                      return [[g.pos.x, g.pos.y], 2 * g.size, 2 * g.size]
                  }
              }
          }]
      },
      ml.Icons.DrawIcon = function(C, p, k, G) {
          k.width = k.height = Vi,
          k.data = G,
          Ij = C,
          n.Default.drawImage(p, k, 0, 0, Vi, Vi)
      }
      ,
      ml.Icons.MapPoints = function(j, S) {
          for (var d = 0, h = j.length; h > d; d++)
              j[d] /= S
      }
      ,
      ml.roundTo = function(q, o, i) {
          var c = Math.abs(q % o);
          return i > c || i > o - c ? o * Math.round(q / o) : q
      }
      ,
      ml.toFixed = function(N) {
          return Math.round(100 * N) / 100
      }
      ,
      ml.getDataMatrix = function($) {
          if ($instanceof n.Shape) {
              var d = new n.Math.Matrix2d
                , W = $.getPosition();
              return d.translate(-W.x, -W.y).scale($.getScale().x, $.getScale().y).rotate($.getRotation()).translate(W.x, W.y),
              d
          }
          return $.getMatrix ? $.getMatrix() : new n.Math.Matrix2d
      }
      ;
      var Ai = ml.Math.Curve = function() {
          this._curves = []
      }
      ;
      Ai.prototype = {},
      Ai.prototype.constructor = Ai,
      Ai.prototype.createFromHtShape = function(k, z, s) {
          z instanceof n.List && (z = z.toArray());
          var l, w, h, x, t, G, r, u = this, m = null, q = null, C = 0, E = ml.Math.Vector2, R = ml.Math.CubicBezier, O = function(W) {
              return new E(k[W],k[W + 1],s ? s[W / 2] : V)
          };
          for (w = 0,
          h = z.length; h > w; w++) {
              switch (x = z[w],
              t = null,
              x) {
              case 1:
                  q = O(C),
                  m = q,
                  C += 2;
                  break;
              case 2:
                  l = O(C),
                  C += 2,
                  t = new R(q,q.clone(),l.clone(),l),
                  q = l;
                  break;
              case 3:
                  G = O(C),
                  l = O(C + 2),
                  C += 4,
                  t = new R(q,G.clone().sub(q).multiplyScalar(2 / 3).add(q),G.clone().sub(l).multiplyScalar(2 / 3).add(l),l),
                  q = l;
                  break;
              case 4:
                  G = O(C),
                  r = O(C + 2),
                  l = O(C + 4),
                  C += 6,
                  t = new R(q,G,r,l),
                  q = l;
                  break;
              case 5:
                  if (!m)
                      break;
                  t = new R(q,q.clone(),m.clone(),m),
                  q = null,
                  m = null
              }
              t && (t._index = u._curves.length,
              u._curves.push(t))
          }
      }
      ,
      Ai.prototype.checkPoint = function(k, c) {
          var L, m, K, z, R, g = this, $ = g._curves;
          for (L = 0,
          m = $.length; m > L; L++)
              if (z = $[L],
              R = z.intersectRect(k, c, c),
              R.length)
                  return K = 0,
                  R.forEach(function(R) {
                      K += R.t
                  }),
                  K /= R.length,
                  k = z.getPointAt(K),
                  k.t = K,
                  {
                      bezier: z,
                      intersection: k
                  }
      }
      ,
      Ai.prototype.insertKnot = function(N, y) {
          var t = N.insertKnot(y)
            , n = this
            , x = n._curves;
          x.splice(N._index, 1, t[0], t[1])
      }
      ,
      Ai.prototype._isCloseEnough = function(U, a) {
          return Math.abs(U.x - a.x) < 1e-6 && Math.abs(U.y - a.y) < 1e-6
      }
      ,
      Ai.prototype._isSamePoint = function(S, Y) {
          return S === Y
      }
      ,
      Ai.prototype.moveRealPoint = function(y, h) {
          var O = this
            , I = O._curves
            , e = h.clone().sub(y);
          I.forEach(function(k) {
              var L = k._p1;
              k._p2,
              k._p3;
              var d = k._p4;
              O._isSamePoint(L, y) && (k._p2.add(e),
              k._p1 = h),
              O._isSamePoint(d, y) && (k._p3.add(e),
              k._p4 = h)
          })
      }
      ,
      Ai.prototype.moveCtrlDueToRealPointMovement = function(p, e) {
          var n = this
            , O = n._curves
            , $ = function(U) {
              U.add(e),
              U.e && e.e && (U.e += e.e)
          };
          O.forEach(function(B) {
              var R = B._p1;
              B._p2,
              B._p3;
              var U = B._p4;
              n._isSamePoint(R, p) && $(B._p2),
              n._isSamePoint(U, p) && $(B._p3)
          })
      }
      ,
      Ai.prototype.moveCtrlPoint = function(b, S, e) {
          var l = b[e];
          if (l) {
              l.e !== V && (S.e = l.e);
              var J = this
                , u = J._curves;
              S.clone().sub(l),
              u.forEach(function(d) {
                  var E;
                  "c2" === e ? E = "_p2" : "c1" === e && (E = "_p3"),
                  J._isSamePoint(d[E], l) && (d[E] = S)
              }),
              b[e] = S
          }
      }
      ,
      Ai.prototype.deleteRealPoint = function(o, J) {
          var L, N, A, d, E, D, M, x = this, H = x._curves, q = {}, e = [], r = ml.Math.CubicBezier;
          for (N = 0,
          A = H.length; A > N; N++)
              L = H[N],
              d = L._p1,
              E = L._p2,
              D = L._p3,
              M = L._p4,
              (q[N] || !x._isSamePoint(d, o)) && (x._isSamePoint(M, o) ? A > N + 1 && x._isSamePoint(H[N + 1]._p1, o) && (J || e.push(new r(d,E,H[N + 1]._p3,H[N + 1]._p4))) : e.push(L));
          x._curves = e
      }
      ,
      Ai.prototype.findPairs = function(n, W) {
          var K, c, F, N, w, I, E, r, d = this, b = d._curves, a = {}, U = [];
          for (c = 0,
          F = b.length; F > c; c++)
              K = b[c],
              N = K._p1,
              w = K._p2,
              I = K._p3,
              E = K._p4,
              !a[c] && d._isSamePoint(N, n) && (W ? U.push({
                  point: N,
                  r2: E
              }) : U.push({
                  point: N,
                  c2: w
              })),
              d._isSamePoint(E, n) && (r = W ? {
                  point: E,
                  r1: N
              } : {
                  point: E,
                  c1: I
              },
              F > c + 1 && d._isSamePoint(b[c + 1]._p1, n) && (W ? r.r2 = b[c + 1]._p4 : r.c2 = b[c + 1]._p2,
              a[c + 1] = !0),
              U.push(r));
          return U
      }
      ,
      Ai.prototype.toHtShape = function() {
          var H = this
            , $ = H._curves
            , d = []
            , k = []
            , _ = {
              x: 1 / 0,
              y: 1 / 0
          };
          return $.forEach(function($) {
              var V = $._p1
                , I = $._p2
                , q = $._p3
                , g = $._p4;
              return H._isCloseEnough(V, _) || (d.push(1),
              k.push(V.clone())),
              _ = g,
              H._isCloseEnough(V, I) && H._isCloseEnough(q, g) ? (d.push(2),
              k.push(g.clone()),
              void 0) : (d.push(4),
              k.push(I.clone(), q.clone(), g.clone()),
              void 0)
          }),
          {
              segments: d,
              points: k
          }
      }
      ;
      var hd = ml.Math.CubicBezier = function(c, w, R, T) {
          var q = this;
          q._id = ml.Math.CubicBezier._globalId++,
          q._p1 = c,
          q._p2 = w,
          q._p3 = R,
          q._p4 = T
      }
      ;
      hd._globalId = 1,
      hd.prototype = {},
      hd.prototype.constructor = hd,
      hd.prototype.toString = function() {
          return this._id
      }
      ,
      hd.prototype.intersectRect = function(c, V, W) {
          var r = V / 2
            , k = W / 2
            , f = c.x
            , T = c.y
            , Y = ml.Math.Vector2
            , v = new Y(-r + f,-k + T)
            , N = new Y(r + f,k + T)
            , i = new Y(N.x,v.y)
            , x = new Y(v.x,N.y)
            , H = this
            , a = H.intersectLine(v, i)
            , R = H.intersectLine(i, N)
            , B = H.intersectLine(N, x)
            , O = H.intersectLine(x, v)
            , w = a.concat(R).concat(B).concat(O);
          return w
      }
      ,
      hd.prototype.intersectLine = function(K, e) {
          var x, d, r, b, i, z, L, C, l, v, $, j, B, Z = this, q = K.clone().min(e), E = K.clone().max(e);
          b = Z._p1,
          i = Z._p2,
          z = Z._p3,
          L = Z._p4,
          x = b.clone().multiplyScalar(-1),
          d = i.clone().multiplyScalar(3),
          r = z.clone().multiplyScalar(-3),
          $ = x.add(d).add(r).add(L),
          x = b.clone().multiplyScalar(3),
          d = i.clone().multiplyScalar(-6),
          r = z.clone().multiplyScalar(3),
          v = x.add(d).add(r),
          x = b.clone().multiplyScalar(-3),
          d = i.clone().multiplyScalar(3),
          l = x.add(d),
          C = b.clone(),
          B = new ml.Math.Vector2(K.y - e.y,e.x - K.x),
          j = K.x * e.y - e.x * K.y;
          for (var P = Z.getRoots(B.dot($), B.dot(v), B.dot(l), B.dot(C) + j), R = new Array, n = 0, X = P.length; X > n; n++) {
              var U = P[n];
              if (!(0 > U || U > 1)) {
                  var O = Z.getPointAt(U);
                  O.t = U,
                  K.x == e.x ? q.y <= O.y && O.y <= E.y && R.push(O) : K.y == e.y ? q.x <= O.x && O.x <= E.x && R.push(O) : O.x >= q.x && O.y >= q.y && O.x <= E.x && O.y <= E.y && R.push(O)
              }
          }
          return R
      }
      ,
      hd.prototype.solveTForPoint = function(F) {
          var K, A, U, Y, h = this;
          K = h._p1.x - F.x,
          A = h._p2.x - F.x,
          U = h._p3.x - F.x,
          Y = h._p4.x - F.x;
          for (var E = h.getRoots(Y - 3 * U + 3 * A - K, 3 * U - 6 * A + 3 * K, 3 * A - 3 * K, K), w = V, f = 1 / 0, T = 0, C = E.length; C > T; T++) {
              var Q = E[T];
              if (!(0 > Q || Q > 1)) {
                  var J = h.getPointAt(Q);
                  J.t = Q;
                  var L = Math.abs(J.y - F.y);
                  f > L && (f = L,
                  w = J)
              }
          }
          return w
      }
      ,
      hd.prototype.getPointAt = function($) {
          var J = this
            , R = J._p1
            , h = J._p2
            , P = J._p3
            , H = J._p4
            , Q = R.clone().lerp(h, $)
            , g = h.clone().lerp(P, $)
            , C = P.clone().lerp(H, $)
            , W = Q.lerp(g, $)
            , o = g.lerp(C, $);
          return W.lerp(o, $)
      }
      ,
      hd.prototype.getPointByPercentage = function(K) {
          var c = this.length * K
            , I = this._cacheLength
            , n = I.length;
          if (0 === c)
              return I[0].point;
          if (K >= 1)
              return I[n - 1].point;
          for (var Y = 0; n > Y; Y++) {
              var U = I[Y];
              if (!(U.len < c)) {
                  var o = I[Y - 1];
                  return U.point.clone().sub(o.point).setLength(c - o.len).add(o.point)
              }
          }
      }
      ,
      hd.prototype.getTByPercentage = function(U) {
          var P = this.length * U
            , p = this._cacheLength
            , v = p.length;
          if (0 === P || 0 >= U)
              return p[0].t;
          if (U >= 1)
              return p[v - 1].t;
          for (var e = 0; v > e; e++) {
              var s = p[e];
              if (!(s.len < P)) {
                  var Z = p[e - 1];
                  return (P - Z.len) / (s.len - Z.len) * (s.t - Z.t) + Z.t
              }
          }
      }
      ,
      hd.prototype.getRoots = function(b, i, v, u) {
          var C, z, f, n, S, B = new Array;
          if (Math.abs(b) < 1e-6) {
              var C = i
                , z = v / C
                , f = u / C
                , n = z * z - 4 * f;
              if (n > 0) {
                  var S = Math.sqrt(n);
                  B.push(.5 * (-z + S)),
                  B.push(.5 * (-z - S))
              } else
                  0 == n && B.push(.5 * -z)
          }
          i /= b,
          v /= b,
          u /= b,
          C = (3 * v - i * i) / 3,
          z = (2 * i * i * i - 9 * v * i + 27 * u) / 27;
          var _ = i / 3
            , I = z * z / 4 + C * C * C / 27
            , N = z / 2;
          if (Math.abs(I) <= 1e-6 && (I = 0),
          I > 0) {
              var P, M, S = Math.sqrt(I);
              P = -N + S,
              M = P >= 0 ? Math.pow(P, 1 / 3) : -Math.pow(-P, 1 / 3),
              P = -N - S,
              P >= 0 ? M += Math.pow(P, 1 / 3) : M -= Math.pow(-P, 1 / 3),
              B.push(M - _)
          } else if (0 > I) {
              var Z = Math.sqrt(-C / 3)
                , y = Math.atan2(Math.sqrt(-I), -N) / 3
                , E = Math.cos(y)
                , c = Math.sin(y)
                , V = Math.sqrt(3);
              B.push(2 * Z * E - _),
              B.push(-Z * (E + V * c) - _),
              B.push(-Z * (E - V * c) - _)
          } else {
              var P;
              P = N >= 0 ? -Math.pow(N, 1 / 3) : Math.pow(-N, 1 / 3),
              B.push(2 * P - _),
              B.push(-P - _)
          }
          return B
      }
      ,
      hd.prototype._70I = function() {
          var A = this;
          return A._p1.distanceToSquared(A._p2) < 1e-10 && A._p3.distanceToSquared(A._p4) < 1e-10
      }
      ,
      hd.prototype.insertKnot = function(n) {
          var z = this
            , d = z._p1
            , T = z._p2
            , i = z._p3
            , B = z._p4
            , j = d.clone().lerp(T, n)
            , M = T.clone().lerp(i, n)
            , N = i.clone().lerp(B, n)
            , Q = j.clone().lerp(M, n)
            , v = M.clone().lerp(N, n)
            , w = Q.clone().lerp(v, n);
          return z._70I() ? (d.clone().lerp(B, n),
          [new ml.Math.CubicBezier(d,d.clone(),w.clone(),w), new ml.Math.CubicBezier(w,w.clone(),B.clone(),B)]) : [new ml.Math.CubicBezier(d,j,Q,w), new ml.Math.CubicBezier(w,v,N,B)]
      }
      ,
      G.defineProperties(hd.prototype, {
          length: {
              get: function() {
                  var $ = this._cacheLength;
                  if (!$) {
                      $ = this._cacheLength = [];
                      for (var u = this._p1, E = 0, G = 0; 1 >= E; ) {
                          var f = this.getPointAt(E += .001);
                          G += f.clone().sub(u).length(),
                          u = f,
                          $.push({
                              len: G,
                              t: E,
                              point: f.clone()
                          })
                      }
                  }
                  return $[$.length - 1].len
              }
          },
          p1: {
              get: function() {
                  return this._p1
              },
              set: function(v) {
                  this._p1 = v,
                  this._cacheLength = V
              }
          },
          p2: {
              get: function() {
                  return this._p2
              },
              set: function(H) {
                  this._p2 = H,
                  this._cacheLength = V
              }
          },
          p3: {
              get: function() {
                  return this._p3
              },
              set: function(J) {
                  this._p3 = J,
                  this._cacheLength = V
              }
          },
          p4: {
              get: function() {
                  return this._p4
              },
              set: function(h) {
                  this._p4 = h,
                  this._cacheLength = V
              }
          }
      });
      var Mm = n.Default.getInternal().ui().EdgeUI
        , Zm = {
          _47O: function(F) {
              var P = this
                , O = Zm.getBackups()._47O;
              ml.inEdit(P.gv) || O.call(P, F)
          }
      };
      ml.Inject.registAsModule(Zm, Mm);
      var Zd = n.Default.getInternal().ui().NodeUI
        , Hj = {
          _47O: function(m) {
              var f = this
                , x = Hj.getBackups()._47O;
              ml.inEdit(f.gv) || x.call(f, m)
          },
          getSelectWidth: function() {
              var n = this
                , O = n.gv
                , F = n._data;
              if (O.isEditable(F) && ml.inEdit(O))
                  return 0;
              var T = Hj.getBackup("getSelectWidth");
              return T.call(n)
          }
      };
      ml.Inject.registAsModule(Hj, Zd);
      var yj = n.graph.GraphView
        , qo = {
          _editPointSize: function() {
              var V = n.Default.isTouchable
                , K = ml.getStyle("pointSize");
              return K[V ? 0 : 1]
          }(),
          isPointEditable: function(p) {
              var w = this;
              if (ml.inEdit(w))
                  return w._pointEditableFunc ? w._pointEditableFunc(p) : !0;
              var u = qo.getBackup("isPointEditable");
              u.call(w, p)
          },
          isEditable: function(C) {
              var v, X = this, t = qo.getBackup("isEditable");
              if (v = C instanceof ml.Group ? !0 : t.call(X, C),
              !ml.inEdit(X))
                  return v;
              if (!(C instanceof n.Edge))
                  return v;
              if (!C.s("2d.editable"))
                  return !1;
              var F = X.getEditableFunc();
              return F ? F(C) : !0
          },
          _42: function(u, J) {
              var y = this
                , D = qo.getBackups()._42;
              if (D.call(y, u, J),
              ml.inEdit(y)) {
                  var P = y.getEditInteractor();
                  P.drawImpl()
              }
          }
      };
      ml.Inject.registAsModule(qo, yj);
      var Ro = n.Default.getInternal().ui().ShapeUI
        , Gg = {
          _47O: function(u) {
              var L = this
                , l = Gg.getBackups()._47O;
              ml.inEdit(L.gv) || l.call(L, u)
          }
      };
      ml.Inject.registAsModule(Gg, Ro);
      var Sj = n.graph.DefaultInteractor
        , lo = {
          handle_mousewheel: function(_) {
              var A = this
                , g = lo.getBackup("handle_mousewheel");
              ml.inEdit(A.gv) || g.call(A, _)
          }
      };
      ml.Inject.registAsModule(lo, Sj);
      var Hb = n.graph.MoveInteractor
        , hr = {
          _calcShift: function(t, U) {
              var z = this
                , i = hr.getBackup("_calcShift")
                , T = z.gv;
              if (!ml.inEdit(T))
                  return i.call(z, t, U);
              var R = T.getEditInteractor()
                , d = R.getSubModule("Move").calcShift(t, U, z);
              return d || i.call(z, t, U)
          },
          clear: function(O) {
              var V = this
                , d = hr.getBackup("clear");
              d.call(V, O);
              var a = V.gv;
              if (ml.inEdit(a)) {
                  var g = a.getEditInteractor();
                  g.getSubModule("Move").clear(O)
              }
          }
      };
      ml.Inject.registAsModule(hr, Hb);
      var cj = ml.Rect = function(l) {
          this.catalog = "Rect",
          this._interactor = l
      }
      ;
      cj.prototype = {},
      cj.prototype.constructor = cj,
      cj.prototype.gatherInfo = function(J, G) {
          var O = this;
          if (1 === G.length) {
              var c = G[0];
              return c instanceof n.Shape && c._70I() ? O.gatherLine(J, c) : dn(c, J) ? !1 : O.gatherSingleTarget(J, c)
          }
          return G.length > 1 ? O.gatherMultiTargets(J, G) : !1
      }
      ,
      cj.prototype.gatherSingleTarget = function(P, e) {
          if (e.getCorners) {
              var g, l = this, K = l.info;
              l.target = e,
              g = l.screenInfo = {};
              var d = e.getCorners();
              K.LT = new ml.Math.Vector2(d[0]),
              K.LB = new ml.Math.Vector2(d[1]),
              K.RB = new ml.Math.Vector2(d[2]),
              K.RT = new ml.Math.Vector2(d[3]),
              K.T = K.LT.clone().add(K.RT).divideScalar(2),
              K.B = K.LB.clone().add(K.RB).divideScalar(2),
              K.L = K.LT.clone().add(K.LB).divideScalar(2),
              K.R = K.RT.clone().add(K.RB).divideScalar(2);
              for (var n in K)
                  g[n] = ml.toScreenPosition(P, K[n]);
              var D = l._interactor
                , W = D.getStyle("checkSize")
                , s = function(A, O, k) {
                  var h = O.clone().sub(A).setLength(-W)
                    , B = k.clone().sub(A).setLength(-W)
                    , C = h.add(B).add(A);
                  return C
              };
              return g.rotLT = s(g.LT, g.RT, g.LB),
              g.rotLB = s(g.LB, g.LT, g.RB),
              g.rotRB = s(g.RB, g.LB, g.RT),
              g.rotRT = s(g.RT, g.LT, g.RB),
              g.rotT = g.rotLT.clone().add(g.rotRT).divideScalar(2),
              g.rotB = g.rotLB.clone().add(g.rotRB).divideScalar(2),
              g.rotL = g.rotLT.clone().add(g.rotLB).divideScalar(2),
              g.rotR = g.rotRT.clone().add(g.rotRB).divideScalar(2),
              g.rotation = e.getRotation(),
              l.gatherConnectInfo(),
              !0
          }
      }
      ,
      cj.prototype.gatherConnectInfo = function() {
          var a = this
            , f = a.target
            , V = a._interactor
            , J = a.screenInfo
            , i = V.gv;
          if (i.isConnectActionVisible(f) && V.getStyle("connectGuideVisible")) {
              var T;
              f.s && (T = f.s("connectGuideShift")),
              T || (T = V.getStyle("connectGuideShift"));
              var P = f.getAnchor()
                , j = f.getSize()
                , S = f.toGlobal({
                  x: j.width * (T[0] - P.x),
                  y: j.height * (T[1] - P.y)
              });
              S = ml.toScreenPosition(i, S),
              J.P1 ? S.add(J.P2.clone().sub(J.P1).setLength(T[2])) : (S.add(J.RT.clone().sub(J.LT).setLength(T[2])),
              S.add(J.LB.clone().sub(J.LT).setLength(T[3]))),
              J.connect = S
          }
      }
      ,
      cj.prototype.gatherMultiTargets = function(X, H) {
          var Z = ml.Group.findOrCreateGroup(H);
          if (!Z)
              return !1;
          var I = this;
          return I.editing && "rotate" !== I.editing.mode || Z.calcInfo(),
          I.gatherSingleTarget(X, Z)
      }
      ,
      cj.prototype.gatherLine = function(U, i) {
          this.target = i;
          var y = this.screenInfo = {}
            , R = i.getPoints()
            , Z = ml.getDataMatrix(i);
          return y.P1 = ml.toScreenPosition(U, Z.apply(R.get(0))),
          y.P2 = ml.toScreenPosition(U, Z.apply(R.get(1))),
          this.gatherConnectInfo(),
          !0
      }
      ,
      cj.ResizeKeys = ["LT", "RB", "LB", "RT", "L", "R", "B", "T"],
      cj.ResizeDirection = [{
          x: -1,
          y: -1
      }, {
          x: 1,
          y: 1
      }, {
          x: -1,
          y: 1
      }, {
          x: 1,
          y: -1
      }, {
          x: -1,
          y: 0
      }, {
          x: 1,
          y: 0
      }, {
          x: 0,
          y: 1
      }, {
          x: 0,
          y: -1
      }],
      cj.RotateKeys = ["rotLT", "rotRB", "rotLB", "rotRT", "rotL", "rotR", "rotB", "rotT"],
      cj.prototype.check = function(Y, B, t) {
          if (n.Default.isLeftButton(B)) {
              var z = this;
              if (z.editing = null,
              z.tipInfo = null,
              z.screenInfo) {
                  var X = z.target
                    , b = Y.isEditable(X)
                    , W = z.screenInfo;
                  if (b && W.connect) {
                      var u = z._checkConnect(t);
                      if (u)
                          return u
                  }
                  if (W.P1)
                      return z._checkLine(t);
                  var _, f, k, M = null, P = z._interactor, H = P.getStyle("checkSize");
                  if (b && Y.isRectEditable(X))
                      for (f = 0; f < ml.Rect.ResizeKeys.length; f++)
                          if (k = ml.Rect.ResizeKeys[f],
                          ml.checkHit(t, W[k], H)) {
                              M = k,
                              _ = "resize";
                              break
                          }
                  if (!M && b && Y.isRotationEditable(X) && !P.getStyle("rotateAsClock")) {
                      var c = P.getStyle("rotateCheckSize");
                      for (f = 0; f < ml.Rect.RotateKeys.length; f++)
                          if (k = ml.Rect.RotateKeys[f],
                          ml.checkHit(t, W[k], c)) {
                              M = k,
                              _ = "rotate";
                              break
                          }
                  }
                  if (!M)
                      return P.setCursor("default"),
                      void 0;
                  if ("rotate" === _) {
                      var p, S = Y.lp(B);
                      if (X instanceof ml.Group) {
                          var D = P.getStyle("groupRotateModeKey");
                          "string" == typeof D && (D = [D]);
                          for (var v = !1, Q = 0, m = D.length; m > Q; Q++)
                              if (B[D[Q]]) {
                                  v = !0;
                                  break
                              }
                          var h = P.getStyle("groupRotateModeDefault");
                          p = v ? "batch" === h ? "block" : "batch" : h
                      }
                      var a = "batch" === p ? X.getAnchor2() : X.getPosition()
                        , e = Math.atan2(S.y - a.y, S.x - a.x);
                      P._setRotateCursor(e),
                      z.editing = {
                          mode: _,
                          key: M,
                          pos: a,
                          flipY: X.getScale().y < 0,
                          rotation: X.getRotation(),
                          hitRot: e
                      },
                      p && (z.editing.groupRotateMode = p)
                  } else {
                      var q = ml.Rect.ResizeKeys.indexOf(M)
                        , O = ml.Rect.ResizeDirection[q]
                        , A = Math.cos(X.getRotation())
                        , V = Math.sin(X.getRotation())
                        , N = O.x * Math.sign(X.getScale().x)
                        , T = O.y * Math.sign(X.getScale().y)
                        , r = Math.atan2(-V * N - A * T, A * N - V * T)
                        , y = (Math.round(r / (Math.PI / 4)) + 8) % 8
                        , I = ["ew-resize", "nesw-resize", "ns-resize", "nwse-resize", "ew-resize", "nesw-resize", "ns-resize", "nwse-resize"][y];
                      this._interactor.setCursor(I);
                      var K = X.getWidth()
                        , w = X.getHeight()
                        , l = X.getAnchor();
                      z.editing = {
                          mode: _,
                          key: M,
                          rect: {
                              x: -K * l.x,
                              y: -w * l.y,
                              width: K,
                              height: w
                          },
                          anchor: l,
                          matrix: X.getMatrix()
                      }
                  }
                  return M
              }
          }
      }
      ,
      cj.prototype._checkLine = function(i) {
          var b = this;
          b.screenInfo;
          var L, h = b._interactor.getStyle("checkSize");
          if (ml.checkHit(i, b.screenInfo.P1, h))
              L = "P1";
          else {
              if (!ml.checkHit(i, b.screenInfo.P2, h))
                  return this._interactor.setCursor("default"),
                  void 0;
              L = "P2"
          }
          return b.editing = {
              mode: "line",
              key: L
          },
          L
      }
      ,
      cj.prototype._checkConnect = function($) {
          var i = this
            , z = i.screenInfo
            , C = i._interactor
            , I = C.getStyle("connectGuideIntersectSize")
            , Z = z.connect
            , O = $.x
            , w = Z.x;
          if (w > O && I > w - O && Math.abs(Z.y - $.y) < I || O >= w && ml.checkHit($, Z, I)) {
              var N = "connect"
                , X = M.getConnectAction(C.gv);
              if (i.editing = {
                  mode: N
              },
              X && X.delete)
                  if (i.target instanceof ml.Group) {
                      var a = !0;
                      C.gv.sm().getSelection().each(function(G) {
                          X.delete.visible.call(null, C.gv, G) || (a = !1)
                      }),
                      i.editing.hasDeleteAction = a
                  } else
                      X.delete.visible.call(null, C.gv, i.target) && (i.editing.hasDeleteAction = !0);
              return C.setCursor("default"),
              N
          }
      }
      ,
      cj.prototype._fireEditEvent = function(i, N) {
          var p = this._interactor
            , o = this.editing;
          if (o) {
              var O = o.mode;
              O = "rotate" === O ? "Rotation" : "connect" === O ? "Connection" : "resize" === O ? "Rect" : O[0].toUpperCase() + O.slice(1),
              p.fi({
                  kind: i + "Edit" + O,
                  event: N
              })
          }
      }
      ,
      cj.prototype.startEdit = function(b, S) {
          b.startDragging(S);
          var N = this;
          N._interactor.fi({
              kind: "prepareEdit",
              event: S
          });
          var y = N.editing
            , t = N.target;
          if (y) {
              if (N._fireEditEvent("begin", S),
              "rotate" === y.mode)
                  return y.groupRotateMode && t.beginRotate(y),
                  void 0;
              if ("connect" !== y.mode)
                  ("line" === y.mode || t && 0 === t.getRotation()) && (N._inSmartGuide = !0,
                  N._interactor.rectGuide.gatherRects());
              else if (y.hasDeleteAction) {
                  var p = b.gv
                    , k = N._interactor.getStyle("connectGuideGarbageShift");
                  y.garbageInfo = {
                      x: p.getWidth() * k[0] + k[2],
                      y: p.getHeight() * k[1] + k[3],
                      size: N._interactor.getStyle("connectGuideGarbageIntersectsize")
                  },
                  b._42()
              }
          }
      }
      ,
      cj.prototype._46O = function(o) {
          var b, w, U = this, j = U.editing, F = U.target;
          if (j) {
              if ("connect" === j.mode && !j.canceled && !j.deleted)
                  try {
                      j.garbageInfo && j.garbageInfo.hover ? M.doDeleteConnectionAction(U._interactor.gv, F) : M.doConnectAction(U._interactor.gv, F, j.target)
                  } catch (q) {
                      console.error(q)
                  }
              w = j.freezeFlag,
              b = U.editing.groupRotateMode,
              U._fireEditEvent("end", o),
              U.editing = null
          }
          U.tipInfo = null,
          U._inSmartGuide && (U._interactor.rectGuide.clear(),
          U._inSmartGuide = !1),
          b && F && F.endRotate(),
          F instanceof n.Block && (w === V ? delete F._freezeSyncFromChildren : F._freezeSyncFromChildren = w,
          F.updateFromChildren())
      }
      ,
      cj.prototype.handleNormalStateDelete = function() {
          var c = this
            , Q = c.editing;
          if (Q && "connect" === Q.mode && !Q.canceled && !Q.deleted) {
              if (Q.garbageInfo) {
                  try {
                      M.doDeleteConnectionAction(c._interactor.gv, c.target)
                  } catch (h) {
                      console.error(h)
                  }
                  Q.garbageInfo = null
              }
              return Q.cursorPos = null,
              Q.targetCorners = null,
              Q.deleted = !0,
              c._interactor._42(),
              !0
          }
      }
      ,
      cj.prototype.handleNormalStateKeyDown = function(A) {
          var Y = this
            , o = Y.editing;
          return !o || "connect" !== o.mode || o.canceled || o.deleted ? void 0 : n.Default.isEsc(A) ? (o.cursorPos = null,
          o.targetCorners = null,
          o.canceled = !0,
          Y._interactor._42(),
          !0) : void 0
      }
      ,
      cj.prototype.handleEdit = function(z, Y) {
          var S = this
            , q = S.editing;
          if (q) {
              var C, F, E, i, d, t = S.target, m = q.key, N = q.mode, p = z.lp(Y), W = S._interactor;
              if ("connect" === N) {
                  if (q.canceled)
                      return;
                  if (q.deleted)
                      return;
                  q.cursorPos = W._getLogicalPoint(Y);
                  var Q = q.garbageInfo;
                  return Q && ml.checkHit(q.cursorPos, Q, Q.size) ? (Q.hover = !0,
                  q.target = null,
                  q.targetCorners = null) : (Q && (Q.hover = !1),
                  q.target = z.getDataAt(p, function(T) {
                      return z.isSelectable(T) ? ud(T) ? !0 : !1 : !1
                  }) || null,
                  q.targetCorners = ml.getTargetCornersOnScreen(z, q.target)),
                  W._42(),
                  void 0
              }
              if ("rotate" === N) {
                  var r, T, L = q.pos, O = Math.atan2(p.y - L.y, p.x - L.x);
                  if (q.groupRotateMode ? T = O - q.hitRot : (r = O - q.hitRot,
                  T = q.rotation + r),
                  T %= 2 * Math.PI,
                  0 > T && (T += 2 * Math.PI),
                  !n.Default.isCtrlDown(Y)) {
                      var l, w;
                      Oh(Y) ? (l = W.getStyle("shiftRotateRound"),
                      w = l / 2) : (l = W.getStyle("rotateRound"),
                      w = W.getStyle("rotateSensitivity")),
                      T = ml.roundTo(T, l, w)
                  }
                  q.groupRotateMode ? (r = T - (q.lastRotation || 0),
                  0 !== r && (t.addRotation(r, q.groupRotateMode, function(k) {
                      return z.isRotationEditable(k)
                  }),
                  q.lastRotation = T)) : t.setRotation(T),
                  W._setRotateCursor(O),
                  T > Math.PI && (T -= 2 * Math.PI);
                  var K = 180 * (T / Math.PI);
                  K = K.toFixed(2),
                  C = "" + K + "°"
              } else if ("resize" === N) {
                  var g = q.rect;
                  E = g.x,
                  i = g.y;
                  var j, D = g.width, A = g.height, B = q.anchor, R = q.matrix, U = t.s && t.s("keepAspectRatio") || W.getStyle("keepAspectRatio");
                  Oh(Y) && (U = !U);
                  var G = S._unionPointMode1
                    , $ = S._unionPointMode2;
                  if (S._inSmartGuide && !n.Default.isCtrlDown(Y) && !U) {
                      var V;
                      "L" === m || "R" === m ? V = "x" : ("T" === m || "B" === m) && (V = "y"),
                      S._adsorbedToClosest(p, V),
                      d = !0
                  }
                  j = R.tfi(p);
                  var s;
                  "LT" === m ? (g = G(j, {
                      x: E + D,
                      y: i + A
                  }, D, A, U),
                  s = 9) : "T" === m ? (g = $({
                      x: E,
                      y: j.y
                  }, {
                      x: E + D,
                      y: i + A
                  }, D, A, U, "v"),
                  s = 1) : "RT" === m ? (g = G(j, {
                      x: E,
                      y: i + A
                  }, D, A, U),
                  s = 33) : "L" === m ? (g = $({
                      x: j.x,
                      y: i
                  }, {
                      x: E + D,
                      y: i + A
                  }, D, A, U, "h"),
                  s = 8) : "R" === m ? (g = $({
                      x: E,
                      y: i
                  }, {
                      x: j.x,
                      y: i + A
                  }, D, A, U, "h"),
                  s = 32) : "LB" === m ? (g = G(j, {
                      x: E + D,
                      y: i
                  }, D, A, U),
                  s = 12) : "B" === m ? (g = $({
                      x: E,
                      y: i
                  }, {
                      x: E + D,
                      y: j.y
                  }, D, A, U, "v"),
                  s = 4) : "RB" === m && (g = G(j, {
                      x: E,
                      y: i
                  }, D, A, U),
                  s = 36);
                  var y = R.tf(g.x + g.width * B.x, g.y + g.height * B.y);
                  t instanceof n.Block && (q.hasOwnProperty("freezeFlag") || (q.freezeFlag = t._freezeSyncFromChildren,
                  t._freezeSyncFromChildren = !0)),
                  t.setPosition(y),
                  t.setSize(g.width, g.height),
                  d && (F = t.getRect(),
                  W.rectGuide.gatherLines({
                      node: t,
                      x: F.x,
                      y: F.y,
                      w: F.width,
                      h: F.height
                  }, V, s)),
                  C = "" + Math.round(g.width) + " * " + Math.round(g.height)
              } else if ("line" === N) {
                  if (Oh(Y)) {
                      var v = t.getPoints()
                        , c = "P1" === m ? v.get(1) : v.get(0)
                        , I = {
                          x: p.x - c.x,
                          y: p.y - c.y
                      }
                        , f = W.getStyle("shiftLineRotateRound")
                        , X = S._shiftDirList;
                      if (!X || S._shiftRotateRound !== f) {
                          S._shiftRotateRound = f,
                          S._shiftDirList = X = [];
                          for (var Z = 0; Z < Math.PI; Z += f)
                              X.push({
                                  x: o(Z),
                                  y: P(Z)
                              })
                      }
                      for (var x, u = 0, b = 0, H = X.length; H > b; b++) {
                          var h = X[b]
                            , J = h.x * I.x + h.y * I.y;
                          Math.abs(J) > Math.abs(u) && (u = J,
                          x = h)
                      }
                      p = {
                          x: c.x + x.x * u,
                          y: c.y + x.y * u
                      },
                      W.rectGuide.clear()
                  } else
                      S._inSmartGuide && !n.Default.isCtrlDown(Y) && (S._adsorbedToClosest(p),
                      d = !0);
                  var k = ml.getDataMatrix(t).applyInverse(p);
                  t.setPoint("P1" === m ? 0 : 1, k, !0);
                  var M = t.getPoints()
                    , e = M.get(0)
                    , a = M.get(1);
                  E = e.x - a.x,
                  i = e.y - a.y,
                  C = " " + Math.round(Math.sqrt(E * E + i * i)) + " ",
                  d && (F = t.getRect(),
                  W.rectGuide.gatherLines({
                      node: t,
                      x: F.x,
                      y: F.y,
                      w: F.width,
                      h: F.height
                  }))
              }
              if (C) {
                  var _ = n.Default.getLogicalPoint(Y, W._canvas);
                  _.x += ml.Icons.TipShiftX,
                  _.y += ml.Icons.TipShiftY,
                  S.tipInfo = {
                      helperPos: _,
                      text: C,
                      size: C.length
                  }
              }
              S._fireEditEvent("between", Y)
          }
      }
      ,
      cj.prototype._unionPointMode1 = function(l, R, V, e, H) {
          if (H && V && e) {
              var c = l.x - R.x
                , f = l.y - R.y;
              Math.abs(c * e) < Math.abs(f * V) ? (f = Math.sign(f) * Math.abs(c * e / V),
              l.y = R.y + f) : (c = Math.sign(c) * Math.abs(f * V / e),
              l.x = R.x + c)
          }
          return n.Default.unionPoint(l, R)
      }
      ,
      cj.prototype._unionPointMode2 = function(w, M, _, z, m, P) {
          var d = n.Default.unionPoint(w, M);
          if (m && _ && z) {
              var l;
              "v" === P ? (l = d.x + d.width / 2,
              d.width = _ * d.height / z,
              d.x = l - d.width / 2) : (l = d.y + d.height / 2,
              d.height = z * d.width / _,
              d.y = l - d.height / 2)
          }
          return d
      }
      ,
      cj.prototype._adsorbedToClosest = function(q, N) {
          var V = this
            , t = V._interactor
            , W = t.rectGuide.findClosest(q, N)
            , m = t.gridGuide.findClosest(q, N)
            , a = 1 / 0
            , L = 1 / 0;
          W && (isFinite(W.x) && (a = W.x),
          isFinite(W.y) && (L = W.y)),
          m && (isFinite(m.x) && Math.abs(m.x) < Math.abs(a) && (a = m.x),
          isFinite(m.y) && Math.abs(m.y) < Math.abs(L) && (L = m.y)),
          isFinite(a) && (q.x += a),
          isFinite(L) && (q.y += L)
      }
      ,
      cj.prototype._42 = function(Q, J, t) {
          var A = this;
          A.info = {},
          A.screenInfo = null;
          var X = A._interactor;
          if (!X.editDetail && A.gatherInfo(J, t)) {
              var y = A.editing
                , B = y ? y.groupRotateMode : null
                , c = A.screenInfo;
              if ("block" !== B) {
                  if (c.P1 ? ml.Icons.DrawIcon(X, Q, ml.Icons.Line, c) : ml.Icons.DrawIcon(X, Q, ml.Icons.Rect, c),
                  c.connect && (ml.Icons.DrawIcon(X, Q, ml.Icons.ConnectGuide, {
                      rotation: c.rotation,
                      connect: c.connect,
                      cursorPos: y ? y.cursorPos : null
                  }),
                  y)) {
                      if (y.targetCorners) {
                          for (var G = {
                              x: 1 / 0,
                              y: 1 / 0
                          }, q = {
                              x: -1 / 0,
                              y: -1 / 0
                          }, u = 0, C = y.targetCorners.length; C > u; u += 2)
                              G.x = Math.min(G.x, y.targetCorners[u]),
                              q.x = Math.max(q.x, y.targetCorners[u]),
                              G.y = Math.min(G.y, y.targetCorners[u + 1]),
                              q.y = Math.max(q.y, y.targetCorners[u + 1]);
                          ml.Icons.DrawIcon(X, Q, ml.Icons.HoverDataRect, {
                              min: G,
                              max: q,
                              color: X.getStyle("hoverGuideColor") || X.getStyle("baseColor")
                          })
                      }
                      y.garbageInfo && ml.Icons.DrawIcon(X, Q, ml.Icons.ConnectGuideGarbage, y.garbageInfo)
                  }
                  A.tipInfo && ml.Icons.DrawIcon(X, Q, ml.Icons.TipHelper, A.tipInfo)
              }
              A.target instanceof ml.Group && A.target._42(X, Q, J)
          }
      }
      ;
      var ns = ml.Anchor = function(J) {
          this.catalog = "Anchor",
          this._interactor = J
      }
      ;
      ns.prototype = {},
      ns.prototype.constructor = ns,
      ns.prototype.gatherInfo = function(b, x) {
          var O = this;
          if (1 === x.length) {
              var G = x[0];
              if (!G.getAnchor)
                  return;
              if (G instanceof n.Shape && G._70I())
                  return;
              if (dn(G, b))
                  return;
              return O.gatherSingleTarget(b, x[0])
          }
          return x.length > 1 ? O.gatherMultiTargets(b, x) : !1
      }
      ,
      ns.prototype.gatherSingleTarget = function(n, B) {
          var r = this;
          return r.info.POS = B.getPosition(),
          r.screenInfo.POS = ml.toScreenPosition(n, r.info.POS),
          r.target = B,
          !0
      }
      ,
      ns.prototype.gatherMultiTargets = function(O, Z) {
          var P = this
            , r = ml.Group.findOrCreateGroup(Z);
          return r ? (P.screenInfo.POS = ml.toScreenPosition(O, r.getAnchor2()),
          P.target = r,
          !0) : !1
      }
      ,
      ns.prototype.isVisible = function() {
          var S = this
            , f = S._interactor;
          if (f.getStyle("anchorVisible") === !1)
              return !1;
          var a = S.target;
          if (a) {
              if (this.editing)
                  return !0;
              var k = a.getAnchor()
                , P = f.getStyle("anchorOutsideVisibleThreshold");
              if (k.x < -P || k.x > 1 + P || k.y < -P || k.y > 1 + P)
                  return !0;
              var j = a.getSize()
                , s = a.getScale()
                , b = Math.min(Math.abs(j.width * s.x), Math.abs(j.height * s.y));
              if (b * f.gv._zoom < f.getStyle("anchorHideThreshold"))
                  return !1
          }
          return !0
      }
      ,
      ns.prototype.check = function(H, M, K) {
          if (n.Default.isLeftButton(M)) {
              var W = this
                , p = W._interactor;
              if (W.isVisible() && p.getStyle("anchorMovable") !== !1) {
                  W.editing = null,
                  W.tipInfo = null;
                  var l = W.target;
                  if (l && H.isAnchorEditable(l) && H.isEditable(l)) {
                      var u;
                      if (W.screenInfo && (u = W.screenInfo.POS) && ml.checkHit(K, new ml.Math.Vector2(u), p.getStyle("checkSize"))) {
                          if (l instanceof ml.Group)
                              return W.editing = {},
                              !0;
                          var $ = l.getWidth()
                            , m = l.getHeight()
                            , y = l.getAnchor();
                          return W.editing = {
                              rect: {
                                  x: -$ * y.x,
                                  y: -m * y.y,
                                  width: $,
                                  height: m
                              },
                              anchor: y,
                              matrix: l.getMatrix()
                          },
                          !0
                      }
                  }
              }
          }
      }
      ,
      ns.prototype.startEdit = function(H, i) {
          H.startDragging(i),
          H.fi({
              kind: "beginEditAnchor",
              event: i
          })
      }
      ,
      ns.prototype._46O = function(G) {
          var C = this;
          C.editing && (C.editing = null,
          C._interactor.fi({
              kind: "endEditAnchor",
              event: G
          })),
          C.tipInfo = null
      }
      ,
      ns.prototype.handleEdit = function(w, N) {
          var g = this
            , S = g.target;
          if (S) {
              var c = g.editing;
              if (c) {
                  var Z = w.lp(N)
                    , K = g._interactor;
                  if (S instanceof ml.Group)
                      return S.setAnchor2(Z),
                      K._42(),
                      void 0;
                  var B = c.matrix
                    , o = B.tfi(Z)
                    , t = c.rect
                    , L = (o.x - t.x) / t.width
                    , y = (o.y - t.y) / t.height;
                  if (!n.Default.isCtrlDown(N)) {
                      var $ = K.getStyle("anchorRound")
                        , v = K.getStyle("anchorSensitivity");
                      L = ml.roundTo(L, $, v),
                      y = ml.roundTo(y, $, v)
                  }
                  S.setAnchor(L, y, !0);
                  var R = n.Default.getLogicalPoint(N, K._canvas);
                  R.x += ml.Icons.TipShiftX,
                  R.y += ml.Icons.TipShiftY;
                  var J = "" + L.toFixed(2) + ", " + y.toFixed(2);
                  g.tipInfo = {
                      helperPos: R,
                      text: J,
                      size: J.length
                  },
                  K.fi({
                      kind: "betweenEditAnchor",
                      event: N
                  })
              }
          }
      }
      ,
      ns.prototype._42 = function(L, B, h) {
          var T = this;
          T.info = {},
          T.screenInfo = {};
          var r = T._interactor;
          r.editDetail || T.gatherInfo(B, h) && T.isVisible() && (ml.Icons.DrawIcon(r, L, ml.Icons.Anchor, T.screenInfo),
          T.tipInfo && ml.Icons.DrawIcon(r, L, ml.Icons.TipHelper, T.tipInfo))
      }
      ;
      var ym = ml.MoveDummy = function(G) {
          this.catalog = "MoveDummy",
          this._interactor = G
      }
      ;
      ym.prototype = {},
      ym.prototype.constructor = ym,
      ym.prototype.gatherInfo = function() {
          var k = this
            , W = this._interactor.getSubModule("Rect");
          if (W) {
              var y = W.screenInfo;
              if (y) {
                  var I = k._interactor
                    , g = k.getMovableTarget(W.target);
                  if (g) {
                      var b = I.getStyle("moveDummyThreshold");
                      if (b !== !1) {
                          var o = y.LT || y.P1
                            , q = y.RT || y.P2
                            , T = y.LB || o;
                          if (o) {
                              var N = y.P1
                                , J = Math.min(o.distanceTo(T), o.distanceTo(q));
                              if (!(b !== !0 && J > b)) {
                                  var e = I.getStyle("moveDummyPosition")
                                    , Y = q.clone().sub(o)
                                    , c = T.clone().sub(o)
                                    , C = e[2]
                                    , Z = e[3];
                                  if (N) {
                                      var a = I.getStyle("moveDummyLineExtraShift");
                                      a && (C += a[0],
                                      Z += a[1])
                                  }
                                  var U = o.clone().add(Y.clone().multiplyScalar(e[0])).add(Y.setLength(C)).add(c.clone().multiplyScalar(e[1])).add(c.setLength(Z));
                                  return k.screenInfo.pos = U,
                                  k.screenInfo.size = I.getStyle("moveDummySensitivity"),
                                  !0
                              }
                          }
                      }
                  }
              }
          }
      }
      ,
      ym.prototype.getMovableTarget = function(C) {
          var x = this._interactor.gv;
          if (ud(C)) {
              if (x.isMovable(C))
                  return C
          } else if (C instanceof ml.Group)
              for (var z = C._entities, b = z.length - 1; b >= 0; b--) {
                  var d = z[b];
                  if (ud(d) && x.isMovable(d))
                      return d
              }
          return null
      }
      ,
      ym.prototype.getMoveInteractor = function() {
          for (var W, d, Q, y = this._interactor.gv, D = y.getInteractors(), W = 0, d = D.length; d > W; W++)
              if (Q = D.get(W),
              Q instanceof Hb)
                  return Q
      }
      ,
      ym.prototype.startEdit = function(W, S) {
          W.startDragging(S);
          var G = this.getMoveInteractor();
          if (G) {
              var d = this.selectedTarget
                , m = W.gv;
              m._moving = 1,
              G._data = d,
              m.handleMouseDown && m.handleMouseDown(S, d)
          }
      }
      ,
      ym.prototype._46O = function(b) {
          var V = this
            , J = V.getMoveInteractor();
          J && (J.handleWindowMouseUp(b),
          V.selectedTarget = null)
      }
      ,
      ym.prototype.handleEdit = function(X, S) {
          var f = this.getMoveInteractor();
          f && f.handleWindowMouseMove(S)
      }
      ,
      ym.prototype.check = function(y, e, l) {
          if (this.selectedTarget = null,
          n.Default.isLeftButton(e) && !y._scrolling && !ec()) {
              var O = this;
              if (O.screenInfo) {
                  var i = O.screenInfo.pos;
                  if (i && !(l.distanceTo(i) > O.screenInfo.size)) {
                      var h = O._interactor;
                      return O.selectedTarget = O.getMovableTarget(h.getSubModule("Rect").target),
                      h.setCursor("default"),
                      !0
                  }
              }
          }
      }
      ,
      ym.prototype._42 = function(l, A, p) {
          var M = this;
          M.screenInfo = {};
          var g = M._interactor;
          g.editDetail || M.gatherInfo(A, p) && (!g.editing || M.selectedTarget) && ml.Icons.DrawIcon(g, l, ml.Icons.MoveDummy, M.screenInfo)
      }
      ;
      var xj = ml.RotateX = function($) {
          this.catalog = "RotateX",
          this._interactor = $
      }
      ;
      xj.prototype = {},
      xj.prototype.constructor = xj,
      xj.prototype.gatherInfo = function(a, D) {
          var $ = this;
          if (1 === D.length) {
              var _ = D[0];
              return _ instanceof n.Shape && _._70I() || dn(_, a) ? !1 : $.gatherSingleTarget(a, _)
          }
          return D.length > 1 ? $.gatherMultiTargets(a, D) : !1
      }
      ,
      xj.prototype.gatherSingleTarget = function() {
          var o = new n.Math.Vector2
            , Y = new n.Math.Vector2
            , e = new n.Math.Vector2
            , U = new n.Math.Vector2
            , u = function(h, G) {
              var E = h.x - G.x
                , C = h.y - G.y;
              return E * E + C * C
          };
          return function(s, r) {
              if (r.getCorners) {
                  var z = this
                    , h = r.getCorners()
                    , _ = 15
                    , d = r.getPosition();
                  o.copy(h[0]),
                  e.copy(h[1]),
                  U.copy(h[3]),
                  Y.copy(o).add(U).divideScalar(2).add(o.sub(e).setLength(_ / s.getZoom()));
                  var K = Math.max(u(d, h[0]), u(d, h[1]), u(d, h[2]), u(d, h[3]));
                  return z.info.POS = Y.clone(),
                  z.screenInfo.POS = ml.toScreenPosition(s, z.info.POS),
                  z.screenInfo.LEN = Math.sqrt(K) * s.getZoom() + _,
                  z.screenInfo.CENTER = ml.toScreenPosition(s, d),
                  z.target = r,
                  !0
              }
          }
      }(),
      xj.prototype.gatherMultiTargets = function(M, w) {
          var O = this
            , H = ml.Group.findOrCreateGroup(w);
          if (!H)
              return !1;
          var O = this;
          return O.gatherSingleTarget(M, H)
      }
      ,
      xj.prototype.isVisible = function() {
          var z = this._interactor;
          if (!z.getStyle("rotateAsClock"))
              return !1;
          var C = this.target;
          if (!C)
              return !0;
          var Q = z.gv;
          return Q.isEditable(C) && Q.isRotationEditable(C) ? !0 : !1
      }
      ,
      xj.prototype.check = function(U, _, V) {
          var X = this
            , o = X._checkImpl(U, _, V);
          return (o || X._clockPainted) && X._interactor._42(),
          o
      }
      ,
      xj.prototype._checkImpl = function(r, l, c) {
          if (n.Default.isLeftButton(l)) {
              var m = this;
              m.editing = null,
              m.tipInfo = null;
              var u;
              if (m.screenInfo && (u = m.screenInfo.POS) && m.isVisible()) {
                  var p = m._interactor;
                  if (ml.checkHit(c, u, p.getStyle("checkSize"))) {
                      var J = m.target
                        , y = r.lp(l)
                        , f = J.getPosition()
                        , D = Math.atan2(y.y - f.y, y.x - f.x);
                      return p._setRotateCursor(D),
                      m.editing = {
                          pos: f,
                          rotation: J.getRotation(),
                          hitRot: D,
                          groupRotateMode: "block",
                          screenInfo: {
                              CENTER: m.screenInfo.CENTER,
                              LEN: m.screenInfo.LEN
                          }
                      },
                      !0
                  }
              }
          }
      }
      ,
      xj.prototype.startEdit = function(g, E) {
          g.startDragging(E),
          g.fi({
              kind: "beginEditRotation",
              event: E
          }),
          this.target instanceof ml.Group && this.target.beginRotate(this.editing)
      }
      ,
      xj.prototype._46O = function(O) {
          var o = this;
          o.editing && (o.editing = null,
          o._interactor.fi({
              kind: "endEditRotation",
              event: O
          })),
          o.target instanceof ml.Group && o.target.endRotate(),
          o.tipInfo = null
      }
      ,
      xj.prototype.handleEdit = function(w, _) {
          var J = this
            , H = J.editing;
          if (H) {
              var s, F, V = J.target, j = w.lp(_), r = J._interactor, k = H.pos, p = Math.atan2(j.y - k.y, j.x - k.x), B = V instanceof ml.Group;
              if (B ? F = p - H.hitRot : (s = p - H.hitRot,
              F = H.rotation + s),
              F %= 2 * Math.PI,
              0 > F && (F += 2 * Math.PI),
              !n.Default.isCtrlDown(_)) {
                  var M, Q;
                  Oh(_) ? (M = r.getStyle("shiftRotateRound"),
                  Q = M / 2) : (M = r.getStyle("rotateRound"),
                  Q = r.getStyle("rotateSensitivity")),
                  F = ml.roundTo(F, M, Q)
              }
              B ? (s = F - (H.lastRotation || 0),
              0 !== s && (V.addRotation(s, H.groupRotateMode, function(W) {
                  return w.isRotationEditable(W)
              }),
              H.lastRotation = F)) : V.setRotation(F),
              r._setRotateCursor(p),
              F > Math.PI && (F -= 2 * Math.PI);
              var S = 180 * (F / Math.PI)
                , d = "" + S.toFixed(2) + "°"
                , Z = n.Default.getLogicalPoint(_, r._canvas);
              Z.x += ml.Icons.TipShiftX,
              Z.y += ml.Icons.TipShiftY,
              J.tipInfo = {
                  helperPos: Z,
                  text: d,
                  size: d.length
              },
              r.fi({
                  kind: "betweenEditRotation",
                  event: _
              })
          }
      }
      ,
      xj.prototype._42 = function(s, J, O) {
          var v = this;
          v._clockPainted = !1,
          v.info = {},
          v.screenInfo = {};
          var t = v._interactor;
          t.editDetail || v.gatherInfo(J, O) && v.isVisible() && (ml.Icons.DrawIcon(t, s, ml.Icons.RoundPoint, v.screenInfo.POS),
          v.tipInfo && ml.Icons.DrawIcon(t, s, ml.Icons.TipHelper, v.tipInfo),
          v.editing && v.drawClock(s))
      }
      ,
      xj.prototype.drawClock = function(H) {
          H.save();
          var I = this;
          I._clockPainted = !0;
          var V = I.editing || {}
            , t = V.screenInfo || I.screenInfo
            , y = t.LEN
            , Q = y + 8
            , R = y + 18;
          H.save(),
          H.translate(t.CENTER.x, t.CENTER.y),
          H.beginPath(),
          H.strokeStyle = "rgb(150, 150, 150)";
          for (var i, m, Y, s, L, C = 0; 360 > C; C++)
              i = C * Math.PI / 180,
              0 === C % 5 && (m = P(i) * y,
              Y = o(i) * y,
              s = P(i) * Q,
              L = o(i) * Q,
              H.moveTo(m, Y),
              H.lineTo(s, L)),
              0 === C % 45 && (m = P(i) * y,
              Y = o(i) * y,
              s = P(i) * R,
              L = o(i) * R,
              H.moveTo(m, Y),
              H.lineTo(s, L));
          H.stroke(),
          H.rotate(-A);
          var O = V.lastRotation || I.target.getRotation();
          H.beginPath(),
          H.fillStyle = "rgba(255, 0, 0, 0.1)",
          H.strokeStyle = "rgb(157, 157, 157)",
          H.moveTo(0, 0),
          H.arc(0, 0, R, 0, O, !1),
          H.fill(),
          H.beginPath(),
          H.moveTo(0 + R, 0),
          H.arc(0, 0, R, 0, O, !1),
          H.stroke(),
          H.restore()
      }
      ;
      var Ai = ml.Curve = function(g) {
          this.catalog = "Curve",
          this._interactor = g
      }
      ;
      Ai.prototype = {},
      Ai.prototype.constructor = Ai,
      G.defineProperties(Ai.prototype, {
          activing: {
              get: function() {
                  return this._activing
              },
              set: function(U) {
                  var L = this;
                  if (U)
                      L._activing = new ml.CurveActiving(this,U),
                      L._activing._firePointChange();
                  else {
                      var H = L._activing;
                      H && H.dispose(),
                      L._activing = null
                  }
              }
          }
      }),
      Ai.PointType = {
          Mirrored: 0,
          Straight: 1,
          Disconnected: 2,
          Asymmetric: 3
      },
      Ai.prototype.setUp = function() {
          var G = this
            , n = G._interactor;
          n && n.gv.mp(G._onGraphviewPropertyChanged, G)
      }
      ,
      Ai.prototype._onGraphviewPropertyChanged = function(b) {
          ("zoom" === b.property || "translateX" === b.property || "translateY" === b.property) && this._handleDataChanged()
      }
      ,
      Ai.prototype.tearDown = function() {
          var P = this
            , y = P._interactor;
          y && y.gv.ump(P._onGraphviewPropertyChanged, P)
      }
      ,
      Ai.prototype.canEnterEditDetailMode = function() {
          var d = this
            , Q = d._interactor
            , Y = Q._getValidSelection();
          if (1 === Y.length) {
              var o = Y[0]
                , e = o instanceof n.Edge;
              if (o instanceof n.Shape || e) {
                  if (e) {
                      var Z = o.s("edge.type");
                      if (Z && "points" !== Z)
                          return
                  }
                  var g = Q.gv;
                  if (g.isPointEditable(o) && g.isEditable(o))
                      return d.target = o,
                      !0
              }
          }
      }
      ,
      Ai.prototype.canQuitEditDetailMode = function($) {
          var X = this
            , V = X._interactor._getLogicalPoint($);
          return X._checkEditRealPoint(V) ? void 0 : X._interactor.gv.getDataAt($) !== X.target ? !0 : void 0
      }
      ,
      Ai.prototype.preHandleScroll = function() {
          var P = this.editing;
          return P && P.inEdit ? !0 : void 0
      }
      ,
      Ai.prototype.getCurrentSelectintStatus = function() {
          var g = this;
          if (g.activing && !g.activing.selections) {
              if (g.activing.status != V)
                  return g.activing.status;
              var i = function(W) {
                  var x = g.activing.status;
                  g.activing.status = W,
                  g._interactor.fp("shapePointStatus", x, W)
              }
                , l = ml.Curve.PointType
                , t = g.activing.point
                , r = g.activing.pairs;
              if (!r || 1 !== r.length)
                  return i(l.Mirrored);
              var I = r[0]
                , X = I.c1 && I.c1.isNearEnough(t)
                , k = I.c2 && I.c2.isNearEnough(t);
              if (!I.c1 || !I.c2)
                  return X || k ? i(l.Straight) : i(l.Disconnected);
              if (X && k)
                  return i(l.Straight);
              if (X || k)
                  return i(l.Asymmetric);
              var j = I.c1.clone().sub(t)
                , J = I.c2.clone().sub(t);
              return Math.abs(j.x * J.y - j.y * J.x) > 1e-5 || j.x * J.x > 0 ? i(l.Disconnected) : Math.abs(j.length() - J.length()) > 1e-5 ? i(l.Asymmetric) : i(l.Mirrored)
          }
      }
      ,
      Ai.prototype.handle_keydown = function(I) {
          var N = this;
          if (N._interactor.editDetail) {
              var f = ml.Curve.PointType;
              "1" === I.key ? N._setCurrentSelectionStatus(f.Straight) : "2" === I.key ? N._setCurrentSelectionStatus(f.Mirrored) : "3" === I.key ? N._setCurrentSelectionStatus(f.Disconnected) : "4" === I.key && N._setCurrentSelectionStatus(f.Asymmetric)
          }
      }
      ,
      Ai.prototype.setCurrentSelectionStatus = function(o) {
          var g = this
            , X = g._interactor;
          if (X) {
              var w = X.gv;
              w.dm().beginTransaction(),
              this._setCurrentSelectionStatus(o),
              w.dm().endTransaction()
          }
      }
      ,
      Ai.prototype._setCurrentSelectionStatus = function(_) {
          var y = this
            , U = y.activing;
          if (U) {
              var t = y.getCurrentSelectintStatus();
              if (null !== t && t !== _) {
                  U.status = _;
                  var T = y.activing.point
                    , Q = y.activing.pairs;
                  if (Q && 1 === Q.length) {
                      var E = Q[0]
                        , b = y.screenInfo.curve
                        , R = ml.Curve.PointType
                        , f = y._interactor
                        , v = function() {
                          y._writeToHt(),
                          f.fp("shapePointStatus", t, _),
                          y.check(f.gv, null, new ml.Math.Vector2(f._lastLogicalPoint))
                      };
                      if (_ === R.Straight)
                          return b.moveCtrlPoint(E, T, "c1"),
                          b.moveCtrlPoint(E, T, "c2"),
                          v(),
                          void 0;
                      if (t === R.Straight) {
                          var h = b.findPairs(T, !0)
                            , N = h[0]
                            , V = N.r1 || T
                            , s = N.r2 || T
                            , D = s.clone().sub(V).multiplyScalar(.25);
                          return b.moveCtrlPoint(E, T.clone().sub(D), "c1"),
                          b.moveCtrlPoint(E, T.clone().add(D), "c2"),
                          v(),
                          void 0
                      }
                      var X = E.c1
                        , u = E.c2;
                      if (X && u) {
                          if (_ === R.Mirrored)
                              return b.moveCtrlPoint(E, T.clone().multiplyScalar(2).sub(u), "c1"),
                              v(),
                              void 0;
                          if (_ === R.Asymmetric && t === R.Disconnected) {
                              var Z = X.clone().sub(T).length()
                                , D = T.clone().sub(u).setLength(Z).add(T);
                              return b.moveCtrlPoint(E, D, "c1"),
                              v(),
                              void 0
                          }
                      }
                      U._firePointChange(),
                      f.fp("shapePointStatus", t, _),
                      y.check(f.gv, null, new ml.Math.Vector2(f._lastLogicalPoint))
                  }
              }
          }
      }
      ,
      Ai.prototype._handleDataChanged = function() {
          var f = "s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");
          return function(D) {
              var C = this;
              if (C.screenInfo && C.target) {
                  if (D && f.indexOf(D.property) < 0)
                      return;
                  var j = C._interactor;
                  C.gatherSingleTarget(j.gv, C.target, !0),
                  C.check(j.gv, null, new ml.Math.Vector2(j._lastLogicalPoint)),
                  j._42()
              }
          }
      }(),
      Ai.prototype.gatherSingleTarget = function(H, P, e) {
          var L, u, K = this;
          K.screenInfo && K.screenInfo.curve && (u = K.screenInfo.curve._curves);
          var X = K.editing;
          L = X ? K.screenInfo : K.screenInfo = {};
          var q, k, i = P instanceof n.Edge;
          i ? (q = P.s("edge.segments"),
          k = P.s("edge.points") || new n.List) : (q = P._58O,
          k = P._59O),
          L.S = q;
          var p, T = L.P = [], w = ml.getDataMatrix(P);
          if (P instanceof n.Polyline || P instanceof n.Edge && K._interactor.getStyle("edgeElevationEditable"))
              p = P.getElevation && P.getElevation() || 0,
              L.E = [];
          else {
              var v = !1;
              k.each(function(p) {
                  p.e !== V && (v = !0)
              }),
              v && (L.E = [])
          }
          if (k.each(function(l) {
              L.E && L.E.push(l.e != V ? l.e : p),
              l = w.apply(l);
              var o = ml.toScreenPosition(H, l);
              T.push(o.x, o.y)
          }),
          i) {
              var J = T.length
                , C = ml.toScreenPosition(H, P._lastSourcePoint || (J ? {
                  x: T[0],
                  y: T[1]
              } : {
                  x: 0,
                  y: 0
              }))
                , M = ml.toScreenPosition(H, P._lastTargetPoint || (J ? {
                  x: T[J - 2],
                  y: T[J - 1]
              } : {
                  x: 0,
                  y: 0
              }));
              T.splice(0, 0, C.x, C.y),
              T.push(M.x, M.y),
              L.E && (L.E.splice(0, 0, "head"),
              L.E.push("tail"))
          }
          if (!L.S || !L.S.size()) {
              L.S = new n.List,
              L.S.add(1);
              for (var A = 0; A < T.length / 2 - 1; A++)
                  L.S.add(2)
          }
          if ((!X || e) && K.convertToCubicBezier(u),
          K.activing && (e || !K.editing || "realPoint" === K.editing.type)) {
              var m = L.curve.findPairs(K.activing.point);
              K.activing.pairs = m
          }
      }
      ,
      Ai.prototype._convertToNewPoint = function(b, y, f, $) {
          var _, i, J;
          for (_ = 0,
          i = y.length; i > _; _++) {
              if (J = y[_],
              J._p1.isNearEnough(b) && (!$ || $.indexOf(J._p1) < 0))
                  return J._p1;
              if (J._p4.isNearEnough(b) && (!$ || $.indexOf(J._p4) < 0))
                  return J._p4
          }
          if (f)
              for (_ = 0,
              i = Math.min(f.length, i); i > _; _++) {
                  if (J = f[_],
                  J._p1 === b && (!$ || $.indexOf(y[_]._p1) < 0))
                      return y[_]._p1;
                  if (J._p4 === b && (!$ || $.indexOf(y[_]._p4) < 0))
                      return y[_]._p4
              }
      }
      ,
      Ai.prototype.convertToCubicBezier = function(c) {
          var o, x, k = this, v = new ml.Math.Curve, $ = k.screenInfo;
          if (v.createFromHtShape($.P, $.S, $.E),
          $.curve = v,
          k.activing) {
              var s = v._curves;
              o = k.activing.point,
              x = k._convertToNewPoint(o, s, c);
              var R = [];
              if (x && (k.activing.point = x,
              R.push(x)),
              k.activing.selections) {
                  var A = -1
                    , S = k.activing.selections;
                  S.forEach(function(C) {
                      A++,
                      x = k._convertToNewPoint(C, s, c, R),
                      x && (S[A] = x,
                      R.push(x))
                  })
              }
          }
      }
      ,
      Ai.prototype.check = function(p, M, $) {
          if (!M || ni(M) || no(M)) {
              var Q = this;
              if (Q._interactor.setCursor("default"),
              Q.editing = null,
              Q.highlight = null,
              Q.tipInfo = null,
              Q.edgeEditResult = null,
              Q.screenInfo) {
                  if (ec() || M && no(M))
                      return Q._interactor._42(),
                      !0;
                  if (Q._checkEditCtrlPoint($))
                      return Q._interactor._42(),
                      !0;
                  if (Q._checkEditRealPoint($))
                      return Q._interactor._42(),
                      !0;
                  if (Q._checkEditElevation($))
                      return Q._interactor._42(),
                      !0;
                  var B = Q.screenInfo.curve
                    , k = B.checkPoint($, Q._interactor.getStyle("curveIntersectSize"));
                  if (k) {
                      var F = Q.highlight = {};
                      F.type = "insertKnot",
                      F.bezier = k.bezier,
                      F.point = k.intersection
                  }
                  return Q._interactor._42(),
                  !0
              }
          }
      }
      ,
      Ai.prototype.getAdjacentBeziers = function(L) {
          var H = this.screenInfo;
          if (H) {
              var j, Y, k, P = H.curve._curves, Z = [], K = V;
              for (j = 0,
              Y = P.length; Y > j; j++)
                  if (k = P[j],
                  K === V) {
                      if (k._p4.isNearEnough(L)) {
                          Z.push(k),
                          K = j;
                          continue
                      }
                  } else {
                      if (k._p1.isNearEnough(L))
                          return Z.push(k),
                          Z;
                      if (k._p4.isNearEnough(L)) {
                          Z[0] = k,
                          K = j;
                          continue
                      }
                  }
          }
      }
      ,
      Ai.prototype.roundCorner = function(D) {
          if (this.activing && this.screenInfo) {
              var P = this.screenInfo.curve
                , S = P._curves
                , h = this.getAdjacentBeziers(this.activing.point)
                , _ = h[1]
                , k = _._index;
              _ = _.insertKnot(_.getTByPercentage(D / _.length))[1],
              S[k] = _;
              var f = _.p1
                , E = h[0]
                , d = E._index;
              E = E.insertKnot(E.getTByPercentage(1 - D / E.length))[0],
              S[d] = E;
              var u = E.p4
                , R = this.activing.point
                , T = new ml.Math.CubicBezier(u,R.clone().sub(u).multiplyScalar(2 / 3).add(u),R.clone().sub(f).multiplyScalar(2 / 3).add(f),f);
              S.splice(k, 0, T),
              this._writeToHt(),
              this.activing = null,
              this._interactor._42()
          }
      }
      ,
      Ai.prototype._checkEditRealPoint = function(c) {
          var o, f, I, n, H, h, V = this, J = V.screenInfo.curve._curves, P = V._interactor.getStyle("curvePointIntersectSize"), y = 1 / 0;
          for (P *= P,
          I = 0,
          n = J.length; n > I; I++)
              o = J[I],
              H = o._p1,
              h = c.distanceToSquared(H),
              y > h && (y = h,
              f = H),
              H = o._p4,
              h = c.distanceToSquared(H),
              y > h && (y = h,
              f = H);
          if (y > P)
              return !1;
          var $ = V.highlight = {};
          return $.type = "changeRealPoint",
          $.point = f,
          V.editing = {
              type: "realPoint",
              point: f,
              shiftGuide: {
                  point: f.clone(),
                  dir: "x",
                  limit: 0
              }
          },
          V._interactor.setCursor("crosshair"),
          !0
      }
      ,
      Ai.prototype._checkEditElevation = function(k) {
          var m = this;
          if (!m._interactor.getStyle("curveElevationVisible"))
              return !1;
          var E = m.target;
          if (E instanceof n.Edge && !m._interactor.getStyle("edgeElevationEditable"))
              return !1;
          var g = m.activing;
          if (!g)
              return !1;
          var w = g.getCurrentEditingPoint();
          if (!w)
              return !1;
          var S = m._interactor
            , t = S.getStyle("curveElevationGuideShift")
            , U = S.getStyle("curveElevationIntersectSize")
            , I = k.distanceToSquared({
              x: w.x + t[0],
              y: w.y + t[1]
          });
          if (!(I > U * U)) {
              var X = m.highlight = {};
              X.type = "elevation";
              var B = new ml.Math.Vector2(k.x,k.y,w.e);
              return m.editing = {
                  type: "elevation",
                  startPoint: B
              },
              m._interactor.setCursor("crosshair"),
              !0
          }
      }
      ,
      Ai.prototype._checkEditCtrlPoint = function(I) {
          var O = this;
          if (O.activing && !O.activing.selections) {
              var A = O.getCurrentSelectintStatus();
              if (A !== ml.Curve.PointType.Straight) {
                  var d = O.activing.pairs;
                  if (d) {
                      var L = O._interactor.getStyle("curvePointIntersectSize");
                      L *= L;
                      var D, v, Q, E, N, y, W, g, X, m = 1 / 0;
                      for (W = 0,
                      X = d.length; X > W; W++)
                          for (E = d[W],
                          g = 0; 2 > g; g++)
                              N = 0 === g ? "c1" : "c2",
                              E[N] && (y = I.distanceToSquared(E[N]),
                              m > y && (m = y,
                              D = E,
                              v = W,
                              Q = N));
                      if (m > L)
                          return !1;
                      O.activing.hlpair = D,
                      O.activing.hltype = Q;
                      var R = O.highlight = {};
                      return R.type = "changeCtrlPoint",
                      R.point = D[Q],
                      O.editing = {
                          type: "ctrlPoint",
                          pair: D,
                          pairId: v,
                          ctrlType: Q,
                          direction: D[Q].clone().sub(O.activing.point).normalize()
                      },
                      O._interactor.setCursor("crosshair"),
                      !0
                  }
              }
          }
      }
      ,
      Ai.prototype.startEdit = function(H, w) {
          H.startDragging(w);
          var P = this;
          P.highlight && "insertKnot" === P.highlight.type && (P.insertKnot(),
          P.gatherSingleTarget(P._interactor.gv, P.target),
          P.activing = null,
          P._checkEditRealPoint(P._interactor._getLogicalPoint(w)));
          var N = P._activing;
          if (N) {
              var Y = P.editing ? P.editing.type : null;
              "ctrlPoint" === Y ? N.editingCtrl = {
                  pairId: P.editing.pairId,
                  type: N.hltype
              } : "realPoint" === Y && (N.editingCtrl = !1)
          }
          var u = P.highlight
            , G = n.Default.isCtrlDown(w);
          if (!u || ec() || no(w)) {
              var g = P._interactor.gv;
              if (!g.setFocus(w) || g._scrolling)
                  return;
              return G ? P._multiSelect = {
                  startPoint: g.lp(w)
              } : g.isPannable() && (ni(w) || no(w)) && (P._pan = {
                  tx: g.tx(),
                  ty: g.ty()
              },
              H.fi({
                  kind: "beginPan",
                  event: w
              })),
              void 0
          }
          if ("changeRealPoint" === u.type) {
              var I, B = P.activing ? P.activing.point : null, h = P.activing ? P.activing.selections : null;
              if (G && P.activing)
                  B === u.point ? (h ? (P.activing = {
                      point: h[0]
                  },
                  h.length > 1 && (h.splice(0, 1),
                  P.activing.selections = h)) : P.activing = null,
                  P.editing = null) : h && (I = h.indexOf(u.point)) >= 0 ? (h.length > 1 ? h.splice(I, 1) : delete P.activing.selections,
                  P.editing = null) : h ? (h.push(B),
                  P.activing = {
                      point: u.point,
                      selections: h
                  }) : P.activing = {
                      point: u.point,
                      selections: [B]
                  };
              else if (h)
                  B === u.point || ((I = h.indexOf(u.point)) >= 0 ? (h.splice(I, 1, B),
                  P.activing = {
                      point: u.point,
                      selections: h
                  }) : P.activing = {
                      point: u.point
                  });
              else {
                  var d;
                  B === u.point && (d = P.activing.status),
                  P.activing = {
                      point: u.point
                  },
                  d && (P.activing.status = d)
              }
              H.fi({
                  kind: "beginEditPoint",
                  event: w
              })
          }
      }
      ,
      Ai.prototype.insertKnot = function() {
          var p = this
            , z = p.highlight
            , L = p.screenInfo.curve;
          L.insertKnot(z.bezier, z.point.t),
          p._writeToHt()
      }
      ,
      Ai.prototype._writeToHt = function() {
          var X, o, p = this, l = p.screenInfo.curve, j = l.toHtShape(), J = j.points, d = [], t = j.segments, T = p._interactor.gv;
          T.dm().beginTransaction();
          var z, e, K = p.target, i = K instanceof n.Edge, m = ml.getDataMatrix(K).invert();
          e = K instanceof n.Polyline || K instanceof n.Edge && p._interactor.getStyle("edgeElevationEditable"),
          e && (z = K.getElevation && K.getElevation() || 0);
          for (var N = 0, x = J.length; x > N; N++)
              X = J[N],
              o = ml.toWorldPosition(T, X),
              o = m.apply(o),
              isFinite(X.e) && X.e !== z && (o.e = X.e),
              d.push(o);
          if (K._writing = !0,
          i) {
              K.s("edge.type", "points"),
              K.setStyle("edge.segments", t),
              K.setStyle("edge.points", d.slice(1, d.length - 1)),
              K.setStyle("edge.source.offset.x", 0),
              K.setStyle("edge.source.offset.y", 0),
              K.setStyle("edge.target.offset.x", 0),
              K.setStyle("edge.target.offset.y", 0);
              var W = p._nextChangeEdgeHost;
              delete p._nextChangeEdgeHost,
              W && ("source" === W.type ? K.setSource(W.host) : K.setTarget(W.host)),
              p._writeEdgeHostAnchor("source", d[0]),
              p._writeEdgeHostAnchor("target", d[d.length - 1])
          } else
              d.length ? (K.setSegments(t),
              K.setPoints(d, !0)) : K.removeFromDataModel();
          T.dm().endTransaction(),
          delete K._writing
      }
      ,
      Ai.prototype._writeEdgeHostAnchor = function(M, u) {
          var z = this
            , P = z.target
            , q = z._calcHostAnchor(P, M, u);
          q.index !== V ? (P.setStyle("edge." + M + ".index", q.index),
          P.setStyle("edge." + M + ".percent", V),
          P.setStyle("edge." + M + ".anchor.x", V),
          P.setStyle("edge." + M + ".anchor.y", V)) : q.percent !== V ? (P.setStyle("edge." + M + ".percent", q.percent),
          P.setStyle("edge." + M + ".index", V),
          P.setStyle("edge." + M + ".anchor.x", V),
          P.setStyle("edge." + M + ".anchor.y", V)) : (P.s("edge." + M + ".anchor.x", q.x),
          P.s("edge." + M + ".anchor.y", q.y),
          q.offsetX || q.offsetY ? (P.s("edge." + M + ".offset.x", q.offsetX),
          P.s("edge." + M + ".offset.y", q.offsetY)) : (P.s("edge." + M + ".offset.x", 0),
          P.s("edge." + M + ".offset.y", 0)))
      }
      ,
      Ai.prototype._calcHostAnchor = function(e, x, d, p) {
          p || (p = "source" === x ? e.getSource() : e.getTarget());
          var F = this._interactor.gv
            , z = F.calculateAttachPoint(p, d);
          if (z)
              return z.info;
          if (ji(p)) {
              var y = F.calculateEdgePosition(p, d);
              return y
          }
          var M = p.getRotation()
            , q = p.getAnchor();
          dn(p, F) && (M = 0);
          var R = p.getScale();
          if (M || R.x < 0 || R.y < 0) {
              var I = p.getMatrix()
                , Q = I.tfi(d)
                , W = p.getSize();
              return {
                  x: Q.x / W.width + q.x,
                  y: Q.y / W.height + q.y
              }
          }
          var V = wo(F, p)
            , E = {
              x: (d.x - V.x) / V.width,
              y: (d.y - V.y) / V.height
          };
          return E
      }
      ,
      Ai.prototype._handlePanning = function(y) {
          var h = this
            , G = h._pan;
          if (G) {
              G.started = !0;
              var A = h._interactor
                , N = A.gv
                , r = A._lastClientPoint
                , z = Gp(y)
                , S = gj(N, z, r);
              N.setTranslate(G.tx + S.x, G.ty + S.y),
              h.gatherSingleTarget(A.gv, h.target),
              A._42(),
              A.fi({
                  kind: "betweenPan",
                  event: y
              })
          }
      }
      ,
      Ai.prototype.handleEdit = function(J, W) {
          var N = this
            , v = N.editing;
          if (N._pan)
              return N._handlePanning(W),
              void 0;
          if (N._multiSelect)
              return N._multiSelect.endPoint = J.lp(W),
              N._interactor.redraw(),
              void 0;
          if (v) {
              v.inEdit = !0;
              var a, h, c, y = N._interactor._getLogicalPoint(W), F = n.Default.isCtrlDown(W), G = n.Default.isShiftDown(W), A = v.type, t = N.activing;
              if (N._guideInfo = null,
              "ctrlPoint" === A && G) {
                  var o = N.editing.direction.clone();
                  a = t.point;
                  var M = o.dot(y.clone().sub(a));
                  y = o.setLength(M).add(a)
              } else if ("ctrlPoint" === A || "realPoint" === A) {
                  var o;
                  if ("realPoint" === A && G) {
                      var X = N.editing.shiftGuide;
                      h = X.point;
                      var k = Math.abs(y.x - h.x)
                        , i = Math.abs(y.y - h.y);
                      k > i && k > X.limit && "y" === X.dir && (X.dir = "x"),
                      i > k && i > X.limit && "x" === X.dir && (X.dir = "y"),
                      o = X.dir,
                      "x" === o ? (y.y = h.y,
                      X.limit = Math.max(X.limit, k)) : "y" === o && (y.x = h.x,
                      X.limit = Math.max(X.limit, i))
                  }
                  var K = N._isEditEdgeSourceTarget();
                  if (K) {
                      var f = N._editEdgeSourceTarget(K, y, F);
                      f && (N.edgeEditResult = f,
                      c = f.tipText)
                  } else if (!F) {
                      var w = N._guidingToEdit(y, o)
                        , s = "realPoint" === A ? N._interactor.gridGuide.findClosest(y, o, !0) : null
                        , P = 1 / 0
                        , H = 1 / 0;
                      s && (s.x && (P = s.x),
                      s.y && (H = s.y));
                      var Q = !1;
                      w && (w.xList && (Math.abs(w.x) <= Math.abs(P) ? (Q = !0,
                      P = w.x) : delete w.xList),
                      w.yList && (Math.abs(w.y) <= Math.abs(H) ? (Q = !0,
                      H = w.y) : delete w.yList),
                      Q && (N._guideInfo = w)),
                      isFinite(P) && (y.x += P),
                      isFinite(H) && (y.y += H),
                      Q && (w.v = y)
                  }
              }
              var z = N.screenInfo.curve;
              if ("realPoint" === v.type) {
                  a = v.point,
                  a.e !== V && (y.e = a.e),
                  z.moveRealPoint(a, y),
                  v.point = y,
                  N.highlight.point = y;
                  var Y = t.status
                    , T = t.selections;
                  if (N.activing = {
                      point: y,
                      status: Y
                  },
                  T) {
                      var g = y.clone().sub(a)
                        , u = 0;
                      T.forEach(function(F) {
                          var Z = F.clone().add(g);
                          z.moveRealPoint(F, Z),
                          T[u++] = Z
                      }),
                      N.activing.selections = T
                  }
              } else if ("ctrlPoint" === v.type) {
                  var x = t.pairs
                    , d = x[v.pairId];
                  z.moveCtrlPoint(d, y, v.ctrlType);
                  var e = t.status
                    , C = ml.Curve.PointType;
                  if ((e === C.Mirrored || e === C.Asymmetric) && d.c1 && d.c2) {
                      var a = new ml.Math.Vector2(t.point)
                        , Z = "c1" === v.ctrlType ? "c2" : "c1";
                      if (e === ml.Curve.PointType.Mirrored)
                          z.moveCtrlPoint(d, a.clone().multiplyScalar(2).sub(y), Z);
                      else if (e === C.Asymmetric) {
                          var M = d[Z].clone().sub(a).length()
                            , S = a.clone().sub(d[v.ctrlType]).setLength(M).add(a);
                          isNaN(S.x) || z.moveCtrlPoint(d, S, Z)
                      }
                  }
                  t._firePointChange()
              } else if ("elevation" === v.type) {
                  h = v.startPoint;
                  var U = h.e + (h.y - y.y) / J._zoom;
                  N._setCurrentPointImpl("e", U),
                  t._firePointChange(),
                  c = "E: " + ml.toFixed(U)
              }
              var q = n.Default.getLogicalPoint(W, N._interactor._canvas);
              if (q.x += ml.Icons.TipShiftX,
              q.y += ml.Icons.TipShiftY,
              !c) {
                  var D = ml.toWorldPosition(J, y);
                  c = "" + ml.toFixed(D.x) + ", " + ml.toFixed(D.y)
              }
              N.tipInfo = {
                  helperPos: q,
                  text: c,
                  size: c.length
              },
              N._writeToHt(),
              N._interactor.fi({
                  kind: "betweenEditPoint",
                  event: W
              })
          }
      }
      ,
      Ai.prototype._setCurrentPointImpl = function(d, u) {
          var A = this
            , y = A._activing;
          if (!y)
              return !1;
          var o = A.target;
          if (!o)
              return !1;
          var x = y.getCurrentEditingPoint();
          if (!x)
              return !1;
          var t = y.editingCtrl;
          if (!t)
              var v = x.clone();
          if ("e" === d)
              x.e = u;
          else {
              var f;
              if ("x" === d || "y" === d) {
                  var Q = y._lastFirePoint;
                  f = "x" === d ? {
                      x: u,
                      y: Q ? Q.y : 0
                  } : {
                      x: Q ? Q.x : 0,
                      y: u
                  }
              } else
                  "object" == typeof d ? (f = d,
                  d.e !== V && (x.e = d.e)) : (f = {
                      x: arguments[0],
                      y: arguments[1]
                  },
                  arguments[2] !== V && (x.e = arguments[2]));
              var P = ml.getDataMatrix(o);
              f = ml.toScreenPosition(A._interactor.gv, P.apply(f)),
              x.x = f.x,
              x.y = f.y
          }
          if (!t) {
              var G = v.multiplyScalar(-1).add(x);
              x.e && v.e && (G.e = x.e - v.e);
              var O = A.screenInfo.curve;
              O.moveCtrlDueToRealPointMovement(x, G);
              var E = y.selections;
              if (E) {
                  var z = 0;
                  E.forEach(function(s) {
                      var j = s.clone().add(G);
                      isFinite(G.e) && (j.e = (isFinite(s.e) ? s.e : o.getElevation() || 0) + G.e),
                      O.moveRealPoint(s, j),
                      E[z++] = j
                  }),
                  y.selections = E
              }
          }
          return !0
      }
      ,
      Ai.prototype.setCurrentPoint = function(x, D) {
          return this._setCurrentPointImpl(x, D) ? (this._writeToHt(),
          !0) : !1
      }
      ,
      Ai.prototype._isEditEdgeSourceTarget = function() {
          var a = this
            , Z = a.target;
          if (!(Z instanceof n.Edge))
              return !1;
          var I = a.editing.point
            , c = a.screenInfo.curve._curves;
          return I === c[0]._p1 ? "source" : I === c[c.length - 1]._p4 ? "target" : !1
      }
      ,
      Ai.prototype._editEdgeSourceTarget = function(g, o, A) {
          var Y, O = this, q = O.target;
          if (Y = "source" === g ? q.getSource() : q.getTarget()) {
              var U, T = O._interactor.gv, X = ml.toWorldPosition(T, o), h = O._calcHostAnchor(q, g, X, Y);
              if (U = h.index !== V || h.percent !== V ? h.distance * T.getZoom() > O._interactor.getStyle("edgeHostEdgeMaxDistance") : O._interactor.getStyle("edgeHostDetectPerFrame") ? !0 : h.x < 0 || h.x > 1 || h.y < 0 || h.y > 1 ? !0 : !1) {
                  var N = T.getDataAt(X, function(Z) {
                      return T.isSelectable(Z) ? T.isSourceTargetEditable(q, Z, g) ? q.canSetSourceTarget(Z, g) ? !0 : !1 : !1 : !1
                  });
                  if (N) {
                      var E = O._calcHostAnchor(q, g, X, N);
                      Y = N,
                      O._nextChangeEdgeHost = {
                          type: g,
                          host: N
                      },
                      h = E
                  }
              }
              var y, w, r;
              if (A || h.x === V)
                  (h.percent !== V || h.index !== V) && (w = h.point);
              else {
                  var c = O._interactor.getStyle("anchorRound")
                    , I = O._interactor.getStyle("anchorSensitivity");
                  y = T.calculateAttachPoint(Y, X),
                  y ? h = y.info : (h.x = ml.roundTo(h.x, c, I),
                  h.y = ml.roundTo(h.y, c, I)),
                  w = or(T, Y, 0, h.offsetX || 0, h.offsetY || 0, h.x, h.y)
              }
              w && (r = ml.toScreenPosition(T, w),
              o.x = r.x,
              o.y = r.y),
              O._edgeHostGuideInfo = {
                  corners: ml.getTargetCornersOnScreen(T, Y),
                  attach: y ? y.index : -1,
                  host: Y
              };
              var L;
              return h.percent !== V ? L = "percent: " + h.percent.toFixed(2) : h.index !== V ? L = "index: " + h.index : (L = "" + h.x.toFixed(2) + ", " + h.y.toFixed(2),
              (h.offsetX || h.offsetY) && (L += " offset: " + h.offsetX.toFixed(2) + ", " + h.offsetY.toFixed(2))),
              {
                  host: Y,
                  anchor: h,
                  tipText: L
              }
          }
      }
      ,
      Ai.prototype._guidingToEdit = function(N, C) {
          var z, w, $ = this;
          if (z = $.screenInfo.curve) {
              w = z._curves;
              var b, u, K, T, Q, X, x, i, E = 1 / 0, e = 1 / 0, h = [];
              for ($.editing && "realPoint" === $.editing.type && (i = $.editing.point),
              Q = 0,
              X = 2 * w.length; X > Q; Q++)
                  x = w[Math.floor(Q / 2)][Q % 2 ? "_p4" : "_p1"],
                  h.indexOf(x) >= 0 || (h.push(x),
                  i && i === x || (K = x.x - N.x,
                  T = x.y - N.y,
                  Math.abs(K) < Math.abs(E) ? (E = K,
                  b = [x]) : K === E && b.push(x),
                  Math.abs(T) < Math.abs(e) ? (e = T,
                  u = [x]) : T === e && u.push(x)));
              var r = $._interactor.getStyle("smartGuideThreshold");
              if ((Math.abs(E) > r || "y" === C) && (b = null),
              (Math.abs(e) > r || "x" === C) && (u = null),
              b || u) {
                  var j = !1
                    , t = {};
                  if (b && (j = !0,
                  t.xList = b,
                  t.x = E),
                  u && (j = !0,
                  t.yList = u,
                  t.y = e),
                  j)
                      return t
              }
          }
      }
      ,
      Ai.prototype._46O = function(T) {
          var F = this;
          F.editing && (F.editing = null,
          F._interactor.fi({
              kind: "endEditPoint",
              event: T
          })),
          F._guideInfo = null,
          F._edgeHostGuideInfo = null,
          F._pan && (F._pan = null,
          F._interactor.fi({
              kind: "endPan",
              event: T
          })),
          F._multiSelect && (F._handleMultiSelect(F._multiSelect),
          F._multiSelect = null),
          F.tipInfo = null,
          F.edgeEditResult = null
      }
      ,
      Ai.prototype._handleMultiSelect = function(j) {
          if (j.startPoint && j.endPoint) {
              var w, U, t, i, I, d = this, N = d._interactor, r = N.gv, v = ml.toScreenPosition(r, j.startPoint), X = ml.toScreenPosition(r, j.endPoint), L = n.Default.unionPoint(v, X), h = d.screenInfo.curve._curves, R = [], E = function(i) {
                  i.x >= L.x && i.y >= L.y && i.x <= L.x + L.width && i.y <= L.y + L.height && R.indexOf(i) < 0 && R.push(i)
              };
              for (w = 0,
              U = h.length; U > w; w++)
                  I = h[w],
                  E(I._p1),
                  E(I._p4);
              if (R.length) {
                  var l = d.activing || {}
                    , z = l.selections || [];
                  for (l.point && z.push(l.point),
                  w = 0,
                  U = z.length; U > w; w++)
                      t = z[w],
                      i = R.indexOf(t),
                      i >= 0 ? R[i] = V : R.push(t);
                  var g = R;
                  for (R = [],
                  w = 0,
                  U = g.length; U > w; w++)
                      g[w] && R.push(g[w]);
                  U = R.length,
                  0 === U ? d.activing = null : 1 === U ? d.activing = {
                      point: R[0]
                  } : (t = R[U - 1],
                  d.activing = {
                      point: t,
                      selections: R.splice(0, U - 1)
                  }),
                  N.redraw()
              }
          }
      }
      ,
      Ai.prototype._canDeletePoint = function(B, d) {
          var R = this.target;
          if (!(R instanceof n.Edge))
              return !0;
          var q = B._curves[0]
            , i = B._curves[B._curves.length - 1];
          return q._p1 === d || i._p4 === d ? !1 : !0
      }
      ,
      Ai.prototype.handleDelete = function() {
          var N = this;
          if (N.activing && N.screenInfo) {
              var I = n.Default.isShiftDown()
                , C = N.screenInfo.curve;
              N._canDeletePoint(C, N.activing.point) && C.deleteRealPoint(N.activing.point, I),
              N.activing.selections && N.activing.selections.forEach(function(Q) {
                  N._canDeletePoint(C, Q) && C.deleteRealPoint(Q, I)
              }),
              N.activing = null,
              delete N.editing,
              delete N.tipInfo,
              delete N.edgeEditResult,
              delete N._pan,
              delete N._multiSelect,
              N._writeToHt(),
              N._interactor.fp("deleteShapePoint", !1, !0)
          }
      }
      ,
      Ai.prototype.handleDoubleClick = function(h) {
          var H = this
            , N = H._interactor._getLogicalPoint(h);
          if (H.screenInfo && H._checkEditRealPoint(N)) {
              var R = H.getCurrentSelectintStatus()
                , C = ml.Curve.PointType;
              return R = R === C.Mirrored ? C.Straight : C.Mirrored,
              H._setCurrentSelectionStatus(R),
              H._interactor._42(),
              !0
          }
      }
      ,
      Ai.prototype._drawHighlight = function(P) {
          var H = this
            , s = H.highlight;
          if (s) {
              var w = s.bezier
                , r = H._interactor;
              w && ml.Icons.DrawIcon(r, P, ml.Icons.ShapeHighlightCurve, [w._p1.x, w._p1.y, w._p2.x, w._p2.y, w._p3.x, w._p3.y, w._p4.x, w._p4.y]);
              var t = s.point;
              t && "insertKnot" === s.type && ml.Icons.DrawIcon(r, P, ml.Icons.ShapeHighlighPoint, t)
          }
      }
      ,
      Ai.prototype._drawGuide = function(e) {
          var n = this
            , Z = n._guideInfo;
          if (Z) {
              var X, g, B, E, P = Z.v;
              for (X = 0; 2 > X; X++)
                  if (E = 0 === X ? Z.xList : Z.yList)
                      for (g = 0,
                      B = E.length; B > g; g++)
                          ml.Icons.DrawIcon(n._interactor, e, ml.Icons.ShapeGuideLine, [P.x, P.y, E[g].x, E[g].y])
          }
      }
      ,
      Ai.prototype._drawCurrentPoint = function(C) {
          var W = this;
          if (W.activing) {
              var B = W.activing
                , J = W.getCurrentSelectintStatus()
                , v = W._interactor;
              if (J !== ml.Curve.PointType.Straight) {
                  var K = B.pairs;
                  B.hlpair,
                  B.hltype;
                  var M = B.selections
                    , k = B.editingCtrl;
                  if (K && !M) {
                      var N, Z, F;
                      for (Z = 0,
                      F = K.length; F > Z; Z++)
                          N = K[Z],
                          k && Z === k.pairId && N[k.type] ? ml.Icons.DrawIcon(v, C, ml.Icons.ShapeActivingCtrl, {
                              point: N.point,
                              c1: N.c1,
                              c2: N.c2,
                              hl: k.type
                          }) : ml.Icons.DrawIcon(v, C, ml.Icons.ShapeActivingCtrl, N)
                  }
              }
              ml.Icons.DrawIcon(v, C, ml.Icons.ShapeHighlighRealPoint, W.activing.point),
              M && M.forEach(function(o) {
                  ml.Icons.DrawIcon(v, C, ml.Icons.ShapeHighlighRealPoint, o)
              })
          }
      }
      ,
      Ai.prototype.clear = function() {
          var N = this;
          N.editing = null,
          N._guideInfo = null,
          N.activing = null,
          N.highlight = null
      }
      ,
      Ai.prototype._42 = function(D) {
          var L = this;
          L.info = {},
          L.editing || (L.screenInfo = null);
          var y = L._interactor;
          if (!y.editDetail)
              return L.clear(),
              void 0;
          var F = y.gv;
          if (!L.target || !F.isSelected(L.target) || !F.isVisible(L.target))
              return y.editDetail = !1,
              L.clear(),
              void 0;
          if (L.gatherSingleTarget(F, L.target),
          ml.Icons.DrawIcon(y, D, ml.Icons.ShapeBgCurve, L.screenInfo),
          L._interactor.getStyle("curveElevationVisible") && (L.target instanceof n.Polyline || L.target instanceof n.Edge && L._interactor.getStyle("edgeElevationEditable")) && L.activing) {
              var G = L.activing.getCurrentEditingPoint();
              G && "string" != typeof G.e && ml.Icons.DrawIcon(y, D, ml.Icons.EdgeElevationGuide, G)
          }
          if (L._drawHighlight(D),
          L._drawCurrentPoint(D),
          L._getRealPoint().forEach(function(l) {
              ml.Icons.DrawIcon(y, D, ml.Icons.ShapePoint, l)
          }),
          L._drawGuide(D),
          L.tipInfo && L._interactor.getStyle("curveTipVisible") && ml.Icons.DrawIcon(y, D, ml.Icons.TipHelper, L.tipInfo),
          L._edgeHostGuideInfo && y._drawHostGuide(L._edgeHostGuideInfo),
          L.edgeEditResult && L._drawEdgeHostHighlight(D, L.edgeEditResult.host, L.edgeEditResult.anchor),
          L._multiSelect && L._multiSelect.endPoint) {
              var N = n.Default.unionPoint(ml.toScreenPosition(F, L._multiSelect.startPoint), ml.toScreenPosition(F, L._multiSelect.endPoint));
              N.color = F.getRectSelectBorderColor(),
              D.save(),
              D.setTransform(1, 0, 0, 1, 0, 0);
              var J = W.devicePixelRatio
                , V = N.borderWidth = Math.round(J);
              V /= 2,
              N.x = Math.round(N.x * J) + V,
              N.y = Math.round(N.y * J) + V,
              N.width = Math.round(N.width * J),
              N.height = Math.round(N.height * J),
              ml.Icons.DrawIcon(y, D, ml.Icons.SimpleRect, N),
              D.restore()
          }
      }
      ,
      Ai.prototype._drawEdgeHostHighlight = function(C, J, M) {
          this.drawEdgeHostHighlight(C, J, M),
          this._interactor.redraw()
      }
      ,
      Ai.prototype.drawEdgeHostHighlight = function(u, a, g) {
          if (ji(a)) {
              var c, M, X, f, K = this, n = K._interactor, G = n.gv, s = G.getDataUI(a), Q = mo(s), x = [];
              for (X = 0,
              f = Q.points.length; f > X; X++)
                  M = ml.toScreenPosition(G, Q.points.get(X)),
                  x.push(M.x, M.y);
              Q.segments && (c = Q.segments.toArray());
              var k = n.getStyle("edgeHostHighlighPeriod")
                , A = n.getStyle("edgeHostEdgeHighlighColor");
              ml.Icons.DrawIcon(n, u, ml.Icons.ShapeBgCurve, {
                  P: x,
                  S: c,
                  color: A,
                  dynamicVisible: g.index === V,
                  dynamicPeriod: k
              }),
              A = n.getStyle("edgeHostPointHighlighColor");
              var d = Rl(s);
              for (X = 0,
              f = d.length; f > X; X++) {
                  var I = d[X]
                    , y = ml.toScreenPosition(G, I);
                  ml.Icons.DrawIcon(n, u, ml.Icons.ShapePoint, {
                      point: {
                          x: y.x,
                          y: y.y
                      },
                      color: A,
                      size: 12,
                      dynamicVisible: X === g.index,
                      dynamicPeriod: k
                  })
              }
          }
      }
      ,
      Ai.prototype._getRealPoint = function() {
          var y, i = this.screenInfo, w = i.P, z = i.S, K = -1, C = [], q = -1, L = z.length;
          return z.each(function(V) {
              q++;
              var f = 1;
              if (3 === V)
                  f = 2;
              else if (4 === V)
                  f = 3;
              else if (5 === V)
                  return;
              K += f,
              y = q + 1 >= L ? !0 : 1 === z.get(q + 1) ? !0 : !1,
              C.push({
                  point: {
                      x: w[2 * K],
                      y: w[2 * K + 1]
                  },
                  segmentIndex: q,
                  pointIndex: K,
                  isEnd: y
              })
          }),
          C
      }
      ,
      Ai.prototype.getEditingPointsInfo = function(M) {
          var Q = this
            , J = Q.activing;
          if (!J)
              return !1;
          var S = J.point;
          if (!S)
              return !1;
          var d = this._getRealPoint()
            , u = [{
              screen: S
          }];
          J.selections && J.selections.forEach(function(l) {
              u.push({
                  screen: l
              })
          });
          var n, e, Y = d.length;
          return u.forEach(function(N) {
              for (n = 0; Y > n; n++)
                  if (e = d[n],
                  N.screen.isNearEnough(e.point)) {
                      N.segmentIndex = e.segmentIndex,
                      N.pointIndex = e.pointIndex,
                      N.point = Q.target.getPoints().get(e.pointIndex);
                      break
                  }
          }),
          M && u.sort(function(J, p) {
              return J.segmentIndex - p.segmentIndex
          }),
          u
      }
      ;
      var lr = ml.MoveHelper = function(S) {
          var G = this;
          G.catalog = "Move",
          G._interactor = S
      }
      ;
      lr.prototype = {},
      lr.prototype.constructor = lr,
      lr.prototype.calcShift = function(p, M, G) {
          var d, o, P = this, v = P._interactor.gv, x = v.lp(M);
          if ("beginMove" === p && P._gatherGridInfo(G._lastLogicalPoint || x),
          d = P._target) {
              var S = d.downPosition;
              if (S) {
                  var w = P._interactor.getStyle("moveSensitivity") / v._zoom;
                  if (S.distanceTo(x) < w)
                      return {
                          x: 0,
                          y: 0
                      };
                  delete d.downPosition
              }
              var T;
              o = n.Default.isShiftDown(M),
              o && (x = P._dealShiftDown(x),
              T = d.shiftGuide.dir);
              var E, t = d.rawPos = {
                  x: d.pos.x + x.x - d.lp.x,
                  y: d.pos.y + x.y - d.lp.y
              };
              if (n.Default.isCtrlDown(M)) {
                  if (E = P._calcShiftByAddon(),
                  P._target.node instanceof ml.Group) {
                      var k = P._target.node;
                      k._position.x += E.x,
                      k._position.y += E.y
                  }
                  return E
              }
              var X = P._interactor.rectGuide;
              if (d.node instanceof n.Data && d.node.s("2d.attachable")) {
                  var O = P._calcAttachNodeShift(d.node, t);
                  if (X.clear(),
                  O)
                      return O
              }
              for (var $, K = d.x + t.x, A = d.y + t.y, b = {
                  x: K,
                  y: A
              }, F = {
                  x: K + d.w / 2,
                  y: A + d.h / 2
              }, s = {
                  x: K + d.w,
                  y: A + d.h
              }, D = P._interactor.gridGuide, j = [X.findClosest(b, T), X.findClosest(F, T), X.findClosest(s, T), D.findClosest(b, T), D.findClosest(F, T), D.findClosest(s, T)], f = 1 / 0, N = 1 / 0, q = 0, r = j.length; r > q; q++)
                  $ = j[q],
                  $ && (K = $.x,
                  A = $.y,
                  isFinite(K) && Math.abs(K) < Math.abs(f) && (f = K),
                  isFinite(A) && Math.abs(A) < Math.abs(N) && (N = A));
              if (isFinite(f) || (f = 0),
              isFinite(N) || (N = 0),
              E = P._calcShiftByAddon(f, N),
              P._target.node instanceof ml.Group) {
                  var k = P._target.node;
                  k._position.x += E.x,
                  k._position.y += E.y
              }
              var H = d.node;
              if (!dn(H, v)) {
                  var i = t.x + f
                    , W = t.y + N;
                  P._interactor.rectGuide.gatherLines({
                      node: H,
                      x: d.x + i,
                      y: d.y + W,
                      w: d.w,
                      h: d.h
                  }, T)
              }
              return E
          }
      }
      ,
      lr.prototype._calcShiftByAddon = function(z, m) {
          var B = this._target
            , Q = B.rawPos
            , J = B.node.getPosition();
          return z = z || 0,
          m = m || 0,
          {
              x: Q.x - J.x + z,
              y: Q.y - J.y + m
          }
      }
      ,
      lr.prototype._dealShiftDown = function(A) {
          var h = this
            , p = h._target.shiftGuide
            , Q = h._target.lp
            , c = Math.abs(A.x - Q.x)
            , X = Math.abs(A.y - Q.y);
          c > X && c > p.limit && "y" === p.dir && (p.dir = "x"),
          X > c && X > p.limit && "x" === p.dir && (p.dir = "y");
          var f = p.dir;
          return "x" === f ? (A.y = Q.y,
          p.limit = Math.max(p.limit, c)) : "y" === f && (A.x = Q.x,
          p.limit = Math.max(p.limit, X)),
          A
      }
      ,
      lr.prototype._isAttachableLineShape = function(M) {
          if (!M.getSegments)
              return !1;
          var Y = M.getSegments();
          if (!Y)
              return !0;
          Y instanceof n.List && (Y = Y.getArray());
          for (var J = 1, H = Y.length; H > J; J++)
              if (2 !== Y[J])
                  return !1;
          return !0
      }
      ,
      lr.prototype._calcAttachNodeShift = function() {
          var R = new le
            , S = new le
            , z = new le
            , o = new le;
          return function(l, M) {
              var T = this._interactor.gv
                , Y = l.getHost()
                , n = T.getDataAt(M, function(O) {
                  return O.s("2d.hostable") ? !0 : !1
              });
              if (n && Y !== n && l.setHost(n),
              !n)
                  return this._edgeHostGuideInfo = null,
                  l.setHost(null);
              var r = this._edgeHostGuideInfo = {
                  corners: ml.getTargetCornersOnScreen(T, n),
                  host: n,
                  attach: -1
              };
              if (this._isAttachableLineShape(n)) {
                  for (var f, _, J, b, v, E, a = n.getPoints(), $ = a.size(), C = n.getPointsMatrix2d(), N = 1 / 0, e = 0; $ > e && (e !== $ - 1 || n.isClosePath()); e++)
                      0 !== e ? S.copy(z) : C.apply(a.get(e), S),
                      C.apply(e === $ - 1 ? a.get(0) : a.get(e + 1), z),
                      R.copy(M).sub(S),
                      o.copy(z).sub(S),
                      f = o.length(),
                      o.divideScalar(f),
                      _ = R.dot(o),
                      0 > _ ? _ = 0 : _ > f && (_ = f),
                      o.multiplyScalar(_).add(S),
                      J = R.copy(M).sub(o).lengthSq(),
                      N > J && (N = J,
                      E = e,
                      b = _,
                      v = f);
                  return Math.sqrt(N) * T.getZoom() > this._interactor.getStyle("attachThreshold") ? (l.s({
                      "attach.index": -1
                  }),
                  l.setHost(null),
                  void 0) : (l.s("attach.offset.opposite") && (b = v - b),
                  l.s({
                      "attach.index": E,
                      "attach.offset": l.s("attach.offset.relative") ? b / v : b
                  }),
                  {
                      x: 0,
                      y: 0
                  })
              }
              var p = T.calculateAttachPoint(n, M);
              if (p) {
                  var c = p.point;
                  return r.attach = p.index,
                  this._calcShiftByAddon(c.x - M.x, c.y - M.y)
              }
          }
      }(),
      lr.prototype._gatherGridInfo = function(S) {
          var v, Z = this, e = Z._interactor, $ = e._getValidSelection();
          if ($.length) {
              if (1 === $.length) {
                  if (v = $[0],
                  !v.getRect)
                      return Z._target = null,
                      void 0
              } else if (v = ml.Group.findOrCreateGroup($),
              !v)
                  return Z._target = null,
                  void 0
          } else {
              var $ = e.gv.sm().getSelection();
              if ($.length && (v = $.get(0),
              !v.getRect))
                  return Z._target = null,
                  void 0
          }
          if (v) {
              var I = v.getPosition()
                , N = v.getRect();
              Z._target = {
                  node: v,
                  x: N.x - I.x,
                  y: N.y - I.y,
                  w: N.width,
                  h: N.height,
                  lp: {
                      x: S.x,
                      y: S.y
                  },
                  pos: {
                      x: I.x,
                      y: I.y
                  },
                  shiftGuide: {
                      dir: "x",
                      limit: 0
                  },
                  downPosition: new ml.Math.Vector2(S)
              },
              e.rectGuide.gatherRects()
          }
      }
      ,
      lr.prototype.clear = function() {
          var H = this;
          H._edgeHostGuideInfo = null,
          H._interactor.rectGuide.clear(),
          H._interactor._42()
      }
      ,
      lr.prototype._42 = function() {
          var s = this._edgeHostGuideInfo;
          s && this._interactor._drawHostGuide(s)
      }
      ;
      var Cg = G.freeze({
          DEPTH_BUFFER_BIT: 256,
          STENCIL_BUFFER_BIT: 1024,
          COLOR_BUFFER_BIT: 16384,
          POINTS: 0,
          LINES: 1,
          LINE_LOOP: 2,
          LINE_STRIP: 3,
          TRIANGLES: 4,
          TRIANGLE_STRIP: 5,
          TRIANGLE_FAN: 6,
          ZERO: 0,
          ONE: 1,
          SRC_COLOR: 768,
          ONE_MINUS_SRC_COLOR: 769,
          SRC_ALPHA: 770,
          ONE_MINUS_SRC_ALPHA: 771,
          DST_ALPHA: 772,
          ONE_MINUS_DST_ALPHA: 773,
          DST_COLOR: 774,
          ONE_MINUS_DST_COLOR: 775,
          SRC_ALPHA_SATURATE: 776,
          FUNC_ADD: 32774,
          BLEND_EQUATION: 32777,
          BLEND_EQUATION_RGB: 32777,
          BLEND_EQUATION_ALPHA: 34877,
          FUNC_SUBTRACT: 32778,
          FUNC_REVERSE_SUBTRACT: 32779,
          BLEND_DST_RGB: 32968,
          BLEND_SRC_RGB: 32969,
          BLEND_DST_ALPHA: 32970,
          BLEND_SRC_ALPHA: 32971,
          CONSTANT_COLOR: 32769,
          ONE_MINUS_CONSTANT_COLOR: 32770,
          CONSTANT_ALPHA: 32771,
          ONE_MINUS_CONSTANT_ALPHA: 32772,
          BLEND_COLOR: 32773,
          ARRAY_BUFFER: 34962,
          ELEMENT_ARRAY_BUFFER: 34963,
          ARRAY_BUFFER_BINDING: 34964,
          ELEMENT_ARRAY_BUFFER_BINDING: 34965,
          STREAM_DRAW: 35040,
          STATIC_DRAW: 35044,
          DYNAMIC_DRAW: 35048,
          BUFFER_SIZE: 34660,
          BUFFER_USAGE: 34661,
          CURRENT_VERTEX_ATTRIB: 34342,
          FRONT: 1028,
          BACK: 1029,
          FRONT_AND_BACK: 1032,
          CULL_FACE: 2884,
          BLEND: 3042,
          DITHER: 3024,
          STENCIL_TEST: 2960,
          DEPTH_TEST: 2929,
          SCISSOR_TEST: 3089,
          POLYGON_OFFSET_FILL: 32823,
          SAMPLE_ALPHA_TO_COVERAGE: 32926,
          SAMPLE_COVERAGE: 32928,
          NO_ERROR: 0,
          INVALID_ENUM: 1280,
          INVALID_VALUE: 1281,
          INVALID_OPERATION: 1282,
          OUT_OF_MEMORY: 1285,
          CW: 2304,
          CCW: 2305,
          LINE_WIDTH: 2849,
          ALIASED_POINT_SIZE_RANGE: 33901,
          ALIASED_LINE_WIDTH_RANGE: 33902,
          CULL_FACE_MODE: 2885,
          FRONT_FACE: 2886,
          DEPTH_RANGE: 2928,
          DEPTH_WRITEMASK: 2930,
          DEPTH_CLEAR_VALUE: 2931,
          DEPTH_FUNC: 2932,
          STENCIL_CLEAR_VALUE: 2961,
          STENCIL_FUNC: 2962,
          STENCIL_FAIL: 2964,
          STENCIL_PASS_DEPTH_FAIL: 2965,
          STENCIL_PASS_DEPTH_PASS: 2966,
          STENCIL_REF: 2967,
          STENCIL_VALUE_MASK: 2963,
          STENCIL_WRITEMASK: 2968,
          STENCIL_BACK_FUNC: 34816,
          STENCIL_BACK_FAIL: 34817,
          STENCIL_BACK_PASS_DEPTH_FAIL: 34818,
          STENCIL_BACK_PASS_DEPTH_PASS: 34819,
          STENCIL_BACK_REF: 36003,
          STENCIL_BACK_VALUE_MASK: 36004,
          STENCIL_BACK_WRITEMASK: 36005,
          VIEWPORT: 2978,
          SCISSOR_BOX: 3088,
          COLOR_CLEAR_VALUE: 3106,
          COLOR_WRITEMASK: 3107,
          UNPACK_ALIGNMENT: 3317,
          PACK_ALIGNMENT: 3333,
          MAX_TEXTURE_SIZE: 3379,
          MAX_VIEWPORT_DIMS: 3386,
          SUBPIXEL_BITS: 3408,
          RED_BITS: 3410,
          GREEN_BITS: 3411,
          BLUE_BITS: 3412,
          ALPHA_BITS: 3413,
          DEPTH_BITS: 3414,
          STENCIL_BITS: 3415,
          POLYGON_OFFSET_UNITS: 10752,
          POLYGON_OFFSET_FACTOR: 32824,
          TEXTURE_BINDING_2D: 32873,
          SAMPLE_BUFFERS: 32936,
          SAMPLES: 32937,
          SAMPLE_COVERAGE_VALUE: 32938,
          SAMPLE_COVERAGE_INVERT: 32939,
          COMPRESSED_TEXTURE_FORMATS: 34467,
          DONT_CARE: 4352,
          FASTEST: 4353,
          NICEST: 4354,
          GENERATE_MIPMAP_HINT: 33170,
          BYTE: 5120,
          UNSIGNED_BYTE: 5121,
          SHORT: 5122,
          UNSIGNED_SHORT: 5123,
          INT: 5124,
          UNSIGNED_INT: 5125,
          FLOAT: 5126,
          DEPTH_COMPONENT: 6402,
          ALPHA: 6406,
          RGB: 6407,
          RGBA: 6408,
          LUMINANCE: 6409,
          LUMINANCE_ALPHA: 6410,
          UNSIGNED_SHORT_4_4_4_4: 32819,
          UNSIGNED_SHORT_5_5_5_1: 32820,
          UNSIGNED_SHORT_5_6_5: 33635,
          FRAGMENT_SHADER: 35632,
          VERTEX_SHADER: 35633,
          MAX_VERTEX_ATTRIBS: 34921,
          MAX_VERTEX_UNIFORM_VECTORS: 36347,
          MAX_VARYING_VECTORS: 36348,
          MAX_COMBINED_TEXTURE_IMAGE_UNITS: 35661,
          MAX_VERTEX_TEXTURE_IMAGE_UNITS: 35660,
          MAX_TEXTURE_IMAGE_UNITS: 34930,
          MAX_FRAGMENT_UNIFORM_VECTORS: 36349,
          SHADER_TYPE: 35663,
          DELETE_STATUS: 35712,
          LINK_STATUS: 35714,
          VALIDATE_STATUS: 35715,
          ATTACHED_SHADERS: 35717,
          ACTIVE_UNIFORMS: 35718,
          ACTIVE_ATTRIBUTES: 35721,
          SHADING_LANGUAGE_VERSION: 35724,
          CURRENT_PROGRAM: 35725,
          NEVER: 512,
          LESS: 513,
          EQUAL: 514,
          LEQUAL: 515,
          GREATER: 516,
          NOTEQUAL: 517,
          GEQUAL: 518,
          ALWAYS: 519,
          KEEP: 7680,
          REPLACE: 7681,
          INCR: 7682,
          DECR: 7683,
          INVERT: 5386,
          INCR_WRAP: 34055,
          DECR_WRAP: 34056,
          VENDOR: 7936,
          RENDERER: 7937,
          VERSION: 7938,
          NEAREST: 9728,
          LINEAR: 9729,
          NEAREST_MIPMAP_NEAREST: 9984,
          LINEAR_MIPMAP_NEAREST: 9985,
          NEAREST_MIPMAP_LINEAR: 9986,
          LINEAR_MIPMAP_LINEAR: 9987,
          TEXTURE_MAG_FILTER: 10240,
          TEXTURE_MIN_FILTER: 10241,
          TEXTURE_WRAP_S: 10242,
          TEXTURE_WRAP_T: 10243,
          TEXTURE_2D: 3553,
          TEXTURE: 5890,
          TEXTURE_CUBE_MAP: 34067,
          TEXTURE_BINDING_CUBE_MAP: 34068,
          TEXTURE_CUBE_MAP_POSITIVE_X: 34069,
          TEXTURE_CUBE_MAP_NEGATIVE_X: 34070,
          TEXTURE_CUBE_MAP_POSITIVE_Y: 34071,
          TEXTURE_CUBE_MAP_NEGATIVE_Y: 34072,
          TEXTURE_CUBE_MAP_POSITIVE_Z: 34073,
          TEXTURE_CUBE_MAP_NEGATIVE_Z: 34074,
          MAX_CUBE_MAP_TEXTURE_SIZE: 34076,
          TEXTURE0: 33984,
          TEXTURE1: 33985,
          TEXTURE2: 33986,
          TEXTURE3: 33987,
          TEXTURE4: 33988,
          TEXTURE5: 33989,
          TEXTURE6: 33990,
          TEXTURE7: 33991,
          TEXTURE8: 33992,
          TEXTURE9: 33993,
          TEXTURE10: 33994,
          TEXTURE11: 33995,
          TEXTURE12: 33996,
          TEXTURE13: 33997,
          TEXTURE14: 33998,
          TEXTURE15: 33999,
          TEXTURE16: 34e3,
          TEXTURE17: 34001,
          TEXTURE18: 34002,
          TEXTURE19: 34003,
          TEXTURE20: 34004,
          TEXTURE21: 34005,
          TEXTURE22: 34006,
          TEXTURE23: 34007,
          TEXTURE24: 34008,
          TEXTURE25: 34009,
          TEXTURE26: 34010,
          TEXTURE27: 34011,
          TEXTURE28: 34012,
          TEXTURE29: 34013,
          TEXTURE30: 34014,
          TEXTURE31: 34015,
          ACTIVE_TEXTURE: 34016,
          REPEAT: 10497,
          CLAMP_TO_EDGE: 33071,
          MIRRORED_REPEAT: 33648,
          FLOAT_VEC2: 35664,
          FLOAT_VEC3: 35665,
          FLOAT_VEC4: 35666,
          INT_VEC2: 35667,
          INT_VEC3: 35668,
          INT_VEC4: 35669,
          BOOL: 35670,
          BOOL_VEC2: 35671,
          BOOL_VEC3: 35672,
          BOOL_VEC4: 35673,
          FLOAT_MAT2: 35674,
          FLOAT_MAT3: 35675,
          FLOAT_MAT4: 35676,
          SAMPLER_2D: 35678,
          SAMPLER_CUBE: 35680,
          VERTEX_ATTRIB_ARRAY_ENABLED: 34338,
          VERTEX_ATTRIB_ARRAY_SIZE: 34339,
          VERTEX_ATTRIB_ARRAY_STRIDE: 34340,
          VERTEX_ATTRIB_ARRAY_TYPE: 34341,
          VERTEX_ATTRIB_ARRAY_NORMALIZED: 34922,
          VERTEX_ATTRIB_ARRAY_POINTER: 34373,
          VERTEX_ATTRIB_ARRAY_BUFFER_BINDING: 34975,
          IMPLEMENTATION_COLOR_READ_TYPE: 35738,
          IMPLEMENTATION_COLOR_READ_FORMAT: 35739,
          COMPILE_STATUS: 35713,
          LOW_FLOAT: 36336,
          MEDIUM_FLOAT: 36337,
          HIGH_FLOAT: 36338,
          LOW_INT: 36339,
          MEDIUM_INT: 36340,
          HIGH_INT: 36341,
          FRAMEBUFFER: 36160,
          RENDERBUFFER: 36161,
          RGBA4: 32854,
          RGB5_A1: 32855,
          RGB565: 36194,
          DEPTH_COMPONENT16: 33189,
          STENCIL_INDEX: 6401,
          STENCIL_INDEX8: 36168,
          DEPTH_STENCIL: 34041,
          RENDERBUFFER_WIDTH: 36162,
          RENDERBUFFER_HEIGHT: 36163,
          RENDERBUFFER_INTERNAL_FORMAT: 36164,
          RENDERBUFFER_RED_SIZE: 36176,
          RENDERBUFFER_GREEN_SIZE: 36177,
          RENDERBUFFER_BLUE_SIZE: 36178,
          RENDERBUFFER_ALPHA_SIZE: 36179,
          RENDERBUFFER_DEPTH_SIZE: 36180,
          RENDERBUFFER_STENCIL_SIZE: 36181,
          FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE: 36048,
          FRAMEBUFFER_ATTACHMENT_OBJECT_NAME: 36049,
          FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL: 36050,
          FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE: 36051,
          COLOR_ATTACHMENT0: 36064,
          DEPTH_ATTACHMENT: 36096,
          STENCIL_ATTACHMENT: 36128,
          DEPTH_STENCIL_ATTACHMENT: 33306,
          NONE: 0,
          FRAMEBUFFER_COMPLETE: 36053,
          FRAMEBUFFER_INCOMPLETE_ATTACHMENT: 36054,
          FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT: 36055,
          FRAMEBUFFER_INCOMPLETE_DIMENSIONS: 36057,
          FRAMEBUFFER_UNSUPPORTED: 36061,
          FRAMEBUFFER_BINDING: 36006,
          RENDERBUFFER_BINDING: 36007,
          MAX_RENDERBUFFER_SIZE: 34024,
          INVALID_FRAMEBUFFER_OPERATION: 1286,
          UNPACK_FLIP_Y_WEBGL: 37440,
          UNPACK_PREMULTIPLY_ALPHA_WEBGL: 37441,
          CONTEXT_LOST_WEBGL: 37442,
          UNPACK_COLORSPACE_CONVERSION_WEBGL: 37443,
          BROWSER_DEFAULT_WEBGL: 37444,
          COMPRESSED_RGB_S3TC_DXT1_EXT: 33776,
          COMPRESSED_RGBA_S3TC_DXT1_EXT: 33777,
          COMPRESSED_RGBA_S3TC_DXT3_EXT: 33778,
          COMPRESSED_RGBA_S3TC_DXT5_EXT: 33779,
          COMPRESSED_RGB_PVRTC_4BPPV1_IMG: 35840,
          COMPRESSED_RGB_PVRTC_2BPPV1_IMG: 35841,
          COMPRESSED_RGBA_PVRTC_4BPPV1_IMG: 35842,
          COMPRESSED_RGBA_PVRTC_2BPPV1_IMG: 35843,
          COMPRESSED_RGB_ETC1_WEBGL: 36196,
          HALF_FLOAT_OES: 36193,
          DOUBLE: 5130,
          READ_BUFFER: 3074,
          UNPACK_ROW_LENGTH: 3314,
          UNPACK_SKIP_ROWS: 3315,
          UNPACK_SKIP_PIXELS: 3316,
          PACK_ROW_LENGTH: 3330,
          PACK_SKIP_ROWS: 3331,
          PACK_SKIP_PIXELS: 3332,
          COLOR: 6144,
          DEPTH: 6145,
          STENCIL: 6146,
          RED: 6403,
          RGB8: 32849,
          RGBA8: 32856,
          RGB10_A2: 32857,
          TEXTURE_BINDING_3D: 32874,
          UNPACK_SKIP_IMAGES: 32877,
          UNPACK_IMAGE_HEIGHT: 32878,
          TEXTURE_3D: 32879,
          TEXTURE_WRAP_R: 32882,
          MAX_3D_TEXTURE_SIZE: 32883,
          UNSIGNED_INT_2_10_10_10_REV: 33640,
          MAX_ELEMENTS_VERTICES: 33e3,
          MAX_ELEMENTS_INDICES: 33001,
          TEXTURE_MIN_LOD: 33082,
          TEXTURE_MAX_LOD: 33083,
          TEXTURE_BASE_LEVEL: 33084,
          TEXTURE_MAX_LEVEL: 33085,
          MIN: 32775,
          MAX: 32776,
          DEPTH_COMPONENT24: 33190,
          MAX_TEXTURE_LOD_BIAS: 34045,
          TEXTURE_COMPARE_MODE: 34892,
          TEXTURE_COMPARE_FUNC: 34893,
          CURRENT_QUERY: 34917,
          QUERY_RESULT: 34918,
          QUERY_RESULT_AVAILABLE: 34919,
          STREAM_READ: 35041,
          STREAM_COPY: 35042,
          STATIC_READ: 35045,
          STATIC_COPY: 35046,
          DYNAMIC_READ: 35049,
          DYNAMIC_COPY: 35050,
          MAX_DRAW_BUFFERS: 34852,
          DRAW_BUFFER0: 34853,
          DRAW_BUFFER1: 34854,
          DRAW_BUFFER2: 34855,
          DRAW_BUFFER3: 34856,
          DRAW_BUFFER4: 34857,
          DRAW_BUFFER5: 34858,
          DRAW_BUFFER6: 34859,
          DRAW_BUFFER7: 34860,
          DRAW_BUFFER8: 34861,
          DRAW_BUFFER9: 34862,
          DRAW_BUFFER10: 34863,
          DRAW_BUFFER11: 34864,
          DRAW_BUFFER12: 34865,
          DRAW_BUFFER13: 34866,
          DRAW_BUFFER14: 34867,
          DRAW_BUFFER15: 34868,
          MAX_FRAGMENT_UNIFORM_COMPONENTS: 35657,
          MAX_VERTEX_UNIFORM_COMPONENTS: 35658,
          SAMPLER_3D: 35679,
          SAMPLER_2D_SHADOW: 35682,
          FRAGMENT_SHADER_DERIVATIVE_HINT: 35723,
          PIXEL_PACK_BUFFER: 35051,
          PIXEL_UNPACK_BUFFER: 35052,
          PIXEL_PACK_BUFFER_BINDING: 35053,
          PIXEL_UNPACK_BUFFER_BINDING: 35055,
          FLOAT_MAT2x3: 35685,
          FLOAT_MAT2x4: 35686,
          FLOAT_MAT3x2: 35687,
          FLOAT_MAT3x4: 35688,
          FLOAT_MAT4x2: 35689,
          FLOAT_MAT4x3: 35690,
          SRGB: 35904,
          SRGB8: 35905,
          SRGB8_ALPHA8: 35907,
          COMPARE_REF_TO_TEXTURE: 34894,
          RGBA32F: 34836,
          RGB32F: 34837,
          RGBA16F: 34842,
          RGB16F: 34843,
          VERTEX_ATTRIB_ARRAY_INTEGER: 35069,
          MAX_ARRAY_TEXTURE_LAYERS: 35071,
          MIN_PROGRAM_TEXEL_OFFSET: 35076,
          MAX_PROGRAM_TEXEL_OFFSET: 35077,
          MAX_VARYING_COMPONENTS: 35659,
          TEXTURE_2D_ARRAY: 35866,
          TEXTURE_BINDING_2D_ARRAY: 35869,
          R11F_G11F_B10F: 35898,
          UNSIGNED_INT_10F_11F_11F_REV: 35899,
          RGB9_E5: 35901,
          UNSIGNED_INT_5_9_9_9_REV: 35902,
          TRANSFORM_FEEDBACK_BUFFER_MODE: 35967,
          MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS: 35968,
          TRANSFORM_FEEDBACK_VARYINGS: 35971,
          TRANSFORM_FEEDBACK_BUFFER_START: 35972,
          TRANSFORM_FEEDBACK_BUFFER_SIZE: 35973,
          TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN: 35976,
          RASTERIZER_DISCARD: 35977,
          MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS: 35978,
          MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS: 35979,
          INTERLEAVED_ATTRIBS: 35980,
          SEPARATE_ATTRIBS: 35981,
          TRANSFORM_FEEDBACK_BUFFER: 35982,
          TRANSFORM_FEEDBACK_BUFFER_BINDING: 35983,
          RGBA32UI: 36208,
          RGB32UI: 36209,
          RGBA16UI: 36214,
          RGB16UI: 36215,
          RGBA8UI: 36220,
          RGB8UI: 36221,
          RGBA32I: 36226,
          RGB32I: 36227,
          RGBA16I: 36232,
          RGB16I: 36233,
          RGBA8I: 36238,
          RGB8I: 36239,
          RED_INTEGER: 36244,
          RGB_INTEGER: 36248,
          RGBA_INTEGER: 36249,
          SAMPLER_2D_ARRAY: 36289,
          SAMPLER_2D_ARRAY_SHADOW: 36292,
          SAMPLER_CUBE_SHADOW: 36293,
          UNSIGNED_INT_VEC2: 36294,
          UNSIGNED_INT_VEC3: 36295,
          UNSIGNED_INT_VEC4: 36296,
          INT_SAMPLER_2D: 36298,
          INT_SAMPLER_3D: 36299,
          INT_SAMPLER_CUBE: 36300,
          INT_SAMPLER_2D_ARRAY: 36303,
          UNSIGNED_INT_SAMPLER_2D: 36306,
          UNSIGNED_INT_SAMPLER_3D: 36307,
          UNSIGNED_INT_SAMPLER_CUBE: 36308,
          UNSIGNED_INT_SAMPLER_2D_ARRAY: 36311,
          DEPTH_COMPONENT32F: 36012,
          DEPTH32F_STENCIL8: 36013,
          FLOAT_32_UNSIGNED_INT_24_8_REV: 36269,
          FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING: 33296,
          FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE: 33297,
          FRAMEBUFFER_ATTACHMENT_RED_SIZE: 33298,
          FRAMEBUFFER_ATTACHMENT_GREEN_SIZE: 33299,
          FRAMEBUFFER_ATTACHMENT_BLUE_SIZE: 33300,
          FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE: 33301,
          FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE: 33302,
          FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE: 33303,
          FRAMEBUFFER_DEFAULT: 33304,
          UNSIGNED_INT_24_8: 34042,
          DEPTH24_STENCIL8: 35056,
          UNSIGNED_NORMALIZED: 35863,
          DRAW_FRAMEBUFFER_BINDING: 36006,
          READ_FRAMEBUFFER: 36008,
          DRAW_FRAMEBUFFER: 36009,
          READ_FRAMEBUFFER_BINDING: 36010,
          RENDERBUFFER_SAMPLES: 36011,
          FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER: 36052,
          MAX_COLOR_ATTACHMENTS: 36063,
          COLOR_ATTACHMENT1: 36065,
          COLOR_ATTACHMENT2: 36066,
          COLOR_ATTACHMENT3: 36067,
          COLOR_ATTACHMENT4: 36068,
          COLOR_ATTACHMENT5: 36069,
          COLOR_ATTACHMENT6: 36070,
          COLOR_ATTACHMENT7: 36071,
          COLOR_ATTACHMENT8: 36072,
          COLOR_ATTACHMENT9: 36073,
          COLOR_ATTACHMENT10: 36074,
          COLOR_ATTACHMENT11: 36075,
          COLOR_ATTACHMENT12: 36076,
          COLOR_ATTACHMENT13: 36077,
          COLOR_ATTACHMENT14: 36078,
          COLOR_ATTACHMENT15: 36079,
          FRAMEBUFFER_INCOMPLETE_MULTISAMPLE: 36182,
          MAX_SAMPLES: 36183,
          HALF_FLOAT: 5131,
          RG: 33319,
          RG_INTEGER: 33320,
          R8: 33321,
          RG8: 33323,
          R16F: 33325,
          R32F: 33326,
          RG16F: 33327,
          RG32F: 33328,
          R8I: 33329,
          R8UI: 33330,
          R16I: 33331,
          R16UI: 33332,
          R32I: 33333,
          R32UI: 33334,
          RG8I: 33335,
          RG8UI: 33336,
          RG16I: 33337,
          RG16UI: 33338,
          RG32I: 33339,
          RG32UI: 33340,
          VERTEX_ARRAY_BINDING: 34229,
          R8_SNORM: 36756,
          RG8_SNORM: 36757,
          RGB8_SNORM: 36758,
          RGBA8_SNORM: 36759,
          SIGNED_NORMALIZED: 36764,
          COPY_READ_BUFFER: 36662,
          COPY_WRITE_BUFFER: 36663,
          COPY_READ_BUFFER_BINDING: 36662,
          COPY_WRITE_BUFFER_BINDING: 36663,
          UNIFORM_BUFFER: 35345,
          UNIFORM_BUFFER_BINDING: 35368,
          UNIFORM_BUFFER_START: 35369,
          UNIFORM_BUFFER_SIZE: 35370,
          MAX_VERTEX_UNIFORM_BLOCKS: 35371,
          MAX_FRAGMENT_UNIFORM_BLOCKS: 35373,
          MAX_COMBINED_UNIFORM_BLOCKS: 35374,
          MAX_UNIFORM_BUFFER_BINDINGS: 35375,
          MAX_UNIFORM_BLOCK_SIZE: 35376,
          MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS: 35377,
          MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS: 35379,
          UNIFORM_BUFFER_OFFSET_ALIGNMENT: 35380,
          ACTIVE_UNIFORM_BLOCKS: 35382,
          UNIFORM_TYPE: 35383,
          UNIFORM_SIZE: 35384,
          UNIFORM_BLOCK_INDEX: 35386,
          UNIFORM_OFFSET: 35387,
          UNIFORM_ARRAY_STRIDE: 35388,
          UNIFORM_MATRIX_STRIDE: 35389,
          UNIFORM_IS_ROW_MAJOR: 35390,
          UNIFORM_BLOCK_BINDING: 35391,
          UNIFORM_BLOCK_DATA_SIZE: 35392,
          UNIFORM_BLOCK_ACTIVE_UNIFORMS: 35394,
          UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES: 35395,
          UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER: 35396,
          UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER: 35398,
          INVALID_INDEX: 4294967295,
          MAX_VERTEX_OUTPUT_COMPONENTS: 37154,
          MAX_FRAGMENT_INPUT_COMPONENTS: 37157,
          MAX_SERVER_WAIT_TIMEOUT: 37137,
          OBJECT_TYPE: 37138,
          SYNC_CONDITION: 37139,
          SYNC_STATUS: 37140,
          SYNC_FLAGS: 37141,
          SYNC_FENCE: 37142,
          SYNC_GPU_COMMANDS_COMPLETE: 37143,
          UNSIGNALED: 37144,
          SIGNALED: 37145,
          ALREADY_SIGNALED: 37146,
          TIMEOUT_EXPIRED: 37147,
          CONDITION_SATISFIED: 37148,
          WAIT_FAILED: 37149,
          SYNC_FLUSH_COMMANDS_BIT: 1,
          VERTEX_ATTRIB_ARRAY_DIVISOR: 35070,
          ANY_SAMPLES_PASSED: 35887,
          ANY_SAMPLES_PASSED_CONSERVATIVE: 36202,
          SAMPLER_BINDING: 35097,
          RGB10_A2UI: 36975,
          INT_2_10_10_10_REV: 36255,
          TRANSFORM_FEEDBACK: 36386,
          TRANSFORM_FEEDBACK_PAUSED: 36387,
          TRANSFORM_FEEDBACK_ACTIVE: 36388,
          TRANSFORM_FEEDBACK_BINDING: 36389,
          COMPRESSED_R11_EAC: 37488,
          COMPRESSED_SIGNED_R11_EAC: 37489,
          COMPRESSED_RG11_EAC: 37490,
          COMPRESSED_SIGNED_RG11_EAC: 37491,
          COMPRESSED_RGB8_ETC2: 37492,
          COMPRESSED_SRGB8_ETC2: 37493,
          COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2: 37494,
          COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2: 37495,
          COMPRESSED_RGBA8_ETC2_EAC: 37496,
          COMPRESSED_SRGB8_ALPHA8_ETC2_EAC: 37497,
          TEXTURE_IMMUTABLE_FORMAT: 37167,
          MAX_ELEMENT_INDEX: 36203,
          TEXTURE_IMMUTABLE_LEVELS: 33503,
          MAX_TEXTURE_MAX_ANISOTROPY_EXT: 34047
      })
        , pj = function() {
          function N(O, D) {
              var W = V;
              return function() {
                  return W || (W = O.getExtension(D)),
                  W
              }
          }
          function w(k, s) {
              s == V && (s = {}),
              s.version = t && (k instanceof WebGL2RenderingContext || G.prototype.toString.call(k) === D) ? 2 : 1,
              s.extensions = function() {
                  for (var p = {}, V = k.getSupportedExtensions(), L = V.length; L--; )
                      p[name] = N(k, V[L]);
                  return p
              }();
              for (var l = G.keys(T), o = 0, n = l.length; n > o; ++o) {
                  var h = l[o];
                  s[h] = k.getParameter(T[h])
              }
              if (s.version > 1) {
                  l = G.keys(m);
                  for (var o = 0, n = l.length; n > o; ++o) {
                      var h = l[o];
                      s[h] = k.getParameter(m[h])
                  }
              }
              return s
          }
          var t = "undefined" != typeof WebGL2RenderingContext
            , D = "[object WebGL2RenderingContext]"
            , T = {
              aliasedLineWidthRange: Cg.ALIASED_LINE_WIDTH_RANGE,
              aliasedPointSizeRange: Cg.ALIASED_POINT_SIZE_RANGE,
              maxCombinedTextureImageUnits: Cg.MAX_COMBINED_TEXTURE_IMAGE_UNITS,
              maxCubeMapTextureSize: Cg.MAX_CUBE_MAP_TEXTURE_SIZE,
              maxFragmentUniformVectors: Cg.MAX_FRAGMENT_UNIFORM_VECTORS,
              maxRenderBufferSize: Cg.MAX_RENDERBUFFER_SIZE,
              maxTextureImageUnits: Cg.MAX_TEXTURE_IMAGE_UNITS,
              maxTextureSize: Cg.MAX_TEXTURE_SIZE,
              maxVaryingVectors: Cg.MAX_VARYING_VECTORS,
              maxVertexAttribs: Cg.MAX_VERTEX_ATTRIBS,
              maxVertexTextureImageUnits: Cg.MAX_VERTEX_TEXTURE_IMAGE_UNITS,
              maxVertexUniformVectors: Cg.MAX_VERTEX_UNIFORM_VECTORS,
              maxViewportDIMs: Cg.MAX_VIEWPORT_DIMS
          }
            , m = {
              max3DTextureSize: Cg.MAX_3D_TEXTURE_SIZE,
              maxArrayTextureLayers: Cg.MAX_ARRAY_TEXTURE_LAYERS,
              maxColorAttachments: Cg.MAX_COLOR_ATTACHMENTS,
              maxCombinedFragmentUniformComponents: Cg.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,
              maxCombinedUniformBlocks: Cg.MAX_COMBINED_UNIFORM_BLOCKS,
              maxCombinedVertexUniformComponents: Cg.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,
              maxDrawBuffers: Cg.MAX_DRAW_BUFFERS,
              maxElementIndex: Cg.MAX_ELEMENT_INDEX,
              maxElementsIndices: Cg.MAX_ELEMENTS_INDICES,
              maxElementsVertices: Cg.MAX_ELEMENTS_VERTICES,
              maxFragmentInpuComponents: Cg.MAX_FRAGMENT_INPUT_COMPONENTS,
              maxFragmentUniformBlocks: Cg.MAX_FRAGMENT_UNIFORM_BLOCKS,
              maxFragmentUniformComponents: Cg.MAX_FRAGMENT_UNIFORM_COMPONENTS,
              maxProgramTexelOffset: Cg.MAX_PROGRAM_TEXEL_OFFSET,
              maxSamples: Cg.MAX_SAMPLES,
              maxTextureLODBias: Cg.MAX_TEXTURE_LOD_BIAS,
              maxTransformFeedbackInterleavedComponents: Cg.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,
              maxTransformFeedbackSeparateAttribs: Cg.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,
              maxTransformFeedbackSeparateComponents: Cg.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,
              maxUniformBlockSize: Cg.MAX_UNIFORM_BLOCK_SIZE,
              maxUniformBufferBindings: Cg.MAX_UNIFORM_BUFFER_BINDINGS,
              maxVaryingComponents: Cg.MAX_VARYING_COMPONENTS,
              maxVertexOutputComponents: Cg.MAX_VERTEX_OUTPUT_COMPONENTS,
              maxVertexUniformBlocks: Cg.MAX_VERTEX_UNIFORM_BLOCKS,
              maxVertexUniformComponents: Cg.MAX_VERTEX_UNIFORM_COMPONENTS,
              minProgramTexelOffset: Cg.MIN_PROGRAM_TEXEL_OFFSET
          };
          return {
              "for": function(V) {
                  var k = V._info;
                  return k || (V._info = k = w(V, k)),
                  k
              }
          }
      }()
        , hs = function() {
          function P(m, v, l) {
              return {
                  def: m,
                  getter: l ? function(j) {
                      var E = pj.for(j);
                      return E.version > 1 ? j.getParameter(v) : m
                  }
                  : function(d) {
                      return d.getParameter(v)
                  }
                  ,
                  setter: l ? function(M, G) {
                      var i = pj.for(M);
                      i.version > 1 && M.pixelStorei(v, G)
                  }
                  : function(W, w) {
                      W.pixelStorei(v, w)
                  }
              }
          }
          function H(_) {
              return "string" == typeof _ ? bd(_) : _.r !== V ? (c[0] = _.r,
              c[1] = _.g,
              c[2] = _.b,
              c[3] = _.a,
              c) : _.red !== V ? (c[0] = _.red,
              c[1] = _.green,
              c[2] = _.blue,
              c[3] = _.alpha,
              c) : _
          }
          function a(R) {
              return k(R) ? Array.prototype.slice.call(R, 0) : R
          }
          function F(_, j, v) {
              this.gl = j,
              this._record = v || {},
              this._branches = {},
              this._leafSync = {},
              this._struct = _;
              for (var T = _.children, R = T.length; R--; ) {
                  var Z = T[R]
                    , J = Z.name;
                  Z.isLeaf ? (this._leafSync[J] = !1,
                  this._record[J] = a(Z.desc.def)) : this._record[J] = {}
              }
          }
          function p(W) {
              function i(H, h) {
                  F.call(this, W, H, h);
                  for (var w = S.length; w--; ) {
                      var n = S[w];
                      this._branches[n._name] = new n._type(H,this._record[n._name])
                  }
              }
              function n(I, b) {
                  function _(k, W) {
                      for (var e = C, v = !1; e--; )
                          k[e] !== W[e] && (k[e] = W[e],
                          v = !0);
                      return v
                  }
                  var m = I.name
                    , r = k(I.desc.def)
                    , C = r && I.desc.def.length;
                  if (I.isLeaf) {
                      var T = I.desc.setter
                        , i = I.desc.parse;
                      G.defineProperty(b, m, {
                          configurable: !1,
                          enumerable: !0,
                          get: function() {
                              return this._record[m]
                          },
                          set: r ? function(j) {
                              i && (j = i(j)),
                              (_(this._record[m], j) || !this._leafSync[m]) && (T(this.gl, this._record[m]),
                              this._leafSync[m] = !0)
                          }
                          : function(n) {
                              this._record[m] === n && this._leafSync[m] || (T(this.gl, n),
                              this._record[m] = n,
                              this._leafSync[m] = !0)
                          }
                      })
                  } else
                      S.push({
                          _name: m,
                          _type: p(I)
                      }),
                      G.defineProperty(b, m, {
                          configurable: !1,
                          enumerable: !0,
                          get: function() {
                              return this._branches[m]
                          },
                          set: function(s) {
                              this._branches[m].apply(s)
                          }
                      })
              }
              var S = [];
              return r(i, F),
              W.forEach(n, i.prototype),
              i
          }
          var c = "undefined" != typeof Float32Array && new Float32Array(4)
            , n = {
              viewport: {
                  def: [0, 0, 0 / 0, 0 / 0],
                  getter: function(B) {
                      return B.getParameter(B.VIEWPORT)
                  },
                  setter: function(C, r) {
                      var U = r[2] !== r[2] ? C.drawingBufferWidth - r[0] : r[2]
                        , B = r[3] !== r[3] ? C.drawingBufferHeight - r[1] : r[3];
                      C.viewport(r[0], r[1], U, B)
                  }
              },
              dither: {
                  def: !1,
                  getter: function(t) {
                      return t.isEnabled(t.DITHER)
                  },
                  setter: function(z, o) {
                      o ? z.enable(z.DITHER) : z.disable(z.DITHER)
                  }
              },
              rasterizerDiscard: {
                  def: !1,
                  getter: function(t) {
                      var A = pj.for(t);
                      return A.version > 1 && t.isEnabled(t.RASTERIZER_DISCARD)
                  },
                  setter: function(f, z) {
                      var U = pj.for(f);
                      1 !== U.version && (z ? f.enable(f.RASTERIZER_DISCARD) : f.disable(f.RASTERIZER_DISCARD))
                  }
              },
              lineWidth: {
                  def: 1,
                  getter: function(X) {
                      return X.lineWidth ? X.getParameter(X.LINE_WIDTH) : 1
                  },
                  setter: function(k, d) {
                      k.lineWidth && k.lineWidth(d)
                  }
              },
              color: {
                  clear: {
                      def: [0, 0, 0, 0],
                      getter: function(b) {
                          return b.getParameter(b.COLOR_CLEAR_VALUE)
                      },
                      setter: function(n, L) {
                          n.clearColor(L[0], L[1], L[2], L[3])
                      },
                      parse: H
                  },
                  mask: {
                      def: [!0, !0, !0, !0],
                      getter: function(i) {
                          return i.getParameter(i.COLOR_WRITEMASK)
                      },
                      setter: function(v, U) {
                          v.colorMask(U[0], U[1], U[2], U[3])
                      }
                  }
              },
              blend: {
                  enabled: {
                      def: !1,
                      getter: function(O) {
                          return O.isEnabled(O.BLEND)
                      },
                      setter: function(G, t) {
                          t ? G.enable(G.BLEND) : G.disable(G.BLEND)
                      }
                  },
                  color: {
                      def: [0, 0, 0, 0],
                      getter: function(w) {
                          return w.getParameter(w.BLEND_COLOR)
                      },
                      setter: function(T, H) {
                          T.blendColor(H[0], H[1], H[2], H[3])
                      },
                      parse: H
                  },
                  equation: {
                      def: [Cg.FUNC_ADD, Cg.FUNC_ADD],
                      getter: function(F) {
                          return [F.getParameter(F.BLEND_EQUATION_RGB), F.getParameter(F.BLEND_EQUATION_ALPHA)]
                      },
                      setter: function(b, N) {
                          b.blendEquationSeparate(N[0], N[1])
                      },
                      parse: function(f) {
                          var Q = f.length;
                          return Q > 1 ? f : 1 === Q ? (c[1] = c[0] = f[0],
                          c) : (c[1] = c[0] = f,
                          c)
                      }
                  },
                  func: {
                      def: [Cg.ONE, Cg.ZERO, Cg.ONE, Cg.ZERO],
                      getter: function(N) {
                          return [N.getParameter(N.BLEND_SRC_RGB), N.getParameter(N.BLEND_DST_RGB), N.getParameter(N.BLEND_SRC_ALPHA), N.getParameter(N.BLEND_DST_ALPHA)]
                      },
                      setter: function(g, K) {
                          g.blendFuncSeparate(K[0], K[1], K[2], K[3])
                      },
                      parse: function(q) {
                          var m = q.length;
                          return m > 3 ? q : (c[2] = c[0] = q[0],
                          c[3] = c[1] = q[1],
                          c)
                      }
                  }
              },
              cullFace: {
                  enabled: {
                      def: !1,
                      getter: function(U) {
                          return U.isEnabled(U.CULL_FACE)
                      },
                      setter: function(C, T) {
                          T ? C.enable(C.CULL_FACE) : C.disable(C.CULL_FACE)
                      }
                  },
                  mode: {
                      def: Cg.BACK,
                      getter: function($) {
                          return $.getParameter($.CULL_FACE_MODE)
                      },
                      setter: function(U, d) {
                          U.cullFace(d)
                      }
                  },
                  frontFace: {
                      def: Cg.CCW,
                      getter: function(F) {
                          return F.getParameter(F.FRONT_FACE)
                      },
                      setter: function(W, X) {
                          W.frontFace(X)
                      }
                  }
              },
              scissor: {
                  enabled: {
                      def: !1,
                      getter: function(l) {
                          return l.isEnabled(l.SCISSOR_TEST)
                      },
                      setter: function(q, n) {
                          n ? q.enable(q.SCISSOR_TEST) : q.disable(q.SCISSOR_TEST)
                      }
                  },
                  box: {
                      def: [0, 0, 0 / 0, 0 / 0],
                      getter: function(q) {
                          return q.getParameter(q.SCISSOR_BOX)
                      },
                      setter: function(M, N) {
                          var z = N[2] !== N[2] ? M.drawingBufferWidth - N[0] : N[2]
                            , L = N[3] !== N[3] ? M.drawingBufferHeight - N[1] : N[3];
                          M.scissor(N[0], N[1], z, L)
                      }
                  }
              },
              depth: {
                  enabled: {
                      def: !1,
                      getter: function(Y) {
                          return Y.isEnabled(Y.DEPTH_TEST)
                      },
                      setter: function(N, D) {
                          D ? N.enable(N.DEPTH_TEST) : N.disable(N.DEPTH_TEST)
                      }
                  },
                  clear: {
                      def: 1,
                      getter: function(S) {
                          return S.getParameter(S.DEPTH_CLEAR_VALUE)
                      },
                      setter: function(B, M) {
                          B.clearDepth(M)
                      }
                  },
                  mask: {
                      def: !0,
                      getter: function(A) {
                          return A.getParameter(A.DEPTH_WRITEMASK)
                      },
                      setter: function(i, h) {
                          i.depthMask(h)
                      }
                  },
                  range: {
                      def: [-1, 1],
                      getter: function(p) {
                          return p.getParameter(p.DEPTH_RANGE)
                      },
                      setter: function(w, M) {
                          w.depthRange(M[0], M[1])
                      }
                  },
                  func: {
                      def: Cg.LESS,
                      getter: function(f) {
                          return f.getParameter(f.DEPTH_FUNC)
                      },
                      setter: function(S, n) {
                          S.depthFunc(n)
                      }
                  }
              },
              stencil: {
                  enabled: {
                      def: !1,
                      getter: function(V) {
                          return V.isEnabled(V.STENCIL_TEST)
                      },
                      setter: function(Q, G) {
                          G ? Q.enable(Q.STENCIL_TEST) : Q.disable(Q.STENCIL_TEST)
                      }
                  },
                  clear: {
                      def: 0,
                      getter: function(Q) {
                          return Q.getParameter(Q.STENCIL_CLEAR_VALUE)
                      },
                      setter: function(F, C) {
                          F.clearStencil(C)
                      }
                  },
                  frontMask: {
                      def: 255,
                      getter: function(Y) {
                          return Y.getParameter(Y.STENCIL_WRITEMASK)
                      },
                      setter: function(e, b) {
                          e.stencilMaskSeparate(e.FRONT, b)
                      }
                  },
                  frontOp: {
                      def: [Cg.KEEP, Cg.KEEP, Cg.KEEP],
                      getter: function(x) {
                          return [x.getParameter(x.STENCIL_FAIL), x.getParameter(x.STENCIL_PASS_DEPTH_FAIL), x.getParameter(x.STENCIL_PASS_DEPTH_PASS)]
                      },
                      setter: function(F, O) {
                          F.stencilOpSeparate(F.FRONT, O[0], O[1], O[2])
                      }
                  },
                  frontFunc: {
                      def: [Cg.ALWAYS, 0, 255],
                      getter: function(l) {
                          return [l.getParameter(l.STENCIL_FUNC), l.getParameter(l.STENCIL_REF), l.getParameter(l.STENCIL_VALUE_MASK)]
                      },
                      setter: function(f, m) {
                          f.stencilFuncSeparate(f.FRONT, m[0], m[1], m[2])
                      }
                  },
                  backMask: {
                      def: 255,
                      getter: function(N) {
                          return N.getParameter(N.STENCIL_BACK_WRITEMASK)
                      },
                      setter: function(V, S) {
                          V.stencilMaskSeparate(V.BACK, S)
                      }
                  },
                  backOp: {
                      def: [Cg.KEEP, Cg.KEEP, Cg.KEEP],
                      getter: function(M) {
                          return [M.getParameter(M.STENCIL_BACK_FAIL), M.getParameter(M.STENCIL_BACK_PASS_DEPTH_FAIL), M.getParameter(M.STENCIL_BACK_PASS_DEPTH_PASS)]
                      },
                      setter: function(h, E) {
                          h.stencilOpSeparate(h.BACK, E[0], E[1], E[2])
                      }
                  },
                  backFunc: {
                      def: [Cg.ALWAYS, 0, 255],
                      getter: function(s) {
                          return [s.getParameter(s.STENCIL_BACK_FUNC), s.getParameter(s.STENCIL_BACK_REF), s.getParameter(s.STENCIL_BACK_VALUE_MASK)]
                      },
                      setter: function($, P) {
                          $.stencilFuncSeparate($.BACK, P[0], P[1], P[2])
                      }
                  }
              },
              hint: {
                  generateMipmap: {
                      def: Cg.DONT_CARE,
                      getter: function(y) {
                          return y.getParameter(y.GENERATE_MIPMAP_HINT)
                      },
                      setter: function(O, k) {
                          O.hint(O.GENERATE_MIPMAP_HINT, k)
                      }
                  },
                  fragmentShaderDerivative: {
                      def: Cg.DONT_CARE,
                      getter: function(H) {
                          var X = pj.for(H);
                          return 1 !== X.version || X.extensions.OES_standard_derivatives ? H.getParameter(Cg.FRAGMENT_SHADER_DERIVATIVE_HINT) : Cg.DONT_CARE
                      },
                      setter: function(i, U) {
                          var o = pj.for(i);
                          return o.version > 1 || o.extensions.OES_standard_derivatives ? (i.hint(Cg.FRAGMENT_SHADER_DERIVATIVE_HINT, U),
                          void 0) : void 0
                      }
                  }
              },
              pixelStore: {
                  packAlignment: P(4, Cg.PACK_ALIGNMENT, !1),
                  unpackAlignment: P(4, Cg.UNPACK_ALIGNMENT, !1),
                  unpackFlipY: P(!1, Cg.UNPACK_FLIP_Y_WEBGL, !1),
                  unpackPremultiplyAlpha: P(!1, Cg.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1),
                  unpackColorspaceConversion: P(Cg.BROWSER_DEFAULT_WEBGL, Cg.UNPACK_COLORSPACE_CONVERSION_WEBGL, !1),
                  packRowLength: P(0, Cg.PACK_ROW_LENGTH, !0),
                  packSkipPixels: P(0, Cg.PACK_SKIP_PIXELS, !0),
                  packSkipRows: P(0, Cg.PACK_SKIP_ROWS, !0),
                  unpackRowLength: P(0, Cg.UNPACK_ROW_LENGTH, !0),
                  unpackImageHeight: P(0, Cg.UNPACK_IMAGE_HEIGHT, !0),
                  unpackSkipPixels: P(0, Cg.UNPACK_SKIP_PIXELS, !0),
                  unpackSkipRows: P(0, Cg.UNPACK_SKIP_ROWS, !0),
                  unpackSkipImages: P(0, Cg.UNPACK_SKIP_IMAGES, !0)
              },
              polygonOffset: {
                  enabled: {
                      def: !1,
                      getter: function(I) {
                          return I.isEnabled(I.POLYGON_OFFSET_FILL)
                      },
                      setter: function(m, F) {
                          F ? m.enable(m.POLYGON_OFFSET_FILL) : m.disable(m.POLYGON_OFFSET_FILL)
                      }
                  },
                  value: {
                      def: [0, 0],
                      getter: function(A) {
                          return [A.getParameter(A.POLYGON_OFFSET_FACTOR), A.getParameter(A.POLYGON_OFFSET_UNITS)]
                      },
                      setter: function(B, $) {
                          B.polygonOffset($[0], $[1])
                      }
                  }
              },
              sampleCoverage: {
                  enabled: {
                      def: !1,
                      getter: function(b) {
                          return b.isEnabled(b.SAMPLE_COVERAGE)
                      },
                      setter: function(H, J) {
                          J ? H.enable(H.SAMPLE_COVERAGE) : H.disable(H.SAMPLE_COVERAGE)
                      }
                  },
                  alpha: {
                      def: !1,
                      getter: function(E) {
                          return E.isEnabled(E.SAMPLE_ALPHA_TO_COVERAGE)
                      },
                      setter: function($, j) {
                          j ? $.enable($.SAMPLE_ALPHA_TO_COVERAGE) : $.disable($.SAMPLE_ALPHA_TO_COVERAGE)
                      }
                  },
                  value: {
                      def: [1, !1],
                      getter: function(D) {
                          return [D.getParameter(D.SAMPLE_COVERAGE_VALUE), D.getParameter(D.SAMPLE_COVERAGE_INVERT)]
                      },
                      setter: function(r, J) {
                          r.sampleCoverage(J[0], J[1])
                      }
                  }
              }
          }
            , h = ui.create(n, function(J) {
              return "def"in J
          });
          F.prototype.reset = function() {
              for (var L = this._struct.children, c = L.length; c--; ) {
                  var t = L[c]
                    , K = t.name;
                  t.isLeaf ? this[K] = t.desc.def : this._branches[K].reset()
              }
          }
          ,
          F.prototype.save = function(z) {
              z == V && (z = {});
              for (var $ = this._struct.children, h = $.length; h--; ) {
                  var A = $[h]
                    , F = A.name;
                  if (A.isLeaf)
                      z[F] = a(this._record[F]);
                  else {
                      var H = z[F];
                      H == V && (z[F] = H = {}),
                      this._branches[F].save(H)
                  }
              }
              return z
          }
          ,
          F.prototype.sync = function(g, C) {
              for (var G = this._struct.children, P = G.length; P--; ) {
                  var D = G[P]
                    , x = D.name;
                  D.isLeaf ? (C || !this._leafSync[x]) && (g ? (this._record[x] = D.desc.getter(this.gl),
                  this._leafSync[x] = !0) : (D.desc.setter(this.gl, this._record[x]),
                  this._leafSync[x] = !0)) : this._branches[x].sync(g, C)
              }
          }
          ,
          F.prototype.syncLoss = function() {
              for (var W = this._struct.children, h = W.length; h--; ) {
                  var A = W[h];
                  A.isLeaf ? this._leafSync[A.name] = !1 : this._branches[A.name].syncLoss()
              }
          }
          ,
          F.prototype.apply = function(D) {
              for (var u = this._struct.children, S = u.length; S--; ) {
                  var X = u[S]
                    , G = X.name;
                  G in D && (X.isLeaf ? this[G] = D[G] : this._branches[G].apply(D[G]))
              }
          }
          ,
          F.prototype.append = function(G) {
              var y = this._struct.childMap;
              for (var h in G) {
                  var v = y[h];
                  v && (v.isLeaf ? this[h] = G[h] : this._branches[h].append(G[h]))
              }
          }
          ;
          var o = p(h);
          return function(h) {
              var k = h._state;
              return k || (h._state = k = new o(h)),
              k
          }
      }()
        , sk = function() {
          function J(p, L, k, g) {
              if (p) {
                  var v = p.length;
                  if (v != V)
                      for (var K = 0; g > K; ++K)
                          L[k + K] = p[K];
                  else
                      p.toArray && p.toArray(L, k)
              } else
                  for (var K = 0; g > K; ++K)
                      L[k + K] = 0
          }
          function K(N, q, E) {
              var a = N[0];
              if (0 >= a || a > 0)
                  return N;
              var D = q * E
                , R = L[D];
              if (R == V && (L[D] = new Float32Array(D)),
              0 !== q) {
                  J(a, R, 0, E);
                  for (var _ = 1, B = 0; _ !== q; ++_)
                      B += E,
                      J(N[_], R, B, E)
              }
              return R
          }
          function y(Q, h) {
              Q.uniform1f(this.addr, h)
          }
          function W(f, s) {
              f.uniform1fv(this.addr, s)
          }
          function Y(A, Z) {
              if (Z.x != V)
                  A.uniform2f(this.addr, Z.x, Z.y);
              else {
                  var S = L[2];
                  S.set(Z, 0),
                  A.uniform2fv(this.addr, S)
              }
          }
          function u(u, X) {
              u.uniform2fv(this.addr, K(X, this.size, 2))
          }
          function F(v, T) {
              if (T.x != V)
                  v.uniform3f(this.addr, T.x, T.y, T.z);
              else if (T.r != V)
                  v.uniform3f(this.addr, T.r, T.g, T.b);
              else if (T.red != V)
                  v.uniform3f(this.addr, T.red, T.green, T.blue);
              else {
                  var W = L[3];
                  W.set(T, 0),
                  v.uniform3fv(this.addr, W)
              }
          }
          function t(Q, P) {
              Q.uniform3fv(this.addr, K(P, this.size, 3))
          }
          function E(d, U) {
              if ("string" == typeof U && (U = bd(U)),
              U.x != V)
                  d.uniform4f(this.addr, U.x, U.y, U.z, U.w);
              else if (U.r != V)
                  d.uniform4f(this.addr, U.r, U.g, U.b, U.a);
              else if (U.red != V)
                  d.uniform4f(this.addr, U.red, U.green, U.blue, U.alpha);
              else {
                  var h = L[4];
                  h.set(U, 0),
                  d.uniform4fv(this.addr, h)
              }
          }
          function a(R, C) {
              R.uniform4fv(this.addr, K(C, this.size, 4))
          }
          function i(E, Q) {
              E.uniform1i(this.addr, Q)
          }
          function x(h, G) {
              h.uniform1iv(this.addr, G)
          }
          function C(S, F) {
              S.uniform2iv(this.addr, F)
          }
          function g(j, g) {
              j.uniform3iv(this.addr, g)
          }
          function f(A, R) {
              A.uniform4iv(this.addr, R)
          }
          function w(d, E) {
              d.uniform1i(this.addr, S[E ? 1 : 0])
          }
          function $(z, d) {
              var q = L[4];
              q.set(d, 0),
              z.uniformMatrix2fv(this.addr, !1, q)
          }
          function I(n, S) {
              n.uniformMatrix2fv(this.addr, !1, K(S, this.size, 4))
          }
          function p(c, E) {
              var F = L[9];
              F.set(E, 0),
              c.uniformMatrix3fv(this.addr, !1, F)
          }
          function D(w, _) {
              w.uniformMatrix3fv(this.addr, !1, K(_, this.size, 9))
          }
          function M(O, Z) {
              var I = L[16];
              I.set(Z, 0),
              O.uniformMatrix4fv(this.addr, !1, I)
          }
          function h(c, p) {
              c.uniformMatrix4fv(this.addr, !1, K(p, this.size, 16))
          }
          function q(C, L) {
              C.uniform1i(this.addr, this.slots[0]),
              C.activeTexture(C.TEXTURE0 + this.slots[0]),
              C.bindTexture(C.TEXTURE_2D, L || C._emptyTexture)
          }
          function R(p, A) {
              p.uniform1iv(this.addr, this.slots);
              for (var g = this.slots.length; g--; )
                  p.activeTexture(p.TEXTURE0 + this.slots[g]),
                  p.bindTexture(p.TEXTURE_2D, A[g] || p._emptyTexture)
          }
          function l(Z, P) {
              Z.uniform1i(this.addr, this.slots[0]),
              Z.activeTexture(Z.TEXTURE0 + this.slots[0]),
              Z.bindTexture(Z.TEXTURE_CUBE_MAP, P || Z._emptyCubeTexture)
          }
          function U(z, e) {
              z.uniform1iv(this.addr, this.slots);
              for (var D = this.slots.length; D--; )
                  z.activeTexture(z.TEXTURE0 + this.slots[D]),
                  z.bindTexture(z.TEXTURE_CUBE_MAP, e[D] || z._emptyCubeTexture)
          }
          function j(L, I, O) {
              o[L] = [I, O]
          }
          function d(R, Z, P) {
              switch (R.type) {
              case 35678:
              case 35680:
                  if ("uSampler" === P)
                      return [0];
                  if ("uBlendSampler" === P)
                      return [1];
                  for (var I = R.size, z = new Int32Array(I), X = 0; I > X; ++X)
                      z[X] = Z.usedTextureSlot++;
                  return z
              }
              return V
          }
          function n(G, e, m, U, q) {
              this.name = G,
              this.addr = e,
              this.size = U ? m.size : 0,
              this.activeInfo = m,
              this.setter = o[m.type][U ? 1 : 0],
              this.slots = d(m, q, G),
              Eb(this)
          }
          function T(q, p, l, Y) {
              var o = q.name
                , Z = o.length;
              for (s.lastIndex = 0; ; ) {
                  var u = s.exec(o)
                    , H = s.lastIndex
                    , N = u[1]
                    , J = "]" === u[2]
                    , h = u[3];
                  if (J && (N = 0 | N),
                  h === V || "[" === h && H + 2 === Z) {
                      l[N] = new n(N,p,q,h !== V,Y);
                      break
                  }
                  var C = l[N];
                  C == V && (l[N] = C = {}),
                  l = C
              }
          }
          function v(Z, t, A) {
              this.gl = t,
              this._program = A,
              this._leaves = {},
              this._branches = {},
              this._struct = Z
          }
          function Q(l) {
              function i(m, s) {
                  v.call(this, l, m, s);
                  for (var S = d.length; S--; ) {
                      var G = d[S];
                      this._branches[G._name] = new G._type(m,s)
                  }
              }
              function x(F, u) {
                  var X = F.name;
                  if (F.isLeaf) {
                      var E = B("d.setter(this.gl, v);", ["v"], ["d"], [F.desc]);
                      G.defineProperty(u, X, {
                          configurable: !1,
                          enumerable: !0,
                          get: function() {
                              return E
                          },
                          set: E
                      })
                  } else
                      d.push({
                          _name: X,
                          _type: Q(F)
                      }),
                      G.defineProperty(u, X, {
                          configurable: !1,
                          enumerable: !0,
                          get: function() {
                              return this._branches[X]
                          },
                          set: function(Y) {
                              this._branches[X].apply(Y)
                          }
                      })
              }
              var d = [];
              return r(i, v),
              l.forEach(x, i.prototype),
              i
          }
          function z($, _) {
              for (var I = $.getProgramParameter(_, $.ACTIVE_UNIFORMS), r = {}, d = {
                  usedTextureSlot: 2
              }; I--; ) {
                  var p = $.getActiveUniform(_, I)
                    , A = p.name
                    , E = $.getUniformLocation(_, A);
                  T(p, E, r, d)
              }
              var g = ui.create(r, function(H) {
                  return "addr"in H
              })
                , L = Q(g);
              return G.defineProperty(L.prototype, "textureCount", {
                  configurable: !1,
                  enumerable: !1,
                  writable: !1,
                  value: d.usedTextureSlot
              }),
              new L($,_)
          }
          var L = [];
          if ("function" == typeof Float32Array)
              for (var O = 1; 17 > O; ++O)
                  L[O] = new Float32Array(O);
          var S = new Int32Array([0, 1])
            , o = [];
          j(Cg.FLOAT, y, W),
          j(Cg.FLOAT_VEC2, Y, u),
          j(Cg.FLOAT_VEC3, F, t),
          j(Cg.FLOAT_VEC4, E, a),
          j(Cg.INT, i, x),
          j(Cg.INT_VEC2, C, C),
          j(Cg.INT_VEC3, g, g),
          j(Cg.INT_VEC4, f, f),
          j(Cg.BOOL, w, x),
          j(Cg.BOOL_VEC2, C, C),
          j(Cg.BOOL_VEC3, g, g),
          j(Cg.BOOL_VEC4, f, f),
          j(Cg.FLOAT_MAT2, $, I),
          j(Cg.FLOAT_MAT3, p, D),
          j(Cg.FLOAT_MAT4, M, h),
          j(Cg.SAMPLER_2D, q, R),
          j(Cg.SAMPLER_CUBE, l, U);
          var s = /([\w\d_]+)(\])?(\[|\.)?/g;
          return v.prototype.apply = function(F) {
              for (var I = this._struct.children, H = I.length; H--; ) {
                  var M = I[H]
                    , Q = M.name;
                  Q in F && (M.isLeaf ? this[Q] = F[Q] : this._branches[Q].apply(F[Q]))
              }
          }
          ,
          v.prototype.append = function(h) {
              var Z = this._struct.childMap;
              for (var e in h) {
                  var c = Z[e];
                  c && (c.isLeaf ? this[e] = h[e] : this._branches[e].append(h[e]))
              }
          }
          ,
          function(C, P) {
              var U = P._uniforms;
              return U || (P._uniforms = U = z(C, P)),
              U
          }
      }()
        , Hl = function() {
          function K(Z, Q, z) {
              Q.vertexAttrib1f(Z.addr, z)
          }
          function H(y, k, Q) {
              if (Q.x != V)
                  k.vertexAttrib2f(y.addr, Q.x, Q.y);
              else {
                  var m = f[2];
                  m.set(Q, 0),
                  k.vertexAttrib2fv(y.addr, m)
              }
          }
          function m(r, K, E) {
              if (E.x != V)
                  K.vertexAttrib3f(r.addr, E.x, E.y, E.z);
              else if (E.r != V)
                  K.vertexAttrib3f(r.addr, E.r, E.g, E.b);
              else if (E.red != V)
                  K.vertexAttrib3f(r.addr, E.red, E.green, E.blue);
              else {
                  var l = f[3];
                  l.set(E, 0),
                  K.vertexAttrib3fv(r.addr, l)
              }
          }
          function v(c, r, G) {
              if ("string" == typeof G && (G = bd(G)),
              G.x != V)
                  r.vertexAttrib4f(c.addr, G.x, G.y, G.z, G.w);
              else if (G.r != V)
                  r.vertexAttrib4f(c.addr, G.r, G.g, G.b, G.a);
              else if (G.red != V)
                  r.vertexAttrib4f(c.addr, G.red, G.green, G.blue, G.alpha);
              else {
                  var D = f[4];
                  D.set(G, 0),
                  r.vertexAttrib4fv(c.addr, D)
              }
          }
          function J(t, u, W) {
              W = W.el || W;
              for (var I = 0, h = 0; 2 > I; ++I)
                  u.vertexAttrib2f(t.addr, W[h++], W[h++])
          }
          function e(f, K, q) {
              q = q.el || q;
              for (var m = 0, B = 0; 3 > m; ++m)
                  K.vertexAttrib3f(f.addr, q[B++], q[B++], q[B++])
          }
          function c(Y, e, R) {
              R = R.el || R;
              for (var k = 0, D = 0; 4 > k; ++k)
                  e.vertexAttrib4f(Y.addr, R[D++], R[D++], R[D++], R[D++])
          }
          function U(M, Z, b, c, w, k, d) {
              Z.bindBuffer(Z.ARRAY_BUFFER, b),
              Z.vertexAttribPointer(M.addr, 1, c || Z.FLOAT, !!w, k || 0, d || 0),
              Z.bindBuffer(Z.ARRAY_BUFFER, null)
          }
          function j(B, c, $, A, R, h, Q) {
              c.bindBuffer(c.ARRAY_BUFFER, $),
              c.vertexAttribPointer(B.addr, 2, A || c.FLOAT, !!R, h || 0, Q || 0),
              c.bindBuffer(c.ARRAY_BUFFER, null)
          }
          function W(F, C, g, w, H, u, N) {
              C.bindBuffer(C.ARRAY_BUFFER, g),
              C.vertexAttribPointer(F.addr, 3, w || C.FLOAT, !!H, u || 0, N || 0),
              C.bindBuffer(C.ARRAY_BUFFER, null)
          }
          function O(S, h, T, w, t, J, m) {
              h.bindBuffer(h.ARRAY_BUFFER, T),
              h.vertexAttribPointer(S.addr, 4, w || h.FLOAT, !!t, J || 0, m || 0),
              h.bindBuffer(h.ARRAY_BUFFER, null)
          }
          function F(N, B, $, R, V, x, l) {
              var x = x || 4
                , l = l || 0;
              B.bindBuffer(B.ARRAY_BUFFER, $),
              B.vertexAttribPointer(N.addr, 2, R || B.FLOAT, !!V, x, l),
              B.vertexAttribPointer(N.addr + 1, 2, R || B.FLOAT, !!V, x, l + 2),
              B.bindBuffer(B.ARRAY_BUFFER, null)
          }
          function h(L, p, S, s, D, d, A) {
              var d = d || 9
                , A = A || 0;
              p.bindBuffer(p.ARRAY_BUFFER, S),
              p.vertexAttribPointer(L.addr, 3, s || p.FLOAT, !!D, d, A),
              p.vertexAttribPointer(L.addr + 1, 3, s || p.FLOAT, !!D, d, A + 3),
              p.vertexAttribPointer(L.addr + 2, 3, s || p.FLOAT, !!D, d, A + 6),
              p.bindBuffer(p.ARRAY_BUFFER, null)
          }
          function a(f, V, d, C, u, i, E) {
              var i = i || 16
                , E = E || 0;
              V.bindBuffer(V.ARRAY_BUFFER, d),
              V.vertexAttribPointer(f.addr, 4, C || V.FLOAT, !!u, i, E),
              V.vertexAttribPointer(f.addr + 1, 4, C || V.FLOAT, !!u, i, E + 4),
              V.vertexAttribPointer(f.addr + 2, 4, C || V.FLOAT, !!u, i, E + 8),
              V.vertexAttribPointer(f.addr + 3, 4, C || V.FLOAT, !!u, i, E + 12),
              V.bindBuffer(V.ARRAY_BUFFER, null)
          }
          function q(G, j, n) {
              l[G] = function(G, D, Q, W, t, J) {
                  this.addr == V || this.addr < 0 || (D == V || D === !1 ? G.disableVertexAttribArray(this.addr) : id(D) === b ? (G.enableVertexAttribArray(this.addr),
                  n(this, G, D, Q, W, t, J)) : (G.disableVertexAttribArray(this.addr),
                  j(this, G, D)))
              }
          }
          function g(J, I, A) {
              this.name = J,
              this.addr = I,
              this.activeInfo = A,
              this.setter = l[A.type],
              Eb(this)
          }
          function s(G, j, E) {
              this.gl = j,
              this.program = E,
              this._branches = {},
              this._struct = G
          }
          function P(z) {
              function D(i, K) {
                  s.call(this, z, i, K);
                  for (var b = w.length; b--; ) {
                      var u = w[b];
                      this._branches[u._name] = new u._type(i,K)
                  }
              }
              function Y(Y, A) {
                  var l = Y.name;
                  if (Y.isLeaf) {
                      var b = B("d.setter(this.gl, v);", ["v"], ["d"], [Y.desc]);
                      G.defineProperty(A, l, {
                          configurable: !1,
                          enumerable: !0,
                          get: function() {
                              return b
                          },
                          set: b
                      })
                  } else
                      w.push({
                          _name: l,
                          _type: P(Y)
                      }),
                      G.defineProperty(A, l, {
                          configurable: !1,
                          enumerable: !0,
                          get: function() {
                              return this._branches[l]
                          },
                          set: function(K) {
                              this._branches[l].apply(K)
                          }
                      })
              }
              var w = [];
              return r(D, s),
              z.forEach(Y, D.prototype),
              D
          }
          function M(N, J) {
              for (var h = N.getProgramParameter(J, N.ACTIVE_ATTRIBUTES), n = {}; h--; ) {
                  var O = N.getActiveAttrib(J, h)
                    , s = O.name
                    , X = N.getAttribLocation(J, s);
                  n[s] = new g(s,X,O)
              }
              var f = ui.create(n, function(n) {
                  return "addr"in n
              })
                , p = P(f);
              return new p(N,J)
          }
          var f = [];
          if (Float32Array)
              for (var X = 1; 17 > X; ++X)
                  f[X] = new Float32Array(X);
          var l = []
            , b = "undefined" != typeof WebGLBuffer && WebGLBuffer.prototype;
          return q(Cg.FLOAT, K, U),
          q(Cg.FLOAT_VEC2, H, j),
          q(Cg.FLOAT_VEC3, m, W),
          q(Cg.FLOAT_VEC4, v, O),
          q(Cg.FLOAT_MAT2, J, F),
          q(Cg.FLOAT_MAT3, e, h),
          q(Cg.FLOAT_MAT4, c, a),
          s.prototype.disable = function() {
              for (var x = this._struct.children, $ = x.length; $--; ) {
                  var d = x[$]
                    , p = d.name;
                  d.isLeaf ? this.gl.disableVertexAttribArray(d.desc.addr) : this._branches[p].disable()
              }
          }
          ,
          s.prototype.apply = function(O) {
              for (var C = this._struct.children, t = C.length; t--; ) {
                  var o = C[t]
                    , G = o.name;
                  G in O && (o.isLeaf ? this[G] = O[G] : this._branches[G].apply(O[G]))
              }
          }
          ,
          s.prototype.append = function(S) {
              var e = this._struct.childMap;
              for (var N in S) {
                  var I = e[N];
                  I && (I.isLeaf ? this[N] = S[N] : this._branches[N].append(S[N]))
              }
          }
          ,
          function($, e) {
              var S = e._attribs;
              return S || (e._attribs = S = M($, e)),
              S
          }
      }()
        , Vj = function(n) {
          var _ = this;
          G.defineProperties(this, {
              gl: {
                  configurable: !1,
                  enumerable: !1,
                  value: n,
                  writable: !1
              },
              glState: {
                  configurable: !1,
                  enumerable: !1,
                  value: hs(n),
                  writable: !1
              }
          }),
          _._currProgram = V,
          _._currUniforms = V,
          _._currAttribs = V,
          _._sync = !0
      };
      G.defineProperties(Vj.prototype, {
          program: {
              configurable: !1,
              enumerable: !1,
              get: function() {
                  return this._currProgram
              },
              set: function(u) {
                  var v = this;
                  v._sync && u === v._currProgram || (v.gl.useProgram(u),
                  v._currProgram = u,
                  v._currUniforms = sk(v.gl, u),
                  v._currAttribs = Hl(v.gl, u),
                  v._sync = !0)
              }
          },
          uniforms: {
              configurable: !1,
              enumerable: !1,
              get: function() {
                  var b = this;
                  return b._currProgram && !b._sync && (b.gl.useProgram(b._currProgram),
                  b._sync = !0),
                  b._currUniforms
              },
              set: function($) {
                  var S = this;
                  S._currUniforms && (S._currProgram && !S._sync && (S.gl.useProgram(S._currProgram),
                  this._sync = !0),
                  S._currUniforms.apply($))
              }
          },
          attribs: {
              configurable: !1,
              enumerable: !1,
              get: function() {
                  var H = this;
                  return H._currProgram && !H._sync && (H.gl.useProgram(H._currProgram),
                  H._sync = !0),
                  H._currAttribs
              },
              set: function(x) {
                  var O = this;
                  O._currUniforms && (O._currProgram && !O._sync && (O.gl.useProgram(O._currProgram),
                  this._sync = !0),
                  O._currAttribs.apply(x))
              }
          }
      }),
      Vj.prototype.useProgram = function(S) {
          var m = this;
          m._sync && S === m._currProgram || (m.gl.useProgram(S),
          m._currProgram = S,
          m._currUniforms = sk(m.gl, S),
          m._currAttribs = Hl(m.gl, S),
          m._sync = !0)
      }
      ,
      Vj.prototype.directState = function() {
          return this.glState
      }
      ,
      Vj.prototype.directUniforms = function() {
          return this._currUniforms
      }
      ,
      Vj.prototype.directAttribs = function() {
          return this._currAttribs
      }
      ,
      Vj.prototype.syncLoss = function() {
          this._sync = !1,
          this.glState.syncLoss()
      }
      ,
      Vj.for = function(W) {
          var x = W._renderState;
          return x || (W._renderState = x = new Vj(W)),
          x
      }
      ;
      var bf = "directional"
        , rr = "point"
        , tm = "spot"
        , os = "light.color"
        , qd = {}
        , Yb = function(A, C) {
          Xq(C) && As.test(C) ? $d(A, C) : Ql(C) && C.modelType ? gi(A, C) : C === V ? delete es[A] : es[A] = C
      }
        , $f = function(D) {
          return D
      }
        , Jq = function(Q) {
          Q = M.convertShape3dModelName(Q);
          var $;
          if (Ql(Q)) {
              if (Q.modelType) {
                  if (Q.uuid) {
                      if ($ = es[Q.uuid])
                          return $
                  } else
                      Q.uuid = n.Math.generateUUID();
                  return $ === V && (Qr && Qr[Q.uuid] || gi(Q.uuid, Q)),
                  V
              }
              return Q
          }
          return $ = es[Q],
          Q && $ === V && As.test(Q) && (Qr && Qr[Q] || $d(Q, Q)),
          $
      }
        , fq = function(R, X) {
          R.frameStack ? R.frameStack.push(X) : R.frameStack = [X],
          R.bindFramebuffer(R.FRAMEBUFFER, X)
      }
        , Zp = function(q) {
          var u = q.frameStack;
          if (u) {
              if (u.pop(),
              u.length)
                  return q.bindFramebuffer(q.FRAMEBUFFER, u[u.length - 1]),
                  void 0;
              q.frameStack = null
          }
          q.bindFramebuffer(q.FRAMEBUFFER, null)
      };
      rc(M, {
          graph3dViewAttributes: E,
          graph3dViewFirstPersonMode: !1,
          graph3dViewMouseRoamable: !0,
          graph3dViewMoveStep: 15,
          graph3dViewRotateStep: s / 60,
          graph3dViewBlockSelectable: !0,
          graph3dViewEditHelperDisabled: !1,
          graph3dViewPannable: !0,
          graph3dViewRotatable: !0,
          graph3dViewWalkable: !0,
          graph3dViewResettable: !0,
          graph3dViewZoomable: !0,
          graph3dViewRectSelectable: !0,
          graph3dViewRectSelectBackground: jd,
          graph3dViewGridVisible: !1,
          graph3dViewGridSize: 50,
          graph3dViewGridGap: 50,
          graph3dViewGridColor: [.4, .75, .85, 1],
          graph3dViewRotateMaxPhi: s,
          graph3dViewRotateMinPhi: 0,
          graph3dViewShadowQuality: "high",
          graph3dViewShadowIntensity: .3,
          graph3dViewShadowBias: -.005,
          graph3dViewShadowRadius: .1,
          graph3dViewShadowType: "hard",
          graph3dViewShadowDegreeX: 30,
          graph3dViewShadowDegreeZ: -10,
          graph3dViewOriginAxisVisible: !1,
          graph3dViewCenterAxisVisible: !1,
          graph3dViewAxisXColor: [1, 0, 0, 1],
          graph3dViewAxisYColor: [0, 1, 0, 1],
          graph3dViewAxisZColor: [0, 0, 1, 1],
          graph3dViewEditSizeColor: [1, 1, 0, 1],
          graph3dViewOrtho: !1,
          graph3dViewOrthoWidth: 2e3,
          graph3dViewFovy: s / 4,
          graph3dViewNear: 10,
          graph3dViewFar: 1e4,
          graph3dViewEye: [0, 300, 1e3],
          graph3dViewCenter: [0, 0, 0],
          graph3dViewUp: [0, 1, -1e-7],
          graph3dViewHeadlightRange: 0,
          graph3dViewHeadlightColor: [1, 1, 1, 1],
          graph3dViewHeadlightIntensity: 1,
          graph3dViewHeadlightDisabled: !1,
          graph3dViewHeadlightAmbientIntensity: .7,
          graph3dViewFogDisabled: !0,
          graph3dViewFogMode: "linear",
          graph3dViewFogDensity: 5e-4,
          graph3dViewFogColor: "white",
          graph3dViewFogNear: 1,
          graph3dViewFogFar: 2e3,
          graph3dViewPickerResolution: .5,
          graph3dViewDashDisabled: !0,
          graph3dViewBatchBlendDisabled: !0,
          graph3dViewBatchBrightnessDisabled: !0,
          graph3dViewBatchColorDisabled: !1,
          graph3dMaxVectorCacheTime: 50,
          graph3dEnvmapCapabilityRequire: 8,
          setShape3dModel: Yb,
          getShape3dModel: Jq,
          convertShape3dModelName: $f,
          getShape3dModelMap: function() {
              return es
          },
          getCachedShape3dModelMap: function() {
              return Yo
          },
          createMatrix: function(I, Q) {
              $c(I) || (I = [I]);
              for (var u = I.length - 1; u >= 0; u--) {
                  var A = I[u];
                  Q = lp(A.mat, A.s3, A.r3, A.rotationMode, A.t3, Q)
              }
              return Q
          },
          transformVec: function(b, O) {
              return Wb(b, O)
          },
          glBindFrame: fq,
          glUnbindFrame: Zp,
          createBoxModel: function() {
              return {
                  vs: qj,
                  ns: Sh,
                  uv: $j,
                  is: Vh
              }
          },
          createRoundRectModel: function(I, G) {
              return Md.roundRect(I, G)
          },
          createStarModel: function(F, l) {
              return Md.star(F, l)
          },
          createRectModel: function(Y, M) {
              return Md.rect(Y, M)
          },
          createTriangleModel: function(i, h) {
              return Md.triangle(i, h)
          },
          createRightTriangleModel: function(m, v) {
              return Md.rightTriangle(m, v)
          },
          createParallelogramModel: function(t, d) {
              return Md.parallelogram(t, d)
          },
          createTrapezoidModel: function(u, B) {
              return Md.trapezoid(u, B)
          },
          createSmoothSphereModel: function(X, S, v, n, u, P, z) {
              return _b(new Ob(X,S,v,n,u,P,z))
          },
          createSphereModel: function(d, j, V, Y, l, H, m) {
              return d ? Vb(d, j, V, Y, l, H, m) : M.createSmoothSphereModel()
          },
          createSmoothConeModel: function(E, g, r, N, y) {
              return pb(E, g, r, N, y)
          },
          createConeModel: function(H, g, t, I, y, T) {
              return H ? Le(H, g, t, I, y, T) : pb(T)
          },
          createSmoothCylinderModel: function(M, k, Y, P, S, w, G, z) {
              return _b(new us(M,k,Y,P,S,w,G,z))
          },
          createCylinderModel: function(V, w, X, m, A, i, P, t) {
              return V ? _m(V, w, X, m, A, i, P, t) : Wf(i, P)
          },
          createSmoothTorusModel: function(D, x, w, L, M, W) {
              return _b(new af(D,x,w,L,M,W))
          },
          createTorusModel: function(G, c, j, g, M, T, h, I) {
              return G ? Hn(G, c, j, g, M, T, h, I) : ih(T, h)
          },
          createExtrusionModel: function(I, L, J, v, e, N, x, Q) {
              return zi(I, L, J, v, e, N, x, Q)
          },
          createSmoothRingModel: function(T, z, K, s, y, h) {
              for (var A = [], Y = 0; Y < T.length - 1; Y += 2)
                  A.push({
                      x: T[Y],
                      y: T[Y + 1]
                  });
              for (T = _q(A, z, K)[0],
              A = [],
              Y = 0; Y < T.length; Y++) {
                  var d = T[Y];
                  A.push(new vm(d.x,0,d.y))
              }
              return _b(new uk(A,h,s,y))
          },
          createTextGeometry: function(V, l) {
              return _b(new Al(V,l))
          },
          loadFontFace: function(N, U) {
              M.xhrLoad(N, function(m) {
                  if (!m)
                      return U();
                  var r;
                  try {
                      r = JSON.parse(m)
                  } catch (A) {
                      r = JSON.parse(m.substring(65, m.length - 2))
                  }
                  dh.loadFace(r),
                  U && U(r.familyName.toLowerCase())
              }, U ? null : {
                  sync: !0
              })
          },
          createRingModel: function(w, F, I, e, B, u, a, l, C, d) {
              for (var v = [], z = 0; z < w.length - 1; z += 2)
                  v.push({
                      x: w[z],
                      y: w[z + 1]
                  });
              u = u || M.shapeSide,
              a = a || 0,
              l = l || u;
              var f, J, $, b, X, q, L, c, Z, n, z, R, K, H, G, V, k, D, r = [], y = [], Y = C ? [] : E, p = C ? [] : E, U = d ? [] : E, m = d ? [] : E, i = e ? [] : E, h = e ? [] : E, t = B ? [] : E, _ = B ? [] : E, w = _q(v, F, I), O = oo(w), s = 0, x = 2 * Math.PI / u;
              return w.forEach(function(Q) {
                  if ($ = Q.length,
                  $ > 1) {
                      if (b = Q[0],
                      e)
                          for (q = b.x,
                          c = b.y,
                          z = a; l > z; z++)
                              R = z + 1,
                              K = z * x,
                              H = R * x,
                              G = P(K),
                              V = o(K),
                              k = P(H),
                              D = o(H),
                              i.push(G * q, c, -V * q, k * q, c, -D * q, 0, c, 0),
                              h.push(.5 - .5 * G, .5 - .5 * V, .5 - .5 * k, .5 - .5 * D, .5, .5);
                      for (n = 0; $ > n; n++) {
                          for (X = Q[n],
                          q = b.x,
                          L = X.x,
                          c = b.y,
                          Z = X.y,
                          f = s / O,
                          s += Qf(b, X),
                          J = s / O,
                          z = a; l > z; z++)
                              R = z + 1,
                              K = z * x,
                              H = R * x,
                              G = P(K),
                              V = o(K),
                              k = P(H),
                              D = o(H),
                              r.push(G * L, Z, -V * L, k * L, Z, -D * L, G * q, c, -V * q, k * L, Z, -D * L, k * q, c, -D * q, G * q, c, -V * q),
                              y.push(z / u, J, R / u, J, z / u, f, R / u, J, R / u, f, z / u, f),
                              C && z === a && (Y.push(0, c, 0, 0, Z, 0, G * L, Z, -V * L, G * L, Z, -V * L, G * q, c, -V * q, 0, c, 0),
                              p.push(0, .5 - c, 0, .5 - Z, 2 * L, .5 - Z, 2 * L, .5 - Z, 2 * q, .5 - c, 0, .5 - c)),
                              d && R === l && (U.push(0, c, 0, k * L, Z, -D * L, 0, Z, 0, k * L, Z, -D * L, 0, c, 0, k * q, c, -D * q),
                              m.push(1, .5 - c, 1 - 2 * L, .5 - Z, 1, .5 - Z, 1 - 2 * L, .5 - Z, 1, .5 - c, 1 - 2 * q, .5 - c));
                          b = X
                      }
                      if (B)
                          for (q = b.x,
                          c = b.y,
                          z = a; l > z; z++)
                              R = z + 1,
                              K = z * x,
                              H = R * x,
                              G = P(K),
                              V = o(K),
                              k = P(H),
                              D = o(H),
                              t.push(k * q, c, -D * q, G * q, c, -V * q, 0, c, 0),
                              _.push(.5 - .5 * k, .5 + .5 * D, .5 - .5 * G, .5 + .5 * V, .5, .5)
                  }
              }),
              {
                  vs: r,
                  uv: y,
                  bottom_vs: t,
                  bottom_uv: _,
                  top_vs: i,
                  top_uv: h,
                  from_vs: Y,
                  from_uv: p,
                  to_vs: U,
                  to_uv: m
              }
          }
      }, !0),
      rc(U, {
          "3d.move.mode": V,
          "3d.selectable": !0,
          "3d.visible": !0,
          "3d.movable": !0,
          "3d.editable": !0,
          "3d.clip.direction": null,
          "3d.clip.percentage": 1,
          "3d.reflectable": !0,
          "shape.border.gradient.color": V,
          "edge.gradient.color": V,
          "edge.source.t3": V,
          "edge.target.t3": V,
          "light.type": rr,
          "light.center": [0, 0, 0],
          "light.color": [1, 1, 1, 1],
          "light.disabled": !1,
          "light.angle": s / 4,
          "light.range": 0,
          "light.exponent": 1,
          "light.intensity": 1,
          "wf.visible": !1,
          "wf.width": 1,
          "wf.color": $p,
          "wf.short": !1,
          "wf.mat": V,
          "wf.geometry": !1,
          "wf.loadQuadWireframe": !1,
          "wf.combineTriangle": !0,
          batch: V,
          "transparent.mask": !1,
          brightness: V,
          "select.brightness": .7,
          "repeat.uv.length": V,
          "shadow.cast": !0,
          "shadow.receive": !0,
          bloom: !1,
          envmap: 0,
          renderTextureSamples: 4,
          alphaTest: .4,
          autorotate: !1,
          fixSizeOnScreen: !1,
          "texture.cache": !1,
          "hide.overlapping.group": V,
          "vector.dynamic": !1,
          "vector.dynamic.maxsize": 2048,
          "texture.scale": 1,
          "geometry.cache": !1,
          "highlight.mode": !1,
          "highlight.visible": !0,
          "highlight.width": .8,
          "highlight.color": "rgba(190, 210, 250, 1)",
          "color.empty": [0, 0, 0, 0],
          "label.face": bn,
          "label.t3": V,
          "label.r3": V,
          "label.texture.scale": 2,
          "label.rotationMode": vp,
          "label.light": !1,
          "label.blend": V,
          "label.reverse.flip": !1,
          "label.reverse.color": ul,
          "label.reverse.cull": !1,
          "label.transparent": !1,
          "label.autorotate": !1,
          "label2.face": bn,
          "label2.t3": V,
          "label2.r3": V,
          "label2.texture.scale": 2,
          "label2.rotationMode": vp,
          "label2.light": !1,
          "label2.blend": V,
          "label2.reverse.flip": !1,
          "label2.reverse.color": ul,
          "label2.reverse.cull": !1,
          "label2.transparent": !1,
          "label2.autorotate": !1,
          "note.face": bn,
          "note.t3": V,
          "note.r3": V,
          "note.texture.scale": 2,
          "note.rotationMode": vp,
          "note.light": !1,
          "note.blend": V,
          "note.reverse.flip": !1,
          "note.reverse.color": ul,
          "note.reverse.cull": !1,
          "note.transparent": !1,
          "note.autorotate": !1,
          "note2.face": bn,
          "note2.t3": V,
          "note2.r3": V,
          "note2.texture.scale": 2,
          "note2.rotationMode": vp,
          "note2.light": !1,
          "note2.blend": V,
          "note2.reverse.flip": !1,
          "note2.reverse.color": ul,
          "note2.reverse.cull": !1,
          "note2.transparent": !1,
          "note2.autorotate": !1,
          shape3d: V,
          "shape3d.color": Jp,
          "shape3d.top.color": V,
          "shape3d.bottom.color": V,
          "shape3d.from.color": V,
          "shape3d.to.color": V,
          "shape3d.image": V,
          "shape3d.top.image": V,
          "shape3d.bottom.image": V,
          "shape3d.from.image": V,
          "shape3d.to.image": V,
          "shape3d.light": !0,
          "shape3d.side": 0,
          "shape3d.side.from": V,
          "shape3d.side.to": V,
          "shape3d.smooth": V,
          "shape3d.visible": !0,
          "shape3d.from.visible": !0,
          "shape3d.to.visible": !0,
          "shape3d.top.visible": !0,
          "shape3d.bottom.visible": !0,
          "shape3d.torus.radius": .17,
          "shape3d.resolution": 0,
          "shape3d.blend": V,
          "shape3d.opacity": V,
          "shape3d.reverse.flip": !1,
          "shape3d.reverse.color": ul,
          "shape3d.reverse.cull": !1,
          "shape3d.transparent": !1,
          "shape3d.uv.offset": V,
          "shape3d.uv.scale": V,
          "shape3d.top.uv.offset": V,
          "shape3d.top.uv.scale": V,
          "shape3d.bottom.uv.offset": V,
          "shape3d.bottom.uv.scale": V,
          "shape3d.from.uv.offset": V,
          "shape3d.from.uv.scale": V,
          "shape3d.to.uv.offset": V,
          "shape3d.to.uv.scale": V,
          "shape3d.top.cap": V,
          "shape3d.bottom.cap": V,
          "shape3d.start.angle": 0,
          "shape3d.sweep.angle": y,
          "shape3d.point.epsilon": 1e-6,
          "shape3d.discard.selectable": !0,
          "shape3d.top.discard.selectable": !0,
          "shape3d.bottom.discard.selectable": !0,
          "shape3d.from.discard.selectable": !0,
          "shape3d.to.discard.selectable": !0,
          "shape3d.scaleable": !0,
          "shape3d.reflector": !1,
          "shape3d.reflector.color": "rgb(128,128,128)",
          "shape3d.reflector.blur": 0,
          "shape3d.reflector.blur.ratio": 1,
          "shape3d.reflector.background": null,
          "shape3d.reflector.clip": .003,
          "texture.mipmap.max": V,
          "texture.filter": V,
          "texture.filter.min": V,
          "texture.filter.mag": V,
          "texture.wrap": V,
          "points.image": V,
          "points.color": "white",
          "points.transparent": !1,
          "points.size": 20,
          "points.opacity": 1,
          "all.light": !0,
          "all.visible": !0,
          "all.color": Jp,
          "all.image": V,
          "all.blend": V,
          "all.opacity": V,
          "all.reverse.flip": !1,
          "all.reverse.color": ul,
          "all.reverse.cull": !1,
          "all.transparent": !1,
          "all.uv": V,
          "all.uv.offset": V,
          "all.uv.scale": V,
          "all.discard.selectable": !0,
          mat: V,
          "left.mat": V,
          "right.mat": V,
          "top.mat": V,
          "bottom.mat": V,
          "front.mat": V,
          "back.mat": V,
          "edge.source.anchor.elevation": V,
          "edge.target.anchor.elevation": V
      }, !0);
      var dr, Bj = !1, vb = [0, 0, 0, 0], fp = function(P) {
          return P instanceof si
      }, $r = function(i) {
          return [i.x, i.e || 0, i.y]
      }, Ng = function(U, Z, j) {
          for (var Z = bd(Z || 0), o = Z[0], s = Z[1], l = Z[2]; j--; )
              U.push(o, s, l)
      }, dg = function(Q, k, A) {
          for (var k = bd(k || 0), q = k[0], D = k[1], B = k[2], V = k[3]; A--; )
              Q.push(q, D, B, V)
      }, Mg = function(t, x, P) {
          if (x)
              for (var Y, q, b, e = x[0], u = x[1], $ = x[2], f = x[4], A = x[5], F = x[6], i = x[8], r = x[9], j = x[10], c = x[12], U = x[13], K = x[14], Z = P.length, O = 0, O = 0; Z > O; O += 3)
                  Y = P[O],
                  q = P[O + 1],
                  b = P[O + 2],
                  t.push(e * Y + f * q + i * b + c, u * Y + A * q + r * b + U, $ * Y + F * q + j * b + K);
          else
              ph(t, P)
      }, Nf = function(r, Y) {
          var U = Y.s("light.intensity")
            , K = bd(Y.s(os))
            , T = K[0]
            , J = K[1]
            , Q = K[2];
          1 !== U && (T *= U,
          J *= U,
          Q *= U),
          r.push(T, J, Q, Y.s("light.disabled") ? 1 : 0)
      }, Wc = function(i, I) {
          var b = Vj.for(I)
            , $ = b.directUniforms();
          $.uHeadlightRange = i._headlightRange,
          $.uHeadlightAmbientIntensity = i._headlightAmbientIntensity;
          var e = i._headlightIntensity
            , G = bd(i._headlightColor);
          1 !== e && (G = [G[0] * e, G[1] * e, G[2] * e]),
          $.uHeadlightColor = [G[0], G[1], G[2], i._headlightDisabled ? 1 : 0];
          var k = i._59O
            , t = i._spots
            , M = i._dirs;
          if (k.length) {
              var T = []
                , o = []
                , m = [];
              k.forEach(function(E) {
                  Nf(T, E),
                  ph(o, i._transformPointToViewSpace(E.p3())),
                  m.push(E.s("light.range"))
              }),
              $.uPointColor = T,
              $.uPointRange = m,
              $.uPointPosition = o
          }
          if (t.length) {
              var Q = []
                , K = []
                , Y = []
                , c = []
                , W = []
                , l = [];
              t.forEach(function(r) {
                  Nf(Q, r),
                  ph(K, i._transformPointToViewSpace(r.p3())),
                  ph(W, i._transformDirectionToViewSpace(r.p3(), r.s("light.center"))),
                  Y.push(r.s("light.range")),
                  c.push(P(r.s("light.angle") / 2)),
                  l.push(r.s("light.exponent"))
              }),
              $.uSpotColor = Q,
              $.uSpotRange = Y,
              $.uSpotAngle = c,
              $.uSpotExponent = l,
              $.uSpotPosition = K,
              $.uSpotDirection = W
          }
          if (M.length) {
              var j = []
                , v = [];
              M.forEach(function(C) {
                  Nf(j, C),
                  ph(v, i._transformDirectionToViewSpace(C.p3()))
              }),
              $.uDirColor = j,
              $.uDirDirection = v
          }
      }, jr = function(y, o) {
          return Math.max(y.getRotateMinPhi() + Uk, Math.min(y.getRotateMaxPhi() - Uk, o))
      }, ao = function() {
          return .05 + F() / 2
      }, Em = function(j, f, q, L) {
          var x, w = j.getEye();
          return j.isOrtho() ? (x = Bb(j.getCenter(), w),
          x[0] += L[0],
          x[1] += L[1],
          x[2] += L[2]) : x = w,
          nf(f, q, L, x)
      }, nf = function(I, h, U, z) {
          var f = Zk(I, h)
            , P = Bb(z, U, !0)
            , d = Zk(P, h);
          if (u(d) < Uk)
              return E;
          var i = (f - Zk(U, h)) / d;
          return [U[0] + P[0] * i, U[1] + P[1] * i, U[2] + P[2] * i]
      }, El = function(j, e) {
          return {
              x: 2 * j.x - e.x,
              y: 2 * j.y - e.y
          }
      }, Bi = function(L, F, T, x) {
          var V, m;
          if (!L)
              return V = a(F.y - T.y, T.x - F.x),
              {
                  x: F.x + x * o(V),
                  y: F.y + x * P(V)
              };
          if (!T)
              return V = a(L.y - F.y, F.x - L.x),
              {
                  x: F.x + x * o(V),
                  y: F.y + x * P(V)
              };
          var U = Bb([L.x, L.y, 0], [F.x, F.y, 0], !0)
            , I = Bb([T.x, T.y, 0], [F.x, F.y, 0], !0)
            , M = -(U[0] + I[0]) / 2
            , e = -(U[1] + I[1]) / 2
            , K = O(M * M + e * e);
          if (Uk > K)
              return V = a(L.y - F.y, F.x - L.x),
              {
                  x: F.x + x * o(V),
                  y: F.y + x * P(V)
              };
          var G = L.x - F.x
            , c = L.y - F.y
            , E = T.x - F.x
            , C = T.y - F.y
            , y = O(G * G + c * c)
            , Y = O(E * E + C * C);
          V = R(Zk(U, I)) / 2,
          m = U[1] * I[0] - U[0] * I[1] > 0 ? -1 : 1,
          M /= K,
          e /= K;
          var u = x / o(V)
            , f = X(y, Y) / P(V);
          K = Math.min(u, f);
          var l = {
              x: F.x + m * K * M,
              y: F.y + m * K * e
          };
          return T.b && u > Y / P(V) && (l.adjust = !0),
          l
      }, Um = function(u) {
          var B = u[1]
            , f = u[2]
            , U = u[3]
            , D = u[6]
            , _ = u[7]
            , j = u[11];
          u[1] = u[4],
          u[2] = u[8],
          u[3] = u[12],
          u[4] = B,
          u[6] = u[9],
          u[7] = u[13],
          u[8] = f,
          u[9] = D,
          u[11] = u[14],
          u[12] = U,
          u[13] = _,
          u[14] = j
      }, ll = function(u) {
          var $ = u[0]
            , k = u[1]
            , R = u[2]
            , g = u[3]
            , f = u[4]
            , b = u[5]
            , y = u[6]
            , C = u[7]
            , P = u[8]
            , t = u[9]
            , s = u[10]
            , x = u[11]
            , D = u[12]
            , v = u[13]
            , U = u[14]
            , A = u[15]
            , d = $ * b - k * f
            , h = $ * y - R * f
            , n = $ * C - g * f
            , r = k * y - R * b
            , G = k * C - g * b
            , z = R * C - g * y
            , B = P * v - t * D
            , e = P * U - s * D
            , X = P * A - x * D
            , c = t * U - s * v
            , N = t * A - x * v
            , Z = s * A - x * U
            , Y = d * Z - h * N + n * c + r * X - G * e + z * B;
          return Y ? (Y = 1 / Y,
          u[0] = (b * Z - y * N + C * c) * Y,
          u[1] = (R * N - k * Z - g * c) * Y,
          u[2] = (v * z - U * G + A * r) * Y,
          u[3] = (s * G - t * z - x * r) * Y,
          u[4] = (y * X - f * Z - C * e) * Y,
          u[5] = ($ * Z - R * X + g * e) * Y,
          u[6] = (U * n - D * z - A * h) * Y,
          u[7] = (P * z - s * n + x * h) * Y,
          u[8] = (f * N - b * X + C * B) * Y,
          u[9] = (k * X - $ * N - g * B) * Y,
          u[10] = (D * G - v * n + A * d) * Y,
          u[11] = (t * n - P * G - x * d) * Y,
          u[12] = (b * e - f * c - y * B) * Y,
          u[13] = ($ * c - k * e + R * B) * Y,
          u[14] = (v * h - D * r - U * d) * Y,
          u[15] = (P * r - t * h + s * d) * Y,
          void 0) : E
      }, Bg = function(w, F) {
          if (F) {
              var u = F[0]
                , T = F[1]
                , X = F[2];
              w[12] = w[0] * u + w[4] * T + w[8] * X + w[12],
              w[13] = w[1] * u + w[5] * T + w[9] * X + w[13],
              w[14] = w[2] * u + w[6] * T + w[10] * X + w[14],
              w[15] = w[3] * u + w[7] * T + w[11] * X + w[15]
          }
      }, zf = function(p, X) {
          if (X) {
              var Y = X[0]
                , l = X[1]
                , j = X[2];
              p[0] = p[0] * Y,
              p[1] = p[1] * Y,
              p[2] = p[2] * Y,
              p[3] = p[3] * Y,
              p[4] = p[4] * l,
              p[5] = p[5] * l,
              p[6] = p[6] * l,
              p[7] = p[7] * l,
              p[8] = p[8] * j,
              p[9] = p[9] * j,
              p[10] = p[10] * j,
              p[11] = p[11] * j
          }
      }, Fo = function(h, D, S) {
          var j = D[0]
            , g = D[1]
            , n = D[2]
            , e = D[3]
            , o = D[4]
            , O = D[5]
            , y = D[6]
            , J = D[7]
            , F = D[8]
            , B = D[9]
            , p = D[10]
            , V = D[11]
            , M = D[12]
            , I = D[13]
            , C = D[14]
            , f = D[15]
            , A = S[0]
            , q = S[1]
            , b = S[2]
            , H = S[3];
          return h[0] = A * j + q * o + b * F + H * M,
          h[1] = A * g + q * O + b * B + H * I,
          h[2] = A * n + q * y + b * p + H * C,
          h[3] = A * e + q * J + b * V + H * f,
          A = S[4],
          q = S[5],
          b = S[6],
          H = S[7],
          h[4] = A * j + q * o + b * F + H * M,
          h[5] = A * g + q * O + b * B + H * I,
          h[6] = A * n + q * y + b * p + H * C,
          h[7] = A * e + q * J + b * V + H * f,
          A = S[8],
          q = S[9],
          b = S[10],
          H = S[11],
          h[8] = A * j + q * o + b * F + H * M,
          h[9] = A * g + q * O + b * B + H * I,
          h[10] = A * n + q * y + b * p + H * C,
          h[11] = A * e + q * J + b * V + H * f,
          A = S[12],
          q = S[13],
          b = S[14],
          H = S[15],
          h[12] = A * j + q * o + b * F + H * M,
          h[13] = A * g + q * O + b * B + H * I,
          h[14] = A * n + q * y + b * p + H * C,
          h[15] = A * e + q * J + b * V + H * f,
          h
      }, Xg = function(C, g, p, M) {
          var q, n, z, Y, w, f, a, $, y, Z, m = g[0], v = g[1], I = g[2], V = M[0], o = M[1], X = M[2], R = p[0], j = p[1], H = p[2];
          return u(m - R) < Uk && u(v - j) < Uk && u(I - H) < Uk ? vr(C) : (a = m - R,
          $ = v - j,
          y = I - H,
          Z = 1 / O(a * a + $ * $ + y * y),
          a *= Z,
          $ *= Z,
          y *= Z,
          q = o * y - X * $,
          n = X * a - V * y,
          z = V * $ - o * a,
          Z = O(q * q + n * n + z * z),
          Z ? (Z = 1 / Z,
          q *= Z,
          n *= Z,
          z *= Z) : (q = 0,
          n = 0,
          z = 0),
          Y = $ * z - y * n,
          w = y * q - a * z,
          f = a * n - $ * q,
          Z = O(Y * Y + w * w + f * f),
          Z ? (Z = 1 / Z,
          Y *= Z,
          w *= Z,
          f *= Z) : (Y = 0,
          w = 0,
          f = 0),
          C[0] = q,
          C[1] = Y,
          C[2] = a,
          C[3] = 0,
          C[4] = n,
          C[5] = w,
          C[6] = $,
          C[7] = 0,
          C[8] = z,
          C[9] = f,
          C[10] = y,
          C[11] = 0,
          C[12] = -(q * m + n * v + z * I),
          C[13] = -(Y * m + w * v + f * I),
          C[14] = -(a * m + $ * v + y * I),
          C[15] = 1,
          C)
      }, nl = function(X, C, r, o, l) {
          var i = 1 / h(C / 2)
            , V = 1 / (o - l);
          return X[0] = i / r,
          X[1] = 0,
          X[2] = 0,
          X[3] = 0,
          X[4] = 0,
          X[5] = i,
          X[6] = 0,
          X[7] = 0,
          X[8] = 0,
          X[9] = 0,
          X[10] = (l + o) * V,
          X[11] = -1,
          X[12] = 0,
          X[13] = 0,
          X[14] = 2 * l * o * V,
          X[15] = 0,
          X
      }, uq = function(P, v, f, m, C, r, h) {
          var S = 1 / (v - f)
            , M = 1 / (m - C)
            , u = 1 / (r - h);
          return P[0] = -2 * S,
          P[1] = 0,
          P[2] = 0,
          P[3] = 0,
          P[4] = 0,
          P[5] = -2 * M,
          P[6] = 0,
          P[7] = 0,
          P[8] = 0,
          P[9] = 0,
          P[10] = 2 * u,
          P[11] = 0,
          P[12] = (v + f) * S,
          P[13] = (C + m) * M,
          P[14] = (h + r) * u,
          P[15] = 1,
          P
      }, Wj = function(H, O) {
          var h = O[0]
            , k = O[1]
            , s = O[2]
            , M = O[3]
            , $ = h * h + k * k + s * s + M * M
            , g = $ ? 1 / $ : 0;
          return H[0] = -h * g,
          H[1] = -k * g,
          H[2] = -s * g,
          H[3] = M * g,
          H
      }, Gb = function(E, A) {
          var Y = A[0] + A[5] + A[10]
            , F = 0;
          return Y > 0 ? (F = 2 * Math.sqrt(Y + 1),
          E[3] = .25 * F,
          E[0] = (A[6] - A[9]) / F,
          E[1] = (A[8] - A[2]) / F,
          E[2] = (A[1] - A[4]) / F) : A[0] > A[5] & A[0] > A[10] ? (F = 2 * Math.sqrt(1 + A[0] - A[5] - A[10]),
          E[3] = (A[6] - A[9]) / F,
          E[0] = .25 * F,
          E[1] = (A[1] + A[4]) / F,
          E[2] = (A[8] + A[2]) / F) : A[5] > A[10] ? (F = 2 * Math.sqrt(1 + A[5] - A[0] - A[10]),
          E[3] = (A[8] - A[2]) / F,
          E[0] = (A[1] + A[4]) / F,
          E[1] = .25 * F,
          E[2] = (A[6] + A[9]) / F) : (F = 2 * Math.sqrt(1 + A[10] - A[0] - A[5]),
          E[3] = (A[1] - A[4]) / F,
          E[0] = (A[8] + A[2]) / F,
          E[1] = (A[6] + A[9]) / F,
          E[2] = .25 * F),
          E
      }, Xf = function(a, i, v) {
          var s = i[0]
            , y = i[1]
            , r = i[2]
            , Z = i[3]
            , O = s + s
            , B = y + y
            , X = r + r
            , d = s * O
            , F = s * B
            , H = s * X
            , D = y * B
            , q = y * X
            , Q = r * X
            , P = Z * O
            , V = Z * B
            , I = Z * X;
          return a[0] = 1 - (D + Q),
          a[1] = F + I,
          a[2] = H - V,
          a[3] = 0,
          a[4] = F - I,
          a[5] = 1 - (d + Q),
          a[6] = q + P,
          a[7] = 0,
          a[8] = H + V,
          a[9] = q - P,
          a[10] = 1 - (d + D),
          a[11] = 0,
          a[12] = v[0],
          a[13] = v[1],
          a[14] = v[2],
          a[15] = 1,
          a
      }, Lq = function(f, V) {
          if (f.vr.enable) {
              var N = f.vr.getViewMatrix(V);
              if (N)
                  return N
          }
          return Xg(V ? V : zm(), f._eye, f._center, f._up)
      }, Yl = function(l, o) {
          if (l.vr.enable) {
              var N = l.vr.getProjectMatrix();
              if (N)
                  return N
          }
          if (!o && l._computedProjectMatrix)
              return fs(l._computedProjectMatrix);
          var R = l.getAspect()
            , Y = l._near
            , S = l._far
            , D = zm();
          if (l._ortho) {
              var X = l._orthoWidth / 2
                , y = X / R;
              uq(D, -X, X, -y, y, Y, S)
          } else
              nl(D, l._fovy, R, Y, S);
          return D
      }, Yc = function(S, J) {
          if (!S)
              return E;
          var L = 0
            , b = 1
            , o = 2
            , K = []
            , B = 0
            , C = S.length
            , t = C / 3;
          if (J) {
              for (; C > B; B++)
                  K[B] = 0;
              for (B = 0; B < J.length; B += 3) {
                  var k = []
                    , Y = []
                    , Z = [];
                  k[L] = S[3 * J[B + 1] + L] - S[3 * J[B] + L],
                  k[b] = S[3 * J[B + 1] + b] - S[3 * J[B] + b],
                  k[o] = S[3 * J[B + 1] + o] - S[3 * J[B] + o],
                  Y[L] = S[3 * J[B + 2] + L] - S[3 * J[B + 1] + L],
                  Y[b] = S[3 * J[B + 2] + b] - S[3 * J[B + 1] + b],
                  Y[o] = S[3 * J[B + 2] + o] - S[3 * J[B + 1] + o],
                  Z[L] = k[b] * Y[o] - k[o] * Y[b],
                  Z[b] = k[o] * Y[L] - k[L] * Y[o],
                  Z[o] = k[L] * Y[b] - k[b] * Y[L];
                  for (var N = 0; 3 > N; N++)
                      K[3 * J[B + N] + L] += Z[L],
                      K[3 * J[B + N] + b] += Z[b],
                      K[3 * J[B + N] + o] += Z[o]
              }
          } else
              for (B = 0; t > B; B += 3) {
                  var k = []
                    , Y = []
                    , Z = [];
                  k[L] = S[3 * (B + 1) + L] - S[3 * B + L],
                  k[b] = S[3 * (B + 1) + b] - S[3 * B + b],
                  k[o] = S[3 * (B + 1) + o] - S[3 * B + o],
                  Y[L] = S[3 * (B + 2) + L] - S[3 * (B + 1) + L],
                  Y[b] = S[3 * (B + 2) + b] - S[3 * (B + 1) + b],
                  Y[o] = S[3 * (B + 2) + o] - S[3 * (B + 1) + o],
                  Z[L] = k[b] * Y[o] - k[o] * Y[b],
                  Z[b] = k[o] * Y[L] - k[L] * Y[o],
                  Z[o] = k[L] * Y[b] - k[b] * Y[L];
                  for (var N = 0; 3 > N; N++)
                      K[3 * (B + N) + L] = Z[L],
                      K[3 * (B + N) + b] = Z[b],
                      K[3 * (B + N) + o] = Z[o]
              }
          for (B = 0; C > B; B += 3) {
              var F = [];
              F[L] = K[B + L],
              F[b] = K[B + b],
              F[o] = K[B + o];
              var c = O(F[L] * F[L] + F[b] * F[b] + F[o] * F[o]);
              0 === c && (c = Uk),
              F[L] = F[L] / c,
              F[b] = F[b] / c,
              F[o] = F[o] / c,
              K[B + L] = F[L],
              K[B + b] = F[b],
              K[B + o] = F[o]
          }
          return new ld(K)
      }, Yh = function(c, a, S, _) {
          if (S || (S = c.createTexture()),
          a) {
              var G = c.TEXTURE_2D
                , P = c.REPEAT
                , v = c.CLAMP_TO_EDGE
                , C = c.TEXTURE_MIN_FILTER;
              _ = _ || Li;
              var j = _.minFilter || _.filter || c.LINEAR
                , M = _.magFilter || _.filter || c.LINEAR;
              c.activeTexture(c.TEXTURE0),
              cr(c, S),
              c.texImage2D(G, 0, c.RGBA, c.RGBA, c.UNSIGNED_BYTE, a),
              ai(c, c.TEXTURE_MAG_FILTER, M);
              var $ = a.naturalWidth || a.width
                , U = a.naturalHeight || a.height;
              rk.isPOT($) && rk.isPOT(U) && !_.clampToEdge && !a.clampToEdge ? (ai(c, c.TEXTURE_WRAP_S, P),
              ai(c, c.TEXTURE_WRAP_T, P),
              ai(c, C, j === c.NEAREST ? c.NEAREST_MIPMAP_NEAREST : c.LINEAR_MIPMAP_LINEAR),
              _.mipmapMaxLevel !== V && ai(c, c.TEXTURE_MAX_LEVEL, _.mipmapMaxLevel),
              c.generateMipmap(G)) : (ai(c, c.TEXTURE_WRAP_S, v),
              ai(c, c.TEXTURE_WRAP_T, v),
              ai(c, C, j)),
              cr(c, E)
          }
          return S
      }, ik = function(x, X) {
          var B = new Uint8Array(4);
          return X = X || x.createTexture(),
          x.activeTexture(x.TEXTURE0),
          cr(x, X),
          ai(x, x.TEXTURE_MIN_FILTER, x.LINEAR),
          x.texImage2D(x.TEXTURE_2D, 0, x.RGBA, 1, 1, 0, x.RGBA, x.UNSIGNED_BYTE, B),
          X
      }, nn = function(L, d) {
          var v = new Uint8Array(4);
          return d = d || L.createTexture(),
          L.activeTexture(L.TEXTURE0),
          L.bindTexture(L.TEXTURE_CUBE_MAP, d),
          L.texParameteri(L.TEXTURE_CUBE_MAP, L.TEXTURE_MAG_FILTER, L.LINEAR),
          L.texParameteri(L.TEXTURE_CUBE_MAP, L.TEXTURE_MIN_FILTER, L.LINEAR),
          L.texImage2D(L.TEXTURE_CUBE_MAP_POSITIVE_X + 0, 0, L.RGBA, 1, 1, 0, L.RGBA, L.UNSIGNED_BYTE, v),
          L.texImage2D(L.TEXTURE_CUBE_MAP_POSITIVE_X + 1, 0, L.RGBA, 1, 1, 0, L.RGBA, L.UNSIGNED_BYTE, v),
          L.texImage2D(L.TEXTURE_CUBE_MAP_POSITIVE_X + 2, 0, L.RGBA, 1, 1, 0, L.RGBA, L.UNSIGNED_BYTE, v),
          L.texImage2D(L.TEXTURE_CUBE_MAP_POSITIVE_X + 3, 0, L.RGBA, 1, 1, 0, L.RGBA, L.UNSIGNED_BYTE, v),
          L.texImage2D(L.TEXTURE_CUBE_MAP_POSITIVE_X + 4, 0, L.RGBA, 1, 1, 0, L.RGBA, L.UNSIGNED_BYTE, v),
          L.texImage2D(L.TEXTURE_CUBE_MAP_POSITIVE_X + 5, 0, L.RGBA, 1, 1, 0, L.RGBA, L.UNSIGNED_BYTE, v),
          d
      }, gr = function(o) {
          o._26I && o._prg && (o._26I.deleteProgram(o._prg),
          o._prg = E)
      }, cc = function(Q, o, s, j) {
          var I = Q.createShader(s);
          return Q.shaderSource(I, j),
          Q.compileShader(I),
          Q.attachShader(o, I),
          I
      }, Rr = function(D) {
          return D.createBuffer()
      }, cr = function(A, z) {
          A.bindTexture(A.TEXTURE_2D, z || A._emptyTexture)
      }, ai = function(s, v, e) {
          s.texParameteri(s.TEXTURE_2D, v, e)
      }, Hg = function(b, d) {
          var u = Vj.for(b).directState();
          u.polygonOffset.enabled = !0,
          u.polygonOffset.value = d
      }, ac = function(v) {
          var y = Vj.for(v).directState();
          y.polygonOffset.enabled = !1
      }, yf = function(c, R) {
          if (R) {
              var x = Vj.for(c).directState();
              x.color.clear = bd(R)
          }
      }, aj = function(M) {
          var Z = Vj.for(M)
            , k = Z.directUniforms()
            , Q = Z.directAttribs();
          k.uFix = !0,
          Q.aNormal = !1
      }, Dk = function(L) {
          var $ = Vj.for(L)
            , A = $.directUniforms();
          $.directAttribs(),
          A.uFix = !1
      }, Xb = function(o, G, P, Q, T, e, I, D) {
          var _ = Vj.for(o)
            , W = _.directState()
            , Z = _.directUniforms();
          o._picking || (P ? (Z.uBlend = !0,
          Z.uBlendColor = P) : Z.uBlend = !1,
          Z.uLight = Q == E ? !0 : Q,
          te(T) && 1 !== T && (Z.uPartOpacity = T),
          Z.uReverseFlip = e == E ? !1 : e,
          Z.uFixPickReverseColor = I || ul),
          W.cullFace.enabled = D ? !0 : !1
      }, he = function(G) {
          if (!G._picking) {
              var g = Vj.for(G)
                , d = g.directUniforms();
              d.uPartOpacity = 1
          }
      }, nb = function() {
          var t = [0, 0, 1, 1];
          return function(M, w, i, T, Y, g, c, D, r) {
              var d = Vj.for(M)
                , b = d.directUniforms()
                , U = d.directAttribs();
              return i ? (b.uTexture = !0,
              b.uDiscardSelectable = mf(T) ? T : !0,
              U.aUv = Bm(M, Y, g, E, 2),
              r ? (b.uBlendTexture = !0,
              b.uBlendSampler = r) : (b.uBlendTexture = !1,
              b.uBlendSampler = M._emptyBlendTexture),
              b.uSampler = i,
              c ? (t[0] = c[0],
              t[1] = c[1]) : (t[0] = 0,
              t[1] = 0),
              D ? (t[2] = D[0],
              t[3] = D[1]) : (t[2] = 1,
              t[3] = 1),
              b.uOffsetScale = t,
              void 0) : (b.uSampler = M._emptyTexture,
              b.uBlendSampler = M._emptyBlendTexture,
              void 0)
          }
      }(), am = function(k, C, H) {
          var t = Vj.for(k)
            , L = t.directUniforms()
            , n = t.directAttribs();
          k.activeTexture(k.TEXTURE0),
          cr(k, E),
          k.activeTexture(k.TEXTURE1),
          cr(k, E),
          H && (n.aUv = !1,
          L.uTexture = !1,
          L.uSampler = k._emptyTexture,
          L.uBlendTexture = !1,
          L.uBlendSampler = k._emptyBlendTexture)
      }, pl = function(t, y, H, A, P, f) {
          var I = Vj.for(t)
            , r = I.directUniforms()
            , L = I.directAttribs();
          !H || Di || xe || t.lineWidth(H),
          A && !t._picking && (r.uFixPickReverseColor = A),
          P && (L.aPosition = Bm(t, P, f, E))
      }, rp = function(O, U, D, F) {
          dr && (F = O[dr]),
          O.drawArrays(F == E ? O.TRIANGLES : F, U, D);
          var Q = O._renderInfo;
          Q && (Q.calls++,
          Q.vertices += D,
          (F == E || F === O.TRIANGLES) && (Q.faces += D / 3),
          F === O.LINES && (Q.lines += D / 2),
          F === O.POINTS && (Q.points += D))
      }, Hh = function(Q, m, q, M, u) {
          dr && (M = Q[dr]),
          Q.drawElements(M == E ? Q.TRIANGLES : M, q, u == E ? Q.UNSIGNED_SHORT : u, m == E ? 0 : 2 * m);
          var X = Q._renderInfo;
          X && (X.calls++,
          X.vertices += q,
          (M == E || M === Q.TRIANGLES) && (X.faces += q / 3),
          M === Q.LINES && (X.lines += q / 2),
          M === Q.POINTS && (X.points += q))
      }, vo = function(J, L, O) {
          var k = J.ARRAY_BUFFER;
          return J.bindBuffer(k, L),
          O && J.bufferData(k, O, J.STATIC_DRAW),
          L
      }, Bm = function(E, K, R, z, t) {
          return R ? bh(E, E.ARRAY_BUFFER, K, R) : vo(E, K, R, z, t)
      }, pq = function(h, C, c) {
          var P = h.ELEMENT_ARRAY_BUFFER;
          h.bindBuffer(P, C),
          c && h.bufferData(P, c, h.STATIC_DRAW)
      }, se = function(E, O, f) {
          bh(E, E.ELEMENT_ARRAY_BUFFER, O, f)
      }, bh = function(o, y, G, z) {
          var f = z._bufId;
          f || (f = z._bufId = n.Math.generateIncreasingID());
          var G, B = o._bufPool;
          return (G = B[f]) && G._buf ? o.bindBuffer(y, G._buf) : (G = B[f] = {
              _buf: Rr(o)
          },
          o.bindBuffer(y, G._buf),
          o.bufferData(y, z, o.STATIC_DRAW)),
          G._fid = o._renderInfo.frame,
          G._buf
      }, Ed = function(t, b) {
          b != E && b >= 0 && t.enableVertexAttribArray(b)
      }, Cb = function(m, d) {
          d != E && d >= 0 && m.disableVertexAttribArray(d)
      }, uo = function(d, t) {
          var V = d.getGL();
          d._prg;
          var k = Vj.for(V)
            , i = k.directUniforms();
          k.directAttribs(),
          d._7O = d._8O.pop(),
          t && (i.uMVMatrix = d._7O,
          d._6O = t,
          i.uNMatrix = t)
      }, vn = function(E, U) {
          return U || (U = zm()),
          ae(U, E),
          ll(U),
          Um(U),
          U
      }, Fb = function(Q, H) {
          var T = Q.getGL()
            , i = Q._7O
            , M = Vj.for(T)
            , O = M.directUniforms();
          H ? (Q._8O.push(fs(i)),
          O.uMMatrix = H,
          Fo(i, i, H),
          Q._7O = i) : O.uMMatrix = Lm,
          O.uMVMatrix = i,
          O.uNMatrix = vn(i, Q._6O)
      }, jf = {
          body: 0,
          label: 1,
          label2: 2,
          note: 3,
          note2: 4,
          symbol: 5
      }, Jj = 10, Sb = function(K, k, Z, o, G, P) {
          var U;
          if (Z) {
              var J = o._pickId;
              J || (J = o._pickId = k._pickIdUsed,
              k._pickIdUsed += Jj);
              var S, z = jf[G];
              if (null != z)
                  S = J + z;
              else {
                  var E = o._pickExtraPartMap;
                  E || (E = o._pickExtraPartMap = {}),
                  (S = E[G]) || (S = E[G] = k._pickIdUsed++)
              }
              k[S] || (k[S] = {
                  data: o,
                  part: G
              }),
              U = Xp(S)
          } else
              U = vb;
          if (!P) {
              var m = Vj.for(K)
                , a = m.directUniforms();
              a.uFixPickReverseColor = U
          }
          return U
      }, Dl = function(Z, b, K) {
          "target" !== K && (K = "source");
          var v = "target" === K ? b.getTargetAgent() : b.getSourceAgent()
            , y = "edge." + K + ".";
          if (ud(v)) {
              var l = b.s(y + "anchor.x")
                , g = b.s(y + "anchor.elevation")
                , d = b.s(y + "anchor.y")
                , H = Dp(v, Z.getMat(v))
                , p = v.getAnchor3d();
              return Wb([(l === V ? .5 : l) - p.x, (g === V ? .5 : g) - p.y, (d === V ? .5 : d) - p.z], H)
          }
          var T = b.s(y + "index")
            , r = Z.getData3dUI(v);
          if (!r.info || !r.info.list)
              return !1;
          if (T >= 0) {
              var X, N, x, t, Q, M = r.info._lastPointsSegments, i = M.points, B = M.segments, J = -1, f = -1;
              for (x = 0,
              t = B ? B.length : i.length; t > x; x++) {
                  if (N = B ? B.get(x) : 1,
                  3 === N)
                      Q = 2;
                  else if (4 === N)
                      Q = 3;
                  else {
                      if (5 === N)
                          continue;
                      Q = 1
                  }
                  if (J += Q,
                  f++,
                  f === T) {
                      X = i.get(J);
                      break
                  }
              }
              return X || (X = i.get(i.length - 1)),
              [X.x, X.e || 0, X.y]
          }
          var L = b.s(y + "percent") || .5;
          if (L = Math.max(0, Math.min(L, 1)),
          !r || !r.getCache)
              return !1;
          var c = r.getCache()
            , t = c[c.length - 1].length
            , M = Z.getLineOffset(v, L * t)
            , A = M.point;
          return [A.x, A.y, A.z]
      }, wp = function() {
          var n = {
              center: function(I, A, c, Q, $) {
                  var B = -A[1] / 2
                    , E = {
                      x: -A[0] / 2,
                      y: B,
                      width: A[0],
                      height: A[1]
                  }
                    , X = Eo(I, E, c);
                  return [X.x + Q, -X.y - $, ao()]
              },
              front: function(u, r, J, h, Z) {
                  var x = -r[1] / 2
                    , w = {
                      x: -r[0] / 2,
                      y: x,
                      width: r[0],
                      height: r[1]
                  }
                    , E = Eo(u, w, J);
                  return [E.x + h, -E.y - Z, r[2] / 2 + ao()]
              },
              back: function(c, G, d, Z, o) {
                  var q = -G[0] / 2
                    , O = -G[1] / 2
                    , n = {
                      x: q,
                      y: O,
                      width: G[0],
                      height: G[1]
                  }
                    , y = Eo(c, n, d);
                  return [-y.x - Z, -y.y - o, -G[2] / 2 - ao()]
              },
              left: function(_, H, X, J, A) {
                  var n = -H[1] / 2
                    , y = {
                      x: -H[2] / 2,
                      y: n,
                      width: H[2],
                      height: H[1]
                  }
                    , M = Eo(_, y, X);
                  return [-H[0] / 2 - ao(), -M.y - A, M.x + J]
              },
              right: function(W, i, P, k, c) {
                  var N = -i[2] / 2
                    , $ = -i[1] / 2
                    , p = {
                      x: N,
                      y: $,
                      width: i[2],
                      height: i[1]
                  }
                    , G = Eo(W, p, P);
                  return [i[0] / 2 + ao(), -G.y - c, -G.x - k]
              },
              top: function(d, I, x, z, A) {
                  var U = {
                      x: -I[0] / 2,
                      y: -I[2] / 2,
                      width: I[0],
                      height: I[2]
                  }
                    , R = Eo(d, U, x);
                  return [R.x + z, I[1] / 2 + ao(), R.y + A]
              },
              bottom: function(P, E, s, m, O) {
                  var B = -E[2] / 2
                    , L = {
                      x: -E[0] / 2,
                      y: B,
                      width: E[0],
                      height: E[2]
                  }
                    , C = Eo(P, L, s);
                  return [C.x + m, -E[1] / 2 - ao(), -C.y - O]
              }
          };
          return function(b, C, w, O, x, u) {
              return n[O](b, C, w, x || 0, u || 0)
          }
      }(), as = function(n, j, Y, T, K, E, J, e, g, i) {
          if (K && (j[0] += K[0],
          j[1] += K[1],
          j[2] += K[2]),
          Bg(n, Y),
          e) {
              var w = zm();
              if (tl(w, g, i),
              Wb(j, w),
              Bg(n, j),
              n.auto = e,
              n.pos = Wb([0, 0, 0], n),
              E) {
                  var c = n.mat2 = zm();
                  tl(c, E, J)
              }
          } else
              tl(n, g, i),
              Bg(n, j),
              T === Mb ? qp(n, -A) : T === Gq ? qp(n, A) : T === Dj ? sf(n, -A) : T === zg ? sf(n, A) : T === zs && qp(n, s),
              tl(n, E, J);
          return n
      }, Eh = function(p, W) {
          var n = W.auto
            , F = W.mat2
            , l = p.gv;
          if (n) {
              var U, I = zm(), Q = [0, 0, 0, 0];
              U = "string" == typeof n ? [n.indexOf("x") < 0 ? l._eye[0] : l._center[0], n.indexOf("y") < 0 ? l._eye[1] : l._center[1], n.indexOf("z") < 0 ? l._eye[2] : l._center[2]] : l._eye,
              Gb(Q, Xg(zm(), U, l._center, l._up)),
              Xf(I, Wj(Q, Q), W.pos),
              F && Fo(I, I, F),
              Fb(l, I)
          } else
              Fb(l, W)
      }, zb = function(i, z, q, D, A) {
          var F = i.s
            , C = i.gv
            , g = C.getGL()
            , P = C._prg
            , B = C._buffer
            , M = C._1O
            , w = Vj.for(g)
            , e = w.directAttribs();
          Yh(g, Xl, M),
          Eh(i, q),
          Xb(g, P, F(z + ".blend"), F(z + ".light"), F(z + ".opacity"), F(z + ".reverse.flip"), F(z + ".reverse.color"), F(z + ".reverse.cull")),
          nb(g, P, M, A, B.uv, Sp),
          e.aPosition = Bm(g, B.vs, D, E),
          e.aNormal = Bm(g, B.ns, um, E),
          se(g, B.is, go),
          Hh(g, 0, go.length),
          am(g, P, M),
          he(g, P),
          uo(C)
      }, Dq = function(C, u, F) {
          var U = C.gv
            , W = C.data
            , Q = C[u] = {
              blend: U.getBodyColor(W) || U.getFaceBlend(W, u),
              light: U.getFaceLight(W, u),
              color: U.getFaceColor(W, u),
              opacity: U.getFaceOpacity(W, u),
              transparent: U.getFaceTransparent(W, u),
              reverseFlip: U.getFaceReverseFlip(W, u),
              reverseColor: U.getFaceReverseColor(W, u),
              reverseCull: U.getFaceReverseCull(W, u),
              texture: U.getFaceImage(W, u),
              blendTexture: U.getFaceBlendImage(W, u),
              discardSelectable: U.getFaceDiscardSelectable(W, u)
          };
          if ("csg" !== u) {
              Q.uv = U.getFaceUv(W, u) || F && F[u + "Uv"],
              Q.uvScale = U.getFaceUvScale(W, u) || F && F[u + "UvScale"],
              Q.uvOffset = U.getFaceUvOffset(W, u) || F && F[u + "UvOffset"];
              var J = U.getFaceMat(W, u);
              if (J) {
                  var z = Dp(W, J);
                  W.appendAnchorMatrix3d(z),
                  Q.mat = z
              }
          }
          return Q
      }, np = function(o, k, M, L, F) {
          var $ = o[L];
          if ($) {
              if (!F($.transparent))
                  return;
              var s = o.data
                , H = o.gv
                , l = H._buffer
                , d = H.getTexture($.texture, s, L)
                , W = H.getTexture($.blendTexture, s)
                , v = Vj.for(k)
                , q = v.directUniforms()
                , a = v.directAttribs();
              nb(k, M, d, $.discardSelectable, l.uv, $.tuv, $.uvOffset, $.uvScale, W),
              Xb(k, M, $.blend, $.light, $.opacity, $.reverseFlip, $.reverseColor, $.reverseCull),
              $.cs && !H._batchColorDisabled ? (q.uBatchColor = !0,
              a.aBatchColor = Bm(k, l.batchColor, $.cs, M.aBatchColor, 4)) : q.uDiffuse = $.color || U["color.empty"],
              a.aPosition = Bm(k, l.vs, $.vs, E),
              a.aNormal = Bm(k, l.ns, $.ns, E),
              rp(k, 0, $.vs.length / 3),
              $.cs && !H._batchColorDisabled && (q.uBatchColor = !1,
              Cb(k, M.aBatchColor)),
              he(k, M),
              am(k, M, d)
          }
      }, pr = function(F, q, D) {
          $c(F) ? F.forEach(function(p) {
              pr(p, q, D)
          }) : Xq(F) ? pr(hc(q, F), q, D) : Ql(F) ? F.shape3d ? pr(F.shape3d, q, D) : D.push(F) : D.push(F)
      }, Ln = function(A, g, o, k, E, p) {
          var P, i, Y, L, f, u, _, X, v, w, F, C = [k - g, E - o], V = A ? A.length : 0;
          for (Y = 0; V > Y; Y++) {
              for (L = 2,
              P = A[Y],
              f = P[0],
              u = P[1]; L + 1 < P.length; ) {
                  if (_ = P[L],
                  X = P[L + 1],
                  i = Wr(g, o, k, E, f, u, _, X, !0)) {
                      v = [_ - f, X - u],
                      w = Qf(v),
                      v[0] /= w,
                      v[1] /= w,
                      w = Zk(C, v),
                      w = w > 0 ? p : -p,
                      F = [v[0] * w, v[1] * w];
                      break
                  }
                  f = _,
                  u = X,
                  L += 2
              }
              if (F)
                  break
          }
          if (F)
              for (k = g + F[0],
              E = o + F[1],
              Y = 0; V > Y; Y++)
                  for (L = 2,
                  P = A[Y],
                  f = P[0],
                  u = P[1]; L + 1 < P.length; ) {
                      if (_ = P[L],
                      X = P[L + 1],
                      i = Wr(g, o, k, E, f, u, _, X, !0))
                          return [0, 0];
                      f = _,
                      u = X,
                      L += 2
                  }
          return F ? F : [k - g, E - o]
      }, Jn = function(B) {
          return "nearest" === B ? Cg.NEAREST : "linear" === B ? Cg.LINEAR : B
      }, rn = n.graph3d = {}, ii = function(k, q, G) {
          Ik(p + ".graph3d." + k, q, G)
      }, Vc = "~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN", gc = "~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit!)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!qe!-*!z/f{jTmfyfu!-yyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*!2!-2!.!)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!}}!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!<*!opjujtpQpUuihjm!)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*!sbfObsfnbDxpebit!.!sbGbsfnbDxpebit!)!0!*!sbfObsfnbDxpebit!.!*!opjujtpQpUuihjm!)iuhofm!)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<*!*!1/3!-1/5!)3dfw!+!f{jTqbNxpebit!)!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*!sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*!68/1!-684/1!)3dfw!,!sbobmq!+!*!63/1!-632/1!)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!z/w!)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!z/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!y/w!)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!y/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*!1/1!?!{/w!)!gj!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!{/Wtcb!)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*!Zf{jTmfyfu!+!1/3!.!1/2!)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<*!*!{/Wtcb!-z/Wtcb!)ybn!-y/Wtcb!)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*!w!)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*!Zf{jTmfyfu!ubpmg!-w!4dfw!)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!gjmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!|!*!utfUnvutvsg!)!gj!!!!!!!!!!!!<*!dfWutfUnvutvsg!)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*!1/2!>=!{/esppDxpebit!-nvutvsGoj!)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*!dfWnvutvsGoj!)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*!1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit!)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*!esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*!y/g!-c!-b!)yjn!>!d!ubpmg!!!!!!!!!!!!<*!z/g!-us!-cs!)yjn!>!c!ubpmg!!!!!!!!!!!!<*!z/g!-um!-cm!)yjn!>!b!ubpmg!!!!!!!!!!!!<*!6/1!,!f{jt!+!wv!)udbsg!>!g!3dfw!!!!!!!!!!!!<*!fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*!6/1!,!f{jt!+!wv!)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*!1/2!-1/1!)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt!)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!*!*!wv!-tiuqfe!)E3fsvuyfu!)iuqfEpUBCHSldbqov!-fsbqnpd!)qfut!osvufs!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt!)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!tspudbGldbqoV!-w!)upe!osvufs|!*!w!5dfw!oj!utopd!)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*!/2!-tspudbGldbQ!)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*!/763!!-/763!+!/763!-/763!+!/763!+!/763!)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
      rc(M, {
          setBatchInfo: function(o, t) {
              Mj[o] = t
          },
          getBatchInfo: function(T) {
              return Mj[T]
          },
          getBatchInfoMap: function() {
              return Mj
          },
          setBatchInfoMap: function(I) {
              Mj = I
          }
      }, !0);
      var hh = [1, 1, 1]
        , Td = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]
        , Hf = [1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0]
        , yi = [-.5, .5, .5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, .5, .5]
        , If = [.5, .5, -.5, .5, .5, .5, .5, -.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, .5, -.5]
        , qk = [.5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, .5, .5, -.5]
        , Vd = [.5, -.5, .5, -.5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, .5]
        , mg = [.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5]
        , kn = [-.5, .5, -.5, .5, .5, -.5, .5, -.5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5]
        , sn = function(H, T) {
          var q = H._40Q;
          q.each(function(E) {
              E.ivBatch(T)
          })
      }
        , bg = function(Z, x, y) {
          var v = y._id
            , q = x[v];
          if (q) {
              var c = q.batch
                , t = Z[c]
                , D = t.ds
                , Q = q.index;
              if (t.invalidate = !0,
              delete x[v],
              D.splice(Q, 1),
              Og(D))
                  return delete Z[c],
                  void 0;
              for (var s = q.begin, b = q.size, P = 3 * s, i = 3 * b, n = 4 * s, A = 4 * b, h = t.vs, X = t.ps, W = t.uv, L = t.cs, T = t.bs, l = t.rs, r = t.ns, Y = t.ls; Q < D.length; Q++)
                  q = x[D[Q]._id],
                  q.index--,
                  q.begin -= b;
              h.splice(P, i),
              X.splice(n, A),
              W && W.splice(2 * s, 2 * b),
              L && L.splice(n, A),
              T && T.splice(P, i),
              l && l.splice(s, b),
              r && r.splice(P, i),
              Y && Y.splice(s, b)
          }
      }
        , Pn = function(P, e, J, n, w) {
          if (!n)
              return E;
          var D = e[n];
          if (!D) {
              var s = w.getBatchInfo(n) || Li
                , f = s.image ? [] : E;
              D = e[n] = {
                  vs: [],
                  ns: [],
                  uv: f,
                  cs: f ? E : s.color ? E : [],
                  bs: s.blend ? [] : E,
                  ps: [],
                  rs: s.brightness ? [] : E,
                  ds: []
              }
          }
          return D.invalidate = !0,
          P[J._id] = {
              index: D.ds.length,
              begin: D.vs.length / 3,
              batch: n
          },
          D.ds.push(J),
          D
      }
        , dp = function(a, Q) {
          return Q != E && 1 !== Q ? [a[0] * Q, a[1] * Q, a[2] * Q, a[3]] : a
      }
        , kh = function(T) {
          var D = T.shapeModel;
          D || (D = hc(T)),
          D && (D._ctlineModel = [],
          D._lineModel = V)
      }
        , ro = function() {
          var s;
          return function(F, d, M) {
              var O = F.getData3dUI(d)
                , Z = O.shapeModel;
              if (Z || (Z = hc(O)),
              Z || !O.shapeName) {
                  var y, H = d.s("wf.combineTriangle");
                  if (M.geometry) {
                      if (!Z && (d instanceof n.Node && !(d instanceof n.Shape) ? (s || (s = {
                          vs: qj,
                          is: Vh,
                          uv: $j
                      }),
                      Z = s) : Z = [O.left, O.front, O.right, O.back, O.top, O.bottom],
                      !Z))
                          return V;
                      if (H) {
                          var x = d.s("wf.normEpsilon");
                          isNaN(x) && (x = 2),
                          H = 0 | Math.min(3, Math.max(1, isNaN(H) ? 1 : H)),
                          y = mq[H - 1](Z, O, 180 / (Math.PI * x))
                      } else
                          y = Zg(Z, O);
                      if (!y || 0 === y.length)
                          return
                  } else
                      y = M.short ? nm : gk;
                  var W = F.getBrightness(d)
                    , T = bd(M.color || "white")
                    , g = T[3] < 1
                    , A = Math.ceil(M.width) || 1
                    , J = (g ? "T" : "O") + (d.s("bloom") ? "_1_" : "_0_") + A
                    , _ = d.getRenderLayer()
                    , u = F._40Q.get(_)
                    , R = u.wireframeIndexMap
                    , o = u.wireframeModelMap
                    , w = o[J];
                  w || (w = o[J] = {
                      vs: [],
                      cs: [],
                      ps: [],
                      ds: [],
                      T: g,
                      B: d.s("bloom"),
                      W: A
                  }),
                  w.invalidate = !0;
                  var D = w.vs
                    , I = w.cs
                    , E = w.ds
                    , N = R[d._id] = {
                      index: E.length,
                      begin: D.length / 3,
                      batch: J
                  };
                  E.push(d);
                  var h = O.mat;
                  d instanceof n.Edge || !(!h || !M.geometry && d instanceof n.Shape) || (h = Dp(d, M.mat),
                  d.appendAnchorMatrix3d(h)),
                  Mg(D, h, y);
                  var b = N.size = D.length / 3 - N.begin;
                  dg(I, dp(T, W), b)
              }
          }
      }()
        , Ym = function(I, U, y, Z, H, b, t, V, c) {
          var J = I.getBrightness(U);
          J == E && (J = 1);
          var g = dp(bd(Z), J)
            , l = g[3] < 1;
          b = Math.ceil(b) || 1;
          var o = (l ? "T" : "O") + b;
          if (t) {
              var p = t[0]
                , s = (t[1] || p) + p;
              o += "-" + p + "-" + s,
              c && (o += "-" + Il(c) + "-" + J,
              c = dp(bd(c), J))
          }
          var P = U.getRenderLayer()
            , v = I._40Q.get(P)
            , h = v.polylineIndexMap
            , X = v.polylineModelMap
            , x = X[o];
          x || (x = X[o] = {
              vs: [],
              cs: [],
              ps: [],
              ds: [],
              ls: t ? [] : E,
              T: l,
              W: b
          },
          t && (x.D = p,
          x.G = s,
          x.A = c)),
          x.invalidate = !0;
          var M, a = x.vs, L = x.cs, A = x.ds, r = x.ls, u = h[U._id] = {
              index: A.length,
              begin: a.length / 3,
              batch: o
          };
          A.push(U),
          ph(a, y);
          var W, z = u.size = a.length / 3 - u.begin, j = y.length, R = 0, f = [];
          if (t || H)
              for (M = 0; j > M; M += 6)
                  W = Qf([y[M], y[M + 1], y[M + 2]], [y[M + 3], y[M + 4], y[M + 5]]),
                  f.push(W),
                  R += W;
          if (R && H) {
              var K, N = dp(bd(H), J), S = [N[0] - g[0], N[1] - g[1], N[2] - g[2], N[3] - g[3]], F = 0;
              for (M = 0; j > M; M += 6)
                  K = F / R,
                  dg(L, [g[0] + S[0] * K, g[1] + S[1] * K, g[2] + S[2] * K, g[3] + S[3] * K], 1),
                  F += f[M / 6],
                  K = F / R,
                  dg(L, [g[0] + S[0] * K, g[1] + S[1] * K, g[2] + S[2] * K, g[3] + S[3] * K], 1)
          } else
              dg(L, g, z);
          if (t)
              for (F = V || 0,
              M = 0; j > M; M += 6)
                  r.push(F),
                  F += f[M / 6],
                  r.push(F)
      }
        , Rc = function(i, Y, u) {
          if (Y) {
              var g = 4 * Y.begin
                , S = u[Y.batch].ps;
              if (S[g] !== i[0] || S[g + 1] !== i[1] || S[g + 2] !== i[2] || S[g + 3] !== i[3]) {
                  for (var J = 0; J < Y.size; J++)
                      S[g++] = i[0],
                      S[g++] = i[1],
                      S[g++] = i[2],
                      S[g++] = i[3];
                  S._invalidateThisFrame = !0
              }
          }
      }
        , Sg = function(i, d) {
          var F = d + ["32"]
            , I = i[d]
            , m = i[F];
          I ? m && m.length === I.length ? (m.set(I),
          m._bufId = null) : i[F] = new ld(I) : delete i[F]
      }
        , ln = function(e, U, M, B, i, G, h, w, p) {
          if ($c(M))
              M.forEach(function(H) {
                  ln(e, U, H, B, i, G, h, w, p)
              });
          else if (Xq(M))
              ln(e, U, hc(B, M), B, i, G, h, w, p);
          else if (Ql(M)) {
              var V, K = yn(M.mat, U, e), L = yn(M.s3, U, e), g = yn(M.t3, U, e), c = yn(M.r3, U, e);
              if ((L || c || g || K) && (V = lp(K, L, c, yn(M.rotationMode, U, e), g),
              G.push(V)),
              M.shape3d)
                  ln(e, U, M.shape3d, B, i, G, h, w, M);
              else {
                  var _ = B.s;
                  p = p || Li;
                  var H = G[0]
                    , n = G.length
                    , A = _("shape3d.color", M.color, p.color);
                  if (i || (i = _("shape3d.blend", M.blend, p.blend)),
                  n > 1) {
                      H = fs(H);
                      for (var E = 1; n > E; E++)
                          Fo(H, H, G[E])
                  }
                  M.vs && _(Qk, M.visible, p.visible) && bm(H, h, w, M.vs, M.uv, M.is, i, A),
                  M.top_vs && _(xb, M.topVisible, p.topVisible) && bm(H, h, w, M.top_vs, M.top_uv, M.top_is, i, _("shape3d.top.color", M.topColor, p.topColor) || A),
                  M.bottom_vs && _(Ge, M.bottomVisible, p.bottomVisible) && bm(H, h, w, M.bottom_vs, M.bottom_uv, M.bottom_is, i, _("shape3d.bottom.color", M.bottomColor, p.bottomColor) || A),
                  M.from_vs && _(so, M.fromVisible, p.fromVisible) && bm(H, h, w, M.from_vs, M.from_uv, M.from_is, i, _("shape3d.from.color", M.fromColor, p.fromColor) || A),
                  M.to_vs && _(fn, M.toVisible, p.toVisible) && bm(H, h, w, M.to_vs, M.to_uv, M.to_is, i, _("shape3d.to.color", M.toColor, p.toColor) || A)
              }
              V && G.pop()
          }
      }
        , bm = function(G, n, w, E, p, k, L, b) {
          var s, H = n.cs, l = n.uv, Y = n.bs;
          if (k) {
              s = k.length;
              for (var e = 0; s > e; e++) {
                  var u = k[e];
                  Mg(w, G, [E[3 * u], E[3 * u + 1], E[3 * u + 2]]),
                  l && ph(l, [p[2 * u], p[2 * u + 1]])
              }
          } else
              s = E.length / 3,
              Mg(w, G, E),
              l && ph(l, p);
          H && dg(H, b, s),
          Y && (L ? Ng(Y, L, s) : ph(Y, hh, s))
      }
        , jc = function(M, k, $, T) {
          var K = [];
          T ? ln(M.gv, M.data, T, M, M.getBodyColor(), [k], $, K) : (br(M, Mb, k, $, K),
          br(M, Gq, k, $, K),
          br(M, bn, k, $, K),
          br(M, zs, k, $, K),
          br(M, Dj, k, $, K),
          br(M, zg, k, $, K),
          br(M, "csg", k, $, K)),
          K.length && (ph($.vs, K),
          ph($.ns, Yc(K)))
      }
        , br = function(O, D, r, Y, W) {
          var n = O[D];
          if (n) {
              var p = n.tuv;
              if (p) {
                  var s, $, I, x, J = n.uvScale, f = n.uvOffset;
                  if (J)
                      for (s = p.length,
                      $ = J[0],
                      I = J[1],
                      x = 0; s > x; x += 2)
                          p[x] *= $,
                          p[x + 1] *= I;
                  if (f)
                      for (s = p.length,
                      $ = f[0],
                      I = f[1],
                      x = 0; s > x; x += 2)
                          p[x] += $,
                          p[x + 1] += I
              }
              bm(r, Y, W, n.vs, p, E, n.blend, n.color)
          }
      }
        , we = function(s, J, F, X, c, r, Q, j) {
          var m, V = F.cs, l = F.uv, B = F.bs;
          if (s.getFaceVisible(J, r)) {
              var G = s.getFaceMat(J, r);
              if (G && (c = Dp(J, G)),
              Mg(Q, c, j),
              V && dg(V, s.getFaceColor(J, r), 6),
              l) {
                  var i = s.getFaceUv(J, r) || X[r + "Uv"]
                    , t = s.getFaceUvScale(J, r) || X[r + "UvScale"]
                    , u = s.getFaceUvOffset(J, r) || X[r + "UvOffset"];
                  i = i ? [i[6], i[7], i[0], i[1], i[2], i[3], i[2], i[3], i[4], i[5], i[6], i[7]] : Hf;
                  var z = i[0]
                    , d = i[1]
                    , Z = i[2]
                    , W = i[3]
                    , w = i[4]
                    , $ = i[5]
                    , C = i[6]
                    , o = i[7]
                    , E = i[8]
                    , f = i[9]
                    , y = i[10]
                    , p = i[11];
                  if (t) {
                      var P = t[0]
                        , h = t[1];
                      z *= P,
                      d *= h,
                      Z *= P,
                      W *= h,
                      w *= P,
                      $ *= h,
                      C *= P,
                      o *= h,
                      E *= P,
                      f *= h,
                      y *= P,
                      p *= h
                  }
                  if (u) {
                      var g = u[0]
                        , O = u[1];
                      z += g,
                      d += O,
                      Z += g,
                      W += O,
                      w += g,
                      $ += O,
                      C += g,
                      o += O,
                      E += g,
                      f += O,
                      y += g,
                      p += O
                  }
                  l.push(z, d, Z, W, w, $, C, o, E, f, y, p)
              }
              B && (m = s.getBodyColor(J) || s.getFaceBlend(J, r),
              m ? Ng(B, m, 6) : ph(B, hh, 6))
          }
      }
        , cm = function(e, W, F, B) {
          var F = e._picking ? e.pickColorMap : null
            , t = e.getGL()
            , j = e._prg
            , i = e._buffer;
          if (!Qm(W)) {
              Fb(e, Td),
              aj(t, j);
              for (var P in W) {
                  var n = W[P];
                  if (!(B && !n.T || !B && n.T)) {
                      n.invalidate ? (n.invalidate = !1,
                      Sg(n, "vs"),
                      Sg(n, "cs"),
                      Sg(n, "ls"),
                      Sg(n, "ps")) : F && n.ps && n.ps._invalidateThisFrame && (n.ps._invalidateThisFrame = !1,
                      Sg(n, "ps"));
                      var y = n.vs32
                        , f = F ? n.ps32 : n.cs32;
                      pl(t, j, n.W, E, i.vs, y);
                      var g = Vj.for(t)
                        , I = g.directUniforms()
                        , r = g.directAttribs()
                        , T = n.D
                        , O = !e._dashDisabled && T;
                      I.uAlphaTest = U.alphaTest,
                      t._blooming && !n.B && (I.blackout = !0),
                      O && (I.uDash = !0,
                      I.uDashDistance = T,
                      I.uDashGapDistance = n.G,
                      I.uDiffuse = n.A || U["color.empty"],
                      r.aLineDistance = Bm(t, i.lineDistance, n.ls32, E, 1));
                      var $ = !e._batchColorDisabled;
                      $ && f.length ? (I.uBatchColor = !0,
                      r.aBatchColor = Bm(t, i.batchColor, f, E, 4)) : (I.uBatchColor = !1,
                      r.aBatchColor = !1),
                      nb(t),
                      rp(t, 0, y.length / 3, t.LINES),
                      am(t),
                      $ && (I.uBatchColor = !1,
                      r.aBatchColor = !1),
                      O && (I.uDash = !1,
                      r.aLineDistance = !1),
                      t._blooming && !n.B && (I.blackout = !1)
                  }
              }
              Dk(t, j),
              uo(e)
          }
      }
        , Nq = function(L, t, m, O, d) {
          var j, T, R, o, e, Y, M, v, S, r, b, m = L._picking ? L.pickColorMap : null, Z = L.getGL(), h = L._prg, F = Vj.for(Z), C = F.directUniforms(), w = F.directAttribs(), P = L._buffer;
          if (!Qm(t) && !L.drawFilter) {
              Fb(L, Td);
              for (j in t)
                  if (T = L.getBatchInfo(j) || Li,
                  T.visible !== !1 && !(O && !T.transparent || !O && T.transparent || L.isReflecting(Z) && T.reflectable === !1)) {
                      var A = T.renderLayerMask;
                      if (A == E && (A = Qd),
                      d == E && (d = Qd),
                      Bk(d, A) && (R = t[j],
                      m || !T.transparentMask)) {
                          var p = O && T.autoSort === !0 && (L._33Q || R.invalidate);
                          if (R.invalidate ? (R.invalidate = !1,
                          Sg(R, "vs"),
                          Sg(R, "ns"),
                          Sg(R, "cs"),
                          Sg(R, "rs"),
                          Sg(R, "ps"),
                          Sg(R, "bs"),
                          Sg(R, "uv")) : m && R.ps && R.ps._invalidateThisFrame && (R.ps._invalidateThisFrame = !1,
                          Sg(R, "ps")),
                          e = R.vs32,
                          Y = m ? R.ps32 : R.cs32,
                          S = R.uv32,
                          M = R.bs32,
                          v = R.rs32,
                          b = e.length / 3,
                          p) {
                              var H = ds(e, L.getEye(), L);
                              H ? (R.is = H.is,
                              R.elementTypeUint = H.useUint32) : (R.is = null,
                              R.elementTypeUint = null)
                          }
                          if (b) {
                              o = T.light,
                              r = L.getTexture(T.image),
                              Xb(Z, h, E, T.light, T.opacity, T.reverseFlip, T.reverseColor, T.reverseCull),
                              Y ? L._batchColorDisabled ? (C.uBatchColor = !1,
                              w.aBatchColor = !1) : (C.uBatchColor = !0,
                              w.aBatchColor = Bm(Z, P.batchColor, Y, E, 4)) : (C.uBatchColor = !1,
                              C.uDiffuse = T.color || U["color.empty"]);
                              var $ = T.alphaTest;
                              C.uAlphaTest = $ === V ? U.alphaTest : $,
                              Z._blooming && !T.bloom && (C.blackout = !0),
                              T.envmap !== V ? (C.uUseEnvMap = !0,
                              C.uReflectivity = T.envmap) : (C.uUseEnvMap = !1,
                              C.uReflectivity = 0);
                              var u = M && !L._batchBlendDisabled;
                              u && (C.uBatchBlend = !0,
                              w.aBatchBlend = Bm(Z, P.batchBlend, M, E));
                              var q = v && !L._batchBrightnessDisabled;
                              q && (C.uBatchBrightness = !0,
                              w.aBatchBrightness = Bm(Z, P.batchBrightness, v, E, 1)),
                              S ? nb(Z, h, r, T.discardSelectable, P.uv, S, T.uvOffset, T.uvScale) : nb(Z),
                              w.aPosition = Bm(Z, P.vs, e, E),
                              w.aNormal = Bm(Z, P.ns, R.ns32, E),
                              R.is ? (pq(Z, P.is, R.is),
                              Hh(Z, 0, b, null, R.elementTypeUint ? Z.UNSIGNED_INT : null)) : rp(Z, 0, b),
                              S ? am(Z, h, r) : am(Z),
                              Y && !L._batchColorDisabled && (C.uBatchColor = !1,
                              w.aBatchColor = !1),
                              u && (C.uBatchBlend = !1,
                              w.aBatchBlend = !1),
                              q && (C.uBatchBrightness = !1,
                              w.aBatchBrightness = !1),
                              Z._blooming && !T.bloom && (C.blackout = !1),
                              he(Z, h)
                          }
                      }
                  }
              uo(L)
          }
      }
        , ds = function($, O, S) {
          var r = $.length / 3
            , N = r > 65535
            , G = S._glCapabilities.elementTypeUint && N;
          if (!G && N)
              return null;
          for (var q = new Array(r), Q = r / 3, W = new Array(Q), l = 0; Q > l; l++)
              W[l] = l;
          W.sort(function(H, c) {
              var Y = 9 * H
                , T = [($[Y] + $[Y + 3] + 2 * $[Y + 6]) / 4, ($[Y + 1] + $[Y + 4] + 2 * $[Y + 7]) / 4, ($[Y + 2] + $[Y + 5] + 2 * $[Y + 8]) / 4];
              Y = 9 * c;
              var g = [($[Y] + $[Y + 3] + 2 * $[Y + 6]) / 4, ($[Y + 1] + $[Y + 4] + 2 * $[Y + 7]) / 4, ($[Y + 2] + $[Y + 5] + 2 * $[Y + 8]) / 4]
                , f = Qf(O, T) - Qf(O, g);
              return f > 0 ? -1 : 0 > f ? 1 : 0
          });
          for (var l = 0; Q > l; l++) {
              var T = 3 * l
                , u = 3 * W[l];
              q[T] = u,
              q[T + 1] = u + 1,
              q[T + 2] = u + 2
          }
          return {
              useUint32: G,
              is: G ? new Uint32Array(q) : new dj(q)
          }
      }
        , Tg = {
          obj: function(x, n) {
              var e = {
                  mat: x.mat,
                  s3: x.s3,
                  r3: x.r3,
                  rotationMode: x.rotationMode,
                  t3: x.t3,
                  cube: x.cube == E ? !0 : x.cube,
                  center: x.center == E ? !0 : x.center,
                  ignoreMtls: x.ignoreMtls,
                  ignoreTransparent: x.ignoreTransparent,
                  ignoreColor: x.ignoreColor,
                  ignoreImage: x.ignoreImage,
                  ignoreNormal: x.ignoreNormal,
                  prefix: x.prefix,
                  flipY: x.flipY,
                  flipFace: x.flipFace,
                  reverseFlipMtls: x.reverseFlipMtls,
                  finishFunc: function(w, k) {
                      if (w) {
                          var k = [];
                          for (var I in w) {
                              var c = w[I];
                              k.rawS3 = c.rawS3,
                              c.center && (k.center = c.center),
                              k.push(c),
                              x.eachModel && x.eachModel(I, c)
                          }
                          k.json = x,
                          n(k)
                      } else
                          n()
                  }
              };
              M.loadObj(x.obj, x.mtl, e)
          },
          bin: function(m, L) {
              var y = {
                  finishFunc: function(W) {
                      W ? L(W) : L()
                  }
              };
              M.loadBin(m.url, y)
          }
      };
      M.getModelTypeHandlers = function() {
          return Tg
      }
      ,
      M.setModelTypeHandler = function(D, P) {
          Tg[D] = P
      }
      ,
      M.getModelTypeHandler = function(L) {
          return Tg[L]
      }
      ,
      M.handleModelLoaded = function() {}
      ,
      M.handleUnfoundModel = function() {}
      ;
      var Qr = E
        , kk = E
        , ol = function(x) {
          Qr && !x._loadingModelView_ && (kk || (kk = {}),
          kk[x._loadingModelView_ = Pm()] = x)
      }
        , $d = function(Z, n) {
          Qr || (Qr = {});
          var H = Qr[Z];
          if (H) {
              if (H.url === n)
                  return;
              H.request.onload = ts,
              H.request.onerror = ts
          }
          if (n.indexOf(".bin") === n.length - 4)
              return gi(Z, {
                  modelType: "bin",
                  url: n
              }, n);
          if (n = M.beforeLoadURL(n),
          n.data) {
              var g = M.parse(n.data);
              gi(Z, g, n)
          } else {
              var G = new tn;
              Qr[Z] = {
                  request: G,
                  url: n
              },
              G.onload = function() {
                  if (200 === this.status || 0 === this.status) {
                      delete Qr[Z];
                      var $ = M.parse(G.getResponseText());
                      gi(Z, $, n)
                  } else
                      po(Z, M.handleUnfoundModel(Z, n) || E)
              }
              ,
              G.onerror = function() {
                  po(Z, M.handleUnfoundModel(Z, n) || E)
              }
              ;
              var c = {};
              c.url = encodeURI(n),
              c.sync = !1,
              G.send(c)
          }
      }
        , gi = function(o, d, U) {
          var Z = d.modelType;
          if (!Z)
              return po(o, d),
              M.handleModelLoaded(o, d),
              void 0;
          var r = M.getModelTypeHandler(Z);
          if (r) {
              if (Qr || (Qr = {}),
              Qr[o])
                  return;
              Qr[o] = !0;
              var i = function($) {
                  $ ? (po(o, $),
                  M.handleModelLoaded(o, $)) : po(o, M.handleUnfoundModel(o, U, d) || E)
              };
              r(d, i)
          } else
              po(o, M.handleUnfoundModel(o, U, d) || E)
      }
        , po = function(Q, w) {
          if (delete Qr[Q],
          Xq(w) && As.test(w))
              return $d(Q, w),
              void 0;
          if (es[Q] = w,
          Qm(Qr) && (Qr = E,
          kk)) {
              for (var G in kk) {
                  var p = kk[G];
                  p.invalidateAll && p.invalidateAll(V, "modelLoaded", Q),
                  p.redraw && p.redraw(),
                  p.iv(),
                  delete p._loadingModelView_
              }
              kk = E
          }
          if (w && kk)
              for (var G in kk) {
                  var p = kk[G];
                  p.invalidateAll && p.invalidateAll(V, "modelLoading", Q),
                  p.redraw && p.redraw(),
                  p.iv()
              }
      }
        , Sp = new ld([0, 0, 0, 1, 1, 1, 1, 0])
        , um = new ld([0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1])
        , go = new dj([0, 1, 2, 2, 3, 0])
        , qj = new ld([-.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, .5, .5, .5, -.5, .5, .5, -.5, -.5, .5, .5, -.5, .5, .5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, .5, .5, .5, .5, .5, -.5, -.5, -.5, .5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, .5])
        , Vh = new dj([0, 1, 2, 0, 2, 3, 4, 5, 6, 4, 6, 7, 8, 9, 10, 8, 10, 11, 12, 13, 14, 12, 14, 15, 16, 17, 18, 16, 18, 19, 20, 21, 22, 20, 22, 23])
        , $j = new ld([0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0])
        , Sh = Yc(qj, Vh)
        , Jo = (new ld([-.5, .5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, -.5, -.5, .5, .5, -.5, -.5, -.5, -.5, -.5, .5, -.5]),
      new dj([0, 1, 2, 3, 0, 7, 5, 4, 6, 7, 5, 3, 2, 4, 6, 1]),
      [Mb, bn, Gq, zs, Dj, zg])
        , gk = [-.5, .5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, .5, .5, -.5, .5, .5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, -.5, .5, .5, .5, .5, .5, -.5, .5, -.5, .5, .5, -.5, -.5, -.5, .5, .5, -.5, .5, -.5, -.5, -.5, .5, -.5, -.5, -.5]
        , nm = [-.5, .5, .5, -.4, .5, .5, -.5, .5, .5, -.5, .4, .5, -.5, .5, .5, -.5, .5, .4, .5, .5, .5, .4, .5, .5, .5, .5, .5, .5, .4, .5, .5, .5, .5, .5, .5, .4, -.5, -.5, .5, -.4, -.5, .5, -.5, -.5, .5, -.5, -.4, .5, -.5, -.5, .5, -.5, -.5, .4, .5, -.5, .5, .4, -.5, .5, .5, -.5, .5, .5, -.4, .5, .5, -.5, .5, .5, -.5, .4, -.5, .5, -.5, -.4, .5, -.5, -.5, .5, -.5, -.5, .4, -.5, -.5, .5, -.5, -.5, .5, -.4, .5, .5, -.5, .4, .5, -.5, .5, .5, -.5, .5, .4, -.5, .5, .5, -.5, .5, .5, -.4, -.5, -.5, -.5, -.4, -.5, -.5, -.5, -.5, -.5, -.5, -.4, -.5, -.5, -.5, -.5, -.5, -.5, -.4, .5, -.5, -.5, .4, -.5, -.5, .5, -.5, -.5, .5, -.4, -.5, .5, -.5, -.5, .5, -.5, -.4]
        , Vb = function(H, M, I, v, z, p, k) {
          p = p || 16,
          H = H || 16,
          M = M || 0,
          I = I || H;
          var n, N, W, X, O, Z, C, w, m, S = .5, c = [], e = [], G = y / H, B = s / p;
          for (n = 0; p > n; n++)
              for (Z = n + 1,
              X = n * B,
              m = Z * B,
              N = M; I > N; N++)
                  C = N + 1,
                  W = N * G,
                  w = C * G,
                  c.push(S * o(X) * P(W), S * P(X), -S * o(X) * o(W), S * o(m) * P(w), S * P(m), -S * o(m) * o(w), S * o(X) * P(w), S * P(X), -S * o(X) * o(w), S * o(X) * P(W), S * P(X), -S * o(X) * o(W), S * o(m) * P(W), S * P(m), -S * o(m) * o(W), S * o(m) * P(w), S * P(m), -S * o(m) * o(w)),
                  e.push(N / H, n / p, C / H, Z / p, C / H, n / p, N / H, n / p, N / H, Z / p, C / H, Z / p);
          if (k) {
              var l = [];
              for (n = 0,
              O = c.length; O > n; n += 3)
                  l.push(2 * c[n], 2 * c[n + 1], 2 * c[n + 2])
          }
          if (v) {
              var q = []
                , T = [];
              for (W = M * G,
              n = 0; p > n; n++)
                  Z = n + 1,
                  X = n * B,
                  m = Z * B,
                  q.push(0, 0, 0, S * o(m) * P(W), S * P(m), -S * o(m) * o(W), S * o(X) * P(W), S * P(X), -S * o(X) * o(W)),
                  T.push(0, .5, M / H, Z / p, M / H, n / p)
          }
          if (z) {
              var R = []
                , h = [];
              for (W = I * G,
              n = 0; p > n; n++)
                  Z = n + 1,
                  X = n * B,
                  m = Z * B,
                  R.push(0, 0, 0, S * o(X) * P(W), S * P(X), -S * o(X) * o(W), S * o(m) * P(W), S * P(m), -S * o(m) * o(W)),
                  h.push(1, .5, I / H, n / p, I / H, Z / p)
          }
          var J = {
              vs: c,
              uv: e,
              from_vs: q,
              from_uv: T,
              to_vs: R,
              to_uv: h
          };
          return k && (J.ns = l),
          J
      }
        , ih = function(I, e, C) {
          I = I || .17,
          e = e || 12,
          C = C || 18,
          0 > I ? I = 0 : I > .25 && (I = .25);
          var r, K, Q, D, j, t, $, n = .5, V = [], f = [], E = [], Y = y / C, i = y / e, J = n - I;
          for (K = 0; e >= K; K++)
              for (D = -s + K * i,
              t = P(D),
              j = o(D),
              r = 0; C >= r; r++)
                  Q = r * Y,
                  $ = J + I * t,
                  V.push(P(Q) * $, j * I, -o(Q) * $),
                  f.push(r / C, 1 - K / e);
          for (K = 0; e > K; K++) {
              var Z = K * (C + 1)
                , M = (K + 1) * (C + 1);
              for (r = 0; C > r; r++)
                  E.push(Z + r, M + r + 1, M + r, Z + r, Z + r + 1, M + r + 1)
          }
          return {
              vs: V,
              uv: f,
              is: E
          }
      }
        , Hn = function(f, J, F, E, m, l, w, C) {
          w = w || 12,
          f = f || 18,
          J = J || 0,
          F = F || f,
          l = l || .17,
          0 > l ? l = 0 : l > .25 && (l = .25);
          var H, L, d, k, N, X, S, u, j, x, h = .5, R = [], c = [], I = y / f, B = y / w, v = h - l, _ = C ? [] : V;
          for (d = 0; w > d; d++)
              for (k = d + 1,
              S = -s + d * B,
              u = -s + k * B,
              H = J; F > H; H++)
                  L = H + 1,
                  N = H * I,
                  X = L * I,
                  j = v + l * P(S),
                  x = v + l * P(u),
                  R.push(P(N) * j, o(S) * l, -o(N) * j, P(X) * j, o(S) * l, -o(X) * j, P(X) * x, o(u) * l, -o(X) * x, P(N) * j, o(S) * l, -o(N) * j, P(X) * x, o(u) * l, -o(X) * x, P(N) * x, o(u) * l, -o(N) * x),
                  c.push(H / f, 1 - d / w, L / f, 1 - d / w, L / f, 1 - k / w, H / f, 1 - d / w, L / f, 1 - k / w, H / f, 1 - k / w),
                  C && _.push(P(N) * P(S), o(S), -o(N) * P(S), P(X) * P(S), o(S), -o(X) * P(S), P(X) * P(u), o(u), -o(X) * P(u), P(N) * P(S), o(S), -o(N) * P(S), P(X) * P(u), o(u), -o(X) * P(u), P(N) * P(u), o(u), -o(N) * P(u));
          if (E) {
              var e = []
                , M = [];
              for (d = 0; w > d; d++)
                  k = d + 1,
                  S = -s + d * B,
                  u = -s + k * B,
                  N = J * I,
                  j = v + l * P(S),
                  x = v + l * P(u),
                  e.push(P(N) * j, o(S) * l, -o(N) * j, P(N) * x, o(u) * l, -o(N) * x, P(N) * v, 0, -o(N) * v),
                  M.push(.5 + .5 * P(S), .5 - .5 * o(S), .5 + .5 * P(u), .5 - .5 * o(u), .5, .5)
          }
          if (m) {
              var n = []
                , Y = [];
              for (d = 0; w > d; d++)
                  k = d + 1,
                  S = -s + d * B,
                  u = -s + k * B,
                  N = F * I,
                  j = v + l * P(S),
                  x = v + l * P(u),
                  n.push(P(N) * j, o(S) * l, -o(N) * j, P(N) * v, 0, -o(N) * v, P(N) * x, o(u) * l, -o(N) * x),
                  Y.push(.5 - .5 * P(S), .5 - .5 * o(S), .5, .5, .5 - .5 * P(u), .5 - .5 * o(u))
          }
          var r = {
              vs: R,
              uv: c,
              from_vs: e,
              from_uv: M,
              to_vs: n,
              to_uv: Y
          };
          return C && (r.ns = _),
          r
      }
        , Wf = function(R, Q) {
          for (var c, b, V, d = .5, u = 16, h = [], i = [], s = [], F = y / u, l = 0; u >= l; l++)
              c = l * F,
              b = P(c) * d,
              V = o(c) * d,
              h.push(b, -d, V, b, d, V),
              i.push(1 - l / u, 1, 1 - l / u, 0);
          for (l = 0; u > l; l++)
              s.push(2 * l, 2 * l + 1, 2 * l + 3, 2 * l, 2 * l + 3, 2 * l + 2);
          if (Q) {
              var M = []
                , p = []
                , X = [];
              for (M.push(0, -d, 0),
              p.push(.5, .5),
              l = 0; u >= l; l++)
                  c = l * F,
                  b = P(c),
                  V = o(c),
                  M.push(b * d, -d, -V * d),
                  p.push(.5 + .5 * b, .5 + .5 * V);
              for (l = 0; u > l; l++)
                  X.push(0, l + 2, l + 1)
          }
          if (R) {
              var j = []
                , m = []
                , T = [];
              for (j.push(0, d, 0),
              m.push(.5, .5),
              l = 0; u >= l; l++)
                  c = l * F,
                  b = P(c),
                  V = o(c),
                  j.push(b * d, d, -V * d),
                  m.push(.5 + .5 * b, .5 - .5 * V);
              for (l = 0; u > l; l++)
                  T.push(0, l + 1, l + 2)
          }
          return {
              vs: h,
              uv: i,
              is: s,
              bottom_vs: M,
              bottom_uv: p,
              bottom_is: X,
              top_vs: j,
              top_uv: m,
              top_is: T
          }
      }
        , _m = function(d, s, I, g, E, M, F, Z) {
          d = d || 12,
          s = s || 0,
          I = I || d;
          for (var B, r, D, A, H, p, Y, w, X, a = .5, q = [], U = [], O = y / d, W = s; I > W; W++)
              B = W + 1,
              r = W * O,
              D = B * O,
              A = P(r) * a,
              H = o(r) * a,
              p = P(D) * a,
              Y = o(D) * a,
              q.push(A, -a, -H, p, -a, -Y, A, a, -H, p, -a, -Y, p, a, -Y, A, a, -H),
              U.push(W / d, 1, B / d, 1, W / d, 0, B / d, 1, B / d, 0, W / d, 0);
          if (Z) {
              var i = [];
              for (W = 0,
              X = q.length; X > W; W += 3)
                  i.push(2 * q[W], 0, 2 * q[W + 2])
          }
          if (F) {
              var T = []
                , c = [];
              for (W = s; I > W; W++)
                  r = O * W,
                  D = O * (W + 1),
                  A = P(r),
                  H = o(r),
                  p = P(D),
                  Y = o(D),
                  T.push(A * a, -a, -H * a, 0, -a, 0, p * a, -a, -Y * a),
                  c.push(.5 + .5 * A, .5 + .5 * H, .5, .5, .5 + .5 * p, .5 + .5 * Y)
          }
          if (M) {
              var l = []
                , x = [];
              for (W = s; I > W; W++)
                  r = O * W,
                  D = O * (W + 1),
                  A = P(r),
                  H = o(r),
                  p = P(D),
                  Y = o(D),
                  l.push(A * a, a, -H * a, p * a, a, -Y * a, 0, a, 0),
                  x.push(.5 + .5 * A, .5 - .5 * H, .5 + .5 * p, .5 - .5 * Y, .5, .5)
          }
          if (g) {
              var b = []
                , G = [];
              r = O * s,
              A = P(r) * a,
              H = o(r) * a,
              w = s / d,
              b.push(0, a, 0, 0, -a, 0, A, -a, -H, A, -a, -H, A, a, -H, 0, a, 0),
              G.push(0, 0, 0, 1, w, 1, w, 1, w, 0, 0, 0)
          }
          if (E) {
              var R = []
                , J = [];
              r = O * I,
              A = P(r) * a,
              H = o(r) * a,
              w = I / d,
              R.push(0, -a, 0, 0, a, 0, A, a, -H, A, a, -H, A, -a, -H, 0, -a, 0),
              J.push(1, 1, 1, 0, w, 0, w, 0, w, 1, 1, 1)
          }
          var V = {
              vs: q,
              uv: U,
              bottom_vs: T,
              bottom_uv: c,
              top_vs: l,
              top_uv: x,
              from_vs: b,
              from_uv: G,
              to_vs: R,
              to_uv: J
          };
          return Z && (V.ns = i),
          V
      }
        , pb = function(q, i, D, F, G) {
          i = i || 18,
          D = D || 0,
          F = F == E ? y : F,
          G = G == E ? .5 : G;
          for (var _, Q, n, T, w, u, g = [0, .5, .75, .875, .9375], t = [], h = [], x = [], U = F / i, j = 0; j < g.length; j++) {
              var O = 0 === j % 2 ? 0 : .5;
              for (_ = 0; i >= _; _++)
                  Q = (_ + O) * U + D,
                  n = 1 - g[j],
                  t.push(P(Q) * G * n, -G + 2 * g[j] * G, -o(Q) * G * n),
                  h.push((_ + O) / i, n)
          }
          for (j = 0; j < g.length - 1; j++) {
              var Y = j * (i + 1)
                , N = (j + 1) * (i + 1);
              for (_ = 0; i > _; _++)
                  x.push(Y + _, N + _ + 1, N + _, Y + _, Y + _ + 1, N + _ + 1)
          }
          for (u = t.length / 3 - (i + 1),
          _ = 0; i > _; _++)
              t.push(0, G, 0),
              h.push((_ + .5) / i, 0);
          for (_ = 0; i > _; _++)
              x.push(u + _, u + _ + 1, u + (i + 1) + _);
          if (q) {
              var m = []
                , s = []
                , l = [];
              for (m.push(0, -G, 0),
              s.push(.5, .5),
              _ = 0; i >= _; _++)
                  Q = _ * U + D,
                  T = P(Q),
                  w = o(Q),
                  m.push(T * G, -G, -w * G),
                  s.push(.5 + .5 * T, .5 + .5 * w);
              for (_ = 0; i > _; _++)
                  l.push(0, _ + 2, _ + 1)
          }
          return {
              vs: t,
              uv: h,
              is: x,
              bottom_vs: m,
              bottom_uv: s,
              bottom_is: l
          }
      }
        , Le = function(C, Q, $, j, p, _) {
          C = C || 16,
          Q = Q || 0,
          $ = $ || C;
          for (var e = .5, T = [], D = [], L = y / C, H = Q; $ > H; H++) {
              var B = H + 1
                , E = L * H
                , F = L * B;
              T.push(P(E) * e, -e, -o(E) * e, P(F) * e, -e, -o(F) * e, 0, e, 0),
              D.push(H / C, 1, B / C, 1, (H + B) / 2 / C, 0)
          }
          if (_) {
              var M = []
                , c = [];
              for (H = Q; $ > H; H++) {
                  E = L * H,
                  F = L * (H + 1);
                  var f = P(E)
                    , U = o(E)
                    , q = P(F)
                    , t = o(F);
                  M.push(f * e, -e, -U * e, 0, -e, 0, q * e, -e, -t * e),
                  c.push(.5 + .5 * f, .5 + .5 * U, .5, .5, .5 + .5 * q, .5 + .5 * t)
              }
          }
          if (j) {
              var s = []
                , N = [];
              E = L * Q,
              s.push(0, e, 0, 0, -e, 0, P(E) * e, -e, -o(E) * e),
              N.push(0, 0, 0, 1, Q / C, 1)
          }
          if (p) {
              var V = []
                , w = [];
              E = L * $,
              V.push(0, -e, 0, 0, e, 0, P(E) * e, -e, -o(E) * e),
              w.push(1, 1, 1, 0, $ / C, 1)
          }
          return {
              vs: T,
              uv: D,
              bottom_vs: M,
              bottom_uv: c,
              from_vs: s,
              from_uv: N,
              to_vs: V,
              to_uv: w
          }
      }
        , zi = function(Y, t, G, m, j, p, z, B) {
          for (var d = [], h = 0; h < Y.length - 1; h += 2)
              d.push({
                  x: Y[h],
                  y: Y[h + 1]
              });
          return Sm(d, t, G, m, j, p, z, B, !1)
      }
        , Md = {
          roundRect: function(G, P) {
              return zi([.5, .4, .5, .442, .471, .471, .442, .5, .4, .5, -.4, .5, -.442, .5, -.471, .471, -.5, .442, -.5, .4, -.5, -.4, -.5, -.442, -.471, -.471, -.442, -.5, -.4, -.5, .4, -.5, .442, -.5, .471, -.471, .5, -.442, .5, -.4, .5, .4], [1, 3, 3, 2, 3, 3, 2, 3, 3, 2, 3, 3, 2], G, P, 3)
          },
          star: function(B, k) {
              return zi([.193, .079, .333, .5, 0, .233, -.333, .5, -.194, .079, -.5, -.167, -.112, -.167, 0, -.5, .111, -.167, .5, -.167], [1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5], B, k)
          },
          rect: function(W, c) {
              return zi([.5, -.5, .5, .5, -.5, .5, -.5, -.5], [1, 2, 2, 2, 5], W, c)
          },
          billboard: function() {
              return {
                  vs: [-.5, .5, 0, -.5, -.5, 0, .5, .5, 0, .5, .5, 0, -.5, -.5, 0, .5, -.5, 0],
                  uv: [0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1],
                  ns: [0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1]
              }
          },
          plane: function() {
              return {
                  vs: [-.5, 0, -.5, -.5, 0, .5, .5, 0, -.5, .5, 0, -.5, -.5, 0, .5, .5, 0, .5],
                  uv: [0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1],
                  ns: [0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0]
              }
          },
          triangle: function(F, P) {
              return zi([0, -.5, .5, .5, -.5, .5], [1, 2, 2, 5], F, P)
          },
          rightTriangle: function(w, o) {
              return zi([.5, .5, -.5, .5, -.5, -.5], [1, 2, 2, 5], w, o)
          },
          parallelogram: function(a, u) {
              return zi([.5, -.5, .25, .5, -.5, .5, -.25, -.5], [1, 2, 2, 2, 5], a, u)
          },
          trapezoid: function(y, f) {
              return zi([.25, -.5, .5, .5, -.5, .5, -.25, -.5], [1, 2, 2, 2, 5], y, f)
          }
      }
        , Dr = {
          sphere: 1,
          cylinder: 1,
          cone: 1,
          torus: 1
      }
        , Kf = {
          torus: 1,
          sphere: 1
      }
        , Fe = rc(Ej(Md), {
          cylinder: 1
      })
        , Ni = rc(Ej(Md), {
          cylinder: 1,
          cone: 1
      })
        , Zn = function(S, u, o) {
          var j, C = yn(S.anchor3d, o, u), N = yn(S.mat, o, u), H = yn(S.s3, o, u), z = yn(S.t3, o, u), G = yn(S.r3, o, u), i = H || G || z || N;
          if (C || i) {
              j = fs(u._6O);
              var h = i ? lp(N, H, G, yn(S.rotationMode, o, u), z) : zm();
              C && Bg(h, [.5 - C[0], .5 - C[1], .5 - C[2]]),
              Fb(u, h)
          }
          return j
      }
        , wc = function(K, D, t, Y, v, s, c) {
          if ($c(t))
              t.forEach(function(o) {
                  wc(K, D, o, Y, v, s, c)
              });
          else if (Xq(t))
              wc(K, D, hc(Y, t), Y, v, s, c);
          else if (Ql(t))
              if (t.shape3d) {
                  var R = Zn(t, K, D);
                  wc(K, D, t.shape3d, Y, v, s, t),
                  R && uo(K, R)
              } else
                  Je(K, D, t, Y.s, v, s, c)
      }
        , Je = function(w, q, F, e, H, v, g) {
          if (g = g || Li,
          !v || v(e("shape3d.transparent", F.transparent, g.transparent))) {
              var i = Zn(F, w, q);
              if (Ec(F)) {
                  var C = w.getData3dUI(q);
                  C.dispatchBoundingBoxChanged()
              }
              var Q = w._26I
                , s = w._prg
                , Z = w._buffer
                , R = e("shape3d.color", F.color, g.color);
              H || (H = e("shape3d.blend", F.blend, g.blend));
              var O, D = F.opacity == E ? g.opacity : F.opacity, K = e("shape3d.opacity");
              O = K != E && D != E ? D * K : D != E ? D : K,
              Xb(Q, s, H, e("shape3d.light", F.light, g.light), O, e("shape3d.reverse.flip", F.reverseFlip, g.reverseFlip), e("shape3d.reverse.color", F.reverseColor, g.reverseColor), e("shape3d.reverse.cull", F.reverseCull, g.reverseCull));
              var n = e("polygonOffset", F.polygonOffset, g.polygonOffset);
              F.vs && e(Qk, F.visible, g.visible) && zl(Q, s, Z, R, w.getTexture(e("shape3d.image", F.image, g.image), q), e("shape3d.discard.selectable", F.discardSelectable, g.discardSelectable), F.vs, F.uv, F.ns, F.is, e("shape3d.uv.offset", F.uvOffset, g.uvOffset), e("shape3d.uv.scale", F.uvScale, g.uvScale), n),
              F.top_vs && e(xb, F.topVisible, g.topVisible) && zl(Q, s, Z, e("shape3d.top.color", F.topColor, g.topColor) || R, w.getTexture(e("shape3d.top.image", F.topImage, g.topImage), q, "top"), e("shape3d.top.discard.selectable", F.topDiscardSelectable, g.topDiscardSelectable), F.top_vs, F.top_uv, F.top_ns, F.top_is, e("shape3d.top.uv.offset", F.topUvOffset, g.topUvOffset), e("shape3d.top.uv.scale", F.topUvScale, g.topUvScale), n),
              F.bottom_vs && e(Ge, F.bottomVisible, g.bottomVisible) && zl(Q, s, Z, e("shape3d.bottom.color", F.bottomColor, g.bottomColor) || R, w.getTexture(e("shape3d.bottom.image", F.bottomImage, g.bottomImage), q, "bottom"), e("shape3d.bottom.discard.selectable", F.bottomDiscardSelectable, g.bottomDiscardSelectable), F.bottom_vs, F.bottom_uv, F.bottom_ns, F.bottom_is, e("shape3d.bottom.uv.offset", F.bottomUvOffset, g.bottomUvOffset), e("shape3d.bottom.uv.scale", F.bottomUvScale, g.bottomUvScale), n),
              F.from_vs && e(so, F.fromVisible, g.fromVisible) && zl(Q, s, Z, e("shape3d.from.color", F.fromColor, g.fromColor) || R, w.getTexture(e("shape3d.from.image", F.fromImage, g.fromImage), q, "from"), e("shape3d.from.discard.selectable", F.fromDiscardSelectable, g.fromDiscardSelectable), F.from_vs, F.from_uv, F.from_ns, F.from_is, e("shape3d.from.uv.offset", F.fromUvOffset, g.fromUvOffset), e("shape3d.from.uv.scale", F.fromUvScale, g.fromUvScale), n),
              F.to_vs && e(fn, F.toVisible, g.toVisible) && zl(Q, s, Z, e("shape3d.to.color", F.toColor, g.toColor) || R, w.getTexture(e("shape3d.to.image", F.toImage, g.toImage), q, "to"), e("shape3d.to.discard.selectable", F.toDiscardSelectable, g.toDiscardSelectable), F.to_vs, F.to_uv, F.to_ns, F.to_is, e("shape3d.to.uv.offset", F.toUvOffset, g.toUvOffset), e("shape3d.to.uv.scale", F.toUvScale, g.toUvScale), n),
              he(Q, s),
              i && uo(w, i)
          }
      }
        , zl = function(J, v, r, g, t, b, x, F, W, Q, h, R, $) {
          if (x) {
              $ && Hg(J, $);
              var B = Vj.for(J)
                , A = B.directUniforms()
                , w = B.directAttribs();
              A.uDiffuse = g || U["color.empty"],
              F ? nb(J, v, t, b, r.uv, F, h, R) : nb(J),
              w.aPosition = Bm(J, r.vs, x, E),
              w.aNormal = Bm(J, r.ns, W, E),
              Q ? (se(J, r.is, Q),
              Hh(J, 0, Q.length, null, Q instanceof Uint32Array ? J.UNSIGNED_INT : null)) : rp(J, 0, x.length / 3),
              F ? am(J, v, t) : am(J),
              $ && ac(J)
          }
      }
        , hc = function(O, n) {
          var L = O.s;
          if (n || (n = L(_o)),
          !n)
              return E;
          var y = Jq(n);
          if (y)
              return y;
          if ("text" === n) {
              var m = {
                  amount: L("shape3d.text.amount"),
                  size: L("shape3d.text.size"),
                  font: L("shape3d.text.font"),
                  style: L("shape3d.text.style"),
                  weight: L("shape3d.text.weight"),
                  fill: L("shape3d.text.fill"),
                  curveSegments: L("shape3d.text.curveSegments"),
                  spacing: L("shape3d.text.spacing")
              }
                , S = O.gv.getShape3dText(O.data)
                , o = S;
              for (var J in m)
                  o += "_" + (m[J] === V ? "U" : m[J]);
              return O._cachedTextKey === o ? O._cachedTextGeometry : (O._cachedTextKey = o,
              O._cachedTextGeometry = M.createTextGeometry(S, m))
          }
          var J = n;
          if (Dr[n]) {
              var Z = L("shape3d.side")
                , d = L("shape3d.side.from")
                , N = L("shape3d.side.to")
                , Q = L(so)
                , j = L(fn);
              3 > Z ? (Z = 0,
              d = 0,
              N = 0,
              Q = !1,
              j = !1) : ((d == E || 0 > d) && (d = 0),
              (N == E || N > Z) && (N = Z),
              0 === d && N === Z && (Q = !1,
              j = !1));
              var z = "cone" === n ? !1 : L("shape3d.smooth");
              J += "-" + Z + "-" + d + "-" + N + "-" + Q + "-" + j + (z ? 1 : 0)
          }
          if (Fe[n]) {
              var U = L(xb);
              J += "-" + U
          }
          if (Ni[n]) {
              var _ = L(Ge);
              J += "-" + _
          }
          if ("torus" === n) {
              var P = L("shape3d.torus.radius");
              0 > P ? P = 0 : P > .25 && (P = .25),
              J += "-" + P
          }
          if (Kf[n]) {
              var g = L(Xn);
              J += "-" + g
          }
          return y = Yo[J],
          y || ("box" === n ? y = M.createBoxModel() : Md[n] ? y = Md[n](U, _) : "sphere" === n ? y = M.createSphereModel(Z, d, N, Q, j, g, z) : n === jl ? y = M.createCylinderModel(Z, d, N, Q, j, U, _, z) : "cone" === n ? y = M.createConeModel(Z, d, N, Q, j, _) : "torus" === n && (y = M.createTorusModel(Z, d, N, Q, j, P, g, z)),
          Yo[J] = y),
          y
      }
        , Ec = function() {
          var t = ["vs", "ns", "uv", "top_vs", "top_ns", "top_uv", "bottom_vs", "bottom_ns", "bottom_uv", "from_vs", "from_ns", "from_uv", "to_vs", "to_ns", "to_uv", "er", "al"]
            , z = ["is", "top_is", "bottom_is", "from_is", "to_is"];
          return L = Nl(Vc.substr(Vc.indexOf("^#") + 2)),
          wi(M[bc(Fj + t[15] + "n" + t[16])]()) && Ue() ? function(c) {
              return c && !c._complete_ ? (c._complete_ = !0,
              c.vs && Og(c.ns) && (c.ns = Yc(c.vs, c.is),
              c.boundingBox = V),
              c.top_vs && Og(c.top_ns) && (c.top_ns = Yc(c.top_vs, c.top_is),
              c.top_boundingBox = V),
              c.bottom_vs && Og(c.bottom_ns) && (c.bottom_ns = Yc(c.bottom_vs, c.bottom_is),
              c.bottom_boundingBox = V),
              c.from_vs && Og(c.from_ns) && (c.from_ns = Yc(c.from_vs, c.from_is),
              c.from_boundingBox = V),
              c.to_vs && Og(c.to_ns) && (c.to_ns = Yc(c.to_vs, c.to_is),
              c.to_boundingBox = V),
              t.forEach(function(B) {
                  var H = c[B];
                  $c(H) && (c[B] = new ld(H))
              }),
              z.forEach(function(j) {
                  var t = c[j];
                  $c(t) && (c[j] = new dj(t))
              }),
              !0) : !1
          }
          : void 0
      }()
        , ee = function(H, w) {
          var l = H[w];
          $c(l) && (H[w] = new ld(l))
      };
      rc(tb, {
          _25Q: function(v) {
              v._16O = function(q, u, h, O, M, K, A, Z, m) {
                  var D = this.info;
                  if (D) {
                      var Y, $, U, _, N, e, G = zm();
                      if (ab[u] ? (Y = D.p3,
                      $ = D.c1,
                      U = D.c2) : Ie[u] ? ($ = D.s1 || D.c1,
                      U = D.s2 || D.c2) : ($ = D.t1 || D.c1,
                      U = D.t2 || D.c2),
                      Y)
                          e = wp(u, kd, h, O, Z, m);
                      else {
                          var H = Bb(U, $)
                            , k = Qf($, U);
                          _ = [0, -a(H[2], H[0]), i(H[1] / k)],
                          N = "zyx",
                          Y = [($[0] + U[0]) / 2, ($[1] + U[1]) / 2, ($[2] + U[2]) / 2],
                          e = wp(u, [k, 0, 0], h, O, Z, m)
                      }
                      return as(G, e, Y, O, M, K, A, q, _, N)
                  }
                  return Lm
              }
              ,
              v._80o = function($, F, X) {
                  var S = this
                    , i = S.shapeModel;
                  if (i) {
                      var k = S.gv;
                      Fb(k),
                      wc(k, S.data, i, S, S.getBodyColor(), X)
                  }
              }
              ,
              v.createLineModel = function(j, H, k, W, s) {
                  var e = this
                    , u = e.s
                    , d = cd(j, H, u(Xn))
                    , L = u(W + ".color");
                  if (L) {
                      for (var x = [], m = 0; m < d.length; m++) {
                          var q = d[m]
                            , f = q.length;
                          if (f > 1) {
                              var G = q[0];
                              x.push(G.x, G.y, G.z);
                              for (var D = 1; f - 1 > D; D++)
                                  G = q[D],
                                  x.push(G.x, G.y, G.z),
                                  x.push(G.x, G.y, G.z);
                              G = q[f - 1],
                              x.push(G.x, G.y, G.z)
                          }
                      }
                      var K, I, o, S = u(s), z = 0;
                      S && (I = u(s + ".color"),
                      K = u(s + ".pattern"),
                      z = u(s + ".offset"),
                      o = L),
                      Ym(e.gv, e.data, x, I || L, o ? E : u(W + ".gradient.color"), k, K || u(W + ".pattern"), z, o)
                  }
                  return d
              }
              ,
              v.createTubeModel = function(d, S, y, N) {
                  for (var $ = this, c = $.s, m = c("shape3d.side") || Zj, n = c("shape3d.start.angle"), V = c("shape3d.sweep.angle"), J = c(xb) ? c("shape3d.top.cap") : E, O = c(Ge) ? c("shape3d.bottom.cap") : E, u = "flat" === J, U = "flat" === O, Z = u && (N ? N.uv : c("shape3d.top.image")), h = U && (N ? N.uv : c("shape3d.bottom.image")), k = N ? N.uv : c("shape3d.image"), t = c("shape3d.smooth"), e = {
                      vs: [],
                      uv: k ? [] : E,
                      ns: t ? [] : E,
                      top_vs: u ? [] : E,
                      top_uv: Z ? [] : E,
                      bottom_vs: U ? [] : E,
                      bottom_uv: h ? [] : E
                  }, C = cd(d, S, c(Xn), y), j = 0, x = C.length; x > j; j++)
                      ql(e, C[j], c(kg), y, m, n, V, J, O);
                  if (N) {
                      var l = [];
                      ln($.gv, $.data, e, $, $.getBodyColor(), $.mat ? [$.mat] : [], N, l),
                      l.length && (ph(N.vs, l),
                      ph(N.ns, Yc(l)))
                  } else
                      $.shapeModel = e;
                  return C
              }
              ,
              v.getCache = function() {
                  var N = this.info;
                  if (N) {
                      var l = N.list;
                      if (l) {
                          var I = N.cache;
                          return I || (I = N.cache = db(l)),
                          I
                      }
                  }
                  return E
              }
          }
      });
      var Br = function(W, p) {
          for (var y, b = 0, F = W.length, V = 0, E = F - 1; E >= V; )
              if (b = q(V + (E - V) / 2),
              y = W[b].length - p,
              0 > y)
                  V = b + 1;
              else {
                  if (!(y > 0)) {
                      E = b;
                      break
                  }
                  E = b - 1
              }
          b = E;
          var U = W[b]
            , t = U.point;
          return b === F - 1 || U.length === p || (t = (new vm).subVectors(W[b + 1].point, t).normalize().multiplyScalar(p - U.length).add(t)),
          {
              point: t,
              tangent: U.tangent
          }
      }
        , db = function(V) {
          for (var L, q, t = [], d = 0, F = 0; F < V.length; F++) {
              for (var u = V[F], k = 0; k < u.length; k++) {
                  L = u[k],
                  q && (d += q.distanceTo(L));
                  var h = new vm
                    , e = u[k + 1];
                  e ? h.subVectors(e, L) : q ? h.subVectors(L, q) : h.x = 1,
                  h.normalize(),
                  t.push({
                      point: L,
                      length: d,
                      tangent: h
                  }),
                  q = L
              }
              q = null
          }
          return t
      }
        , cd = function(p, R, Q, y) {
          Q = Q || xi;
          for (var Z = [], a = 0, C = p.size(); C > a; a++) {
              var T = p.get(a);
              Z.push(new vm(T.x,T.e || 0,T.y))
          }
          R && (fb(R) && (R = R._as),
          R.length || (R = null));
          for (var B, q, J, m, c, o = [], r = 0, l = 0, d = R ? R.length : C; d > l; l++)
              if (c = R ? R[l] : 0 === l ? 1 : 2,
              1 === c)
                  o.push(J = []),
                  J.push(Z[r++]);
              else if (2 === c || 5 === c)
                  if (m = 2 === c ? Z[r++] : J[0],
                  y) {
                      var A = R ? R[l + 1] : d > l + 1 ? 2 : E;
                      if (2 === A || 5 === A) {
                          var Y = J[J.length - 1]
                            , u = 2 === A ? Z[r] : J[0]
                            , k = (new vm).subVectors(Y, m)
                            , N = (new vm).subVectors(u, m)
                            , g = k.length()
                            , W = N.length();
                          if (g && W)
                              if (y > g / 2 && y > W / 2)
                                  J.push(m);
                              else
                                  for (k.multiplyScalar(K(y, g / 2) / g).add(m),
                                  N.multiplyScalar(K(y, W / 2) / W).add(m),
                                  B = new Sr(k,m,N).getPoints(Q),
                                  q = 0; Q >= q; q++)
                                      J.push(B[q])
                      } else
                          J.push(m)
                  } else
                      J.push(m);
              else if (3 === c)
                  for (B = new Sr(J[J.length - 1],Z[r++],Z[r++]).getPoints(Q),
                  q = 1; Q >= q; q++)
                      J.push(B[q]);
              else if (4 === c)
                  for (B = new Sd(J[J.length - 1],Z[r++],Z[r++],Z[r++]).getPoints(Q),
                  q = 1; Q >= q; q++)
                      J.push(B[q]);
          return o
      }
        , Vo = function(P) {
          for (var q, e, W = new vm, o = [], O = [], $ = [], i = 0, U = P.length; U > i; i++)
              q = P[i],
              e = P[i + 1],
              e ? W.subVectors(e, q) : W.subVectors(q, P[i - 1]),
              o.push(W.normalize().clone());
          var w, E, G, n, v = new vm, k = new vm, l = new Uq, h = 1e-4, I = Number.MAX_VALUE, L = o[0], b = O[0] = new vm, D = $[0] = new vm;
          for (E = u(L.x),
          G = u(L.y),
          n = u(L.z),
          I >= E && (I = E,
          v.set(1, 0, 0)),
          I >= G && (I = G,
          v.set(0, 1, 0)),
          I >= n && v.set(0, 0, 1),
          k.crossVectors(L, v).normalize(),
          b.crossVectors(L, k),
          D.crossVectors(L, b),
          i = 1; U > i; i++)
              O[i] = O[i - 1].clone(),
              $[i] = $[i - 1].clone(),
              k.crossVectors(o[i - 1], o[i]),
              k.length() > h && (k.normalize(),
              w = R(al(o[i - 1].dot(o[i]), -1, 1)),
              O[i].applyMatrix4(l.makeRotationAxis(k, w))),
              $[i].crossVectors(o[i], O[i]);
          return {
              B: $,
              T: o,
              N: O
          }
      }
        , ql = function() {
          var j = function(q) {
              for (var W = 1; W < arguments.length; W++) {
                  var I = arguments[W];
                  q.push(I.x, I.y, I.z)
              }
          }
            , G = function(L) {
              for (var x = 1; x < arguments.length; x++) {
                  var Y = arguments[x].uv;
                  L.push(Y[0], Y[1])
              }
          }
            , h = function(B) {
              for (var n = 1; n < arguments.length; n++) {
                  var p = arguments[n].ns;
                  B.push(p[0], p[1], p[2])
              }
          }
            , K = function(y, u, e, I, f) {
              var M = -I * P(f)
                , L = I * o(f);
              return new vm(y.x + M * e.x + L * u.x,y.y + M * e.y + L * u.y,y.z + M * e.z + L * u.z)
          }
            , b = function(P, I, f, V, c, G, d, J, $) {
              d = d || y;
              for (var o, R = [], T = d / c, o = $ ? new Rh : E, g = 0; c >= g; g++) {
                  var k = K(P, I, f, V, g * T + G);
                  R.push(k),
                  J != E && (k.uv = [J, 1 - g / c]),
                  $ && (k.ns = o.subVectors(k, P).normalize().toArray())
              }
              return R
          }
            , L = function(c, O, Y, m, A, q, u, B, h) {
              h = h || y;
              var R = O ? c.top_vs : c.bottom_vs;
              if (R)
                  for (var l = O ? c.top_uv : c.bottom_uv, U = h / u, w = 0; u > w; w++) {
                      var $, b;
                      O ? ($ = w * U + B,
                      b = (w + 1) * U + B) : (b = w * U + B,
                      $ = (w + 1) * U + B),
                      j(R, K(Y, m, A, q, $), K(Y, m, A, q, b), Y),
                      l && l.push(.5 - .5 * P($), .5 - .5 * o($), .5 - .5 * P(b), .5 - .5 * o(b), .5, .5)
                  }
          };
          return function(S, x, l, F, I, W, J, B, N) {
              var Z = x.length;
              if (Z > 1) {
                  var X, D, A, r, u, Q, M, Y = Vo(x), t = Y.T, K = Y.N, i = Y.B;
                  "flat" === B && L(S, !0, x[0], i[0], K[0], F, I, W, J),
                  "flat" === N && L(S, !1, x[Z - 1], i[Z - 1], K[Z - 1], F, I, W, J);
                  var c, w, f = [], C = z(I / 2), q = "round" === B, n = "round" === N, a = x[0], p = t[0], o = i[0], T = K[0], _ = x[Z - 1], v = t[Z - 1], P = i[Z - 1], d = K[Z - 1];
                  if (q) {
                      for (A = 1; C >= A; A++)
                          K.splice(0, 0, T),
                          i.splice(0, 0, o),
                          t.splice(0, 0, p),
                          w = -A / C * F,
                          x.splice(0, 0, p.clone().multiplyScalar(w).add(a)),
                          f[C - A] = O(F * F - w * w);
                      Z += C
                  }
                  if (n) {
                      for (A = 1; C >= A; A++)
                          K.push(d),
                          i.push(P),
                          t.push(v),
                          w = A / C * F,
                          x.push(v.clone().multiplyScalar(w).add(_)),
                          f[x.length - 1] = O(F * F - w * w);
                      Z += C
                  }
                  if (S.uv) {
                      var H = 0
                        , e = 0
                        , k = [];
                      for (l && (H = l),
                      u = x[0],
                      k[0] = 0,
                      A = 1; Z > A; A++)
                          r = x[A],
                          k[A] = u.distanceTo(r),
                          u = r,
                          l || (H += k[A]);
                      for (c = [],
                      A = 0; Z > A; A++)
                          e += k[A],
                          c[A] = H ? e / H : 0
                  }
                  var U = S.ns ? !0 : !1;
                  for (A = 0; Z > A; A++) {
                      if (r = x[A],
                      Q = i[A],
                      M = K[A],
                      X = b(r, Q, M, f[A] === V ? F : f[A], I, W, J, c ? c[A] : E, U),
                      D)
                          for (var y = 0; I > y; y++) {
                              var $ = D[y]
                                , m = D[y + 1] || D[0]
                                , R = X[y]
                                , s = X[y + 1] || X[0];
                              j(S.vs, m, $, R, R, s, m),
                              S.uv && G(S.uv, m, $, R, R, s, m),
                              U && h(S.ns, m, $, R, R, s, m)
                          }
                      D = X
                  }
              }
          }
      }();
      rc(M, {
          getLineLength: function(Z) {
              return Z[Z.length - 1].length
          },
          getLineOffset: function(E, h) {
              return Br(E, h)
          },
          getLineCacheInfo: function(I, r, v, w) {
              return db(cd(I, r, v, w))
          }
      });
      var _p = n.graph3d.RenderLite = {}
        , Zi = new Array(0)
        , Nm = _p.Buffer = function(C, c, x, e) {
          this.gl = C,
          this.buffer = C.createBuffer(),
          this.type = c || C.ARRAY_BUFFER,
          this.drawType = e || C.STATIC_DRAW,
          this.data = Zi,
          x && this.upload(x)
      }
      ;
      Nm.prototype.upload = function(P, j, e) {
          e || this.bind();
          var f = this.gl;
          P = P || this.data,
          j = j || 0,
          this.data.byteLength >= P.byteLength ? f.bufferSubData(this.type, j, P) : f.bufferData(this.type, P, this.drawType),
          this.data = P
      }
      ,
      Nm.prototype.bind = function() {
          var t = this.gl;
          t.bindBuffer(this.type, this.buffer)
      }
      ,
      Nm.createVertexBuffer = function(W, K, S) {
          return new Nm(W,W.ARRAY_BUFFER,K,S)
      }
      ,
      Nm.createIndexBuffer = function(W, L, C) {
          return new Nm(W,W.ELEMENT_ARRAY_BUFFER,L,C)
      }
      ,
      Nm.create = function(l, t, s, T) {
          return new Nm(l,t,T)
      }
      ,
      Nm.prototype.destroy = function() {
          this.gl.deleteBuffer(this.buffer)
      }
      ;
      var Fh = _p.Shader = function(y, b, _) {
          this.gl = y,
          this.program = Rg(y, b, _),
          this.attributes = Ic(y, this.program);
          var e = Ep(y, this.program);
          this.uniforms = Sf(y, e)
      }
      ;
      Fh.prototype.bind = function() {
          this.gl.useProgram(this.program)
      }
      ,
      Fh.prototype.destroy = function() {
          this.gl
      }
      ;
      var Rg = function(w, $, o) {
          var O = Se(w, w.VERTEX_SHADER, $)
            , v = Se(w, w.FRAGMENT_SHADER, o);
          w.getShaderParameter(v, w.COMPILE_STATUS) || console.error(w.getError());
          var U = w.createProgram();
          return w.attachShader(U, O),
          w.attachShader(U, v),
          w.linkProgram(U),
          w.getProgramParameter(U, w.LINK_STATUS) || (console.error("Error: Could not initialize shader."),
          console.error("gl.VALIDATE_STATUS", w.getProgramParameter(U, w.VALIDATE_STATUS)),
          console.error("gl.getError()", w.getError()),
          "" !== w.getProgramInfoLog(U) && console.warn("Warning: gl.getProgramInfoLog()", w.getProgramInfoLog(U)),
          w.deleteProgram(U),
          U = null),
          w.deleteShader(O),
          w.deleteShader(v),
          U
      }
        , Se = function(d, w, E) {
          var v = d.createShader(w);
          return d.shaderSource(v, E),
          d.compileShader(v),
          d.getShaderParameter(v, d.COMPILE_STATUS) ? v : (console.log(d.getShaderInfoLog(v)),
          null)
      }
        , Ep = function(q, n) {
          for (var P = {}, s = q.getProgramParameter(n, q.ACTIVE_UNIFORMS), $ = 0; s > $; $++) {
              var B = q.getActiveUniform(n, $)
                , V = B.name.replace(/\[.*?\]/, "")
                , K = hl(q, B.type);
              P[V] = {
                  type: K,
                  size: B.size,
                  location: q.getUniformLocation(n, V),
                  value: ve(K, B.size)
              }
          }
          return P
      }
        , Ic = function(r, e) {
          for (var Y = {}, c = r.getProgramParameter(e, r.ACTIVE_ATTRIBUTES), K = 0; c > K; K++) {
              var D = r.getActiveAttrib(e, K)
                , P = hl(r, D.type);
              Y[D.name] = {
                  type: P,
                  size: Yk(P),
                  gl: r,
                  location: r.getAttribLocation(e, D.name),
                  pointer: rl
              }
          }
          return Y
      }
        , rl = function(q, Y, l, c, V) {
          var X = this.gl;
          X.enableVertexAttribArray(this.location),
          q instanceof _p.Buffer || (q = _p.Buffer.createVertexBuffer(X, q)),
          X.bindBuffer(q.type, q.buffer),
          X.vertexAttribPointer(this.location, this.size, Y || X.FLOAT, l || !1, c || 0, V || 0)
      }
        , Yk = function(w) {
          return Xi[w]
      }
        , Xi = {
          "float": 1,
          vec2: 2,
          vec3: 3,
          vec4: 4,
          "int": 1,
          ivec2: 2,
          ivec3: 3,
          ivec4: 4,
          bool: 1,
          bvec2: 2,
          bvec3: 3,
          bvec4: 4,
          mat2: 4,
          mat3: 9,
          mat4: 16,
          sampler2D: 1
      }
        , hl = function(z, C) {
          if (!qm) {
              var v = G.keys(el);
              qm = {};
              for (var N = 0; N < v.length; ++N) {
                  var M = v[N];
                  qm[z[M]] = el[M]
              }
          }
          return qm[C]
      }
        , qm = null
        , el = {
          FLOAT: "float",
          FLOAT_VEC2: "vec2",
          FLOAT_VEC3: "vec3",
          FLOAT_VEC4: "vec4",
          INT: "int",
          INT_VEC2: "ivec2",
          INT_VEC3: "ivec3",
          INT_VEC4: "ivec4",
          BOOL: "bool",
          BOOL_VEC2: "bvec2",
          BOOL_VEC3: "bvec3",
          BOOL_VEC4: "bvec4",
          FLOAT_MAT2: "mat2",
          FLOAT_MAT3: "mat3",
          FLOAT_MAT4: "mat4",
          SAMPLER_2D: "sampler2D"
      }
        , ve = function(Y, n) {
          switch (Y) {
          case "float":
              return 0;
          case "vec2":
              return new Float32Array(2 * n);
          case "vec3":
              return new Float32Array(3 * n);
          case "vec4":
              return new Float32Array(4 * n);
          case "int":
          case "sampler2D":
              return 0;
          case "ivec2":
              return new Int32Array(2 * n);
          case "ivec3":
              return new Int32Array(3 * n);
          case "ivec4":
              return new Int32Array(4 * n);
          case "bool":
              return !1;
          case "bvec2":
              return rg(2 * n);
          case "bvec3":
              return rg(3 * n);
          case "bvec4":
              return rg(4 * n);
          case "mat2":
              return new Float32Array([1, 0, 0, 1]);
          case "mat3":
              return new Float32Array([1, 0, 0, 0, 1, 0, 0, 0, 1]);
          case "mat4":
              return new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1])
          }
      }
        , rg = function(D) {
          for (var g = new Array(D), A = 0; A < g.length; A++)
              g[A] = !1;
          return g
      }
        , Sf = function(V, q) {
          var x = {
              data: {}
          };
          x.gl = V;
          for (var R = G.keys(q), Q = 0; Q < R.length; Q++) {
              var h = R[Q]
                , w = h.split(".")
                , K = w[w.length - 1]
                , J = Ad(w, x)
                , e = q[h];
              J.data[K] = e,
              J.gl = V,
              G.defineProperty(J, K, {
                  get: Cl(K),
                  set: yk(K, e)
              })
          }
          return x
      }
        , Cl = function(D) {
          var $ = Lf.replace("%%", D);
          return new Function($)
      }
        , yk = function(I, R) {
          var j, k = Yf.replace(/%%/g, I);
          return j = 1 === R.size ? wb[R.type] : qi[R.type],
          j && (k += "\nthis.gl." + j + ";"),
          new Function("value",k)
      }
        , Ad = function(e, s) {
          for (var F = s, x = 0; x < e.length - 1; x++) {
              var d = F[e[x]] || {
                  data: {}
              };
              F[e[x]] = d,
              F = d
          }
          return F
      }
        , Lf = ["return this.data.%%.value;"].join("\n")
        , Yf = ["this.data.%%.value = value;", "var location = this.data.%%.location;"].join("\n")
        , wb = {
          "float": "uniform1f(location, value)",
          vec2: "uniform2f(location, value[0], value[1])",
          vec3: "uniform3f(location, value[0], value[1], value[2])",
          vec4: "uniform4f(location, value[0], value[1], value[2], value[3])",
          "int": "uniform1i(location, value)",
          ivec2: "uniform2i(location, value[0], value[1])",
          ivec3: "uniform3i(location, value[0], value[1], value[2])",
          ivec4: "uniform4i(location, value[0], value[1], value[2], value[3])",
          bool: "uniform1i(location, value)",
          bvec2: "uniform2i(location, value[0], value[1])",
          bvec3: "uniform3i(location, value[0], value[1], value[2])",
          bvec4: "uniform4i(location, value[0], value[1], value[2], value[3])",
          mat2: "uniformMatrix2fv(location, false, value)",
          mat3: "uniformMatrix3fv(location, false, value)",
          mat4: "uniformMatrix4fv(location, false, value)",
          sampler2D: "uniform1i(location, value)"
      }
        , qi = {
          "float": "uniform1fv(location, value)",
          vec2: "uniform2fv(location, value)",
          vec3: "uniform3fv(location, value)",
          vec4: "uniform4fv(location, value)",
          "int": "uniform1iv(location, value)",
          ivec2: "uniform2iv(location, value)",
          ivec3: "uniform3iv(location, value)",
          ivec4: "uniform4iv(location, value)",
          bool: "uniform1iv(location, value)",
          bvec2: "uniform2iv(location, value)",
          bvec3: "uniform3iv(location, value)",
          bvec4: "uniform4iv(location, value)",
          sampler2D: "uniform1iv(location, value)"
      }
        , En = function(F) {
          function c(F) {
              if ("string" != typeof F)
                  return 0 | F;
              switch (F) {
              case "low":
                  return 512;
              case "medium":
                  return 1024;
              case "ultra":
                  return 4096;
              default:
                  return 2048
              }
          }
          var j = this;
          j.enable = !1;
          var o, k, R = M.graph3dViewShadowType, P = M.graph3dViewShadowIntensity, D = M.graph3dViewShadowBias, L = M.graph3dViewShadowQuality, J = M.graph3dViewShadowRadius, K = M.graph3dViewShadowDegreeX, W = M.graph3dViewShadowDegreeZ, Z = 1, s = c(L), Y = !1, i = new n.Math.Matrix4, B = new n.Math.Matrix4, O = j.pvMatrix = new n.Math.Matrix4;
          j.render = function() {
              if (!F._picking && j.enable) {
                  var $ = F.getGL();
                  if ($) {
                      Y && j.setupShadowCamera(),
                      F._glCapabilities && (s = Math.min(s, F._glCapabilities.maxTextureSize)),
                      j.map ? o.setSize(s, s) : o = j.map = new hm(F,F.getGL(),0,0,{
                          samples: 1,
                          minFilter: Cg.NEAREST,
                          magFilter: Cg.NEAREST,
                          width: s,
                          height: s
                      }),
                      $._shadowShader || ($._shadowShader = new _p.Shader($,En.shaderSrc.vs,En.shaderSrc.fs));
                      var Z = F._frameState
                        , P = Z.renderState.glState;
                      P.blend.enabled = !1,
                      P.depth.enabled = !0,
                      P.depth.mask = !0;
                      var L = P.color.clear.slice(0);
                      yf($, [1, 1, 1, 1]),
                      Z.renderState.useProgram($._shadowShader.program),
                      h(),
                      yf($, L)
                  }
              }
          }
          ,
          j.getShadow = function() {
              var x = {
                  degreeX: K,
                  degreeZ: W,
                  intensity: P,
                  quality: L,
                  type: R,
                  radius: J,
                  bias: D
              };
              return 1 !== Z && (x.boundExtend = Z),
              x
          }
          ,
          j.setShadow = function(G, N) {
              G = !!G;
              var k = j.enable !== G;
              j.enable = G,
              "object" == typeof N && (N.intensity !== V && (P = N.intensity),
              N.bias !== V && (D = N.bias),
              N.radius !== V && (J = N.radius),
              N.degreeX !== V && (K = N.degreeX),
              N.degreeZ !== V && (W = N.degreeZ),
              N.quality !== V && (L = N.quality),
              N.type !== V && R !== N.type && (R = N.type,
              k = !0),
              s = c(L),
              N.boundExtend !== V && (Z = N.boundExtend)),
              G && j.setupShadowCamera(),
              k && gr(F),
              F.iv()
          }
          ,
          j.refresh = function() {
              this.enable && (this.setupShadowCamera(),
              F.iv())
          }
          ,
          j.tryUpdateBounding = function(U) {
              var E = this.boundingSphere;
              if (E) {
                  var W = (new Sc).fromArray(Dp(U, F.getMat(U)))
                    , o = U.getAnchor3d()
                    , c = new Rh;
                  E.containsPoint(c.set(0 - o.x, 0 - o.y, 0 - o.z).applyMatrix4(W)) && E.containsPoint(c.set(0 - o.x, 0 - o.y, 1 - o.z).applyMatrix4(W)) && E.containsPoint(c.set(0 - o.x, 1 - o.y, 0 - o.z).applyMatrix4(W)) && E.containsPoint(c.set(0 - o.x, 1 - o.y, 1 - o.z).applyMatrix4(W)) && E.containsPoint(c.set(1 - o.x, 0 - o.y, 0 - o.z).applyMatrix4(W)) && E.containsPoint(c.set(1 - o.x, 0 - o.y, 1 - o.z).applyMatrix4(W)) && E.containsPoint(c.set(1 - o.x, 1 - o.y, 0 - o.z).applyMatrix4(W)) && E.containsPoint(c.set(1 - o.x, 1 - o.y, 1 - o.z).applyMatrix4(W)) || j.setupShadowCamera()
              }
          }
          ,
          j.createShadow = function(r) {
              r || (r = F._frameState.renderState.directUniforms()),
              r.shadowMatrix = O.toArray(),
              r.shadowMap = o.texture,
              r.shadowSize = [o.width, o.height],
              r.shadowIntensity = P,
              r.shadowBias = D,
              r.shadowRadius = J
          }
          ,
          j.genShaderDefine = function() {
              var z = "#define USE_SHADOWMAP\n";
              return "hard" === R ? z += "#define SHADOWMAP_TYPE_PCF\n" : "soft" === R && (z += "#define SHADOWMAP_TYPE_PCF_SOFT\n"),
              z
          }
          ;
          var r;
          j.setupShadowCamera = function() {
              k || (k = j.boundingSphere = new n.Math.Sphere),
              Y = !1;
              var s, $, B = F.getBoundingBox(F.dm().toDatas(function(o) {
                  return o.s("shadow.cast") && F.isVisible(o)
              }));
              B ? (s = new Rh(B.min),
              $ = new Rh(B.max)) : (s = new Rh(-256,-256,-256),
              $ = new Rh(256,256,256),
              Y = !0),
              k.set(s.clone().add($).multiplyScalar(.5), .5 * s.distanceTo($) * Z);
              var q, p = k.radius, f = F.getBoundingBox(F.dm().toDatas(function(z) {
                  return (z.s("shadow.cast") || z.s("shadow.receive")) && F.isVisible(z)
              }));
              if (f) {
                  s.copy(f.min),
                  $.copy(f.max);
                  var Q = .5 * s.distanceTo($);
                  q = Q + Math.min(Q, p + k.center.distanceTo(s.add($).multiplyScalar(.5)))
              } else
                  q = 2 * p;
              r = uq(zm(), -p, p, -p, p, q / 1e3, q),
              O.set(.5, 0, 0, .5, 0, .5, 0, .5, 0, 0, .5, .5, 0, 0, 0, 1),
              O.multiply(i.fromArray(r));
              var u = Math.tan(-K * Math.PI / 180)
                , x = Math.tan(-W * Math.PI / 180)
                , t = p / Math.sqrt(u * u + x * x + 1)
                , C = new Rh(t * u,t,t * x);
              i.lookAt(C, new Rh(0,0,0), new Rh(0,1,0)).setPosition(C.add(k.center)),
              i.getInverse(i),
              O.multiply(i)
          }
          ;
          var h = function() {
              var i = F.getGL()
                , u = s
                , R = s;
              o.setSize(i, u, R),
              o.bind(i),
              i.clear(Cg.COLOR_BUFFER_BIT | Cg.DEPTH_BUFFER_BIT);
              var N = F._frameState
                , V = N.renderState
                , T = V.directUniforms()
                , S = V.directAttribs()
                , E = V.directState();
              T.projectionMatrix = r;
              var h = F._viewport;
              F.setViewport(i, 0, 0, u, R);
              var Q, O, d, c;
              for (Q = 0,
              O = Vg.length; O > Q; Q++)
                  d = Vg[Q],
                  ug[d].ignore || (c = F._40Q.get(d),
                  c && (j.renderItems(i, T, S, c.opaque, E),
                  j.renderItems(i, T, S, c.transparent, E)));
              o.unbind(i),
              F.setViewport(i, h[0], h[1], h[2], h[3])
          };
          j._renderDirect = function(j, k, C, V) {
              C && C.length && (k.position = Bm(j, F._buffer.vs, C, E),
              V ? (se(j, F._buffer.is, V),
              Hh(j, 0, V.length, null, V instanceof Uint32Array ? j.UNSIGNED_INT : null)) : rp(j, 0, C.length / 3))
          }
          ,
          j.renderShapeModel = function(H, A, e, c) {
              var U, Z, V;
              if ($c(e))
                  for (Z = 0,
                  V = e.length; V > Z; Z++)
                      U = e[Z],
                      U && j.renderShapeModel(H, A, U, c);
              else
                  Xq(e) ? j.renderShapeModel(H, A, hc(c, e), c) : Ql(e) && (e.shape3d ? j.renderShapeModel(H, A, e.shape3d, c) : j.renderShapeModelImpl(H, A, e))
          }
          ,
          j.renderShapeModelImpl = function(v, t, Z) {
              Ec(Z),
              j._renderDirect(v, t, Z.vs, Z.is),
              j._renderDirect(v, t, Z.top_vs, Z.top_is),
              j._renderDirect(v, t, Z.bottom_vs, Z.bottom_is),
              j._renderDirect(v, t, Z.from_vs, Z.from_is),
              j._renderDirect(v, t, Z.to_vs, Z.to_is)
          }
          ,
          j.renderItems = function(A, g, O, T, c) {
              var X, o, u, I, v, U = T.length;
              for (X = 0; U > X; X++)
                  o = T[X],
                  I = o.ui,
                  u = o.data,
                  !fp(u) && u.s("shadow.cast") && F.isVisible(u) && (v = I.shapeModel || hc(I),
                  v || (v = u instanceof n.Node && !(u instanceof n.Shape) ? {
                      vs: qj,
                      is: Vh
                  } : [I.left, I.front, I.right, I.back, I.top, I.bottom]),
                  g.modelViewMatrix = (I.mat ? B.fromArray(I.mat) : B.identity()).premultiply(i).toArray(),
                  c.cullFace.enabled = !!u.s("shape3d.reverse.cull"),
                  j.renderShapeModel(A, O, v, I))
          }
      };
      En.shaderSrc = {
          vs: ["uniform mat4 modelViewMatrix;", "uniform mat4 projectionMatrix;", "attribute vec3 position;", "void main() {", "vec3 transformed = vec3( position );", "vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );", "gl_Position = projectionMatrix * mvPosition;", "}"].join("\n"),
          fs: ["precision highp float;", "const float PackUpscale = 256. / 255.;", "const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );", "const float ShiftRight8 = 1. / 256.;", "vec4 packDepthToRGBA( const in float v ) {", "vec4 r = vec4( fract( v * PackFactors ), v );", "r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;", "}", "void main() {", "gl_FragColor = packDepthToRGBA( gl_FragCoord.z );", "}"].join("\n")
      },
      En.PARAMS = ["quality", "intensity", "bias", "radius", "type", "degree.x", "degree.z"];
      var si = n.Light = function() {
          Jg(si, this),
          this.s(os, U[os]),
          this.s(_o, "sphere"),
          this.s("shape3d.reverse.cull", !0),
          this.s3(20, 20, 20)
      }
      ;
      jq("Light", Wd, {
          _image: "light_icon",
          _icon: "light_icon",
          onStyleChanged: function(o, s, F) {
              si.superClass.onStyleChanged.apply(this, arguments),
              o === os && this.s("shape3d.color", F)
          }
      });
      var Zh = rn.FrameState = function(P, e) {
          this.renderState = Vj.for(e),
          this.picking = !1,
          this.envmapReflectivity = .5,
          this.cameraPosition = V,
          this.projectMatrix = V,
          this.viewMatrix = V,
          this.view = P,
          this.defaultProgram = V,
          this.pickColorMap = V,
          this._pvStack = [],
          this._renderStateStack = []
      }
      ;
      Zh.prototype.savePV = function() {
          var o = this.view;
          this._pvStack.push([fs(this.projectMatrix), fs(this.viewMatrix), o._18Q, fs(o._7O)])
      }
      ,
      Zh.prototype.restorePV = function() {
          var V = this._pvStack.pop();
          if (V) {
              var q = this.view;
              this.projectMatrix = q._projectMatrix = V[0],
              this.viewMatrix = q._viewMatrix = V[1],
              q._18Q = V[2],
              q._7O = V[3]
          }
      }
      ,
      Zh.prototype.setPV = function(l, g) {
          var D = this.view
            , G = !1;
          if (l && (this.projectMatrix = D._projectMatrix = l,
          G = !0),
          g && (this.viewMatrix = D._viewMatrix = g,
          D._7O = fs(g),
          G = !0),
          G) {
              var o = D.getWidth()
                , I = D.getHeight()
                , x = fs(this.projectMatrix);
              D._18Q = Fo(x, x, g),
              D._18Q._wh = o / I
          }
      }
      ,
      Zh.prototype.syncEnv = function(y) {
          var W = this
            , a = W.view;
          W.envmapReflectivity = a._envmapReflectivity || .5,
          W.cameraPosition = a.getEye(),
          W.projectMatrix = a._projectMatrix,
          W.viewMatrix = a._viewMatrix,
          W.pickColorMap = y,
          W.picking = a.getGL()._picking
      }
      ,
      Zh.prototype.setGLState = function() {
          var u = [0, 0, 0, 0]
            , c = [!0, !0, !0, !0]
            , G = [-1, 1]
            , T = [Cg.FUNC_ADD, Cg.FUNC_ADD]
            , w = [Cg.SRC_ALPHA, Cg.ONE_MINUS_SRC_ALPHA, Cg.ONE, Cg.ONE_MINUS_SRC_ALPHA];
          return function(s, M) {
              var j = this
                , Y = j.renderState.gl
                , p = j.renderState.glState;
              p.dither = !1,
              M ? p.color.mask = c : p.color.reset(),
              p.pixelStore.reset(),
              p.blend.color = u,
              p.blend.equation = T,
              p.blend.func = w,
              p.cullFace.enabled = !1,
              p.scissor.enabled = !1,
              p.depth.enabled = !0,
              p.depth.clear = 1,
              p.depth.func = Y.LEQUAL,
              p.depth.range = G,
              p.stencil.enabled = !1,
              p.polygonOffset.enabled = !1,
              s ? (p.depth.mask = !1,
              p.blend.enabled = !0) : (p.depth.mask = !0,
              p.blend.enabled = !1)
          }
      }(),
      Zh.prototype.setUniforms = function(W) {
          var e = this
            , z = e.view
            , q = e.renderState
            , x = q.gl
            , t = q.uniforms;
          t.uBrightness = 1,
          t.uOpacity = 1,
          t.uPartOpacity = 1,
          t.uPick = e.picking,
          t.uTexture = !1,
          t.uBlendTexture = !1,
          t.uAlphaTest = U.alphaTest,
          t.uTransparent = !!W,
          t.uFix = !1,
          t.uBatchColor = !1,
          t.uBatchBlend = !1,
          t.uBatchBrightness = !1,
          t.uReflectivity = e.envmapReflectivity || .5,
          t.uCameraPosition = e.cameraPosition,
          t.uPMatrix = e.projectMatrix,
          t.uViewMatrix = e.viewMatrix,
          z.bindEnvMap(x),
          e.picking || (Wc(z, x, V),
          z._fogDisabled || (t.uFogColor = z._fogColor,
          t.uFogDensity = z._fogDensity,
          t.uFogNear = z._fogNear,
          t.uFogFar = z._fogFar))
      }
      ,
      Zh.prototype.drawLayer = function(u) {
          return this.view.renderLayers(u, !0)
      }
      ,
      Zh.prototype.drawData = function(O, M, d) {
          var g = this.view;
          if (g.isVisible(O)) {
              var k = this.renderState
                , V = k.uniforms
                , s = g.getData3dUI(O);
              if (s) {
                  var a = k.gl
                    , Z = a._picking
                    , R = g._picking
                    , P = O._pickId;
                  d && (O._pickId = d),
                  V.uPick = a._picking = g._picking = !!d,
                  V.uTransparent = !!M,
                  s._42(k.gl, k.program, M ? Q : c),
                  V.uPick = a._picking = Z,
                  g._picking = R,
                  O._pickId = P
              }
          }
      }
      ;
      var bp = rn.Graph3dView = function(g, J) {
          var C = this;
          C._webGLVersion = 1,
          C._attributes = J || M.graph3dViewAttributes,
          C._25I = {},
          C._view = Te(1, C);
          var R = C._canvas = Jl(C._view);
          b(R, "webglcontextlost", function(q) {
              q.preventDefault(),
              gr(C),
              C._26I && C._doBufferGC(C._26I, !0),
              C._26I = E,
              C._1o.onContextLost(),
              C._35O = !0
          }),
          b(R, "webglcontextrestored", function() {
              C._35O = !1,
              C.iv()
          }),
          C._40Q = new ss,
          C._43Q = {},
          C._44Q = -1,
          C._batchIndexMap = {},
          C._batchModelMap = {},
          C._wireframeIndexMap = {},
          C._wireframeModelMap = {},
          C._wireframeIndexMapSwap = {},
          C._wireframeModelMapSwap = {},
          C._polylineIndexMap = {},
          C._polylineIndexMap = {},
          C._polylineIndexMapSwap = {},
          C._polylineIndexMapSwap = {},
          C._8O = [],
          C._7O = zm(),
          C._6O = zm(),
          C._1o = new sl(C),
          C._30O = new qc(C),
          C._31O = new Pc(C),
          C._32O = new Cs(C),
          C._raycaster = new Gk(C),
          C._highlightHelper = new kl(C),
          C._postProcessing = new Hs(C),
          C._41Q = [],
          C._42Q = 0,
          C.vr = new Es(C),
          C.shadowMap = new En(C),
          C._33Q = !0,
          C._eye = Ej(M.graph3dViewEye),
          C._center = Ej(M.graph3dViewCenter),
          C._up = Ej(M.graph3dViewUp),
          C._lightChanged = !1,
          C._59O = [],
          C._spots = [],
          C._dirs = [],
          C._frameId = 0,
          C._batchInfoMap = {},
          C.overlappingBox = new Pd(C),
          C.dm(g ? g : new em),
          C._coreInteractor = new Zf(this),
          C.setInteractors([new tc(C)]),
          C._initView()
      }
        , mi = {
          fogDisabled: 1,
          fogMode: 1,
          dashDisabled: 1,
          batchColorDisabled: 1,
          batchBlendDisabled: 1,
          batchBrightnessDisabled: 1,
          ortho: 1
      }
        , ob = 0;
      ii("Graph3dView", G, {
          ms_v: 1,
          ms_tip: 1,
          ms_gv: 1,
          ms_dm: 1,
          ms_lp: 1,
          ms_fire: 1,
          ms_sm: 1,
          _51o: 1,
          ms_shadow: 1,
          ms_ac: ["devicePixelRatio", "boundaries", "moveStep", "rotateStep", "editHelperDisabled", "blockSelectable", "sizeEditableFunc", "rotationEditableFunc", "editableFunc", "rotatable", "zoomable", "pannable", "walkable", "resettable", "mouseRoamable", "zoomToCenter", Lh, Yr, "firstPersonMode", sq, "movableFunc", "gridVisible", "gridSize", "gridGap", "gridColor", "originAxisVisible", "centerAxisVisible", "axisXColor", "axisYColor", "axisZColor", "editSizeColor", "rectSelectable", "rectSelectBackground", "headlightRange", "headlightColor", "headlightIntensity", "headlightAmbientIntensity", "headlightDisabled", "ortho", "orthoWidth", "fovy", "near", "far", Cm, ef, "up", "aspect", "fogDisabled", "fogMode", "fogDensity", "fogColor", "fogNear", "fogFar", "pickerResolution", "dashDisabled", "batchColorDisabled", "batchBlendDisabled", "batchBrightnessDisabled", "hoverDelay", "batchInfoMap", "rotateMinPhi", "rotateMaxPhi"],
          _editable: !1,
          _editHelperDisabled: M.graph3dViewEditHelperDisabled,
          _blockSelectable: M.graph3dViewBlockSelectable,
          _devicePixelRatio: V,
          _boundaries: V,
          _moveStep: M.graph3dViewMoveStep,
          _rotateStep: M.graph3dViewRotateStep,
          _rotateMinPhi: M.graph3dViewMinPhi === V ? M.graph3dViewRotateMinPhi : M.graph3dViewMinPhi,
          _rotateMaxPhi: M.graph3dViewMaxPhi === V ? M.graph3dViewRotateMaxPhi : M.graph3dViewMaxPhi,
          _pannable: M.graph3dViewPannable,
          _rotatable: M.graph3dViewRotatable,
          _walkable: M.graph3dViewWalkable,
          _resettable: M.graph3dViewResettable,
          _zoomable: M.graph3dViewZoomable,
          _zoomToCenter: !0,
          _firstPersonMode: M.graph3dViewFirstPersonMode,
          _mouseRoamable: M.graph3dViewMouseRoamable,
          _gridVisible: M.graph3dViewGridVisible,
          _gridSize: M.graph3dViewGridSize,
          _gridGap: M.graph3dViewGridGap,
          _gridColor: M.graph3dViewGridColor,
          _originAxisVisible: M.graph3dViewOriginAxisVisible,
          _centerAxisVisible: M.graph3dViewCenterAxisVisible,
          _axisXColor: M.graph3dViewAxisXColor,
          _axisYColor: M.graph3dViewAxisYColor,
          _axisZColor: M.graph3dViewAxisZColor,
          _ortho: M.graph3dViewOrtho,
          _orthoWidth: M.graph3dViewOrthoWidth,
          _fovy: M.graph3dViewFovy,
          _near: M.graph3dViewNear,
          _far: M.graph3dViewFar,
          _headlightColor: M.graph3dViewHeadlightColor,
          _headlightIntensity: M.graph3dViewHeadlightIntensity,
          _headlightRange: M.graph3dViewHeadlightRange,
          _headlightAmbientIntensity: M.graph3dViewHeadlightAmbientIntensity,
          _headlightDisabled: M.graph3dViewHeadlightDisabled,
          _rectSelectable: M.graph3dViewRectSelectable,
          _rectSelectBackground: M.graph3dViewRectSelectBackground,
          _editSizeColor: M.graph3dViewEditSizeColor,
          _autoMakeVisible: Bc,
          _fogDisabled: M.graph3dViewFogDisabled,
          _fogMode: M.graph3dViewFogMode,
          _fogDensity: M.graph3dViewFogDensity,
          _fogColor: M.graph3dViewFogColor,
          _fogNear: M.graph3dViewFogNear,
          _fogFar: M.graph3dViewFogFar,
          _pickerResolution: M.graph3dViewPickerResolution,
          _dashDisabled: M.graph3dViewDashDisabled,
          _batchColorDisabled: M.graph3dViewBatchColorDisabled,
          _batchBlendDisabled: M.graph3dViewBatchBlendDisabled,
          _batchBrightnessDisabled: M.graph3dViewBatchBrightnessDisabled,
          addCamera: function(v) {
              var W = this
                , p = G.freeze({
                  id: W._42Q++,
                  priority: v.priority || 0,
                  ignoreInPick: !!v.ignoreInPick,
                  render: v.render
              });
              v.switch3DStatus && (W._43Q[p.id] = !0),
              W._41Q.push(p),
              W._41Q.sort(function(f, C) {
                  return f.priority !== C.priority ? f.priority - C.priority : f.id - C.id
              })
          },
          setEye: function(k, S, g) {
              1 === arguments.length && (S = k[1],
              g = k[2],
              k = k[0]);
              var K = this._eye;
              K[0] = k,
              K[1] = S,
              K[2] = g,
              this.fp(Cm, E, K)
          },
          setCenter: function(t, H, b) {
              1 === arguments.length && (H = t[1],
              b = t[2],
              t = t[0]);
              var P = this._center;
              P[0] = t,
              P[1] = H,
              P[2] = b,
              this.fp(ef, E, P)
          },
          setUp: function(B, b, Q) {
              1 === arguments.length && (b = B[1],
              Q = B[2],
              B = B[0]);
              var m = this._up;
              m[0] = B,
              m[1] = b,
              m[2] = Q,
              this.fp("up", E, m)
          },
          getDevicePixelRatio: function() {
              return this._picking ? this._1o._resolution : this._devicePixelRatio || Ph
          },
          isTransparentMask: function(b) {
              return b.s("transparent.mask")
          },
          getCoreInteractor: function() {
              return this._coreInteractor
          },
          getHighlightHelper: function() {
              return this._highlightHelper
          },
          getRaycaster: function() {
              return this._raycaster
          },
          getAspect: function() {
              var u = this
                , F = u._aspect;
              return F ? F : (F = u.getWidth() / u.getHeight(),
              F || 1.2)
          },
          getCanvas: function() {
              return this._canvas
          },
          setDataModel: function(O) {
              var W = this
                , y = W._dataModel
                , h = W._selectionModel;
              y !== O && (y && (y.ump(W.handleDataModelPropertyChange, W),
              y.umm(W.handleDataModelChange, W),
              y.umd(W.handleDataPropertyChange, W),
              h || y.sm().ums(W.handleSelectionChange, W)),
              W._dataModel = O,
              O.mp(W.handleDataModelPropertyChange, W),
              O.mm(W.handleDataModelChange, W),
              O.md(W.handleDataPropertyChange, W),
              h ? h._21I(O) : O.sm().ms(W.handleSelectionChange, W),
              W._postProcessing.handleDataModleChange(y, O),
              W.invalidateAll(!0),
              W.invalidateLight(),
              W.fp(jh, y, O),
              W._canvas.style.background = O.getBackground() || "")
          },
          handleDataModelPropertyChange: function(T) {
              if ("background" === T.property) {
                  var G = this._canvas.style.background
                    , g = T.newValue || "";
                  this._canvas.style.background = g,
                  this.fp("canvasBackground", G, g)
              } else
                  "envmap" === T.property ? this.iv() : "cubicEnvmap" === T.property && (this._lastEnvMap = V,
                  this.iv())
          },
          handleDataPropertyChange: function(R) {
              var B = R.data;
              this.invalidateData(B),
              fp(B) && "s:light.type" === R.property ? this.invalidateLight() : "s:shadow.cast" === R.property ? this.shadowMap.tryUpdateBounding(B) : ("s:alwaysOnTop" === R.property || "s:shape3d.alwaysOnTop" === R.property) && (R.newValue ? B.setRenderLayer("top") : B.setRenderLayer(V))
          },
          invalidateLight: function() {
              this._lightChanged || (this._lightChanged = !0,
              this.iv())
          },
          onPropertyChanged: function(O) {
              var h = this
                , M = O.property;
              h.iv(),
              h._18Q = E,
              "eye" === M ? h._33Q = !0 : "devicePixelRatio" === M ? h._42(E, h.getDevicePixelRatio()) : mi[M] && gr(h)
          },
          _5O: function(U) {
              var W = U._22Q();
              return W ? new W(this,U) : E
          },
          getData3dUI: function(E) {
              var r = this._25I[E._id];
              return r === V && (r = this._5O(E),
              this._25I[E._id] = r),
              r
          },
          invalidateAll: function(f) {
              var W = this;
              if (f) {
                  for (var K in W._25I) {
                      var H = W._25I[K];
                      H && H.dispose()
                  }
                  W._25I = {},
                  W.iv(),
                  sn(W)
              } else
                  sn(W),
                  W.dm().each(function(Z) {
                      W.invalidateData(Z)
                  })
          },
          invalidateSelection: function() {
              var W = this;
              W.sm().each(function(x) {
                  W.invalidateData(x)
              })
          },
          invalidateData: function(b) {
              var F = this
                , q = F.getData3dUI(b);
              q && (q.iv(),
              F.iv()),
              sn(F, b)
          },
          getShape3dText: function(j) {
              return j.getStyle("shape3d.text") || this.getLabel(j)
          },
          invalidateBatch: function(K) {
              var d = this
                , N = d._40Q;
              N.each(function(j) {
                  d._invalidateBatch(j.batchModelMap, j.batchIndexMap, j.polylineModelMap, j.polylineIndexMap, j.wireframeModelMap, j.wireframeIndexMap, K),
                  j.markBatchInvalid()
              })
          },
          _invalidateBatch: function(q, t, J, Z, a, r, e) {
              var c = this
                , z = q[e]
                , A = []
                , L = {};
              if (z) {
                  z.ds.forEach(function(a) {
                      var F = c.getData3dUI(a);
                      F && F.iv(),
                      delete t[a._id],
                      A.push(a._id)
                  }),
                  delete q[e];
                  for (var Y, w, $, f, M, n, T, U, G, u = [a, J], C = [r, Z], m = 0; m < u.length; m++) {
                      var B = u[m]
                        , S = C[m];
                      for (L = {},
                      U = 0; U < A.length; U++) {
                          var i = S[A[U]];
                          if (i) {
                              delete S[A[U]],
                              G = i.batch,
                              Y = B[G];
                              var b = i.begin
                                , P = i.size
                                , x = 3 * b
                                , W = 3 * P
                                , o = 4 * b
                                , H = 4 * P;
                              for (w = Y.ds,
                              $ = Y.vs,
                              f = Y.cs,
                              M = Y.ps,
                              n = Y.ls,
                              T = i.index,
                              Y.invalidate = !0,
                              w[T] = V,
                              T = x; x + W > T; T++)
                                  $[T] = V;
                              for (T = o; o + H > T; T++)
                                  f[T] = V;
                              for (T = o; o + H > T; T++)
                                  M[T] = V;
                              if (n)
                                  for (T = x; x + W > T; T++)
                                      n[T] = V;
                              L[G] = !0
                          }
                      }
                      for (G in L) {
                          Y = B[G],
                          w = Y.ds,
                          $ = Y.vs,
                          f = Y.cs,
                          M = Y.ps,
                          n = Y.ls;
                          var D = [];
                          for (T = 0; T < w.length; T++)
                              w[T] !== V && D.push(w[T]);
                          if (0 === D.length)
                              delete B[G];
                          else {
                              for (Y.ds = D,
                              D = [],
                              T = 0; T < $.length; T++)
                                  $[T] !== V && D.push($[T]);
                              for (Y.vs = D,
                              D = [],
                              T = 0; T < f.length; T++)
                                  f[T] !== V && D.push(f[T]);
                              for (Y.cs = D,
                              D = [],
                              T = 0; T < M.length; T++)
                                  M[T] !== V && D.push(M[T]);
                              if (Y.ps = D,
                              n) {
                                  for (D = [],
                                  T = 0; T < n.length; T++)
                                      n[T] !== V && D.push(n[T]);
                                  Y.ls = D
                              }
                          }
                      }
                  }
                  c.iv()
              }
          },
          handleDataModelChange: function(S) {
              var W = this
                , u = S.kind
                , r = S.data;
              if ("add" === u)
                  W.invalidateData(r),
                  ji(r) && r.getEdgeGroup() && r.getEdgeGroup().eachSiblingEdge(W.invalidateData, W),
                  fp(r) && W.invalidateLight();
              else if (u === mc) {
                  var R = r._id
                    , K = W._25I[R];
                  K && (K.dispose(),
                  delete W._25I[R],
                  W.iv()),
                  r === W._currentSubGraph && W.setCurrentSubGraph(E),
                  sn(W, r),
                  fp(r) && W.invalidateLight()
              } else
                  u === Cn && (W.invalidateAll(!0),
                  W.setCurrentSubGraph(E),
                  sn(W),
                  W.invalidateLight())
          },
          toCanvas: function(t, n, H) {
              var d = this
                , T = d.getGL();
              if (d.validate(),
              t) {
                  var $ = T.getParameter(T.COLOR_CLEAR_VALUE);
                  yf(T, t)
              }
              d._42(E, 1);
              var O = d.getWidth() || 1
                , J = d.getHeight() || 1
                , W = new Uint8Array(4 * O * J)
                , a = Jl()
                , U = a.getContext("2d");
              T.readPixels(0, 0, O, J, T.RGBA, T.UNSIGNED_BYTE, W),
              Uj(a, O, J, 1);
              for (var L = U.getImageData(0, 0, O, J), K = L.data, u = 0; u < K.length; u += 4) {
                  var X = u / 4
                    , r = q(X / O)
                    , g = X - r * O;
                  X = 4 * ((J - 1 - r) * O + g),
                  K[X] = W[u],
                  K[X + 1] = W[u + 1],
                  K[X + 2] = W[u + 2],
                  K[X + 3] = W[u + 3]
              }
              if (U.putImageData(L, 0, 0),
              t && yf(T, $),
              d._42(E, d.getDevicePixelRatio()),
              n && H) {
                  var s = Jl()
                    , N = s.getContext("2d");
                  return Uj(s, n, H, 1),
                  M.drawImage(N, a, 0, 0, n, H),
                  s
              }
              return a
          },
          toDataURL: function(_, v) {
              var I = this
                , s = I.getGL();
              if (I.validate(),
              _) {
                  var M = s.getParameter(s.COLOR_CLEAR_VALUE);
                  yf(s, _)
              }
              I._42(E, 1);
              var R = I._canvas.toDataURL(v || "image/png", 1);
              return _ && yf(s, M),
              I._42(E, I.getDevicePixelRatio()),
              R
          },
          getGL: function() {
              var b = this._26I;
              if (b)
                  return this.acquireProgram(),
                  b;
              if (!this._35O) {
                  var X = this
                    , z = X._canvas
                    , R = X._attributes;
                  if (!R || R.requestWebGL2 !== !1)
                      try {
                          b = z.getContext("webgl2", R) || z.getContext("experimental-webgl2", R),
                          b && (X._webGLVersion = 2,
                          X._26I = b)
                      } catch (G) {}
                  if (!b)
                      try {
                          b = z.getContext("webgl", R) || z.getContext("experimental-webgl", R)
                      } catch (G) {
                          throw new Error("WebGL not supported")
                      }
                  if (!b)
                      throw new Error("WebGL not supported");
                  X._26I = b;
                  var D = X._frameState = new Zh(this,b);
                  X._glExtensions = new x(b),
                  X._glCapabilities = new T(b,X._glExtensions),
                  X._2O = {},
                  b._emptyCubeTexture = nn(b),
                  b._compiledShader = {},
                  b._emptyTexture = ik(b),
                  b._emptyBlendTexture = ik(b),
                  b._bufPool = {},
                  b._id = ++ob,
                  D.setGLState(),
                  X._buffer = {
                      vs: Rr(b),
                      ns: Rr(b),
                      is: Rr(b),
                      uv: Rr(b),
                      batchColor: Rr(b),
                      batchBlend: Rr(b),
                      batchBrightness: Rr(b),
                      lineDistance: Rr(b)
                  },
                  X._1O = Yh(b);
                  var M = X._cube = {
                      vs: Rr(b),
                      ns: Rr(b),
                      is: Rr(b),
                      uv: Rr(b)
                  };
                  return vo(b, M.vs, qj),
                  vo(b, M.ns, Sh),
                  vo(b, M.uv, $j),
                  pq(b, M.is, Vh),
                  X.acquireProgram(),
                  b._renderInfo = {
                      calls: 0,
                      vertices: 0,
                      faces: 0,
                      lines: 0,
                      points: 0,
                      frame: 0,
                      cacheTimeCost: 0
                  },
                  b
              }
          },
          getEnvmap: function() {
              return this._glCapabilities && this._glCapabilities.maxVertexTextures < M.graph3dEnvmapCapabilityRequire ? null : this.dm().getEnvmap()
          },
          acquireProgram: function() {
              var w = this
                , T = w._26I;
              if (T) {
                  var h = M.getImage(w.getEnvmap())
                    , x = h && h.tagName ? !0 : !1
                    , j = w._prg && w._prg.envMapFlag ? !0 : !1;
                  if (!w._prg || x !== j) {
                      var Y = w._prg = T.createProgram();
                      if (!Y)
                          return E;
                      Y.envMapFlag = x;
                      var U = w._dirs.length
                        , N = w._spots.length
                        , D = w._59O.length
                        , G = ["uPMatrix", "uMVMatrix", "uMMatrix", "uReflectivity", "uViewMatrix", "uUseEnvMap", "uEnvMap", "uCameraPosition", "uNMatrix", "uViewMatrix", "aNormal", "aUv", "uOffsetScale", "uDiffuse", "uBlend", "uBlendColor", "uBrightness", "uPartOpacity", "uAlphaTest", "uTransparent", "uClipDirection", "uClipPercent", "uTexture", "uBlendTexture", "uSampler", "uBlendSampler", "uDiscardSelectable", "uFix", "uPick", "uReverseFlip", "uFixPickReverseColor", "uBatchBrightness", "aBatchBrightness", "uBatchColor", "aBatchColor", "uBatchBlend", "aBatchBlend", "uDash", "aLineDistance", "uDashDistance", "uDashGapDistance", "uLight", "uHeadlightRange", "uHeadlightAmbientIntensity", "uHeadlightColor", "uFogColor", "uFogDensity", "uFogNear", "uFogFar"];
                      U && G.push("uDirColor", "uDirDirection"),
                      N && G.push("uSpotColor", "uSpotRange", "uSpotAngle", "uSpotExponent", "uSpotPosition", "uSpotDirection"),
                      D && G.push("uPointColor", "uPointRange", "uPointPosition"),
                      Bj || (Vc = Nl(Vc.substring(0, Vc.indexOf("^#"))),
                      gc = Nl(gc),
                      Bj = !0);
                      var v = ["#define MAX_DIR " + U, "#define MAX_SPOT " + N, "#define MAX_POINT " + D, w._fogDisabled ? "" : "#define FOG", "exp2" === w.getFogMode() ? "#define FOG_EXP2" : "", w._dashDisabled ? "" : "#define DASH", x ? "#define USE_ENVMAP" : "", w.isOrtho() ? "#define ORTHOGRAPHIC" : "", w._batchColorDisabled ? "" : "#define BATCHCOLOR", w._batchBlendDisabled ? "" : "#define BATCHBLEND", w._batchBrightnessDisabled ? "" : "#define BATCHBRIGHTNESS", w.shadowMap.enable ? w.shadowMap.genShaderDefine() : "", ""].join("\n")
                        , F = cc(T, Y, T.VERTEX_SHADER, Vc.replace("PREFIX", v));
                      T.getShaderParameter(F, T.COMPILE_STATUS) || console.error("compile vs shader faild, error info : ", T.getShaderInfoLog(F));
                      var X = cc(T, Y, T.FRAGMENT_SHADER, gc.replace("PREFIX", v));
                      T.getShaderParameter(X, T.COMPILE_STATUS) || console.error("compile fs shader faild, error info : ", T.getShaderInfoLog(X)),
                      Di ? G.push("aPosition") : (Y.aPosition = 0,
                      T.bindAttribLocation(Y, 0, "aPosition")),
                      T.linkProgram(Y),
                      G.forEach(function(n) {
                          Y[n] = /^u/.test(n) ? T.getUniformLocation(Y, n) : T.getAttribLocation(Y, n)
                      });
                      var l = this._frameState;
                      l.renderState.program = l.defaultProgram = Y,
                      T.deleteShader(F),
                      T.deleteShader(X)
                  }
              }
          },
          getBrightness: function(r) {
              var n = r.s("brightness")
                , O = this.isSelected(r) ? r.s("select.brightness") : E;
              return n == E ? O : O == E ? n : n * O
          },
          setHighlightMode: function(H) {
              var k;
              k = "selection" === H || "selected" === H ? kl.Mode.Selection : "mouseover" === H || "hover" === H ? kl.Mode.MouseOver : "style" === H ? kl.Mode.Style : kl.Mode.Disable;
              var V = this._highlightHelper.mode;
              this._highlightHelper.mode = k,
              this.firePropertyChange("highlightMode", V, k)
          },
          getHighlightMode: function() {
              var c = this._highlightHelper.mode;
              return c === kl.Mode.Selection ? "selected" : c === kl.Mode.MouseOver ? "hover" : c === kl.Mode.Style ? "style" : "disabled"
          },
          getDataHighlightMode: function(H) {
              return H.s("highlight.mode")
          },
          getHighlightColor: function() {
              return this._highlightHelper.color || U["highlight.color"]
          },
          setHighlightColor: function(K) {
              var c = this._highlightHelper.color;
              this._highlightHelper.color = K,
              this.firePropertyChange("highlightColor", c, K)
          },
          getHighlightWidth: function() {
              return this._highlightHelper.width || U["highlight.width"]
          },
          setHighlightWidth: function(T) {
              var m = this._highlightHelper.width;
              this._highlightHelper.width = T,
              this.firePropertyChange("highlightWidth", m, T)
          },
          bindEnvMap: function(o) {
              var H = this
                , x = Vj.for(o)
                , A = x.directUniforms()
                , S = H.getEnvmap()
                , b = M.getImage(S);
              if (b && b.tagName) {
                  if (S !== H._lastEnvMap) {
                      var B = {};
                      if (H.dm().isCubicEnvmap()) {
                          var n = Aj(b)
                            , s = Xc(b);
                          if (0 === n || 0 === s)
                              return;
                          var Q = n / 4
                            , r = s / 3
                            , z = {
                              top: {
                                  x: Q,
                                  y: 0
                              },
                              left: {
                                  x: 0,
                                  y: r
                              },
                              front: {
                                  x: Q,
                                  y: r
                              },
                              right: {
                                  x: 2 * Q,
                                  y: r
                              },
                              back: {
                                  x: 3 * Q,
                                  y: r
                              },
                              bottom: {
                                  x: Q,
                                  y: 2 * r
                              }
                          };
                          ["top", "left", "front", "right", "back", "bottom"].forEach(function(o) {
                              var X = z[o]
                                , e = B[o] = Jl();
                              Uj(e, Q, r, 1);
                              var q = hq(e);
                              q.drawImage(b, X.x, X.y, Q, r, 0, 0, Q, r),
                              q.restore(),
                              B[o] = M.resizeImagePOT(e, !0)
                          })
                      } else
                          b = M.resizeImagePOT(b, !0);
                      H._envMapTexture && o.deleteTexture(H._envMapTexture);
                      var $ = H._envMapTexture = o.createTexture();
                      o.activeTexture(o.TEXTURE0),
                      o.bindTexture(o.TEXTURE_CUBE_MAP, $),
                      o.texParameteri(o.TEXTURE_CUBE_MAP, o.TEXTURE_MAG_FILTER, o.LINEAR),
                      o.texParameteri(o.TEXTURE_CUBE_MAP, o.TEXTURE_MIN_FILTER, o.LINEAR),
                      o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X + 0, 0, o.RGBA, o.RGBA, o.UNSIGNED_BYTE, B.right || b),
                      o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X + 1, 0, o.RGBA, o.RGBA, o.UNSIGNED_BYTE, B.left || b),
                      o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X + 2, 0, o.RGBA, o.RGBA, o.UNSIGNED_BYTE, B.top || b),
                      o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X + 3, 0, o.RGBA, o.RGBA, o.UNSIGNED_BYTE, B.bottom || b),
                      o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X + 4, 0, o.RGBA, o.RGBA, o.UNSIGNED_BYTE, B.front || b),
                      o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X + 5, 0, o.RGBA, o.RGBA, o.UNSIGNED_BYTE, B.back || b),
                      o.bindTexture(o.TEXTURE_CUBE_MAP, o._emptyCubeTexture),
                      H._lastEnvMap = S
                  }
                  A.uEnvMap = H._envMapTexture
              }
          },
          getWireframe: function(J) {
              var F = J.s("wf.visible")
                , k = J.s("wf.width");
              return F === !0 || k > 0 && "selected" === F && this.isSelected(J) ? {
                  color: J.s("wf.color"),
                  width: k,
                  "short": J.s("wf.short"),
                  mat: J.s("wf.mat")
              } : void 0
          },
          _transformPointToViewSpace: function(a) {
              var l = [a[0], a[1], a[2]];
              return Wb(l, this._viewMatrix),
              l
          },
          _transformDirectionToViewSpace: function(l, E) {
              var o = [l[0], l[1], l[2]];
              Wb(o, this._viewMatrix);
              var O = E ? [E[0], E[1], E[2]] : [0, 0, 0];
              Wb(O, this._viewMatrix);
              var U = O[0] - o[0]
                , Z = O[1] - o[1]
                , A = O[2] - o[2]
                , i = Math.sqrt(U * U + Z * Z + A * A);
              return i ? [U / i, Z / i, A / i] : [U, Z, A]
          },
          getWireframeGeometry: function(Z) {
              return Z.s("wf.geometry") ? {
                  color: Z.s("wf.color"),
                  width: Z.s("wf.width"),
                  mat: Z.s("wf.mat"),
                  geometry: !0
              } : void 0
          },
          getBodyColor: function(v) {
              return v.s("body.color")
          },
          getMat: function(u) {
              return u.getMat ? u.getMat() : u.s("mat")
          },
          getFaceMat: function(C, B) {
              return C.getFaceMat ? C.getFaceMat(B) : C.s(B + ".mat")
          },
          getFaceBlend: function(k, C) {
              return k.s(C + ".blend") || k.s("all.blend")
          },
          getFaceColor: function(V, H) {
              return V.s(H + ".color") || V.s("all.color")
          },
          getFaceImage: function(W, $) {
              return W.s($ + ".image") || W.s("all.image")
          },
          getFaceBlendImage: function(d, S) {
              return d.s(S + ".blend.image") || d.s("all.blend.image")
          },
          getFaceDiscardSelectable: function(B, l) {
              var e = B.s(l + ".discard.selectable");
              return e == E ? B.s("all.discard.selectable") : e
          },
          getFaceUv: function(h, C) {
              return h.s(C + ".uv") || h.s("all.uv")
          },
          getFaceUvOffset: function(f, e) {
              return f.s(e + ".uv.offset") || f.s("all.uv.offset")
          },
          getFaceUvScale: function(k, s) {
              return k.s(s + ".uv.scale") || k.s("all.uv.scale")
          },
          getFaceLight: function(u, q) {
              var o = u.s(q + ".light");
              return o == E ? u.s("all.light") : o
          },
          getFaceVisible: function(H, b) {
              var q = H.s(b + ".visible");
              return q == E ? H.s("all.visible") : q
          },
          getFaceOpacity: function(r, N) {
              var B = r.s(N + ".opacity");
              return B == E ? r.s("all.opacity") : B
          },
          getFaceTransparent: function(h, u) {
              var $ = h.s(u + ".transparent");
              return $ == E ? h.s("all.transparent") : $
          },
          getFaceReverseColor: function(g, X) {
              return g.s(X + ".reverse.color") || g.s("all.reverse.color")
          },
          getFaceReverseFlip: function(Q, k) {
              var s = Q.s(k + ".reverse.flip");
              return s == E ? Q.s("all.reverse.flip") : s
          },
          getFaceReverseCull: function(d, x) {
              var K = d.s(x + ".reverse.cull");
              return K == E ? d.s("all.reverse.cull") : K
          },
          getTextureMap: function() {
              return this._2O
          },
          deleteTexture: function(q) {
              var S = this
                , Q = S._2O[q];
              Q && (delete S._2O[q],
              S.getGL().deleteTexture(Q))
          },
          renderPickScene: function() {
              var R = this.getGL();
              this._picking = R._picking = !0,
              this.renderScene(),
              this._picking = R._picking = !1
          },
          invalidateCachedTexture: function(n) {
              var k = this.getData3dUI(n);
              k.invalidateCachedTexture(this.getGL()),
              this.invalidateData(n)
          },
          invalidateShape3dCachedImage: function(q) {
              this.invalidateCachedTexture(q)
          },
          invalidateCachedGeometry: function(M) {
              var n = this.getData3dUI(M);
              n.invalidateCachedGeometry(),
              this.invalidateData(M)
          },
          isInteractive: function(b) {
              return b.s("interactive")
          },
          getTexture: function(J, S, v) {
              if (!J)
                  return E;
              var k = this
                , U = k.getGL()
                , N = k._2O[J];
              if (!N) {
                  var q = Ti(J)
                    , g = {};
                  if (!q)
                      return U._emptyTexture;
                  if (S) {
                      g.mipmapMaxLevel = S.s("texture.mipmap.max");
                      var A = S.s("texture.wrap");
                      g.clampToEdge = "clampToEdge" === A ? !0 : "repeat" === A ? !1 : V
                  }
                  if (q.uuid || (q.uuid = n.Math.generateUUID()),
                  q.tagName) {
                      if (q.dynamic)
                          return Yh(U, q, k._1O, g);
                      N = k._2O[J] = Yh(U, q, V, g)
                  } else {
                      var G, P = S && (S.s("texture.cache") || S.s("shape3d.image.cache") || q.textureCache), L = k.vr.isPresenting();
                      if (L && (S._textureUpdateFrame === U._renderInfo.frame ? P = !0 : S._textureUpdateFrame = U._renderInfo.frame),
                      P && (G = k.getData3dUI(S),
                      N = G.getCachedTexture(v),
                      N && G.interactiveInfo && N.interactiveInfo && (G.interactiveInfo[N.interactiveInfo.key] = N.interactiveInfo.info)),
                      !N) {
                          var O = U._renderInfo.textureCache;
                          if (P) {
                              if (O.time > M.graph3dMaxVectorCacheTime)
                                  return k.redraw(),
                                  U._emptyTexture;
                              if (!hp(q, S))
                                  return U._emptyTexture
                          }
                          var b;
                          S && (1 !== S.s("texture.scale") ? b = S.s("texture.scale") : 1 !== S.s("shape3d.texture.scale") && (b = S.s("shape3d.texture.scale"))),
                          b || (b = 1);
                          var p = S && (S.s("fixSizeOnScreen") || S.s("shape3d.fixSizeOnScreen"))
                            , e = p ? U.NEAREST : U.LINEAR;
                          p ? "number" == typeof p && (b *= 0 > p ? 1 : p) : S && (S.s("vector.dynamic") || S.s("shape3d.vector.dynamic")) && (G || (G = k.getData3dUI(S)),
                          p = G.getVectorDynamicSize());
                          var F, B, a, W = S && S.s("shape3d");
                          "billboard" === W ? a = S.getTall() / S.getWidth() : "plane" === W && (a = S.getHeight() / S.getWidth());
                          var Z = Aj(q, S);
                          if (p) {
                              var s;
                              s = P ? k._devicePixelRatio || Ph : k.getDevicePixelRatio(),
                              F = p[0] > 0 ? p[0] * s : b * Z * s,
                              B = p[1] > 0 ? p[1] * s : b * (a ? Xc(q, S, k, Math.min(4096, Z * a)) : Xc(q, S)) * s
                          } else
                              F = b * Z,
                              B = b * (a ? Xc(q, S, k, Math.min(4096, Z * a)) : Xc(q, S));
                          if (F >= 1 && B >= 1) {
                              var X = 0;
                              (P || L) && (X = Date.now());
                              var f = k._glCapabilities.maxTextureSize;
                              F = Math.min(F, f),
                              B = Math.min(B, f);
                              var K = en(F, B);
                              if (!G && S && (G = k.getData3dUI(S)),
                              G && G.interactiveInfo) {
                                  var D = J;
                                  "object" == typeof D && (D = D.uuid || (D.uuid = n.Math.generateUUID()));
                                  var t = G.interactiveInfo[D] = {};
                                  K.interactiveInfo = t.bodyInfo = {
                                      compInfos: [],
                                      matrix: new Ld,
                                      rect: {
                                          x: 0,
                                          y: 0,
                                          width: F,
                                          height: B
                                      }
                                  }
                              }
                              Gm(K, q, 0, 0, F, B, S, k),
                              K.interactiveInfo && (K.interactiveInfo = null),
                              K.restore(),
                              O.count++,
                              O.pixels += F * B,
                              S ? (g.minFilter = Jn(S.s("texture.filter.min") || S.s("texture.filter")) || e,
                              g.magFilter = Jn(S.s("texture.filter.mag") || S.s("texture.filter")) || e) : g.minFilter = g.magFilter = e,
                              P || L ? (N = Yh(U, Xl, null, g),
                              G.setCachedTexture(N, v),
                              O.time += Date.now() - X,
                              t && (N.interactiveInfo = {
                                  key: D,
                                  info: t
                              }),
                              Xl = null) : N = Yh(U, Xl, k._1O, g)
                          }
                      }
                  }
              }
              return N
          },
          redraw: function() {
              this.iv()
          },
          validateImpl: function() {
              var B = this;
              if (B._lightChanged) {
                  B._lightChanged = !1;
                  var I = []
                    , J = []
                    , o = [];
                  B.dm().each(function(A) {
                      if (fp(A)) {
                          var L = A.s("light.type");
                          L === rr ? I.push(A) : L === tm ? J.push(A) : L === bf && o.push(A)
                      }
                  }),
                  (I.length !== B._59O.length || J.length !== B._spots.length || o.length !== B._dirs.length) && gr(B),
                  B._59O = I,
                  B._spots = J,
                  B._dirs = o
              }
              B._42(),
              B._1o.iv()
          },
          getRenderInfo: function() {
              var d = this.getGL();
              return d ? d._renderInfo : void 0
          },
          getDebugTip: function() {
              var c = this
                , J = c.getRenderInfo();
              if (J) {
                  var M = c.getGL()._validBufCount || 0
                    , Q = "Draw Calls: " + J.calls + "<br/>" + "Vertices: " + J.vertices + "<br/>" + "Faces: " + J.faces + "<br/>" + "Lines: " + J.lines + "<br/>" + (J.points ? "Points: " + J.points + "<br/>" : "") + "Buffers: " + M + "<br/>" + "Cache Models: " + G.keys(Yo).length + "<br/>" + "Shape3d Models: " + G.keys(es).length;
                  if (c.vr.isPresenting() && (Q += "<br/>VR fps: " + c.vr.getFps()),
                  J.textureCache) {
                      var j = J.textureCache.count;
                      if (Q += "<br/>2D Dynamic Textures: " + J.textureCache.count,
                      j > 0) {
                          var m, w = J.textureCache.pixels;
                          m = w > 1e6 ? Math.round(w / 1e6) + "M" : w > 1e3 ? Math.round(w / 1e3) + "K" : Math.round(w),
                          Q += "<br/>2D Dynamic pixels: " + m
                      }
                  }
                  return Q
              }
          },
          getFrameState: function() {
              return this._frameState
          },
          isBoundingBoxInView: function() {
              var i = new n.Math.Box3
                , G = new n.Math.Matrix4;
              return function(H) {
                  var f = H;
                  if (f instanceof n.Data && (f = this.getData3dUI(f)),
                  !f.mat)
                      return !0;
                  var O = f.getBoundingBox();
                  i.copy(O).applyMatrix4(G.fromArray(f.mat));
                  var z = this.getFrustum();
                  return z.intersectsBox(i)
              }
          }(),
          updateScene: function() {
              var q = this;
              q._81O = E,
              q.overlappingBox.clear(),
              q._40Q.init();
              var b, o, O, Y = this.dm().getDatas().getArray(), k = Y.length, t = this.getGL(), e = this._40Q;
              for (b = 0; k > b; b++)
                  o = Y[b],
                  O = this.getData3dUI(o),
                  O && O.update(this, t, e);
              q._40Q.onUpdated()
          },
          renderScene: function() {
              function s(B, C) {
                  p.setGLState(B, C),
                  p.setUniforms(B),
                  p.renderState.attribs.disable(),
                  A = g.directUniforms(),
                  D = g.directAttribs(),
                  D.disable()
              }
              function h(B) {
                  for (; N > S; S++) {
                      var J = y[S];
                      if (!l || !J.ignoreInPick) {
                          if (J.priority >= B)
                              break;
                          (!z._43Q[z._44Q = J.id] || Dh[Rq.length]) && (J.render(I, z, p),
                          s())
                      }
                  }
              }
              var z = this;
              z.shadowMap.render(),
              z._44Q = -1;
              var D, p = z._frameState, g = p.renderState, m = g.glState, A = g.directUniforms(), I = z.getGL(), x = z._prg;
              g.syncLoss(),
              z._projectMatrix = Yl(z),
              Lq(z, z._7O),
              z._viewMatrix = fs(z._7O),
              p.syncEnv(this._picking ? this.pickColorMap : V),
              g.useProgram(x),
              s(!1, !0),
              I.clear(I.DEPTH_BUFFER_BIT);
              var l = z._picking
                , y = this._41Q
                , S = 0
                , N = y.length;
              if (h(M.cameraPriority.skybox),
              l) {
                  var o = m.color.clear.slice(0);
                  yf(I, [0, 0, 0, 0])
              } else
                  yf(I, [0, 0, 0, 0]),
                  m.blend.enabled = !1,
                  m.depth.enabled = !1,
                  m.depth.mask = !1,
                  z.drawSky(I, x),
                  z.drawReflectors(I) && (z._projectMatrix = Yl(z),
                  Lq(z, z._7O),
                  z._viewMatrix = fs(z._7O),
                  p.syncEnv(),
                  s()),
                  m.blend.enabled = !1,
                  m.depth.enabled = !0,
                  m.depth.mask = !0,
                  A.uTransparent = !1,
                  z._31O._42(I, x);
              if (!I.textureBatch || Dh[(ONE_FRAME_TIME - 6) / 2]) {
                  !l && z.shadowMap.enable && z.shadowMap.createShadow(A);
                  for (var w = 0, W = Vg.length; W > w; w++) {
                      var c = Vg[w]
                        , B = ug[c];
                      if (!B.ignore) {
                          var Z = B.priority;
                          h(Z),
                          this.renderLayer(c)
                      }
                  }
                  m.depth.enabled = !1,
                  A.uTransparent = !1,
                  A.shadowReceive = !1,
                  l ? z.drawFilter || z._30O._42(I, x) : (m.blend.enabled = !1,
                  m.depth.mask = !0,
                  z._32O._42(I, x),
                  z._30O._42(I, x),
                  z._highlightHelper._42(I, x)),
                  m.depth.enabled = !0,
                  h(M.cameraPriority.infinity),
                  l && yf(I, o),
                  vo(I, E),
                  pq(I, E),
                  z._44Q = -1
              }
          },
          renderLayers: function(u, U) {
              U && (u = mh(u));
              for (var Z = 0, W = u.length; W > Z; Z++)
                  this.renderLayer(u[Z])
          },
          renderLayer: function(Y) {
              var q = this
                , d = q._picking
                , T = q._40Q.get(Y);
              if (T) {
                  var U, I, N, y = q.getGL(), P = q._frameState, b = P.renderState, o = b.glState, _ = b.directUniforms(), V = T.opaque, j = T.transparent, D = T.batchModelMap, F = T.polylineModelMap, S = T.wireframeModelMap, y = q.getGL(), a = q._prg;
                  d || (o.blend.enabled = !1,
                  o.depth.enabled = !0,
                  o.depth.mask = !0),
                  _.uTransparent = !1,
                  ug[Y].clearDepth !== !1 && y.clear(y.DEPTH_BUFFER_BIT);
                  var i = this.drawFilter;
                  if (i)
                      for (N = V,
                      U = 0,
                      I = N.length; I > U; U++)
                          i(N[U].data) !== !0 && N[U].ui._42(y, a, c);
                  else {
                      for (N = V,
                      U = 0,
                      I = N.length; I > U; U++)
                          N[U].ui._42(y, a, c);
                      if (d)
                          for (N = j,
                          U = 0,
                          I = N.length; I > U; U++)
                              N[U].ui._46Q(y);
                      Nq(q, D),
                      cm(q, F),
                      cm(q, S)
                  }
                  if (d || (o.blend.enabled = !0,
                  o.depth.mask = !1),
                  q._45Q = _.uTransparent = !0,
                  i)
                      for (N = j,
                      U = 0,
                      I = N.length; I > U; U++)
                          i(N[U].data) !== !0 && N[U].ui._42(y, a, Q);
                  else {
                      for (N = j,
                      U = 0,
                      I = N.length; I > U; U++)
                          N[U].ui._42(y, a, Q);
                      Nq(q, D, null, !0),
                      cm(q, F, null, !0),
                      cm(q, S, null, !0)
                  }
                  q._45Q = null
              }
          },
          drawV2: function(H) {
              var I = this;
              if (!I._35O && (!xc || Dh(xc))) {
                  var Y = I.getWidth()
                    , M = I.getHeight();
                  if (Y && M) {
                      var k = I.getGL();
                      if (k) {
                          var v = I._canvas;
                          if (H || (H = I.getDevicePixelRatio()),
                          Y !== v.clientWidth || M !== v.clientHeight) {
                              Uj(v, Y, M, H);
                              var u = H;
                              Y && Math.abs(k.drawingBufferWidth - Y * H) > 1 && (u = Math.min(u, k.drawingBufferWidth / Y)),
                              M && Math.abs(k.drawingBufferHeight - M * H) > 1 && (u = Math.min(u, k.drawingBufferHeight / M)),
                              u !== H && (I.setDevicePixelRatio(H = u),
                              Uj(v, Y, M, H)),
                              I._18Q = null
                          }
                          k.clear(k.COLOR_BUFFER_BIT);
                          var d = k._renderInfo;
                          d.calls = 0,
                          d.vertices = 0,
                          d.faces = 0,
                          d.lines = 0,
                          d.points = 0,
                          d.textureCache = {
                              time: 0,
                              count: 0,
                              pixels: 0
                          },
                          d.frame = ++I._frameId,
                          d.cacheTimeCost = 0,
                          d.reflectDepth = 0,
                          Y *= H,
                          M *= H;
                          do {
                              if (I.vr.enable && I.vr.render(k, Y, M))
                                  break;
                              if (I.updateScene(),
                              I._postProcessing.render(k, Y, M))
                                  break;
                              I.setViewport(k, 0, 0, Y, M),
                              I.renderScene()
                          } while (!1);I._33Q = !1,
                          I.countFrame(),
                          I._doBufferGC(k)
                      }
                  }
              }
          },
          _42: function(U, O) {
              return this.drawV2(O)
          },
          drawReflectors: function(J) {
              J._renderInfo.reflectDepth++;
              var h, l, u, R = this, I = R._dataModel.getReflectors(), i = !1;
              for (h in I)
                  l = I[h],
                  R.isVisible(l) && (u = R.getData3dUI(l),
                  u && u.drawReflector(J) && (i = !0));
              return J._renderInfo.reflectDepth--,
              i
          },
          isReflecting: function(d) {
              return d._renderInfo.reflectDepth
          },
          getPostProcessing: function() {
              return this._postProcessing
          },
          enablePostProcessing: function(c, f) {
              return this._postProcessing.enableModule(c, f)
          },
          getPostProcessingModule: function(Z) {
              return this._postProcessing.getModule(Z)
          },
          getPostProcessingValue: function(y, o) {
              var j = this._postProcessing.getModule(y);
              return j ? j[o] : V
          },
          setPostProcessingValue: function(K, T, h) {
              var j = this.getPostProcessingValue(K, T)
                , U = this._postProcessing.getModule(K);
              U && j !== h && ("enable" === T ? this.enablePostProcessing(K, h) : U[T] = h,
              this.firePropertyChange("postProcessing." + K + "." + T, j, h))
          },
          setViewport: function(z, k, E, r, X) {
              this._viewport = [k, E, r, X],
              Vj.for(z).directState().viewport = this._viewport
          },
          getViewport: function() {
              return this._viewport
          },
          setBufferGCInterval: function(d) {
              this._bufferGCInterval = d
          },
          _doBufferGC: function(I, E) {
              var Q, D, J = I._bufPool, l = 0, s = 0, w = I._renderInfo.frame, c = this._bufferGCInterval || 10;
              for (Q in J)
                  l++,
                  D = J[Q],
                  D && (E || w - D._fid > c ? (I.deleteBuffer(D._buf),
                  D._buf = null,
                  J[Q] = null) : s++);
              if (l / 2 > s && l > 128) {
                  var n = {};
                  for (Q in J)
                      J[Q] && (n[Q] = J[Q]);
                  I._bufPool = n
              }
              I._validBufCount = s
          },
          _swapLineMap: function() {
              var $ = this;
              wn = $._polylineModelMap,
              $._polylineModelMap = $._polylineModelMapSwap,
              $._polylineModelMapSwap = wn,
              wn = $._wireframeModelMap,
              $._wireframeModelMap = $._wireframeModelMapSwap,
              $._wireframeModelMapSwap = wn,
              wn = $._polylineIndexMap,
              $._polylineIndexMap = $._polylineIndexMapSwap,
              $._polylineIndexMapSwap = wn,
              wn = $._wireframeIndexMap,
              $._wireframeIndexMap = $._wireframeIndexMapSwap,
              $._wireframeIndexMapSwap = wn
          },
          _updateSkybox: function(S) {
              if (this._skybox && S) {
                  var p = S.property
                    , x = !1
                    , G = this._skybox;
                  if ("eye" === p || "forceUpdate" === p) {
                      var U = this._eye;
                      G.p3(U[0], U[1], U[2]),
                      x = !0
                  }
                  if ("near" === p || "far" === p || "forceUpdate" === p) {
                      var d = this._near
                        , J = this._far
                        , E = G.getFinalScale3d();
                      if (E[0] /= 2,
                      E[1] /= 2,
                      E[2] /= 2,
                      E[0] <= d || E[0] >= J || E[1] <= d || E[1] >= J || E[2] <= d || E[2] >= J) {
                          var h = 2 * d * J / (d + J)
                            , F = Math.min(E[0], E[1], E[2])
                            , R = h / F
                            , c = G.getScale3d();
                          G.setScale3d(c[0] * R, c[1] * R, c[2] * R),
                          x = !0
                      }
                  }
                  x && this.invalidateData(G)
              }
          },
          getSkyBox: function() {
              return this.getSkybox()
          },
          setSkyBox: function(y) {
              return this.setSkybox(y)
          },
          getSkybox: function() {
              return this._skybox
          },
          setSkybox: function(_) {
              var J = this._skybox;
              return J === _ ? (_ && this._updateSkybox({
                  property: "forceUpdate"
              }),
              void 0) : (J && (this._skyboxStyleMap && J.setStyleMap(this._skyboxStyleMap),
              this._skyboxStyleMap = null,
              this._skyboxAnchor3d && J.setAnchor3d(this._skyboxAnchor3d),
              this._skyboxAnchor3d = null,
              this._skyboxP3 && J.p3(this._skyboxP3),
              this._skyboxP3 = null),
              this._skybox = _,
              this.ump(this._updateSkybox, this),
              _ && (_.dm() && _.dm().remove(_),
              this._skyboxStyleMap = n.Default.clone(_.getStyleMap()),
              this._skyboxAnchor3d = _.getAnchor3d(),
              _.setAnchor3d(.5, .5, .5),
              this._skyboxP3 = _.p3().slice(0),
              _.s({
                  "shape3d.reverse.flip": !0,
                  "shape3d.reverse.cull": !1,
                  "all.reverse.flip": !0,
                  "all.reverse.cull": !1,
                  "front.reverse.flip": !0,
                  "front.reverse.cull": !1,
                  "back.reverse.flip": !0,
                  "back.reverse.cull": !1,
                  "left.reverse.flip": !0,
                  "left.reverse.cull": !1,
                  "right.reverse.flip": !0,
                  "right.reverse.cull": !1,
                  "top.reverse.flip": !0,
                  "top.reverse.cull": !1,
                  "bottom.reverse.flip": !0,
                  "bottom.reverse.cull": !1
              }),
              this.mp(this._updateSkybox, this),
              this._updateSkybox({
                  property: "forceUpdate"
              })),
              this.fp("skybox", J, _),
              void 0)
          },
          drawSky: function(E, B) {
              var V = this
                , $ = V._skybox;
              if ($) {
                  var J = Vj.for(E).directUniforms()
                    , U = V._headlightIntensity
                    , e = bd(V._headlightColor)
                    , B = V._prg;
                  1 !== U && (e = [e[0] * U, e[1] * U, e[2] * U]),
                  J.uHeadlightColor = [e[0], e[1], e[2], 1];
                  var l = V.getData3dUI($);
                  if (l) {
                      var S = V.isOrtho()
                        , K = S || this._computedProjectMatrix;
                      if (K) {
                          var N = V._projectMatrix;
                          S && (V._ortho = !1),
                          J.uPMatrix = V._projectMatrix = Yl(V, !0)
                      }
                      var k = $.p3()
                        , y = this._eye;
                      (k[0] !== y[0] || k[1] !== y[1] || k[2] !== y[2]) && ($._position.x = y[0],
                      $._54O = y[1],
                      $._position.y = y[2]),
                      l.validate(),
                      l._42(E, B, I),
                      K && (S && (V._ortho = !0),
                      J.uPMatrix = V._projectMatrix = N)
                  }
                  E.clear(E.DEPTH_BUFFER_BIT),
                  J.uHeadlightColor = [e[0], e[1], e[2], V._headlightDisabled ? 1 : 0]
              }
          },
          getLogicalPoint: function(f) {
              return Pf(f, this._canvas)
          },
          isRectOverlapping: function(B) {
              var d = this.getData3dUI(B);
              return d._rectOverlapping
          },
          getHitFaceInfo: function(i) {
              i.target && (i = this.lp(i));
              var d = this.getDataInfoAt(i);
              if (d) {
                  var V = this.intersectObject(i, d.data);
                  if (V)
                      return {
                          data: d.data,
                          face: V.part
                      }
              }
              return E
          },
          unproject: function(Q, s) {
              var P = this
                , E = P.getWidth()
                , G = P.getHeight()
                , I = Q.target ? P.lp(Q) : Q
                , b = I.x - E / 2
                , O = I.y - G / 2
                , w = 2 * (b / E)
                , m = 2 * (-1 * O / G);
              s = s || 0;
              var U = zm()
                , a = Yl(P)
                , h = Lq(P);
              Fo(U, a, h),
              ll(U);
              var g = Or([w, m, s, 1], U);
              return [g[0] / g[3], g[1] / g[3], g[2] / g[3]]
          },
          getDataAt: function(y) {
              var M = this.getDataInfoAt(y);
              return M ? M.data : E
          },
          getDataInfoAt: function(S, J) {
              return S.target && (S = this.lp(S)),
              this._1o.get(Ke(S.x, S.y, J), !0)
          },
          getDatasInRect: function(n) {
              return this._1o.get(n)
          },
          setEditable: function(p) {
              var D = this
                , A = D._editable;
              D._editable = p,
              this.fp(Ap, A, p)
          },
          isEditable: function(Z) {
              var n = this;
              return Z ? n._editable ? ud(Z) ? Z.s("3d.editable") ? n._editableFunc ? n._editableFunc(Z) : !0 : !1 : !1 : !1 : n._editable
          },
          isSelectable: function(M) {
              return M.s("3d.selectable") && this.sm().isSelectable(M)
          },
          isMovable: function(Z) {
              var d = this;
              return ji(Z) && Z.getStyle(vj) !== $h ? !1 : Z.s("3d.movable") ? d._movableFunc ? d._movableFunc(Z) : !0 : !1
          },
          isSizeEditable: function(J) {
              return ud(J) ? this._sizeEditableFunc ? this._sizeEditableFunc(J) : !0 : !1
          },
          isRotationEditable: function(k) {
              return ud(k) && k.IRotatable !== !1 ? this._rotationEditableFunc ? this._rotationEditableFunc(k) : !0 : !1
          },
          handleDelete: function() {
              this._editable && this.removeSelection()
          },
          zoomIn: function(R) {
              this.setZoom(lm, R)
          },
          zoomOut: function(c) {
              this.setZoom(1 / lm, c)
          },
          setZoom: function() {
              var X = new Rh
                , l = new Rh
                , f = new Rh
                , r = new Rh;
              return function(E, d) {
                  if (1 !== E) {
                      var M = this;
                      M._14o && M._14o.stop(!0);
                      var T, u = 1 / E;
                      X.copy(M.getCenter()),
                      l.copy(M.getEye());
                      var e = M._ortho;
                      if (e) {
                          if (T = M._orthoWidth,
                          T < M._moveStep && E > 1)
                              return
                      } else if (X.distanceTo(l) < M._moveStep && 1 > u)
                          return;
                      var W = !1;
                      return M._zoomToCenter === !1 && M._lastZoomLP && (f.copy(l).sub(X).normalize(),
                      M._81O = null,
                      r.copy(M.getHitPosition(M._lastZoomLP, X.toArray(), f.toArray())),
                      W = !0,
                      M._lastZoomHit = r),
                      (d = Dg(d)) ? (d.action = function(k) {
                          M.fi({
                              kind: M._zooming ? "betweenZoom" : "beginZoom"
                          }),
                          M._zooming = 1;
                          var g = (u - 1) * k + 1;
                          e && M.setOrthoWidth(T * g),
                          W ? (M.setEye(f.lerpVectors(r, l, g).toArray()),
                          M.setCenter(f.lerpVectors(r, X, g).toArray())) : e || M.setEye(f.lerpVectors(X, l, g).toArray())
                      }
                      ,
                      d._37o = function() {
                          delete M._14o,
                          delete M._zooming,
                          M.fi({
                              kind: "endZoom"
                          }),
                          M.onZoomEnded()
                      }
                      ,
                      M._14o = Bl(d)) : (e && M.setOrthoWidth(T * u),
                      W ? (M.setEye(f.lerpVectors(r, l, u).toArray()),
                      M.setCenter(f.lerpVectors(r, X, u).toArray())) : e || M.setEye(f.lerpVectors(X, l, u).toArray()),
                      void 0)
                  }
              }
          }(),
          setOrthoZoom: function(P, R) {
              return this.setZoom(P, R)
          },
          getPositionInfo: function(y) {
              var B = this
                , J = B._eye
                , p = B._center
                , a = B.getAspect()
                , S = y ? Zk(Bb(p, J, !0), Bb(y, J)) : Qf(J, p);
              if (B._ortho) {
                  var H = B._orthoWidth;
                  return {
                      length: S,
                      height: H / a,
                      width: H
                  }
              }
              var s = 2 * h(B._fovy / 2) * S;
              return {
                  length: S,
                  height: s,
                  width: s * a
              }
          },
          getCenterInfo: function() {
              var K = this;
              return K._81O || (K._81O = K.getPositionInfo()),
              Ej(K._81O)
          },
          rotate: function(l, L, R, q) {
              var x = this;
              if (l || L) {
                  q == E && (q = x._firstPersonMode),
                  x._88O && x._88O.stop(!0);
                  var W = x._center
                    , n = x._eye
                    , z = x.getCenterInfo().length
                    , Q = q ? W : n
                    , w = q ? n : W
                    , S = Bb(Q, w)
                    , A = a(S[0], S[2])
                    , Y = a(O(S[0] * S[0] + S[2] * S[2]), S[1])
                    , $ = q ? ef : Cm;
                  return q && (L = -L),
                  (R = Dg(R)) ? (R.action = function(C) {
                      x.fi({
                          kind: x._rotating ? "betweenRotate" : "beginRotate"
                      }),
                      x._rotating = 1;
                      var _ = A + l * C
                        , T = Y + L * C;
                      T = q ? s - jr(x, s - T) : jr(x, T),
                      S[0] = z * o(T) * o(_),
                      S[1] = z * P(T),
                      S[2] = z * o(T) * P(_),
                      Q[0] = w[0] + S[0],
                      Q[1] = w[1] + S[1],
                      Q[2] = w[2] + S[2],
                      x.fp($, E, Q)
                  }
                  ,
                  R._37o = function() {
                      delete x._88O,
                      delete x._rotating,
                      x.fi({
                          kind: "endRotate"
                      }),
                      x.onRotateEnded()
                  }
                  ,
                  x._88O = Bl(R)) : (A += l,
                  Y += L,
                  Y = q ? s - jr(x, s - Y) : jr(x, Y),
                  S[0] = z * o(Y) * o(A),
                  S[1] = z * P(Y),
                  S[2] = z * o(Y) * P(A),
                  Q[0] = w[0] + S[0],
                  Q[1] = w[1] + S[1],
                  Q[2] = w[2] + S[2],
                  x.fp($, E, Q),
                  void 0)
              }
          },
          pan: function($, y, G, n) {
              if ($ || y) {
                  var D = this;
                  n == E && (n = D._firstPersonMode),
                  D._89O && D._89O.stop(!0);
                  var h = Lq(D)
                    , P = [h[0] * $, h[4] * $, h[8] * $]
                    , z = [h[1] * y, h[5] * y, h[9] * y]
                    , s = P[0] + z[0]
                    , _ = P[1] + z[1]
                    , c = P[2] + z[2]
                    , Z = D._center
                    , R = D._eye;
                  if (n) {
                      var W = Ln(D.getBoundaries(), R[0], R[2], R[0] + s, R[2] + c, O(s * s + c * c));
                      s = W[0],
                      c = W[1]
                  }
                  if (G = Dg(G)) {
                      var T = Ej(R)
                        , i = Ej(Z);
                      return G.action = function(y) {
                          D.fi({
                              kind: D._panning ? "betweenPan" : "beginPan"
                          }),
                          D._panning = 1,
                          Z[0] = i[0] + s * y,
                          Z[1] = i[1] + _ * y,
                          Z[2] = i[2] + c * y,
                          R[0] = T[0] + s * y,
                          R[1] = T[1] + _ * y,
                          R[2] = T[2] + c * y,
                          D.fp(Cm, E, R),
                          D.fp(ef, E, Z)
                      }
                      ,
                      G._37o = function() {
                          delete D._89O,
                          delete D._panning,
                          D.fi({
                              kind: "endPan"
                          }),
                          D.onPanEnded()
                      }
                      ,
                      D._89O = Bl(G)
                  }
                  Z[0] += s,
                  Z[1] += _,
                  Z[2] += c,
                  R[0] += s,
                  R[1] += _,
                  R[2] += c,
                  D.fp(Cm, E, R),
                  D.fp(ef, E, Z)
              }
          },
          walk: function(Y, N, I) {
              if (Y) {
                  var C = this;
                  I == E && (I = C._firstPersonMode),
                  C._90O && C._90O.stop(!0);
                  var X = C._center
                    , n = C._eye
                    , z = Bb(X, n, !0);
                  if (I) {
                      var m = Ln(C.getBoundaries(), n[0], n[2], n[0] + z[0] * Y, n[2] + z[2] * Y, u(Y));
                      if (Y = Qf(m),
                      !Y)
                          return;
                      z = [m[0] / Y, 0, m[1] / Y]
                  }
                  if (N = Dg(N)) {
                      var P = Ej(n)
                        , k = Ej(X);
                      return N.action = function(_) {
                          C.fi({
                              kind: C._walking ? "betweenWalk" : "beginWalk"
                          }),
                          C._walking = 1;
                          var O = Y * _;
                          n[0] = P[0] + z[0] * O,
                          n[1] = P[1] + z[1] * O,
                          n[2] = P[2] + z[2] * O,
                          X[0] = k[0] + z[0] * O,
                          X[1] = k[1] + z[1] * O,
                          X[2] = k[2] + z[2] * O,
                          C.fp(Cm, E, n),
                          C.fp(ef, E, X)
                      }
                      ,
                      N._37o = function() {
                          delete C._90O,
                          delete C._walking,
                          C.fi({
                              kind: "endWalk"
                          }),
                          C.onWalkEnded()
                      }
                      ,
                      C._90O = Bl(N)
                  }
                  n[0] += z[0] * Y,
                  n[1] += z[1] * Y,
                  n[2] += z[2] * Y,
                  X[0] += z[0] * Y,
                  X[1] += z[1] * Y,
                  X[2] += z[2] * Y,
                  C.fp(Cm, E, n),
                  C.fp(ef, E, X)
              }
          },
          handleScroll: function(O, Q) {
              O.preventDefault();
              var j = this
                , R = j._moveStep
                , V = j.getDataInfoAt(O);
              if (V) {
                  var J = V.data;
                  if (J && j.isInteractive(J)) {
                      var a = j.intersectObject(O, J);
                      if (a) {
                          var $ = a.part
                            , W = Ti(J.s($ + ".image") || J.s("shape3d." + $ + ".image") || J.s("all.image") || J.s("shape3d.image"));
                          if (W && yn(W.scrollable, J, j))
                              return
                      }
                  }
              }
              return j.isFirstPersonMode() ? (j.isPannable() && j.pan(0, Q > 0 ? R : -R),
              void 0) : (j.isZoomable() && (j._lastZoomLP = j.lp(O),
              j.setZoom(0 > Q ? 1 / Qe : Qe),
              j._lastZoomLP = j._lastZoomHit = null),
              void 0)
          },
          handlePinch: function(u, E) {
              if (this.isZoomable()) {
                  if (Math.abs(u - E) < M.pinchZoomThreshold)
                      return;
                  this.setZoom(E > u ? 1 / pd : pd)
              }
          },
          reset: function() {
              this.setCenter(M.graph3dViewCenter),
              this.setEye(M.graph3dViewEye),
              this.setUp(M.graph3dViewUp)
          },
          moveSelection: function(E, h, j) {
              var K = this;
              K.dm().beginTransaction(),
              Lc(this.sm().toSelection(this.isMovable, this), E, h, j),
              K.dm().endTransaction()
          },
          getMoveMode: function(e, w) {
              var g = w.s("3d.move.mode");
              if (g)
                  return g;
              var K = "88"
                , U = "89"
                , E = "90";
              return Oh(e) || de[K] && de[U] && de[E] ? "xyz" : de[K] && de[U] ? "xy" : de[K] && de[E] ? "xz" : de[U] && de[E] ? "yz" : de[K] ? "x" : de[U] ? "y" : de[E] ? "z" : "xz"
          },
          handleTick: function() {
              var R = this
                , g = !1
                , P = R._moveStep
                , Y = P
                , H = !1
                , n = !0
                , d = R._rotateStep * (n ? -1 : 1);
              if (R.isWalkable() || (Y = 0),
              R.isPannable() || (P = 0),
              R.isRotatable() || (d = 0),
              R._32Q) {
                  var B = (Nr() - R._32Q) / 50;
                  Y *= B,
                  P *= B,
                  d *= B
              }
              R._31Q && (zj(R._31Q),
              delete R._31Q,
              delete R._32Q),
              mj() && (g = !0,
              R.pan(-P, 0, H, n)),
              Kd() && (g = !0,
              R.pan(P, 0, H, n)),
              be() && (g = !0,
              Oh() ? R.pan(0, P, H, n) : R.walk(Y, H, n)),
              pi() && (g = !0,
              Oh() ? R.pan(0, -P, H, n) : R.walk(-Y, H, n)),
              Ll() && (g = !0,
              R.rotate(-d, 0, H, n)),
              zp() && (g = !0,
              R.rotate(d, 0, H, n)),
              yo() && (g = !0,
              R.rotate(0, -d / 2, H, n)),
              Cf() && (g = !0,
              R.rotate(0, d / 2, H, n)),
              g && (R._32Q = Nr(),
              R._31Q = rb(R.handleTick, R))
          },
          handleKeyDown: function(j) {
              var I = this;
              !Tr(j) && Jd[j.keyCode] ? I.handleTick() : td(j) ? I.selectAll() : Xr(j) ? I.handleDelete(j) : ec(j) && this.isResettable() && I.reset()
          },
          checkDoubleClickOnNote: function(Y, K, q) {
              var B = this;
              if (q === Up) {
                  if (K.s("note.toggleable"))
                      return K.s(Nj, !K.s(Nj)),
                      B.fi({
                          kind: "toggleNote",
                          event: Y,
                          data: K,
                          part: q
                      }),
                      !0
              } else if (q === lj && K.s("note2.toggleable"))
                  return K.s($o, !K.s($o)),
                  B.fi({
                      kind: "toggleNote2",
                      event: Y,
                      data: K,
                      part: q
                  }),
                  !0;
              return !1
          },
          checkDoubleClickOnRotation: function(Z, u, c) {
              return c === ir ? (u.setRotationX(0),
              !0) : c === Wn ? (u.setRotationY(0),
              !0) : c === Ve ? (u.setRotationZ(0),
              !0) : !1
          },
          onRotateEnded: function() {},
          onWalkEnded: function() {},
          getViewRatio: function(t) {
              var j = this;
              if (j.isOrtho())
                  return j.getWidth() / j.getOrthoWidth();
              var l = j.getCenter()
                , r = j.getHeight()
                , A = j.getEye()
                , m = [l[0] - A[0], l[1] - A[1], l[2] - A[2]]
                , H = [t[0] - A[0], t[1] - A[1], t[2] - A[2]]
                , N = Math.sqrt(m[0] * m[0] + m[1] * m[1] + m[2] * m[2])
                , q = 1 / Math.tan(j.getFovy() / 2);
              return r * N * q / (H[0] * m[0] + H[1] * m[1] + H[2] * m[2])
          },
          inViewSpace: function(L) {
              var C, p = this, W = p._transformPointToViewSpace(L), d = p.getAspect(), q = p.getNear(), w = p.getFar();
              return -W[2] < q || -W[2] > w ? !1 : p.isOrtho() ? (C = p.getOrthoWidth() / 2,
              Math.abs(W[0]) <= C && Math.abs(W[1] * d) <= C) : (C = Math.sqrt(W[0] * W[0] + W[1] * W[1] + W[2] * W[2]) * Math.tan(p.getFovy() / 2),
              Math.abs(W[1] <= C) && Math.abs(W[0]) <= C * d)
          },
          getPVMatrix: function() {
              var E, K = this;
              return (E = K._18Q) || (E = Yl(K),
              K._18Q = Fo(E, E, Lq(K)),
              K._18Q._wh = K.getWidth() / 2 / K.getHeight()),
              E
          },
          getFrustum: function() {
              var o = new Sc
                , B = new yr
                , f = new Array(16);
              return function() {
                  for (var e = this.getPVMatrix(), G = !1, a = 0; 16 > a; a++)
                      e[a] !== f[a] && (G = !0,
                      f[a] = e[a]);
                  return G && B.setFromMatrix(o.fromArray(e)),
                  B
              }
          }(),
          toViewPosition: function(D) {
              var _ = this
                , t = _.getWidth() / 2
                , i = _.getHeight() / 2
                , B = _.getPVMatrix();
              return D = Or([D[0], D[1], D[2], 1], B),
              {
                  x: t + t * D[0] / D[3],
                  y: i - i * D[1] / D[3],
                  z: D[2] / D[3]
              }
          },
          getHitPosition: function(p, Z, Y) {
              var _ = this
                , u = _.getWidth()
                , i = _.getHeight()
                , d = p.target ? _.lp(p) : p
                , w = d.x - u / 2
                , M = d.y - i / 2
                , g = _.getCenterInfo()
                , R = Lq(_);
              Z = Z ? Z : [0, 0, 0],
              Y = Y ? Y : [0, 1, 0],
              w = w / u * g.width,
              M = -1 * M / i * g.height;
              var b = [R[0] * w, R[4] * w, R[8] * w]
                , h = [R[1] * M, R[5] * M, R[9] * M]
                , G = [b[0] + h[0], b[1] + h[1], b[2] + h[2]]
                , l = _.getCenter()
                , C = Em(_, Z, Y, [G[0] + l[0], G[1] + l[1], G[2] + l[2]]);
              return C ? C : [0, 0, 0]
          },
          intersectObject: function(u, C) {
              return this._raycaster.intersectObject(u, C)
          },
          intersectObjects: function(T, J, Q) {
              return this._raycaster.intersectObjects(T, J, Q)
          },
          getLineLength: function(y) {
              this.validate();
              var B = this.getData3dUI(y);
              if (B && B.getCache) {
                  var t = B.getCache();
                  if (t)
                      return t[t.length - 1].length
              }
              return 0
          },
          getLineOffset: function(x, I) {
              var K = this.getData3dUI(x);
              if (K && K.getCache) {
                  var e = K.getCache();
                  if (e) {
                      var v = Br(e, I);
                      if (!x.r3)
                          return v;
                      var R = x.r3();
                      if (0 === R[0] && 0 === R[1] && 0 === R[2])
                          return v;
                      var w = new Rh(x.p3())
                        , t = new Rh(v.point).sub(w)
                        , W = new Rh(v.tangent).add(t)
                        , m = (new Qp).setFromEuler(new Ml(R,x.getRotationMode(),!0));
                      return t.applyQuaternion(m),
                      W.applyQuaternion(m),
                      {
                          point: t.add(w),
                          tangent: W.sub(t).normalize()
                      }
                  }
              }
              return E
          },
          isLabelVisible: function() {
              return !0
          },
          isNoteVisible: function() {
              return !0
          },
          moveCamera: function(e, N, j) {
              var G = this
                , a = G.getEye();
              a = [a[0], a[1], a[2]];
              var o = G.getCenter();
              if (o = [o[0], o[1], o[2]],
              e || (e = a),
              N || (N = o),
              G._flyAnim && G._flyAnim.stop(!0),
              j = Dg(j),
              !j)
                  return G.setEye(e[0], e[1], e[2]),
                  G.setCenter(N[0], N[1], N[2]),
                  delete G._flyAnim,
                  !0;
              var z = [e[0] - a[0], e[1] - a[1], e[2] - a[2]]
                , F = [N[0] - o[0], N[1] - o[1], N[2] - o[2]];
              return j.action = function(q) {
                  G.setCenter(o[0] + F[0] * q, o[1] + F[1] * q, o[2] + F[2] * q),
                  G.setEye(a[0] + z[0] * q, a[1] + z[1] * q, a[2] + z[2] * q)
              }
              ,
              j._37o = function() {
                  delete G._flyAnim
              }
              ,
              G._flyAnim = Bl(j)
          },
          flyTo: function() {
              function m(f, i, J) {
                  if (J instanceof n.Node) {
                      w.fromArray(Dp(J, i.getMat(J)));
                      var l = J.getAnchor3d();
                      f.push((new Rh).set(0 - l.x, 0 - l.y, 0 - l.z).applyMatrix4(w)),
                      f.push((new Rh).set(0 - l.x, 0 - l.y, 1 - l.z).applyMatrix4(w)),
                      f.push((new Rh).set(0 - l.x, 1 - l.y, 0 - l.z).applyMatrix4(w)),
                      f.push((new Rh).set(0 - l.x, 1 - l.y, 1 - l.z).applyMatrix4(w)),
                      f.push((new Rh).set(1 - l.x, 0 - l.y, 0 - l.z).applyMatrix4(w)),
                      f.push((new Rh).set(1 - l.x, 0 - l.y, 1 - l.z).applyMatrix4(w)),
                      f.push((new Rh).set(1 - l.x, 1 - l.y, 0 - l.z).applyMatrix4(w)),
                      f.push((new Rh).set(1 - l.x, 1 - l.y, 1 - l.z).applyMatrix4(w))
                  }
              }
              var s = new Rh
                , u = new Rh
                , D = new Rh
                , C = new Rh
                , w = new Sc
                , L = new n.Math.Quaternion
                , O = new Ml
                , z = new Wi;
              return function(P, N, a) {
                  var H = this;
                  if (a !== V)
                      N = {
                          animation: N,
                          ratio: a
                      };
                  else {
                      var i = typeof N;
                      ("boolean" === i || "object" === i && N.duration) && (N = {
                          animation: N
                      })
                  }
                  N = N || {},
                  s.fromArray(H.getEye()),
                  u.fromArray(H.getCenter());
                  var j, l, K = [], r = N.center, Y = N.distance === V;
                  if (r && D.fromArray(r),
                  P instanceof n.Node)
                      r || D.fromArray(P.p3()),
                      Y && (m(K, H, P),
                      j = K.length);
                  else {
                      if (P || (P = H.dm().getDatas()),
                      !P.length)
                          return;
                      if ((Y || !r) && (K = [],
                      P.forEach(function(P) {
                          m(K, H, P)
                      }),
                      j = K.length,
                      !j))
                          return;
                      r || (z.setFromPoints(K),
                      D.copy(z.min).add(z.max).multiplyScalar(.5))
                  }
                  if (H.setCenter(D.x, D.y, D.z),
                  C.subVectors(s, u),
                  N.direction || N.worldDirection) {
                      !N.worldDirection && P instanceof n.Node ? L.setFromEuler(O.set(P.r3(), P.getRotationMode(), !0)) : L.set(0, 0, 0, 1);
                      var t = C.length();
                      C.fromArray(N.worldDirection || N.direction).applyQuaternion(L).setLength(t)
                  }
                  var W = 0;
                  if (Y) {
                      var f, b, x, a = N.ratio || .8, Q = N.xRatio || a, E = N.yRatio || a;
                      if (H.isOrtho()) {
                          var p = -1 / 0;
                          for (H._eye[0] = C.x + D.x,
                          H._eye[1] = C.y + D.y,
                          H._eye[2] = C.z + D.z,
                          f = Yl(H),
                          Fo(f, f, Lq(H)),
                          l = 0; j > l; l++)
                              x = K[l],
                              b = Or([x.x, x.y, x.z, 1], f),
                              p = Math.max(p, Math.max(Math.abs(b[0]) / Q, Math.abs(b[1]) / E));
                          W = H.getOrthoWidth() * p,
                          C.add(D)
                      } else {
                          for (var e, T, y = H.getNear(), Z = 10; Z--; ) {
                              for (H._eye[0] = C.x + D.x,
                              H._eye[1] = C.y + D.y,
                              H._eye[2] = C.z + D.z,
                              f = Yl(H),
                              Fo(f, f, Lq(H)),
                              e = !0,
                              T = -1 / 0,
                              l = 0; j > l; l++) {
                                  if (x = K[l],
                                  b = Or([x.x, x.y, x.z, 1], f),
                                  b[3] < y && Z) {
                                      C.multiplyScalar(2),
                                      e = !1;
                                      break
                                  }
                                  T = Math.max(T, Math.max(Math.abs(b[0]) / Q, Math.abs(b[1]) / E) - b[3])
                              }
                              if (e)
                                  break
                          }
                          C.setLength(T + C.length()).add(D)
                      }
                  } else
                      C.setLength(N.distance).add(D);
                  H._flyAnim && H._flyAnim.stop(!0);
                  var I = Dg(N.animation);
                  if (I) {
                      H.setEye(s.x, s.y, s.z),
                      H.setCenter(u.x, u.y, u.z);
                      var q = (new Rh).subVectors(C, s)
                        , R = (new Rh).subVectors(D, u);
                      if (W)
                          var F = H.getOrthoWidth();
                      var $ = new Rh
                        , A = new Rh
                        , M = I.action
                        , v = I._37o
                        , d = s.clone()
                        , B = u.clone();
                      return I.action = function(m, l) {
                          $.copy(d).addScaledVector(q, m),
                          A.copy(B).addScaledVector(R, m),
                          H.setCenter(A.x, A.y, A.z),
                          H.setEye($.x, $.y, $.z),
                          W && H.setOrthoWidth((W - F) * m + F),
                          M && M(m, l)
                      }
                      ,
                      I._37o = function() {
                          delete H._flyAnim,
                          v && v()
                      }
                      ,
                      {
                          lastEye: s,
                          lastCenter: u,
                          eye: C,
                          center: D,
                          orthoWidth: W,
                          animation: H._flyAnim = Bl(I)
                      }
                  }
                  return H.setEye(C.x, C.y, C.z),
                  W && H.setOrthoWidth(W),
                  delete H._flyAnim,
                  {
                      lastEye: s,
                      lastCenter: u,
                      eye: C,
                      center: D,
                      orthoWidth: W
                  }
              }
          }(),
          getBoundingBox: function() {
              function q(G, v, w) {
                  P.fromArray(Dp(w, v.getMat(w)));
                  var y = w.getAnchor3d();
                  G.push((new Rh).set(0 - y.x, 0 - y.y, 0 - y.z).applyMatrix4(P)),
                  G.push((new Rh).set(0 - y.x, 0 - y.y, 1 - y.z).applyMatrix4(P)),
                  G.push((new Rh).set(0 - y.x, 1 - y.y, 0 - y.z).applyMatrix4(P)),
                  G.push((new Rh).set(0 - y.x, 1 - y.y, 1 - y.z).applyMatrix4(P)),
                  G.push((new Rh).set(1 - y.x, 0 - y.y, 0 - y.z).applyMatrix4(P)),
                  G.push((new Rh).set(1 - y.x, 0 - y.y, 1 - y.z).applyMatrix4(P)),
                  G.push((new Rh).set(1 - y.x, 1 - y.y, 0 - y.z).applyMatrix4(P)),
                  G.push((new Rh).set(1 - y.x, 1 - y.y, 1 - y.z).applyMatrix4(P))
              }
              var P = new Sc;
              return function(Z) {
                  if (Z = Z || this.sm().getSelection(),
                  Z instanceof n.Node && (Z = [Z]),
                  0 === Z.length)
                      return E;
                  var p = [];
                  Z.forEach(function(F) {
                      ud(F) && q(p, this, F)
                  }, this);
                  var k = [1 / 0, 1 / 0, 1 / 0]
                    , I = [-1 / 0, -1 / 0, -1 / 0];
                  return p.forEach(function(o) {
                      k[0] = Math.min(o.x, k[0]),
                      k[1] = Math.min(o.y, k[1]),
                      k[2] = Math.min(o.z, k[2]),
                      I[0] = Math.max(o.x, I[0]),
                      I[1] = Math.max(o.y, I[1]),
                      I[2] = Math.max(o.z, I[2])
                  }),
                  {
                      min: k,
                      max: I
                  }
              }
          }(),
          setBatchInfo: function(w, J) {
              var i = this._batchInfoMap[w];
              this._batchInfoMap[w] = J,
              this.fp("batchInfo", i, J)
          },
          getBatchInfo: function(M) {
              return this._batchInfoMap[M] || Mj[M]
          }
      }),
      rn.RenderEnv = function(k) {
          this.gv = k,
          this.enable = !1
      }
      ,
      G.defineProperties(rn.RenderEnv.prototype, {
          debugOn: {
              get: function() {
                  return this._debugOn
              },
              set: function(l) {
                  this._debugOn = l,
                  this.capture && this.capture()
              }
          }
      }),
      G.assign(rn.RenderEnv.prototype, {
          renderEnvToCube: function(V, S, L, O) {
              var w = this
                , x = w.gv;
              if (!V || !S || !L)
                  return w.enable = !1,
                  w._42 = null,
                  void 0;
              w.enable = !0;
              var d = Math.floor(O / V * S)
                , t = x.getGL()
                , G = w._renderTargets;
              G ? G.length < L && (G = w._renderTargets = G.concat(new Array(L - G.length))) : G = w._renderTargets = new Array(L);
              for (var v = 0; L > v; v++)
                  G[v] ? G[v].setSize(t, O, d) : G[v] = new rn.RenderTarget(x,t,O,d);
              var H = !1;
              w.capture = function() {
                  H = !0,
                  x._42(),
                  H = !1
              }
              ;
              var K = new Rh
                , P = new Rh
                , J = new Rh
                , h = new Rh
                , B = (new Rh).setY(0)
                , l = 2 * Math.PI / L
                , m = V / 2 / Math.tan(Math.PI / L)
                , R = 2 * Math.atan2(S / 2, m)
                , I = V / S;
              w._42 = function(i, o, M, S) {
                  var v = w._debugOn;
                  if (!H && !v)
                      return !1;
                  K.copy(x.getEye()),
                  h.copy(x.getCenter()).sub(K);
                  var D = Math.atan2(h.z, h.x)
                    , O = x.getNear()
                    , $ = x.getFovy()
                    , A = x.getAspect();
                  P.copy(x.getCenter());
                  for (var q, N = 0; L > N; N++)
                      if (q = G[N],
                      B.setZ(Math.cos(D)).setX(Math.sin(D)).multiplyScalar(m),
                      D -= l,
                      J.addVectors(K, B),
                      x.setNear(m),
                      x.setCenter([J.x, J.y, J.z]),
                      x.setFovy(R),
                      x.setAspect(I),
                      v) {
                          var p = Math.round(o / L);
                          Vj.for(i).glState.viewport = [p * N, 0, p, M],
                          S()
                      } else
                          fq(i, q.frame),
                          Vj.for(i).glState.viewport = [0, 0, q.width, q.height],
                          i.clear(i.COLOR_BUFFER_BIT),
                          S(),
                          Zp(i),
                          q.assureTexture();
                  return x.setNear(O),
                  x.setCenter([P.x, P.y, P.z]),
                  x.setFovy($),
                  x.setAspect(A),
                  !0
              }
              ,
              w.capture()
          },
          getTextureInfo: function(T) {
              var e = this._renderTargets;
              if (!e)
                  return null;
              var O = this._renderTargets[T];
              return O ? {
                  index: T,
                  texture: O.texture,
                  textureName: O.uuid
              } : null
          }
      }),
      G.assign(rn.Graph3dView.prototype, {
          renderEnvToCube: function(x, $, G, B) {
              var i = this;
              i.envRenderer || (i.envRenderer = new rn.RenderEnv(i)),
              i.envRenderer.renderEnvToCube(x, $, G, B)
          }
      });
      var tk = ["left", "front", "right", "back", "top", "bottom"]
        , yc = rn._RenderList = function() {
          function Y() {
              R.length = 0,
              a.length = 0,
              h = {}
          }
          function H(h) {
              var H = h.gv
                , r = h.data;
              if (_ && !Fc)
                  return h._renderParams = null,
                  void 0;
              var f, E, v, l, O = h.shapeModel;
              if (O) {
                  var Z, p, o, a = r.s("shape3d.transparent") || r.s("points.transparent");
                  for ($c(O) || (Z = yn(O.transparent, r, H),
                  O = [O]),
                  v = 0,
                  l = O.length; l > v; v++)
                      o = O[v],
                      p = yn(o.transparent, r, H),
                      p === V && (p = Z),
                      p === V && (p = a),
                      p ? E = !0 : f = !0
              }
              for (v = 0,
              l = tk.length; l > v; v++) {
                  var A = h[tk[v]];
                  A && (A.transparent ? E = !0 : f = !0)
              }
              H.isLabelVisible(r) && (h.labelInfo && (r.s(_r + ".transparent") ? E = !0 : f = !0),
              h.label2Info && (r.s(lc + ".transparent") ? E = !0 : f = !0)),
              H.isNoteVisible(r) && (h.noteInfo && (r.s(Up + ".transparent") ? E = !0 : f = !0),
              h.note2Info && (r.s(lj + ".transparent") ? E = !0 : f = !0)),
              h._38o && (E = f = !0),
              E || (f = !0),
              h._renderParams = {
                  opaque: f,
                  transparent: E
              }
          }
          function W(Q, n) {
              n && H(Q);
              var Z = Q.data
                , r = Z._id;
              if (!h[r]) {
                  h[r] = !0;
                  var Y = Q._renderParams;
                  Y && Y.visible !== !1 && (Q = {
                      ui: Q,
                      data: Z,
                      z: Z._z,
                      id: r
                  },
                  Y.opaque && R.push(Q),
                  Y.transparent && a.push(Q))
              }
          }
          function E() {
              R.length > 1 && R.sort(C),
              a.length > 1 && a.sort(g)
          }
          function x(m) {
              m ? (bg(z, $, m),
              bg(J, D, m),
              bg(N, r, m)) : (z = this.batchModelMap = {},
              $ = this.batchIndexMap = {},
              J = this.polylineModelMap = {},
              D = this.polylineIndexMap = {},
              N = this.wireframeModelMap = {},
              r = this.wireframeIndexMap = {}),
              this.markBatchInvalid()
          }
          function y(j) {
              j ? bg(z, $, j) : (z = this.batchModelMap = {},
              $ = this.batchIndexMap = {}),
              this.markBatchInvalid()
          }
          function S(w) {
              w ? bg(J, D, w) : (J = this.polylineModelMap = {},
              D = this.polylineIndexMap = {}),
              this.markBatchInvalid()
          }
          function M(J) {
              J ? bg(N, r, J) : (N = this.wireframeModelMap = {},
              r = this.wireframeIndexMap = {}),
              this.markBatchInvalid()
          }
          function B() {
              return this._batchInvalid
          }
          function k() {
              this._batchInvalid = !0
          }
          function v() {
              this._batchInvalid = null
          }
          var R = []
            , a = []
            , z = {}
            , $ = {}
            , J = {}
            , D = {}
            , N = {}
            , r = {}
            , h = {};
          return {
              opaque: R,
              transparent: a,
              init: Y,
              push: W,
              batchModelMap: z,
              batchIndexMap: $,
              polylineModelMap: J,
              polylineIndexMap: D,
              wireframeModelMap: N,
              wireframeIndexMap: r,
              ivBatch: x,
              ivModelBatch: y,
              ivPolylineBatch: S,
              ivWireframeBatch: M,
              markBatchInvalid: k,
              isBatchInvalid: B,
              onUpdated: v,
              sort: E
          }
      }
        , ss = rn._RenderLists = function() {
          function F() {
              for (var e in j)
                  j[e].init()
          }
          function u() {
              for (var C in j)
                  j[C].onUpdated()
          }
          function e(N, c) {
              N = N || "main";
              var G = j[N];
              return !G && c && (G = j[N] = new yc),
              G
          }
          function o(X, R) {
              var Y = X.data.getRenderLayer()
                , F = e(Y, !0);
              F.push(X, R)
          }
          function C(H) {
              for (var y in j)
                  H(j[y])
          }
          var j = {};
          return {
              init: F,
              onUpdated: u,
              get: e,
              push: o,
              each: C,
              lists: j
          }
      }
        , hm = rn.RenderTarget = function(t, i, W, w, Y) {
          var m = this;
          Y = Y || {},
          Y.samples = Math.min(t._glCapabilities.maxSamples, Y.samples && Y.samples > 1 && 2 === t._webGLVersion ? Y.samples : 0),
          m.options = Y,
          m.uuid = n.Math.generateUUID(),
          m.gv = t,
          m.init(t, i, Y),
          Y.samples && !t._glCapabilities._maxSamplesChecked ? m.setSize(i, W || 1, w || 1) : m.setSize(i, W, w)
      }
      ;
      G.assign(rn.RenderTarget.prototype, {
          bind: function(A) {
              fq(A, this.options.samples ? this._MSAAFbo : this.frame)
          },
          unbind: function($) {
              Zp($),
              this.options.samples && ($.bindFramebuffer($.READ_FRAMEBUFFER, this._MSAAFbo),
              $.bindFramebuffer($.DRAW_FRAMEBUFFER, this.frame),
              $.blitFramebuffer(0, 0, this.width, this.height, 0, 0, this.width, this.height, $.COLOR_BUFFER_BIT, $.NEAREST),
              $.bindFramebuffer($.READ_FRAMEBUFFER, null),
              $.bindFramebuffer($.DRAW_FRAMEBUFFER, null))
          },
          init: function(W, S, U) {
              var z = this
                , T = z.texture = S.createTexture();
              S.activeTexture(S.TEXTURE0),
              cr(S, T);
              var Y = U.samples
                , o = Y ? S.NEAREST : S.LINEAR;
              S.texParameteri(S.TEXTURE_2D, S.TEXTURE_MIN_FILTER, U.minFilter || o),
              S.texParameteri(S.TEXTURE_2D, S.TEXTURE_MAG_FILTER, U.magFilter || o),
              cr(S, null),
              z.render = S.createRenderbuffer(),
              z.frame = S.createFramebuffer(),
              W._2O[z.uuid] = T
          },
          assureTexture: function() {
              var t = this
                , M = t.uuid
                , x = t.gv._2O;
              x[M] || (x[M] = t.texture)
          },
          setSize: function(Y, O, p) {
              var x = this;
              if (O && p && (x.width !== O || x.height !== p)) {
                  var l = Y.RGBA
                    , Z = Y.TEXTURE_2D
                    , e = Y.RENDERBUFFER
                    , T = Y.FRAMEBUFFER
                    , z = x.options.samples;
                  if (Y.activeTexture(Y.TEXTURE0),
                  cr(Y, x.texture),
                  Y.texImage2D(Z, 0, l, O, p, 0, l, Y.UNSIGNED_BYTE, E),
                  rk.isPOT(O) && rk.isPOT(p) && !x.options.clampToEdge ? (Y.texParameteri(Y.TEXTURE_2D, Y.TEXTURE_WRAP_S, Y.REPEAT),
                  Y.texParameteri(Y.TEXTURE_2D, Y.TEXTURE_WRAP_S, Y.REPEAT)) : (Y.texParameteri(Y.TEXTURE_2D, Y.TEXTURE_WRAP_S, Y.CLAMP_TO_EDGE),
                  Y.texParameteri(Y.TEXTURE_2D, Y.TEXTURE_WRAP_T, Y.CLAMP_TO_EDGE)),
                  Y.bindRenderbuffer(e, x.render),
                  z) {
                      var k = x.gv._glCapabilities;
                      if (k._maxSamplesChecked)
                          Y.renderbufferStorageMultisample(e, z, Y.DEPTH_COMPONENT16, O, p);
                      else {
                          for (Y.getError(); z > 1 && (Y.renderbufferStorageMultisample(e, z, Y.DEPTH_COMPONENT16, O, p),
                          Y.getError()); )
                              z = Math.floor(z >> 1);
                          1 >= z && (z = 0,
                          Y.texParameteri(Y.TEXTURE_2D, Y.TEXTURE_MIN_FILTER, x.options.minFilter || Y.LINEAR),
                          Y.texParameteri(Y.TEXTURE_2D, Y.TEXTURE_MAG_FILTER, x.options.magFilter || Y.LINEAR),
                          Y.renderbufferStorage(e, Y.DEPTH_COMPONENT16, O, p)),
                          k._maxSamplesChecked = !0,
                          k.maxSamples = x.options.samples = z
                      }
                  } else
                      Y.renderbufferStorage(e, Y.DEPTH_COMPONENT16, O, p);
                  z && !x._MSAAFbo && (x._MSAAFbo = Y.createFramebuffer(),
                  x._MSAARbO = Y.createRenderbuffer()),
                  fq(Y, x.frame),
                  Y.framebufferTexture2D(T, Y.COLOR_ATTACHMENT0, Z, x.texture, 0),
                  z || Y.framebufferRenderbuffer(T, Y.DEPTH_ATTACHMENT, e, x.render),
                  Zp(Y),
                  z && (Y.bindRenderbuffer(Y.RENDERBUFFER, x._MSAARbO),
                  Y.renderbufferStorageMultisample(Y.RENDERBUFFER, z, Y.RGBA8, O, p),
                  fq(Y, x._MSAAFbo),
                  Y.framebufferRenderbuffer(Y.FRAMEBUFFER, Y.COLOR_ATTACHMENT0, Y.RENDERBUFFER, x._MSAARbO),
                  Y.framebufferRenderbuffer(T, Y.DEPTH_ATTACHMENT, e, x.render),
                  Zp(Y)),
                  cr(Y, E),
                  Y.bindRenderbuffer(e, E),
                  x.width = O,
                  x.height = p
              }
          },
          toCanvas: function() {
              var U = this
                , z = U.gv.getGL();
              fq(z, U.frame);
              var i = U.width
                , d = U.height
                , h = new Uint8Array(4 * i * d);
              z.readPixels(0, 0, i, d, z.RGBA, z.UNSIGNED_BYTE, h),
              Zp(z);
              var j = Y.createElement("canvas");
              j.width = i,
              j.height = d;
              var H = j.getContext("2d")
                , V = H.createImageData(i, d);
              return V.data.set(h),
              H.putImageData(V, 0, 0),
              j
          }
      });
      var fm = rn.Interactor = function(y) {
          this.gv = this.g3d = y
      }
      ;
      ii("Interactor", G, {
          ms_listener: 1,
          getView: function() {
              return this.gv.getView()
          },
          setUp: function() {
              this.addListeners()
          },
          tearDown: function() {
              this.removeListeners()
          }
      });
      var tc = rn.DefaultInteractor = function(W) {
          Jg(tc, this, [W])
      }
      ;
      ii("DefaultInteractor", fm, {
          getDataInfoAt: function(U, r) {
              var C = this.gv
                , e = C.getDataInfoAt(U);
              if (!C.isBlockSelectable() || !e || !e.data)
                  return e;
              if (!r && C.isSelected(e.data))
                  return e;
              for (var m = e.data; (m = m.getParent()) && m instanceof n.Block && C.isSelectable(m); ) {
                  var B = C.isSelected(m);
                  if (B && r)
                      break;
                  if (e = {
                      data: m,
                      part: e
                  },
                  B && !r)
                      break
              }
              return e
          },
          handle_contextmenu: function(c) {
              ad(c)
          },
          handle_mousewheel: function(t) {
              this.gv.handleScroll(t, t.wheelDelta / 40)
          },
          handle_DOMMouseScroll: function(Y) {
              2 === Y.axis && this.gv.handleScroll(Y, -Y.detail)
          },
          handle_keydown: function(c) {
              this.gv.handleKeyDown(c)
          },
          handle_mousedown: function(p) {
              this.handle_touchstart(p)
          },
          handle_touchstart: function(J) {
              ad(J);
              var O = this
                , h = O.gv
                , f = ni(J)
                , Z = O.getDataInfoAt(J)
                , e = Z ? Z.data : E
                , z = Z ? Z.part : E
                , m = h.sm()
                , a = Re(J)
                , c = Yp(J);
              h.setFocus(J) && (O._62O = E,
              O._57I = E,
              O.pendingClickThrough = E,
              O.__lastClientPoint__ = Gp(J),
              e ? Tr(J) ? m.co(e) ? m.rs(e) : m.as(e) : m.co(e) ? e instanceof ch && e.isClickThroughEnabled() && ni(J) && (O.pendingClickThrough = Gp(J)) : m.ss(e) : f && (Tr(J) ? h.isRectSelectable() && (O._62O = Mk) : O._57I = Gp(J)),
              O._31Q && (zj(O._31Q),
              delete O._31Q,
              delete O._32Q),
              O._62O || (h.isFirstPersonMode() && (Oh(J) || no(J) || c > 2 ? O._62O = "pan" : h.isMouseRoamable() || sg(J) ? (O._62O = "roaming",
              O.foward = a && ni(J),
              O._32Q = Nr(),
              O._31Q = rb(O.tick, O)) : f || (O._62O = "roaming")),
              O._62O || (f && a && Er[z] ? (O._62O = z,
              O.p3 = e.p3()) : f && a && ud(e) && h.isSelected(e) ? h.isMovable(e) ? (O._62O = "move",
              O.p3 = e.p3(),
              O.movedata = e) : h._39Q(e) && (O._62O = "none") : sg(J) && (c > 2 ? O._62O = "pan" : 2 === c && (O.dist = fd(J),
              O._62O = "pinch")))),
              O.point = h.lp(J),
              dq(O, J),
              Xk(J) ? h.handleDoubleClick(J, e, z) : h.handleClick(J, e, z))
          },
          tick: function() {
              var I = this
                , F = I.gv
                , p = F._moveStep;
              I.point && F.isWalkable() && (I._32Q && (p *= (Nr() - I._32Q) / 50),
              F.walk(I.foward ? p : -p),
              I._32Q = Nr(),
              I._31Q = rb(I.tick, I))
          },
          handle_mouseup: function(h) {
              this.handle_touchend(h)
          },
          handle_touchend: function(k) {
              var Q = this._57I;
              if (Q && (Qf(Q, Gp(k)) <= 1 && this.gv.sm().cs(),
              this._57I = E),
              Q = this.pendingClickThrough) {
                  if (Qf(Q, Gp(k)) <= 1) {
                      var b = this.getDataInfoAt(k);
                      b && b.data instanceof ch && b.data.isClickThroughEnabled() && (b = this.getDataInfoAt(k, !0),
                      b && (k.clickThrough = !0,
                      this.gv.sm().ss(b.data)))
                  }
                  this.pendingClickThrough = null
              }
          },
          handleWindowMouseMove: function(h) {
              this.handleWindowTouchMove(h)
          },
          handleWindowTouchMove: function(_) {
              var T, x, P = this, d = P.gv, I = P._62O, h = P.point, E = d.dm(), a = d.lp(_), G = a.x - h.x, K = a.y - h.y, k = d.getWidth(), w = d.getHeight();
              if (k && w) {
                  var q = Gp(_)
                    , C = gj(d, q, P.__lastClientPoint__)
                    , Z = Qf({
                      x: 0,
                      y: 0
                  }, C)
                    , Y = -y * G / k
                    , j = -y * K / w;
                  if ("roaming" === I)
                      P.rotate(_, Y / 2, j / 2);
                  else if (I === ir || I === Wn || I === Ve)
                      d._86O || E.beginTransaction(),
                      d.fi({
                          kind: d._86O ? "betweenEditRotation" : "beginEditRotation",
                          event: _
                      }),
                      d._86O = 1,
                      d.sm().each(function(p) {
                          if (ud(p) && d.isRotationEditable(p)) {
                              var J = u(Y) > u(j) ? Y : j;
                              I === ir ? p.setRotationX(p.getRotationX() + J) : I === Wn ? p.setRotationY(p.getRotationY() + J) : I === Ve && p.setRotationZ(p.getRotationZ() + J)
                          }
                      });
                  else if ("move" === I || Er[I]) {
                      if (I === of || I === ko || I === Gl)
                          d._87O || E.beginTransaction(),
                          d.fi({
                              kind: d._87O ? "betweenEditScale" : "beginEditScale",
                              event: _
                          }),
                          d._87O = 1;
                      else {
                          if (!d._moving) {
                              if (Z < M.touchMoveThreshold)
                                  return;
                              E.beginTransaction()
                          }
                          d.fi({
                              kind: d._moving ? "betweenMove" : "beginMove",
                              event: _
                          }),
                          d._moving = 1
                      }
                      var i, s = P.p3, v = d.getPositionInfo(s), t = Lq(d);
                      i = I === xd ? "x" : I === An ? "y" : I === ip ? "z" : I === of ? "sx" : I === ko ? "sy" : I === Gl ? "sz" : d.getMoveMode(_, P.movedata),
                      G = G / k * v.width,
                      K = -1 * K / w * v.height;
                      var V, Q, e = [t[0] * G, t[4] * G, t[8] * G], n = [t[1] * K, t[5] * K, t[9] * K], D = e[0] + n[0], U = e[1] + n[1], R = e[2] + n[2], A = [s[0] + D, s[1] + U, s[2] + R], l = Bb(d.getEye(), A, !0);
                      if ("xyz" === i ? (V = A,
                      d.moveSelection(D, U, R)) : "xz" === i ? (V = Em(d, s, [0, 1, 0], A),
                      V && d.moveSelection(V[0] - s[0], 0, V[2] - s[2])) : "xy" === i ? (V = Em(d, s, [0, 0, 1], A),
                      V && d.moveSelection(V[0] - s[0], V[1] - s[1], 0)) : "yz" === i ? (V = Em(d, s, [1, 0, 0], A),
                      V && d.moveSelection(0, V[1] - s[1], V[2] - s[2])) : "x" === i || "sx" === i ? (l[0] = 0,
                      V = Em(d, s, l, A),
                      V && (Q = V[0] - s[0],
                      "x" === i ? d.moveSelection(Q, 0, 0) : d.sm().each(function(P) {
                          ud(P) && d.isSizeEditable(P) && (T = P.getScaleX() + Q / 100,
                          x = T / P.getScaleX(),
                          P.setScaleX(T),
                          Oh(_) && (P.setScaleY(P.getScaleY() * x),
                          P.setScaleTall(P.getScaleTall() * x)))
                      }))) : "y" === i || "sy" === i ? (l[1] = 0,
                      V = Em(d, s, l, A),
                      V && (Q = V[1] - s[1],
                      "y" === i ? d.moveSelection(0, Q, 0) : d.sm().each(function(g) {
                          ud(g) && d.isSizeEditable(g) && (T = g.getScaleTall() + Q / 100,
                          x = T / g.getScaleTall(),
                          g.setScaleTall(T),
                          Oh(_) && (g.setScaleY(g.getScaleY() * x),
                          g.setScaleX(g.getScaleX() * x)))
                      }))) : ("z" === i || "sz" === i) && (l[2] = 0,
                      V = Em(d, s, l, A),
                      V && (Q = V[2] - s[2],
                      "z" === i ? d.moveSelection(0, 0, Q) : d.sm().each(function(G) {
                          ud(G) && d.isSizeEditable(G) && (T = G.getScaleY() + Q / 100,
                          x = T / G.getScaleY(),
                          G.setScaleY(T),
                          Oh(_) && (G.setScaleX(G.getScaleX() * x),
                          G.setScaleTall(G.getScaleTall() * x)))
                      }))),
                      !V)
                          return;
                      P.p3 = V
                  } else if (I === Mk) {
                      var F = P.div;
                      F || (F = P.div = cf(),
                      Qc(P.getView(), F),
                      F.op = h,
                      F.style.background = d.getRectSelectBackground()),
                      d.fi({
                          kind: d._rectSelecting ? "betweenRectSelect" : "beginRectSelect",
                          event: _
                      }),
                      d._rectSelecting = 1,
                      F.rect = kr(F.op, a),
                      ib(F, F.rect)
                  } else if ("pinch" === I && 2 === Yp(_)) {
                      d.fi({
                          kind: d._pinching ? "betweenPinch" : "beginPinch",
                          event: _
                      }),
                      d._pinching = 1;
                      var Q = fd(_);
                      d._lastZoomLP || (d._lastZoomLP = Rj(_)),
                      d.handlePinch(Q, P.dist),
                      P.dist = Q
                  } else
                      "pan" === I || Oh(_) || no(_) ? P.pan(_, G, K) : "none" === I || d.isFirstPersonMode() || P.rotate(_, Y, j);
                  P.point = a
              }
          },
          pan: function(x, T, u) {
              var J = this.gv;
              if (J.isPannable()) {
                  var X = J.getWidth()
                    , p = J.getHeight();
                  if (!X || !p)
                      return;
                  var l = J.getCenterInfo()
                    , s = T / X * l.width
                    , v = -1 * u / p * l.height;
                  J.fi({
                      kind: J._panning ? "betweenPan" : "beginPan",
                      event: x
                  }),
                  J._panning = 1,
                  J.pan(-s, -v)
              }
          },
          rotate: function(b, k, c) {
              var q = this.gv;
              q.isRotatable() && (q.fi({
                  kind: q._rotating ? "betweenRotate" : "beginRotate",
                  event: b
              }),
              q._rotating = 1,
              q.rotate(k, c))
          },
          handleWindowMouseUp: function(v) {
              this.handleWindowTouchEnd(v)
          },
          handleWindowTouchEnd: function(p) {
              var L = this
                , k = L.gv
                , X = k.dm()
                , P = L.div;
              if (P) {
                  var r = k.getDatasInRect(P.rect);
                  if (!r.isEmpty()) {
                      var F = k.sm()
                        , d = F.toSelection();
                      r.each(function(D) {
                          F.co(D) ? d.remove(D) : d.add(D)
                      }),
                      F.ss(d)
                  }
                  is(P)
              }
              k._moving && (delete k._moving,
              k.fi({
                  kind: "endMove",
                  event: p
              }),
              k.onMoveEnded(),
              X.endTransaction()),
              k._panning && (delete k._panning,
              k.fi({
                  kind: "endPan",
                  event: p
              }),
              k.onPanEnded()),
              k._rotating && (delete k._rotating,
              k.fi({
                  kind: "endRotate",
                  event: p
              }),
              k.onRotateEnded()),
              k._86O && (delete k._86O,
              k.fi({
                  kind: "endEditRotation",
                  event: p
              }),
              X.endTransaction()),
              k._87O && (delete k._87O,
              k.fi({
                  kind: "endEditScale",
                  event: p
              }),
              X.endTransaction()),
              k._pinching && (delete k._pinching,
              k.fi({
                  kind: "endPinch",
                  event: p
              }),
              k.onPinchEnded()),
              k._rectSelecting && (delete k._rectSelecting,
              k.fi({
                  kind: "endRectSelect",
                  event: p
              }),
              k.onRectSelectEnded()),
              k._walking && (delete k._walking,
              k.fi({
                  kind: "endWalk",
                  event: p
              }),
              k.onWalkEnded()),
              k._lastZoomLP = k._lastZoomHit = null,
              L.dist = L.point = L._62O = L.p3 = L.movedata = L.div = L._57I = L.pendingClickThrough = L._32Q = L._31Q = L.foward = E,
              L.__lastClientPoint__ = E
          }
      });
      var Gf = rn.MapInteractor = function(e) {
          Jg(Gf, this, [e]),
          this._keepHorizon = !0,
          this._threshold = 2,
          this._touchScaleThreshold = .05,
          this._touchRotateThreshold = .03,
          this._touchScaleCheckAccuracy = .01,
          this._panButton = "right",
          this.maxPhi = 5 * Math.PI / 12
      }
      ;
      ii("MapInteractor", fm, {
          handle_contextmenu: function(f) {
              ad(f)
          },
          handle_mousewheel: function(c) {
              this.gv.handleScroll(c, c.wheelDelta / 40)
          },
          handle_DOMMouseScroll: function(V) {
              2 === V.axis && this.gv.handleScroll(V, -V.detail)
          },
          handle_keydown: function(J) {
              this.gv.handleKeyDown(J)
          },
          handle_mousedown: function(l) {
              this.handle_touchstart(l)
          },
          handle_touchstart: function(X) {
              ad(X);
              var u = this
                , f = u.gv;
              if (f.setFocus(X)) {
                  var B = f.getDataInfoAt(X)
                    , $ = B ? B.data : E
                    , e = B ? B.part : E
                    , j = u.editing = {
                      point: f.lp(X)
                  };
                  sg(X) ? j.touch = !0 : (j.touch = !1,
                  j.clickLeft = ni(X),
                  j.pan = no(X) ? !0 : "left" === this.panButton === j.clickLeft),
                  $ && f._39Q($) && (j.preventDefault = !0),
                  dq(u, X),
                  Xk(X) ? f.handleDoubleClick(X, $, e) : f.handleClick(X, $, e)
              }
          },
          handle_mouseup: function(_) {
              this.handle_touchend(_)
          },
          handle_touchend: function() {},
          handleWindowMouseMove: function(G) {
              this.handleWindowTouchMove(G)
          },
          handleWindowTouchMove: function(J) {
              var b = this
                , i = b.gv
                , e = b.editing;
              if (e) {
                  var F = i.lp(J)
                    , W = e.point
                    , g = F.x - W.x
                    , V = F.y - W.y;
                  if (!e.moved) {
                      if (Math.abs(g) < b.threshold && Math.abs(V) < b.threshold && !(J.touches && J.touches.length > 1))
                          return;
                      e.moved = !0
                  }
                  if (!e.preventDefault)
                      if (e.point = F,
                      e.touch) {
                          var q = J.touches.length;
                          if (2 !== q)
                              b.pan(J, g, V);
                          else {
                              if (1 >= q)
                                  return;
                              var l = J.touches
                                , t = {
                                  x: l[0].clientX,
                                  y: l[0].clientY
                              }
                                , D = {
                                  x: l[1].clientX,
                                  y: l[1].clientY
                              }
                                , u = {
                                  x: D.x - t.x,
                                  y: D.y - t.y
                              }
                                , Y = e.lastCenter
                                , w = Math.atan2(u.y, u.x)
                                , H = e.theta
                                , x = 0;
                              H == E ? H = e.theta = w : (x = w - H,
                              e.thetaStarted || Math.abs(x) > b.touchRotateThreshold ? (e.thetaStarted = !0,
                              e.theta = w) : x = 0);
                              var h = s * (t.y + D.y) / 2 / i.getHeight()
                                , _ = e.phi
                                , m = 0;
                              _ == E ? _ = e.phi = h : (m = h - _,
                              e.phiStarted || Math.abs(m) > b.touchRotateThreshold ? (e.phiStarted = !0,
                              e.phi = h) : m = 0);
                              var T, r = Math.sqrt(u.x * u.x + u.y * u.y), f = e.vlen;
                              if (f) {
                                  var A = t.x - Y.x
                                    , L = t.y - Y.y
                                    , K = D.x - Y.x
                                    , N = D.y - Y.y
                                    , d = Math.sqrt(A * A + L * L)
                                    , c = Math.sqrt(K * K + N * N)
                                    , $ = f / 2
                                    , n = b._sign2(d - $)
                                    , v = b._sign2(c - $);
                                  0 > n * v || 0 === n && 0 === v ? (T = 1,
                                  e.vlen = r) : (T || (T = r / f),
                                  e.scaleStarted || Math.abs(T - 1) > b.touchScaleThreshold ? (e.vlen = r,
                                  e.scaleStarted = !0) : T = 1)
                              } else
                                  f = e.vlen = r,
                                  T = 1;
                              1 !== T && i.setZoom(T),
                              (m || x) && b.rotate(J, x, -m),
                              e.lastCenter = {
                                  x: (D.x + t.x) / 2,
                                  y: (D.y + t.y) / 2
                              }
                          }
                      } else if (e.pan)
                          b.pan(J, g, V);
                      else {
                          var O = i.getWidth()
                            , G = i.getHeight();
                          if (!O || !G)
                              return;
                          var j = -y * g / O
                            , R = -y * V / G;
                          b.rotate(J, j, R)
                      }
              }
          },
          _sign2: function(u) {
              return Math.abs(u) < this._touchScaleCheckAccuracy ? 0 : u > 0 ? 1 : -1
          },
          handleWindowMouseUp: function(i) {
              this.handleWindowTouchEnd(i)
          },
          handleWindowTouchEnd: function(t) {
              var p = this
                , X = p.editing;
              if (p.editing = null,
              X) {
                  var Q = p.gv;
                  if (X.moved || !X.clickLeft && !X.touch)
                      Q._panning = null,
                      Q._rotating = null,
                      Q.fi({
                          kind: X.pan ? "endPan" : "endRotate",
                          event: t
                      });
                  else {
                      var Z = Q.getDataAt(t);
                      Z ? Q.sm().setSelection([Z]) : Q.sm().clearSelection()
                  }
              }
          },
          pan: function(o, W, Q) {
              var R = this
                , C = R.gv;
              if (C.isPannable()) {
                  var u = C.getWidth()
                    , e = C.getHeight();
                  if (u && e) {
                      var g = C.getCenterInfo()
                        , Y = -W / u * g.width
                        , j = 1 * Q / e * g.height;
                      C.fi({
                          kind: C._panning ? "betweenPan" : "beginPan",
                          event: o
                      }),
                      C._panning = 1;
                      var i = R.keepHorizon
                        , S = R.editing.touch;
                      if ((S && o.touches && o.touches.length > 1 || !S && Oh(o)) && (i = !i),
                      !i)
                          return C.pan(Y, j);
                      if (Y || j) {
                          var t = Lq(C)
                            , z = [t[0] * Y, t[4] * Y, t[8] * Y]
                            , l = [t[1], 0, t[9]]
                            , X = Math.sqrt(l[0] * l[0] + l[2] * l[2]);
                          X && (l = [l[0] / X * j, 0, l[2] / X * j]);
                          var c = z[0] + l[0]
                            , q = z[1] + l[1]
                            , p = z[2] + l[2]
                            , d = C._center
                            , w = C._eye;
                          d[0] += c,
                          d[1] += q,
                          d[2] += p,
                          w[0] += c,
                          w[1] += q,
                          w[2] += p,
                          C.fp(Cm, E, w),
                          C.fp(ef, E, d)
                      }
                  }
              }
          },
          rotate: function(G, v, H) {
              var r = this
                , n = r.gv;
              if (n.isRotatable()) {
                  var $ = n._center
                    , Z = n._eye
                    , g = Bb(Z, $)
                    , T = a(O(g[0] * g[0] + g[2] * g[2]), g[1])
                    , C = jr(n, T + H);
                  H = C - T,
                  n.fi({
                      kind: n._rotating ? "betweenRotate" : "beginRotate",
                      event: G
                  }),
                  n._rotating = 1,
                  n.rotate(v, H)
              }
          }
      }),
      G.defineProperties(Gf.prototype, {
          panButton: {
              get: function() {
                  return this._panButton
              },
              set: function(l) {
                  this._panButton = l
              }
          },
          minPhi: {
              get: function() {
                  return this.gv.getRotateMinPhi()
              },
              set: function(Z) {
                  this.gv.setRotateMinPhi(Z)
              }
          },
          maxPhi: {
              get: function() {
                  return this.gv.getRotateMaxPhi()
              },
              set: function(m) {
                  this.gv.setRotateMaxPhi(m)
              }
          },
          keepHorizon: {
              get: function() {
                  return this._keepHorizon
              },
              set: function(B) {
                  this._keepHorizon = B
              }
          },
          threshold: {
              get: function() {
                  return this._threshold
              },
              set: function(A) {
                  this._threshold = A
              }
          },
          touchScaleThreshold: {
              get: function() {
                  return this._touchScaleThreshold
              },
              set: function(b) {
                  this._touchScaleThreshold = b
              }
          },
          touchRotateThreshold: {
              get: function() {
                  return this._touchRotateThreshold
              },
              set: function(c) {
                  this._touchRotateThreshold = c
              }
          }
      });
      var xr, Gh = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==", Cj = 32, Oe = rn.GlobeInteractor = function(n, F) {
          Jg(Oe, this, [n]);
          var m, R = F.radius || 6378137, S = this, v = null;
          xr || (xr = cf(),
          xr.style.border = "",
          xr.style.backgroundImage = "url(" + Gh + ")");
          var L = new Qp
            , J = new Rh
            , i = new Rh
            , p = new Rh
            , j = new nr
            , O = "number" == typeof R ? {
              x: R,
              y: R,
              z: R
          } : R
            , $ = {
              center: new Rh(0,0,0),
              radius: O
          }
            , X = function(N) {
              n._81O = null;
              var I = n.getHitPosition(N, n.getCenter(), J.copy(n.getEye()).sub(i.copy(n.getCenter())).toArray());
              return j.origin.copy(n.getEye()),
              j.direction.copy(I).sub(j.origin).normalize(),
              j.intersectEllipsoid($)
          }
            , V = function(q, Q) {
              n._81O = null,
              j.origin.copy(n.getEye());
              for (var b, H, P = n.getCenter(), v = J.copy(n.getEye()).sub(i.copy(n.getCenter())).toArray(), R = 1, d = 16, p = 0, y = 1, u = {
                  x: 0,
                  y: 0
              }; d--; ) {
                  if (u.x = Q.x + (q.x - Q.x) * R,
                  u.y = Q.y + (q.y - Q.y) * R,
                  b = n.getHitPosition(u, P, v),
                  j.direction.copy(b).sub(j.origin).normalize(),
                  H = j.intersectEllipsoid($),
                  H && 1 === R)
                      return {
                          hit: H
                      };
                  H ? p = R : y = R,
                  R = (p + y) / 2
              }
              return {
                  hit: H,
                  out: 1 > R
              }
          }
            , W = function(T, X) {
              if (v) {
                  var g = Date.now();
                  v.deltaTime = v.lastTime ? g - v.lastTime : 1e3,
                  v.lastTime = g,
                  v.lastAxis = T,
                  v.lastAngle = X
              }
              X && (L.setFromAxisAngle(T, X),
              n.setEye(J.copy(n.getEye()).applyQuaternion(L).toArray()),
              n.setCenter(J.copy(n.getCenter()).applyQuaternion(L).toArray()),
              n.setUp(J.copy(n.getUp()).applyQuaternion(L).toArray()))
          };
          S._showCrossIcon = function(L) {
              Qc(S.getView(), xr),
              ib(xr, {
                  x: L.clientX - Cj / 2,
                  y: L.clientY - Cj / 2,
                  width: Cj,
                  height: Cj
              })
          }
          ,
          S._hideCrossIcon = function() {
              is(xr)
          }
          ,
          S._scrollImpl = function(O, M) {
              v = {
                  point: n.lp(O),
                  screen: Gp(O),
                  hit: X(O),
                  type: "right"
              },
              v.hitNormalize = v.hit ? v.hit.clone().normalize() : new Rh;
              var U = {
                  clientX: v.screen.x,
                  clientY: v.screen.y + 10 * M
              };
              S._handleMoveImpl(U),
              S._endMoveImpl(U)
          }
          ,
          S._startMoveImpl = function(i) {
              m && (m.stop(!0),
              m = null),
              v = {
                  point: n.lp(i),
                  screen: Gp(i),
                  hit: X(i)
              },
              v.hitNormalize = v.hit ? v.hit.clone().normalize() : new Rh,
              sg(i) ? 1 === i.touches.length ? v.hit && (v.type = "left") : 2 === i.touches.length && (v.type = "touch2") : (ni(i) ? v.hit && (v.type = "left") : Rm(i) ? v.type = "right" : no(i) && v.hit && (v.type = "middle"),
              !v.hit || "right" !== v.type && "middle" !== v.type || S._showCrossIcon(i)),
              v.type && dq(S, i)
          }
          ,
          S._handleMoveImpl = function(x) {
              if (v)
                  switch (v.type) {
                  case "left":
                      return S._handleLeft(x);
                  case "right":
                      return S._handleRight(x);
                  case "middle":
                      return S._handleMiddle(x);
                  case "touch2":
                      return S._handleTouch2(x)
                  }
          }
          ,
          S._endMoveImpl = function() {
              if (v) {
                  if (this._hideCrossIcon(),
                  "left" === v.type || "middle" === v.type) {
                      var U = 1e3 * (v.lastAngle / (v.deltaTime || 30))
                        , z = v.lastAxis
                        , F = v.lastTime
                        , n = function() {
                          var A = Date.now()
                            , y = (A - F) / 1e3;
                          return F = A,
                          U *= Math.pow(Math.abs(S.decelerationRate), 3 * y),
                          Math.abs(U) < .01 ? (U = 0,
                          m && m.stop(),
                          void 0) : (W(z, U * y),
                          void 0)
                      };
                      m = Bl({
                          action: function() {
                              n(arguments)
                          },
                          duration: 5e3
                      })
                  }
                  v = null
              }
          }
          ,
          S._handleLeft = function(p) {
              if (!v.finished) {
                  var N = Gp(p)
                    , U = V(N, v.lastScreen || v.screen);
                  if (v.lastScreen = N,
                  !U.hit)
                      return v.finished = !0,
                      S._endMoveImpl(p),
                      void 0;
                  var Q = U.hit;
                  Q.normalize();
                  var Y = v.hitNormalize
                    , j = Math.acos(Q.dot(Y))
                    , P = Q.cross(Y).normalize();
                  W(P, j),
                  U.out && (v.finished = !0,
                  S._endMoveImpl(p))
              }
          }
          ,
          S._handleRight = function(U) {
              var k = v.lastScreen || v.screen
                , Z = k.y;
              k = v.lastScreen = Gp(U);
              var R = k.y
                , u = R - Z;
              if (u) {
                  var j = Math.min(.5, u * S.scaleSpeed);
                  J.copy(n.getEye());
                  var s = v.hit;
                  s || (s = J.clone().divide(O).normalize().multiply(O)),
                  i.copy(J).lerp(s, j),
                  n.setEye(i.toArray()),
                  J.copy(n.getUp()),
                  i.normalize();
                  var m = J.clone().cross(i).normalize();
                  if (p.copy(n.getCenter()),
                  p.sub(m.multiplyScalar(p.dot(m))),
                  n.setCenter(p.toArray()),
                  v.hit) {
                      var B = X(v.screen)
                        , g = v.hitNormalize;
                      if (B) {
                          B.normalize();
                          var f = Math.acos(B.dot(g))
                            , y = B.cross(g).normalize();
                          f && W(y, f)
                      }
                  }
              }
          }
          ;
          var s = function(N) {
              return Math.abs(N) < .01 ? 0 : N > 0 ? 1 : -1
          };
          S._handleTouch2 = function(q) {
              var J = q.touches.length;
              if (2 === J) {
                  var Y = q.touches
                    , D = {
                      x: Y[0].clientX,
                      y: Y[0].clientY
                  }
                    , y = {
                      x: Y[1].clientX,
                      y: Y[1].clientY
                  }
                    , k = {
                      x: y.x - D.x,
                      y: y.y - D.y
                  }
                    , H = v.lastCenter
                    , o = Math.atan2(k.y, k.x)
                    , c = v.theta
                    , f = 0;
                  c == E ? c = v.theta = o : (f = o - c,
                  v.thetaStarted || Math.abs(f) > .03 ? (v.thetaStarted = !0,
                  v.theta = o) : f = 0);
                  var L, P = Math.sqrt(k.x * k.x + k.y * k.y), G = v.vlen;
                  if (G) {
                      var M = D.x - H.x
                        , X = D.y - H.y
                        , B = y.x - H.x
                        , _ = y.y - H.y
                        , I = Math.sqrt(M * M + X * X)
                        , w = Math.sqrt(B * B + _ * _)
                        , d = G / 2
                        , a = s(I - d)
                        , p = s(w - d);
                      0 > a * p || 0 === a && 0 === p ? (L = 1,
                      v.vlen = P) : (L || (L = P / G),
                      v.scaleStarted || Math.abs(L - 1) > .05 ? (v.vlen = P,
                      v.scaleStarted = !0) : L = 1)
                  } else
                      G = v.vlen = P,
                      L = 1;
                  var k = i.copy(n.getEye()).clone();
                  1 !== L && n.setEye(k.setLength((k.length() - R) / L + R).toArray()),
                  f && W(k.normalize(), f),
                  v.lastCenter = {
                      x: (y.x + D.x) / 2,
                      y: (y.y + D.y) / 2
                  }
              }
          }
          ,
          S._handleMiddle = function(r) {
              var G = Gp(r)
                , t = v.screen;
              v.screen = G;
              var q = (G.y - t.y) / 180 * Math.PI * S.rollSpeed;
              i.copy(n.getCenter()).sub(J.copy(n.getEye())).normalize(),
              J.copy(n.getUp()).cross(i).normalize(),
              i.copy(n.getEye()).sub(v.hit).applyAxisAngle(J, q).add(v.hit);
              var m = i.clone();
              i.copy(n.getCenter()).sub(v.hit).applyAxisAngle(J, q).add(v.hit);
              var Z = i.clone()
                , P = i.copy(n.getUp()).applyAxisAngle(J, q).clone()
                , F = !1;
              q > 0 && (p.copy(P),
              i.copy(Z).sub(m).normalize(),
              J.copy(m).multiplyScalar(-1).normalize(),
              J.dot(p) - i.dot(p) > 0 && (F = !0)),
              F || p.copy(v.hit).sub(m).dot(v.hitNormalize) >= 0 && (F = !0),
              F || (n.setEye(m.toArray()),
              n.setCenter(Z.toArray()),
              n.setUp(P.toArray()));
              var R = -(G.x - t.x) / 180 * Math.PI * S.rotateSpeed;
              W(v.hitNormalize, R)
          }
      }
      ;
      ii("GlobeInteractor", fm, {
          handle_contextmenu: function(Y) {
              ad(Y)
          },
          handle_mousewheel: function(D) {
              this._scrollImpl(D, D.wheelDelta / 40)
          },
          handle_DOMMouseScroll: function(X) {
              2 === X.axis && this._scrollImpl(X, -X.detail)
          },
          handle_keydown: function(W) {
              this.gv.handleKeyDown(W)
          },
          handle_mousedown: function(p) {
              this.handle_touchstart(p)
          },
          handle_touchstart: function(t) {
              ad(t);
              var e = this.gv;
              if (e.setFocus(t)) {
                  var G = e.getDataInfoAt(t)
                    , d = G ? G.data : E;
                  d && e.isInteractive(d) || this._startMoveImpl(t);
                  var C = G ? G.part : E;
                  Xk(t) ? e.handleDoubleClick(t, d, C) : e.handleClick(t, d, C)
              }
          },
          handle_mouseup: function(E) {
              this.handle_touchend(E)
          },
          handle_touchend: function() {},
          handleWindowMouseMove: function(Y) {
              this.handleWindowTouchMove(Y)
          },
          handleWindowTouchMove: function(f) {
              this._handleMoveImpl(f)
          },
          handleWindowMouseUp: function(h) {
              this.handleWindowTouchEnd(h)
          },
          handleWindowTouchEnd: function(I) {
              this._endMoveImpl(I)
          }
      }),
      G.defineProperties(Oe.prototype, {
          rotateSpeed: {
              get: function() {
                  return this._rotateSpeed || .3
              },
              set: function(C) {
                  this._rotateSpeed = C
              }
          },
          rollSpeed: {
              get: function() {
                  return this._rollSpeed || .1
              },
              set: function(v) {
                  this._rollSpeed = v
              }
          },
          scaleSpeed: {
              get: function() {
                  return this._scaleSpeed || .002
              },
              set: function(K) {
                  this._scaleSpeed = K
              }
          },
          decelerationRate: {
              get: function() {
                  return this._decelerationRate || .04
              },
              set: function(Z) {
                  this._decelerationRate = Z
              }
          }
      });
      var Xp = function(Q) {
          var i = 2147483648 | Q;
          return [(255 & i >> 16) / 255, (255 & i >> 8) / 255, (255 & i) / 255, (255 & i >> 24) / 255]
      }
        , sl = function(C) {
          this.gv = C,
          this.gv.pickColorMap = {
              _pickIdUsed: 1e3
          }
      };
      Ik(sl, G, {
          _iv: !0,
          iv: function() {
              this._iv = !0
          },
          get: function(w, M) {
              this.validate();
              var Z = this
                , Q = Z.gv.getGL();
              if (!Q)
                  return E;
              var c, R, x = Z._resolution, k = Math.round(w.x * x), Y = Math.ceil(w.width * x), T = Math.ceil(w.height * x), s = Z.height - Math.round(w.y * x) - T, p = q(Y / 2), U = new Uint8Array(4 * Y * T), H = 0, l = U.length, y = M ? E : new Mh, i = M ? E : {};
              if (fq(Q, Z.frame),
              Q.readPixels(k, s, Y, T, Q.RGBA, Q.UNSIGNED_BYTE, U),
              Zp(Q),
              M) {
                  for (; p >= H; H++)
                      for (var W = p - H, e = p + H, B = W; e >= B; B++)
                          for (var $ = W; e >= $; $++)
                              if ((B === W || B === e || $ === W || $ === e) && (c = Z.info(U, 4 * (B * Y + $))))
                                  return c
              } else
                  for (; l > H; H += 4)
                      c = Z.info(U, H),
                      c && (R = c.data,
                      i[R._id] || (y.add(R),
                      i[R._id] = R));
              return y
          },
          info: function(D, x) {
              return this.gv.pickColorMap[(D[x] << 16) + (D[x + 1] << 8) + D[x + 2] + ((127 & D[x + 3]) << 24)]
          },
          getResolution: function() {
              return this._resolution
          },
          onContextLost: function() {
              this.texture = null,
              this.width = this.height = -1
          },
          validate: function() {
              var e = this
                , T = e.gv
                , g = T.getGL();
              if (g) {
                  var H = e._resolution = T._pickerResolution * T.getDevicePixelRatio()
                    , n = Math.round(H * T.getWidth())
                    , p = Math.round(H * T.getHeight())
                    , J = g.RGBA
                    , F = g.TEXTURE_2D
                    , S = g.RENDERBUFFER
                    , B = g.FRAMEBUFFER;
                  if (e.texture || (e.texture = Yh(g),
                  e.render = g.createRenderbuffer(),
                  e.frame = g.createFramebuffer()),
                  (e.width !== n || e.height !== p) && (g.activeTexture(g.TEXTURE0),
                  cr(g, e.texture),
                  g.texImage2D(F, 0, J, n, p, 0, J, g.UNSIGNED_BYTE, E),
                  ai(g, g.TEXTURE_MIN_FILTER, g.LINEAR),
                  g.bindRenderbuffer(S, e.render),
                  g.renderbufferStorage(S, g.DEPTH_COMPONENT16, n, p),
                  fq(g, e.frame),
                  g.framebufferTexture2D(B, g.COLOR_ATTACHMENT0, F, e.texture, 0),
                  g.framebufferRenderbuffer(B, g.DEPTH_ATTACHMENT, S, e.render),
                  cr(g, E),
                  g.bindRenderbuffer(S, E),
                  Zp(g),
                  e.width = n,
                  e.height = p),
                  e._iv) {
                      e._iv = !1;
                      var r = !1;
                      T._40Q.each(function(t) {
                          !r && t.isBatchInvalid() && (r = !0)
                      }),
                      r && T.updateScene(),
                      fq(g, e.frame),
                      g.clear(g.COLOR_BUFFER_BIT),
                      T.overlappingBox.clear(),
                      T.setViewport(g, 0, 0, n, p),
                      T.renderPickScene(),
                      Zp(g)
                  }
              }
          }
      });
      var Pc = function(S) {
          this.gv = S
      };
      Ik(Pc, G, {
          gap: 0,
          size: 0,
          _42: function(u, w) {
              var F = this
                , S = F.gv
                , V = S._gridGap
                , j = S._gridSize;
              if (S._gridVisible) {
                  if (F.gap !== V || F.size !== j) {
                      for (var Q = [], G = S._gridSize / 2, I = V * G, y = 0; 2 * G + 1 > y; y++) {
                          var c = 6 * y
                            , K = 6 * (2 * G + 1) + c;
                          Q[c] = -I,
                          Q[c + 1] = 0,
                          Q[c + 2] = -I + y * V,
                          Q[c + 3] = I,
                          Q[c + 4] = 0,
                          Q[c + 5] = -I + y * V,
                          Q[K] = -I + y * V,
                          Q[K + 1] = 0,
                          Q[K + 2] = -I,
                          Q[K + 3] = -I + y * V,
                          Q[K + 4] = 0,
                          Q[K + 5] = I
                      }
                      F.vs = new ld(Q),
                      F.gap = V,
                      F.size = j
                  }
                  Fb(S),
                  aj(u, w),
                  nb(u),
                  pl(u, w, 1, S._gridColor, S._buffer.vs, F.vs),
                  rp(u, 0, F.vs.length / 3, u.LINES),
                  am(u),
                  Dk(u, w)
              } else
                  F.vs = F.gap = F.size = E
          }
      });
      var Cs = function(D) {
          this.gv = D
      };
      Ik(Cs, G, {
          _42: function(b, h) {
              var i = this.gv
                , g = i._buffer.vs
                , p = i._axisXColor
                , R = i._axisYColor
                , T = i._axisZColor
                , N = i._originAxisVisible
                , C = i._centerAxisVisible;
              if (N || C) {
                  var k = Di ? b.TRIANGLES : b.TRIANGLE_FAN
                    , e = b.LINES;
                  if (Fb(i),
                  aj(b, h),
                  nb(b),
                  N) {
                      var y = i.getCenterInfo()
                        , r = K(y.width, y.height) / 5
                        , G = .8 * r
                        , F = .05 * r;
                      pl(b, h, 1.5, p, g, new ld([0, 0, 0, r, 0, 0, G, F, 0, G, 0, F, G, -F, 0, G, 0, -F, G, F, 0, 0, 0, 0, 0, r, 0, F, G, 0, 0, G, F, -F, G, 0, 0, G, -F, F, G, 0, 0, 0, 0, 0, 0, r, F, 0, G, 0, F, G, -F, 0, G, 0, -F, G, F, 0, G])),
                      rp(b, 0, 2, e),
                      rp(b, 1, 6, k),
                      pl(b, h, E, R),
                      rp(b, 7, 2, e),
                      rp(b, 8, 6, k),
                      pl(b, h, E, T),
                      rp(b, 14, 2, e),
                      rp(b, 15, 6, k)
                  }
                  if (C) {
                      var _ = i._center
                        , M = _[0]
                        , Q = _[1]
                        , o = _[2]
                        , y = i.getPositionInfo(_);
                      r = K(y.width, y.height) / 20,
                      pl(b, h, 1.5, p, g, new ld([M, Q, o, M + r, Q, o, M, Q, o, M, Q + r, o, M, Q, o, M, Q, o + r])),
                      rp(b, 0, 2, e),
                      pl(b, h, E, R),
                      rp(b, 2, 2, e),
                      pl(b, h, E, T),
                      rp(b, 4, 2, e)
                  }
                  am(b),
                  Dk(b, h)
              }
          }
      });
      var kl = function(l) {
          this.gv = l,
          this.onMouseOver = this.onMouseOver.bind(this),
          this.mode = kl.Mode.Style,
          this.color = V,
          this.width = V
      };
      kl.Mode = {
          Disable: 0,
          Selection: 1,
          MouseOver: 2,
          Style: 3
      },
      Ik(kl, G, {
          onMouseOver: function(o) {
              M.preventDefault(o);
              var y = this.gv.getDataAt(o);
              y !== this.mouseOverData && (this.mouseOverData = y,
              this.gv.iv())
          },
          setFetchTargetFunc: function(C) {
              this.fetchTargetFunc = C
          },
          _42: function(G, s) {
              var M, r, i = this, Z = i._mode, t = i.gv;
              if (!G._renderInfo.reflectDepth && Z !== kl.Mode.Disable) {
                  if (Z === kl.Mode.Selection ? M = t.sm().getSelection().toArray(function(v) {
                      return v.s("highlight.visible")
                  }) : Z === kl.Mode.MouseOver && i.mouseOverData && i.mouseOverData.s("highlight.visible") && (M = [i.mouseOverData]),
                  i.fetchTargetFunc && (M = i.fetchTargetFunc(M)),
                  Z === kl.Mode.Style)
                      M = M || [],
                      r = function(k) {
                          if (M.indexOf(k) >= 0)
                              return !1;
                          var m = t.getDataHighlightMode(k);
                          return m === !1 ? !0 : m === !0 ? !1 : "selected" === m ? t.isSelected(k) ? !1 : !0 : "hover" === m ? k === i.mouseOverData ? !1 : !0 : !0
                      }
                      ;
                  else {
                      if (!M || !M.length)
                          return;
                      r = function(d) {
                          return M.indexOf(d) < 0 ? !0 : void 0
                      }
                  }
                  var t = i.gv
                    , R = t.vr.isPresenting()
                    , a = t.getWidth();
                  if (R) {
                      var D = t.getWidth;
                      a /= 2,
                      t.getWidth = function() {
                          return a
                      }
                      ;
                      var U = t.getViewport()
                  }
                  var H, e = t.getDevicePixelRatio(), x = a * e, C = t.getHeight() * e;
                  (H = i._renderTarget) ? H.setSize(G, x, C) : i._renderTarget = H = new rn.RenderTarget(t,G,x,C),
                  fq(G, H.frame),
                  G.clear(G.COLOR_BUFFER_BIT),
                  t.setViewport(G, 0, 0, x, C);
                  var P = [];
                  M.forEach(function(n) {
                      var K = n.getRenderLayer();
                      P.indexOf(K) < 0 && P.push(K)
                  }),
                  t.drawFilter = r,
                  t.renderPickScene(),
                  t.drawFilter = null,
                  Zp(G),
                  Di && Cb(G, s.aPosition),
                  Cb(G, s.aNormal),
                  R && (t.getWidth = D,
                  t.setViewport(G, U[0], U[1], U[2], U[3]));
                  var q = G._compiledShader.highlight;
                  q || (q = G._compiledShader.highlight = new _p.Shader(G,lk.vs,lk.fs)),
                  q.bind();
                  var B = Vj.for(G)
                    , O = B.directState();
                  O.blend.enabled = !0,
                  G.activeTexture(G.TEXTURE0 + 0),
                  cr(G, H.texture),
                  q.uniforms.image = 0,
                  q.uniforms.textureSize = [x, C],
                  q.uniforms.edgeWidth = t.getHighlightWidth();
                  var j = t.getHighlightColor();
                  if (i._lastHighlightColor !== j) {
                      var p = Il(i._lastHighlightColor = j);
                      i._highlightColorData = [p[0] / 255, p[1] / 255, p[2] / 255, p[3] / 255]
                  }
                  q.uniforms.edgeColor = i._highlightColorData,
                  i.ibuffer ? (i.ibuffer.upload(),
                  i.vbuffer.upload()) : (i.ibuffer = _p.Buffer.createIndexBuffer(G, new Uint16Array([0, 2, 1, 1, 2, 3])),
                  i.vbuffer = _p.Buffer.createVertexBuffer(G, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))),
                  q.attributes.pos.pointer(i.vbuffer),
                  G.drawElements(G.TRIANGLES, 6, G.UNSIGNED_SHORT, 0),
                  O.blend.enabled = !1,
                  cr(G, null),
                  G.useProgram(s),
                  Di && Ed(G, s.aPosition)
              }
          }
      }),
      G.defineProperties(kl.prototype, {
          mode: {
              get: function() {
                  return this._mode
              },
              set: function(e) {
                  var a = this._mode;
                  e !== a && (this._mode = e,
                  e === kl.Mode.MouseOver || e === kl.Mode.Style ? b(this.gv.getView(), "mousemove", this.onMouseOver) : (a === kl.Mode.MouseOver || a === kl.Mode.Style) && D(this.gv.getView(), "mousemove", this.onMouseOver))
              }
          }
      });
      var lk = {
          vs: ["attribute vec2 pos;", "varying vec2 vUv;", "void main(void) {", "gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);", "vUv = vec2(pos.x, 1.0 - pos.y);", "}"].join("\n"),
          fs: ["precision highp float;", "uniform sampler2D image;", "uniform vec2 textureSize;", "uniform float edgeWidth;", "uniform vec4 edgeColor;", "varying vec2 vUv;", "float getCol(vec2 coord) {", "return texture2D(image, coord).a;", "}", "void main() {", "vec2 cc = vUv;", "float center = getCol(cc);", "float dx = edgeWidth / textureSize.x;", "float dy = edgeWidth / textureSize.y;", "vec2 coord;", "float topLeft = getCol(cc+vec2(-dx, -dy));", "float top = getCol(cc+vec2(0.0, -dy));", "float topRight = getCol(cc+vec2(dx, -dy));", "float left = getCol(cc+vec2(-dx, 0.0));", "float right = getCol(cc+vec2(dx, 0.0));", "float bottomLeft = getCol(cc+vec2(-dx, dy));", "float bottom = getCol(cc+vec2(0.0, dy));", "float bottomRight = getCol(cc+vec2(dx, dy));", "float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;", "float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;", "float edge = sqrt(h * h + v * v);", "edge = smoothstep(0.9, 1.0, edge);", "if (edge < 0.5) {", "discard;", "}", "gl_FragColor = edgeColor;", "}"].join("\n")
      }
        , qc = function(I) {
          this.gv = I
      }
        , xd = "edit_tx"
        , An = "edit_ty"
        , ip = "edit_tz"
        , ir = "edit_rx"
        , Wn = "edit_ry"
        , Ve = "edit_rz"
        , of = "edit_sx"
        , ko = "edit_sy"
        , Gl = "edit_sz"
        , Er = {};
      Er[xd] = 101,
      Er[An] = 102,
      Er[ip] = 103,
      Er[ir] = 104,
      Er[Wn] = 105,
      Er[Ve] = 106,
      Er[of] = 107,
      Er[ko] = 108,
      Er[Gl] = 109,
      Ik(qc, G, {
          _42: function(l, F, $) {
              var D = this
                , s = D.gv
                , J = s.sm().ld();
              if (J && s.isEditable(J) && !s.isEditHelperDisabled() && ud(J) && (!s.isFirstPersonMode() || !s.isMouseRoamable() && !Ul)) {
                  Fb(s);
                  var M, b, B = s.isMovable(J), r = s.isRotationEditable(J), e = s.isSizeEditable(J), u = s._axisXColor, x = s._axisYColor, d = s._axisZColor, p = s._editSizeColor, U = J.p3(), t = Qf(s.getEye(), U) / 10, C = t / ($ ? 5 : 10), V = .7 * t, G = .4 * V, P = U[0], y = U[1], j = U[2];
                  M = [0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0],
                  B && D._17O(l, F, J, $, xd, u, M, [P, y - C, j, P + V, y - C, j, P + V, y, j, P + V, y, j, P, y, j, P, y - C, j, P, y - C, j + C, P + V, y - C, j + C, P + V, y - C, j, P + V, y - C, j, P, y - C, j, P, y - C, j + C]),
                  b = P + V,
                  e && D._17O(l, F, J, $, of, p, M, [b, y - C, j, b + G, y - C, j, b + G, y, j, b + G, y, j, b, y, j, b, y - C, j, b, y - C, j + C, b + G, y - C, j + C, b + G, y - C, j, b + G, y - C, j, b, y - C, j, b, y - C, j + C]),
                  b += G,
                  r && D._17O(l, F, J, $, ir, u, M, [b, y - C, j, b + G, y - C, j, b + G, y, j, b + G, y, j, b, y, j, b, y - C, j, b, y - C, j + C, b + G, y - C, j + C, b + G, y - C, j, b + G, y - C, j, b, y - C, j, b, y - C, j + C]),
                  M = [0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0],
                  B && D._17O(l, F, J, $, An, x, M, [P, y, j, P, y + V, j, P - C, y + V, j, P - C, y + V, j, P - C, y, j, P, y, j, P, y, j, P, y, j - C, P, y + V, j - C, P, y + V, j - C, P, y + V, j, P, y, j]),
                  b = y + V,
                  e && D._17O(l, F, J, $, ko, p, M, [P, b, j, P, b + G, j, P - C, b + G, j, P - C, b + G, j, P - C, b, j, P, b, j, P, b, j, P, b, j - C, P, b + G, j - C, P, b + G, j - C, P, b + G, j, P, b, j]),
                  b += G,
                  r && D._17O(l, F, J, $, Wn, x, M, [P, b, j, P, b + G, j, P - C, b + G, j, P - C, b + G, j, P - C, b, j, P, b, j, P, b, j, P, b, j - C, P, b + G, j - C, P, b + G, j - C, P, b + G, j, P, b, j]),
                  M = [1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0],
                  B && D._17O(l, F, J, $, ip, d, M, [P, y, j, P, y, j + V, P, y - C, j + V, P, y - C, j + V, P, y - C, j, P, y, j, P, y - C, j, P - C, y - C, j, P - C, y - C, j + V, P - C, y - C, j + V, P, y - C, j + V, P, y - C, j]),
                  b = j + V,
                  e && D._17O(l, F, J, $, Gl, p, M, [P, y, b, P, y, b + G, P, y - C, b + G, P, y - C, b + G, P, y - C, b, P, y, b, P, y - C, b, P - C, y - C, b, P - C, y - C, b + G, P - C, y - C, b + G, P, y - C, b + G, P, y - C, b]),
                  b += G,
                  r && D._17O(l, F, J, $, Ve, d, M, [P, y, b, P, y, b + G, P, y - C, b + G, P, y - C, b + G, P, y - C, b, P, y, b, P, y - C, b, P - C, y - C, b, P - C, y - C, b + G, P - C, y - C, b + G, P, y - C, b + G, P, y - C, b])
              }
          },
          _17O: function(N, Q, A, a, x, n, d, o) {
              var D = this.gv
                , v = D._buffer
                , i = Vj.for(N)
                , F = i.directUniforms()
                , K = i.directAttribs();
              if (D._picking) {
                  a = D.pickColorMap;
                  var S = Er[x];
                  a[S] = {
                      data: A,
                      part: x
                  },
                  F.uFixPickReverseColor = Xp(S)
              }
              Xb(N, Q, E, !0, E, !0, E, !1),
              F.uDiffuse = n,
              K.aPosition = vo(N, v.vs, new ld(o), E),
              K.aNormal = vo(N, v.ns, new ld(d), E),
              nb(N),
              rp(N, 0, 12),
              am(N),
              he(N, Q)
          }
      });
      var Gk = n.Raycaster = function(k) {
          this.gv = k,
          this.maxTriangleTest = 1 / 0,
          this.backfaceCulling = !0
      }
      ;
      jq("Raycaster", G, {
          intersect: function(Y) {
              var n = this
                , k = n.gv
                , Z = k.getDataAt(Y);
              return Z ? n.intersectObject(Y, Z) : null
          },
          intersectObjects: function(I, z, N) {
              var H, x, l, D, K = this, h = 1 / 0, q = I.origin || (new Rh).fromArray(K.gv.getEye()), u = K.maxTriangleTest, v = [];
              return z.forEach(function(S) {
                  N && N(S) === !1 || S.s("intersect") !== !1 && v.push(S)
              }),
              v.sort(function(i, x) {
                  return q.distanceToSquared2(i.p3()) - q.distanceToSquared2(x.p3())
              }),
              K.countTriangles = 0,
              v.forEach(function(E) {
                  K.countTriangles > u || (H = K.intersectObject(I, E),
                  H && (x = q.distanceToSquared(H.world),
                  h > x && (l = E,
                  D = H,
                  h = x)))
              }),
              K.countTriangles = 0,
              {
                  data: l,
                  intersect: D
              }
          },
          intersectObject: function(h, Q) {
              if (h instanceof nr)
                  return this._intersectObjectImpl(h, Q);
              var s = this
                , A = s.gv
                , t = A.unproject(h)
                , Z = new Rh
                , w = A.getEye()
                , k = new Rh;
              if (A.isOrtho()) {
                  var D = new Rh(w);
                  k.copy(A.getCenter()).sub(D).normalize();
                  var $ = Z.copy(t).sub(D).dot(k);
                  Z.copy(k).setLength(-$).add(D.copy(t))
              } else
                  Z.copy(w),
                  k.copy(t).sub(Z).normalize();
              var W = new n.Math.Ray(Z,k);
              return s._intersectObjectImpl(W, Q)
          },
          _intersectObjectImpl: function() {
              function J() {
                  var v = new Rh;
                  return v.subVectors(l, m),
                  _.subVectors(A, m),
                  v.cross(_).normalize(),
                  v
              }
              function d(M, s, Y, J, o, V, O) {
                  return Mi.barycoordFromPoint(M, s, Y, J, C),
                  o.multiplyScalar(C.x),
                  V.multiplyScalar(C.y),
                  O.multiplyScalar(C.z),
                  o.add(V).add(O),
                  o.clone()
              }
              var N = new Sc
                , E = new Sc
                , D = new nr
                , q = new Rh
                , Y = new Rh
                , r = new Rh
                , f = new Rh
                , S = new Rh
                , A = new Rh
                , m = new Rh
                , l = new Rh
                , V = new le
                , x = new le
                , e = new le
                , _ = new Rh
                , F = {
                  vs: qj,
                  is: Vh,
                  uv: $j
              }
                , C = new Rh
                , X = Jo.slice(0);
              return X.push("csg"),
              function(H, Q) {
                  var u = this.gv.getData3dUI(Q)
                    , B = Q.mat || u.mat;
                  B ? N.fromArray(B) : N.identity(),
                  E.getInverse(N),
                  D.copy(H).applyMatrix4(E);
                  var W, c, T, i = "body", k = u.shapeModel;
                  if (k || (k = hc(u)),
                  k || (n.CSGNode && Q instanceof n.CSGNode || n.CSGShape && Q instanceof n.CSGShape ? (T = !0,
                  k = [u.left, u.front, u.right, u.back, u.top, u.bottom, u.csg]) : Q instanceof n.Node && !(Q instanceof n.Shape) ? (W = !0,
                  k = F) : (c = !0,
                  k = [u.left, u.front, u.right, u.back, u.top, u.bottom])),
                  !k)
                      return console.log("Can not find shape model."),
                      null;
                  $c(k) || (k = [k]);
                  var O, g, w, v, s, t, K, p, Z, M, R, _, I, y, h, U, P = 1 / 0, o = ["", "top_", "bottom_"], b = !1, j = this.backfaceCulling, C = [];
                  for (pr(k, u, C),
                  O = 0,
                  g = C.length; g > O; O++)
                      if (I = C[O])
                          for (w = 0,
                          v = o.length; v > w; w++)
                              if (y = o[w],
                              K = I[y + "vs"],
                              p = I[y + "is"],
                              Z = I[y + "uv"] || I[y + "tuv"],
                              K) {
                                  if (h = I[y + "boundingBox"]) {
                                      var R = D.intersectBox(h);
                                      if (!R)
                                          continue;
                                      if (D.origin.distanceTo(R) > P)
                                          continue;
                                      U = !1
                                  } else
                                      I[y + "boundingBox"] = h = new n.Math.Box3,
                                      U = !0;
                                  for (s = 0,
                                  t = p ? p.length : K.length / 3; t > s; s += 3)
                                      this.countTriangles++,
                                      p ? (Y.fromArray(K, 3 * p[s]),
                                      r.fromArray(K, 3 * p[s + 1]),
                                      f.fromArray(K, 3 * p[s + 2])) : (Y.fromArray(K, 3 * s),
                                      r.fromArray(K, 3 * (s + 1)),
                                      f.fromArray(K, 3 * (s + 2))),
                                      U && (h.expandByPoint(Y),
                                      h.expandByPoint(r),
                                      h.expandByPoint(f)),
                                      M = D.intersectTriangle(Y, r, f, j, q),
                                      M && (_ = D.origin.distanceTo(M),
                                      P > _ && (P = _,
                                      S.copy(M),
                                      A.copy(Y),
                                      m.copy(r),
                                      l.copy(f),
                                      "" !== y ? i = y.slice(0, -1) : W ? i = Jo[Math.floor(s / 6)] : c ? i = Jo[O] : T && (i = X[O]),
                                      Z && (b = !0,
                                      p ? (V.fromArray(Z, 2 * p[s]),
                                      x.fromArray(Z, 2 * p[s + 1]),
                                      e.fromArray(Z, 2 * p[s + 2])) : (V.fromArray(Z, 2 * s),
                                      x.fromArray(Z, 2 * (s + 1)),
                                      e.fromArray(Z, 2 * (s + 2))))))
                              }
                  if (!isFinite(P))
                      return null;
                  var z, a = S.clone().applyMatrix4(N);
                  b && (z = d(S, A, m, l, V, x, e));
                  var L = J(A, m, l)
                    , G = J(A.applyMatrix4(N), m.applyMatrix4(N), l.applyMatrix4(N))
                    , $ = D.direction.dot(L);
                  return $ > 0 && (L.multiplyScalar(-1),
                  G.multiplyScalar(-1)),
                  {
                      world: a,
                      local: S.clone(),
                      worldNormal: G,
                      normal: L,
                      uv: z,
                      part: i
                  }
              }
          }()
      });
      var wf = function(A, o) {
          this.gv = A,
          this.s = function(O, B, i) {
              return B == E && (B = i),
              B == E ? o.getStyle(O) : yn(B, o, A)
          }
          ,
          this.data = o
      };
      Ik(wf, G, {
          I3d: !0,
          ms_icons: 1,
          _iv: !0,
          _cacheBoundingBox: V,
          iv: function() {
              this._iv = !0
          },
          update: function(e, H, W) {
              var b = this
                , Z = b.data;
              if (e || (e = b.gv,
              H = e.getGL(),
              W = H._40Q),
              !b.needValidate(H) || !e.isVisible(Z))
                  return W.push(this, !1),
                  void 0;
              var p, P, s, c, N, I = Z._id, n = b.s("autorotate") || b.s("shape3d.autorotate") || b.s("fixSizeOnScreen") || b.s("shape3d.fixSizeOnScreen") ? null : b.s("batch"), h = Z.getRenderLayer(), C = W.get(h, !0), M = C.batchIndexMap, A = C.batchModelMap, k = e.getBrightness(Z), r = k != E && 1 !== k;
              p = Pn(M, A, Z, n, e);
              var O = b.validate(p, n ? e.getBatchInfo(n) || Li : E);
              if (p && (P = M[I],
              s = P.size = p.vs.length / 3 - P.begin,
              N = p.rs))
                  for (k = r ? k : 1,
                  c = 0; s > c; c++)
                      N.push(k);
              var U = e.getWireframeGeometry(Z);
              if (U)
                  ro(e, Z, U);
              else if (ud(Z)) {
                  var g = e.getWireframe(Z);
                  g && ro(e, Z, g)
              }
              b.labelInfo = b.label2Info = b.noteInfo = b.note2Info = b._38o = E,
              b._24O(_r, "getLabel"),
              b._24O(lc, "getLabel2"),
              b._26O(Up, "getNote"),
              b._26O(lj, "getNote2"),
              b._15O(),
              b.interactiveInfo = e.isInteractive(Z) ? {} : E,
              C.push(this, !0),
              O !== !1 && (b._iv = !1)
          },
          clearWireframeGeometryCache: function() {
              var V = this;
              kh(V),
              V.data.iv()
          },
          _46Q: function(Q) {
              var A = this
                , j = A.data
                , N = A.gv;
              if (N.isVisible(j)) {
                  var G = j._id
                    , E = N._40Q.get(j._renderLayer, !0)
                    , T = E.batchIndexMap[G]
                    , v = E.polylineIndexMap[G]
                    , l = E.wireframeIndexMap[G];
                  if (T || v || l) {
                      var z = Sb(Q, N.pickColorMap, N.isSelectable(j), j, Qi, !0);
                      z && (Rc(z, T, E.batchModelMap),
                      Rc(z, v, E.polylineModelMap),
                      Rc(z, l, E.wireframeModelMap))
                  }
              }
          },
          _42: function(O, $, x) {
              function a(y, G, p) {
                  var Z = G.getBrightness(p)
                    , W = p.s("alphaTest")
                    , T = p.s("envmap")
                    , g = Vj.for(y)
                    , D = g.directUniforms();
                  Z != E && 1 !== Z && (D.uBrightness = Z),
                  D.uAlphaTest = W,
                  D.uUseEnvMap = T ? !0 : !1,
                  D.uReflectivity = T || .01,
                  D.shadowReceive = !B && p.s("shadow.receive"),
                  D.shadowCull = !B && !!p.s("shadow.cull");
                  var F = I.s("3d.clip.direction");
                  if (F) {
                      var S = I.s("3d.clip.percentage");
                      switch (0 === S && (f = !1),
                      F) {
                      case "left":
                          F = 2;
                          break;
                      case "top":
                          F = 3;
                          break;
                      case "bottom":
                          F = 4;
                          break;
                      case "front":
                          F = 5;
                          break;
                      case "back":
                          F = 6;
                          break;
                      case "right":
                      default:
                          F = 1
                      }
                      if (0 === F % 2 && (S = 1 - S),
                      p instanceof n.Shape) {
                          var C = p.s3()
                            , X = p.p3()
                            , V = p.getAnchor3d();
                          S = 3 > F ? (S - V.x) * C[0] + X[0] : 5 > F ? (S - V.y) * C[1] + X[1] : (S - V.z) * C[2] + X[2]
                      } else
                          S -= .5;
                      D.uClipPercent = S
                  }
                  D.uClipDirection = F || 0,
                  y._blooming && !p.s("bloom") && (D.blackout = !0)
              }
              var I = this
                , e = I.data
                , p = I.gv;
              if (p.isVisible(e)) {
                  var l, B = p._picking;
                  if (B)
                      l = p.pickColorMap;
                  else {
                      if (p.isTransparentMask(e) || p.isReflecting(O) && e.s("3d.reflectable") === !1)
                          return;
                      l = V
                  }
                  if (wf.getTitle === V) {
                      wf.getTitle = 0;
                      for (var g in M)
                          if (g.length === lc.length + 1 && g[lc.length] === gh[4].toUpperCase() && g[lc.length - 1] === gh[lc.length + 1].toUpperCase()) {
                              wf.getTitle = sj;
                              break
                          }
                  }
                  if (!wf.getTitle || Dh[lc.length + 2]) {
                      if (wf.getHead === V) {
                          wf.getHead = 0;
                          for (var g in J) {
                              var Z = "box-sizing";
                              6 === g.length && g[0] === gh[4] && g[3] === Z[0] && g[4] === Z[1] && g[5] === Z[2] && (wf.getHead = sj)
                          }
                      }
                      if (!wf.getHead || Dh[lc.length]) {
                          var D, Y, o = e._id, u = p._40Q.get(e._renderLayer, !0), F = u.batchIndexMap, A = u.batchModelMap, v = p.isSelectable(e), K = !1, f = !0, y = F[o];
                          if (B && (Y = Sb(O, l, v, e, Qi, y),
                          Y && !p._45Q && (Rc(Y, y, A),
                          Rc(Y, u.polylineIndexMap[o], u.polylineModelMap),
                          Rc(Y, u.wireframeIndexMap[o], u.wireframeModelMap))),
                          y || (K || (K = !0,
                          a(O, p, e)),
                          f && I._80o(O, $, x)),
                          p.isLabelVisible(e) && ((D = I.labelInfo) && (B && Sb(O, l, v, e, _r),
                          K || (K = !0,
                          a(O, p, e)),
                          I._28O(D, _r, x)),
                          (D = I.label2Info) && (B && Sb(O, l, v, e, lc),
                          K || (K = !0,
                          a(O, p, e)),
                          I._28O(D, lc, x))),
                          p.isNoteVisible(e) && ((D = I.noteInfo) && (B && Sb(O, l, v, e, Up),
                          K || (K = !0,
                          a(O, p, e)),
                          I._29O(D, Up, x)),
                          (D = I.note2Info) && (B && Sb(O, l, v, e, lj),
                          K || (K = !0,
                          a(O, p, e)),
                          I._29O(D, lj, x))),
                          (D = I._38o) && (K || (K = !0,
                          a(O, p, e)),
                          I._99O(O, $, D, l, v, x)),
                          K) {
                              var h = Vj.for(O).directUniforms();
                              h.uBrightness = 1,
                              h.uClipDirection = 0,
                              O._blooming && (h.blackout = !1)
                          }
                      }
                  }
              }
          },
          prepare: function() {
              var C = this
                , Z = C.data;
              if (!(Z instanceof ch)) {
                  var t, b, B, k, r, L = C.gv, q = L.getGL(), N = Z._id, J = C.s("batch"), O = L._batchIndexMap, z = L._batchModelMap, s = L.getBrightness(Z), F = s != E && 1 !== s;
                  if (C.needValidate(q)) {
                      if (t = Pn(O, z, Z, J, L),
                      C.validate(t, J ? L.getBatchInfo(J) || Li : E),
                      t && (b = O[N],
                      B = b.size = t.vs.length / 3 - b.begin,
                      r = t.rs))
                          for (s = F ? s : 1,
                          k = 0; B > k; k++)
                              r.push(s);
                      if (ud(Z)) {
                          var A = L.getWireframeGeometry(Z);
                          if (A)
                              ro(L, Z, A);
                          else {
                              var p = L.getWireframe(Z);
                              p && ro(L, Z, p)
                          }
                      }
                      C.labelInfo = C.label2Info = C.noteInfo = C.note2Info = C._38o = E,
                      C._24O(_r, "getLabel"),
                      C._24O(lc, "getLabel2"),
                      C._26O(Up, "getNote"),
                      C._26O(lj, "getNote2"),
                      C._15O(),
                      C.interactiveInfo = L.isInteractive(Z) ? {} : E,
                      C._iv = !1
                  }
              }
          },
          dispatchBoundingBoxChanged: function() {
              this._cacheBoundingBox = V
          },
          getBoundingBox: function() {
              var X, y, H, O, x, q;
              return function() {
                  if (this._cacheBoundingBox)
                      return this._cacheBoundingBox;
                  X || (X = {
                      vs: qj,
                      is: Vh,
                      uv: $j
                  },
                  y = new Rh,
                  H = new Rh,
                  O = new Rh,
                  x = new Rh,
                  q = new Rh);
                  var o = this
                    , A = o.data
                    , I = o.shapeModel;
                  if (I || A instanceof n.Shape || (I = hc(o)),
                  !I && A instanceof n.Shape && (o.prepare(),
                  I = o.shapeModel),
                  I || (A instanceof n.Node && !(A instanceof n.Shape) ? I = X : (o.left || o.front || o.right || o.back || o.top || o.bottom) && (I = [o.left, o.front, o.right, o.back, o.top, o.bottom])),
                  !I)
                      return V;
                  $c(I) || (I = [I]);
                  var W, _, M, b, l, u, t, d, B, e, Y, Q, R = ["", "top_", "bottom_"], U = new n.Math.Box3, z = !1;
                  if (o._needRecoverPosition) {
                      x.set.apply(x, A.p3());
                      var s = A.s3();
                      q.set(1 / (s[0] || 1), 1 / (s[1] || 1), 1 / (s[2] || 1))
                  } else
                      x.set(0, 0, 0),
                      q.set(1, 1, 1);
                  for (W = 0,
                  _ = I.length; _ > W; W++)
                      if (B = I[W])
                          for (M = 0,
                          b = R.length; b > M; M++)
                              if (e = R[M],
                              t = B[e + "vs"],
                              d = B[e + "is"],
                              t) {
                                  if (Q = e + "boundingBox",
                                  Y = B[Q],
                                  !Y)
                                      for (B[Q] = Y = new n.Math.Box3,
                                      l = 0,
                                      u = d ? d.length : t.length / 3; u > l; l += 3)
                                          d ? (y.fromArray(t, 3 * d[l]).sub(x).multiply(q),
                                          H.fromArray(t, 3 * d[l + 1]).sub(x).multiply(q),
                                          O.fromArray(t, 3 * d[l + 2]).sub(x).multiply(q)) : (y.fromArray(t, 3 * l).sub(x).multiply(q),
                                          H.fromArray(t, 3 * (l + 1)).sub(x).multiply(q),
                                          O.fromArray(t, 3 * (l + 2)).sub(x).multiply(q)),
                                          !y.isNaN() && Y.expandByPoint(y),
                                          !H.isNaN() && Y.expandByPoint(H),
                                          !O.isNaN() && Y.expandByPoint(O);
                                  U.expandByBox(Y),
                                  z = !0
                              }
                  return z ? (this._cacheBoundingBox = U,
                  G.freeze(U),
                  G.freeze(U.min),
                  G.freeze(U.max),
                  sn(o.gv, A),
                  U) : V
              }
          }(),
          needValidate: function() {
              return this._iv
          },
          validate: function() {},
          _16O: function() {
              return Lm
          },
          _80o: function() {},
          dispose: function() {},
          getBodyColor: function(q) {
              var y = this.data
                , _ = this.gv.getBodyColor(y);
              return _ ? _ : q ? y.getStyle(q) : E
          },
          getCachedTexture: function(i) {
              var r = this._cachedTextures;
              return r ? r[i || "main"] : null
          },
          setCachedTexture: function(C, x) {
              var M = this._cachedTextures;
              return M || (M = this._cachedTextures = {}),
              M[x || "main"] = C,
              C
          },
          invalidateCachedTexture: function(_) {
              var Z = this._cachedTextures;
              if (Z) {
                  for (var v in Z)
                      _.deleteTexture(Z[v]);
                  this._cachedTextures = {}
              }
          },
          invalidateCachedGeometry: function() {},
          _24O: function(b, n) {
              var L = this
                , M = L.data
                , m = L.gv
                , F = L.s
                , N = m[n](M);
              if (N != E) {
                  var o = F(b + ".scale")
                    , z = F(b + ".max")
                    , A = L[b + "Info"] = {
                      label: N,
                      textureScale: F(b + ".texture.scale"),
                      color: m[n + "Color"](M),
                      font: F(b + ".font"),
                      align: F(b + ".align"),
                      background: m[n + "Background"](M)
                  }
                    , v = A.rect = Df(A, N);
                  z > 0 && z < v.width && (A.labelWidth = v.width,
                  v.width = z),
                  v.x = v.y = 0,
                  v.width *= o,
                  v.height *= o,
                  A.mat = L._16O(F(b + ".autorotate"), F(b + ".position"), v, F(b + ".face"), F(b + ".t3"), F(b + ".r3"), F(b + ".rotationMode"));
                  var Z = v.width / 2
                    , l = v.height / 2;
                  A.vs = new ld([-Z, l, 0, -Z, -l, 0, Z, -l, 0, Z, l, 0]),
                  v.width /= o,
                  v.height /= o
              }
          },
          _26O: function(W, D) {
              var h = this
                , T = h.data
                , C = h.gv
                , $ = h.s
                , V = C[D](T);
              if (V != E) {
                  var Y = $(W + ".scale")
                    , F = this[W + "Info"] = {
                      note: V,
                      textureScale: $(W + ".texture.scale"),
                      expanded: $(W + ".expanded"),
                      font: $(W + ".font"),
                      color: $(W + ".color"),
                      align: $(W + ".align"),
                      borderWidth: $(W + ".border.width"),
                      borderColor: $(W + ".border.color"),
                      background: C[D + "Background"](T)
                  };
                  if (F.expanded) {
                      var H = $(W + ".max")
                        , Z = Df(F, V);
                      Z.width += 6,
                      Z.height += 2,
                      H > 0 && H < Z.width && (F.labelWidth = Z.width,
                      Z.width = H);
                      var A = {
                          x: -Z.width / 2,
                          y: -8 - Z.height,
                          width: Z.width,
                          height: Z.height + 8
                      }
                  } else
                      A = {
                          x: -6,
                          y: -18,
                          width: 12,
                          height: 18
                      };
                  F.mat = h._16O($(W + ".autorotate"), $(W + ".position"), E, $(W + ".face"), $(W + ".t3"), $(W + ".r3"), $(W + ".rotationMode")),
                  F.rect = A,
                  1 !== Y && (A = Ej(A),
                  A.x *= Y,
                  A.height *= Y,
                  A.y = -A.height,
                  A.width *= Y);
                  var J = A.x
                    , r = A.y
                    , p = A.width
                    , v = A.height;
                  F.vs = new ld([J, -r, 0, J, -r - v, 0, J + p, -r - v, 0, J + p, -r, 0])
              }
          },
          eachShapeModel: function(O, $) {
              function s(R) {
                  Ec(R),
                  R.vs && O(R.vs, R.is, R.ns, R.uv),
                  R.top_vs && O(R.top_vs, R.top_is, R.top_ns, R.top_uv),
                  R.bottom_vs && O(R.bottom_vs, R.bottom_is, R.bottom_ns, R.bottom_uv),
                  R.from_vs && O(R.from_vs, R.from_is, R.from_ns, R.from_uv),
                  R.to_vs && O(R.to_vs, R.to_is, R.to_ns, R.to_uv)
              }
              function F(b) {
                  var g, P, K;
                  if ($c(b))
                      for (P = 0,
                      K = b.length; K > P; P++)
                          g = b[P],
                          g && F(g);
                  else
                      Xq(b) ? F(hc(M, b), M) : Ql(b) && (b.shape3d ? F(b.shape3d) : s(b))
              }
              var M = this
                , G = M.data
                , $ = $ || M.shapeModel || hc(M);
              $ || ($ = G instanceof n.Node && !(G instanceof n.Shape) ? {
                  vs: qj,
                  is: Vh
              } : [M.left, M.front, M.right, M.back, M.top, M.bottom]),
              F($)
          },
          _28O: function(Q, o, F) {
              if (F(this.s(o + ".transparent"))) {
                  var O = Q.rect
                    , g = Q.textureScale
                    , B = O.width * g
                    , W = O.height * g;
                  if (B >= 1 && W >= 1) {
                      var H = en(B, W);
                      1 !== g && (H.translate(H, O.x, O.y),
                      H.scale(g, g),
                      H.translate(H, -O.x, -O.y)),
                      Jb(H, Q),
                      H.restore(),
                      zb(this, o, Q.mat, Q.vs, !0)
                  }
              }
          },
          _29O: function(n, b, N) {
              if (N(this.s(b + ".transparent"))) {
                  var u = n.rect
                    , T = n.textureScale
                    , Z = u.x
                    , f = u.y
                    , t = u.width * T
                    , O = u.height * T;
                  if (t >= 1 && O >= 1) {
                      u.x = u.y = 0;
                      var H = en(t, O);
                      1 !== T && H.scale(T, T),
                      Sk(H, n),
                      H.restore(),
                      u.x = Z,
                      u.y = f,
                      zb(this, b, n.mat, n.vs, !1)
                  }
              }
          },
          _99O: function(O, t, w, S, d, D) {
              if (w) {
                  var u = this
                    , j = u.gv
                    , x = u.data
                    , v = j._buffer
                    , $ = j._1O
                    , H = w.icons
                    , h = Vj.for(O)
                    , Q = h.directAttribs();
                  for (var r in H) {
                      var _ = H[r]
                        , C = w.rects[r];
                      if (C && D(yn(_.transparent, x, j))) {
                          j._picking && Sb(O, S, d, x, r);
                          var f = yn(_.shape3d, x, j)
                            , M = f ? [f] : yn(_.names, x, j)
                            , k = M ? M.length : 0
                            , J = yn(_.textureScale, x, j) || 1
                            , G = yn(_.light, x, j);
                          G == E && (G = f ? !0 : !1),
                          Xb(O, t, yn(_.blend, x, j), G, yn(_.opacity, x, j), yn(_.reverseFlip, x, j), yn(_.reverseColor, x, j), yn(_.reverseCull, x, j));
                          for (var T = 0; k > T; T++) {
                              var b = M[T]
                                , Y = C[T];
                              if (Eh(u, Y.mat),
                              f)
                                  wc(j, x, hc(u, f), u);
                              else {
                                  var L = Ti(b);
                                  if (L) {
                                      var A = Y.width * J
                                        , U = Y.height * J;
                                      if (A >= 1 && U >= 1) {
                                          var X = en(A, U);
                                          Eq(X, L, yn(_.stretch, x, j), 0, 0, A, U, x, j),
                                          X.restore(),
                                          Yh(O, Xl, $),
                                          nb(O, t, $, yn(_.discardSelectable, x, j), v.uv, Sp),
                                          Q.aPosition = vo(O, v.vs, Y.vs, E),
                                          Q.aNormal = Bm(O, v.ns, um, E),
                                          se(O, v.is, go),
                                          Hh(O, 0, go.length),
                                          am(O, t, $)
                                      }
                                  }
                              }
                              uo(j)
                          }
                          he(O, t)
                      }
                  }
              }
          }
      });
      var Uo = function(H, D) {
          Jg(Uo, this, [H, D])
      };
      Ik(Uo, wf, {
          _16O: function(D, J, W, p, k, n, X, c, B) {
              var b = this.data
                , C = b.getFinalScale3d()
                , g = wp(J, C, W, p, c, B);
              if (b.hasOwnProperty("_anchor") || b.hasOwnProperty("_anchorElevation")) {
                  var w = b.getAnchor3d();
                  g[0] -= (w.x - .5) * C[0],
                  g[1] -= (w.y - .5) * C[1],
                  g[2] -= (w.z - .5) * C[2]
              }
              return as(zm(), g, b.p3(), p, k, n, X, D, b.getFinalRotation3d(), b.getRotationMode())
          },
          clear: function() {
              var T = this;
              T.faceMat = T.mat = T.shapeModel = T.left = T.right = T.front = T.back = T.top = T.bottom = T.csg = E
          },
          needValidate: function(q) {
              if (this._iv)
                  return this._validateFrameId = q._renderInfo.frame,
                  !0;
              if (this.s("autorotate") || this.s("shape3d.autorotate") || this.s("fixSizeOnScreen") || this.s("shape3d.fixSizeOnScreen") || this.s("hide.overlapping.group")) {
                  var F = q._renderInfo.frame;
                  if (this._validateFrameId !== F)
                      return this._validateFrameId = F,
                      !0
              }
              return !1
          },
          validate: function(_, I) {
              var Y = this
                , O = Y.gv
                , C = Y.data
                , X = Y.shapeName = Y.s(_o)
                , A = hc(Y, X);
              if (Y._updateAutoRotation(),
              Y._updateFixSize2d(),
              Y._updateOverlapping(),
              Y.dispatchBoundingBoxChanged(),
              this.s("autorotate") || this.s("shape3d.autorotate") || this.s("fixSizeOnScreen") || this.s("shape3d.fixSizeOnScreen")) {
                  var j = C.getRenderLayer()
                    , B = O._40Q.get(j);
                  B && B.ivWireframeBatch(C)
              }
              var J = Dp(C, O.getMat(C), A ? Y.s("shape3d.scaleable") : !0);
              if (C.appendAnchorMatrix3d(J),
              Y.clear(),
              Y.mat = C.mat = J,
              A || !X)
                  if (Y.shapeModel = A,
                  _) {
                      var H = [];
                      A ? ln(O, C, A, Y, Y.getBodyColor(), [J], _, H) : (we(O, C, _, I, J, Mb, H, yi),
                      we(O, C, _, I, J, Gq, H, If),
                      we(O, C, _, I, J, Dj, H, qk),
                      we(O, C, _, I, J, zg, H, Vd),
                      we(O, C, _, I, J, bn, H, mg),
                      we(O, C, _, I, J, zs, H, kn)),
                      H.length && (ph(_.vs, H),
                      ph(_.ns, Yc(H)))
                  } else
                      A || (Y._cubeUvs = null,
                      Y.vf(Mb, 0),
                      Y.vf(Gq, 16),
                      Y.vf(bn, 8),
                      Y.vf(zs, 24),
                      Y.vf(Dj, 32),
                      Y.vf(zg, 40))
          },
          _updateAutoRotation: function() {
              var t = new Ml
                , u = new Sc
                , S = new Rh
                , b = new Rh
                , E = new Rh;
              return function() {
                  var D = this
                    , A = D.data
                    , O = D.s("autorotate") || D.s("shape3d.autorotate");
                  if (!O)
                      return A._dynamicRotation && delete A._dynamicRotation,
                      void 0;
                  var Y = D.gv;
                  E.copy(D.s("shape3d.autorotate.up") || Y._up);
                  var U;
                  U = "string" == typeof O ? [O.indexOf("x") < 0 ? Y._eye[0] : Y._center[0], O.indexOf("y") < 0 ? Y._eye[1] : Y._center[1], O.indexOf("z") < 0 ? Y._eye[2] : Y._center[2]] : Y._eye;
                  var P = Y._center
                    , F = A.p3();
                  S.copy(F),
                  b.set(U[0] - P[0], U[1] - P[1], U[2] - P[2]).add(S),
                  u.lookAt(b, S, E),
                  t.set(0, 0, 0, A.getRotationMode(), !0).setFromRotationMatrix(u);
                  var J = A._dynamicRotation;
                  J && Math.abs(J[0] - t.x) < 1e-5 && Math.abs(J[1] - t.y) < 1e-5 && Math.abs(J[2] - t.z) < 1e-5 || (A._dynamicRotation = [t.x, t.y, t.z])
              }
          }(),
          _updateFixSize2d: function() {
              var Q = this
                , W = Q.data
                , d = Q.s("fixSizeOnScreen") || Q.s("shape3d.fixSizeOnScreen");
              if (!d)
                  return W._dynamicScale3d && delete W._dynamicScale3d,
                  void 0;
              var G = Q.gv
                , Z = Dp(W, G.getMat(W))
                , A = Wb([0, 0, 0], Z)
                , V = G.toViewPosition(A);
              if (!isNaN(V.x) && !isNaN(V.y)) {
                  var U = Wb([1, 0, 0], Z)
                    , w = G.toViewPosition(U)
                    , B = Wb([0, 1, 0], Z)
                    , J = G.toViewPosition(B)
                    , x = w.x - V.x
                    , F = J.y - V.y;
                  if (x && F) {
                      var m, i, u = W._dynamicScale3d || [1, 1, 1], I = Ti(W.s("shape3d.image"));
                      if (d[0] > 0 && (m = d[0]),
                      d[1] > 0 && (i = d[1]),
                      !m || !i) {
                          var H = d > 0 ? d : 1;
                          m || (m = (Aj(I, W) || W.getWidth()) * H),
                          i || (i = (Xc(I, W) || W.getTall()) * H)
                      }
                      var L = Math.abs(x / m)
                        , f = Math.abs(F / i);
                      Math.abs(L - 1) < .001 && Math.abs(f - 1) < .001 || (W._dynamicScale3d = [u[0] / L, u[1] / f, u[2]])
                  }
              }
          },
          _updateOverlapping: function() {
              var M = this
                , F = M.s("hide.overlapping.group");
              if (!F)
                  return M._rectOverlapping && (M._rectOverlapping = V),
                  void 0;
              var A, n, H, l = M.gv, a = M.data, i = Dp(a, l.getMat(a)), r = 1 / 0, K = 1 / 0, C = -1 / 0, X = -1 / 0, J = a.getAnchor3d(), T = J.x, U = J.y, t = J.z;
              for (A = 0; 8 > A; A++) {
                  if (n = Wb([(A >> 2) - T, (1 & A >> 1) - U, (1 & A) - t], i),
                  H = l.toViewPosition(n),
                  isNaN(H.x) || isNaN(H.y))
                      return;
                  r = Math.min(r, H.x),
                  C = Math.max(C, H.x),
                  K = Math.min(K, H.y),
                  X = Math.max(X, H.y)
              }
              var y = {
                  x: r,
                  y: K,
                  w: C - r,
                  h: X - K
              };
              M._rectOverlapping = l.overlappingBox.isOverlapping(F, y)
          },
          getVectorDynamicSize: function() {
              var F, A = this, S = A.s("shape3d"), K = A.data;
              if ("billboard" === S || "plane" === S || (F = K._currentCubeElementId) != E) {
                  var s, U, k = A.gv, i = Dp(K, k.getMat(K)), g = K.getAnchor3d(), c = .5 - g.x, e = .5 - g.y, T = .5 - g.z, w = Math.min(A.s("vector.dynamic.maxsize"), k._glCapabilities.maxTextureSize) / k.getDevicePixelRatio(), O = function(Q, o) {
                      Q[0] += c,
                      Q[1] += e,
                      Q[2] += T,
                      o[0] += c,
                      o[1] += e,
                      o[2] += T;
                      var r = k.toViewPosition(Wb(Q, i))
                        , S = k.toViewPosition(Wb(o, i))
                        , t = r.x - S.x
                        , N = r.y - S.y;
                      return Math.min(w, Math.sqrt(t * t + N * N))
                  };
                  if ("billboard" === S)
                      s = O([-.5, 0, 0], [.5, 0, 0]),
                      U = O([0, -.5, 0], [0, .5, 0]);
                  else if ("plane" === S)
                      s = O([-.5, 0, 0], [.5, 0, 0]),
                      U = O([0, 0, -.5], [0, 0, .5]);
                  else if (K._currentCubeElementId != E) {
                      var P = 3 * Vh[F + 1]
                        , q = 3 * Vh[F]
                        , d = 3 * Vh[F + 2];
                      s = O([qj[P], qj[P + 1], qj[P + 2]], [qj[d], qj[d + 1], qj[d + 2]]),
                      U = O([qj[P], qj[P + 1], qj[P + 2]], [qj[q], qj[q + 1], qj[q + 2]])
                  }
                  return [s, U]
              }
          },
          vf: function(X, M) {
              var j = this;
              if (j.gv.getFaceVisible(j.data, X)) {
                  var T = Dq(j, X);
                  T.mat && (j.faceMat = !0);
                  var s = T.uv;
                  if (s) {
                      var l = j._cubeUvs;
                      l || (l = j._cubeUvs = new ld([0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0]));
                      for (var R = 0; 8 > R; R++)
                          l[M + R] = s[R]
                  }
                  return T
              }
          },
          _billboardInView: function() {
              var L = [-.5, -.5, 0, -.5, .5, 0, .5, -.5, 0, .5, .5, 0]
                , J = [-.5, 0, -.5, -.5, 0, .5, .5, 0, -.5, .5, 0, .5]
                , O = new Wi
                , E = new Rh
                , D = new Sc;
              return function(M) {
                  var e = this;
                  if (!e.mat)
                      return !0;
                  var Q = e.gv.getFrustum()
                    , A = "billboard" === M ? L : J;
                  O.makeEmpty(),
                  D.fromArray(e.mat);
                  for (var Y = 0, c = A.length; c > Y; Y += 3)
                      O.expandByPoint(E.fromArray(A, Y).applyMatrix4(D));
                  return Q.intersectsBox(O)
              }
          }(),
          _80o: function(j, S, b) {
              var V = this;
              if (V._rectOverlapping)
                  return !0;
              var w = V.shapeModel;
              if (w || !V.shapeName) {
                  var K = V.s("shape3d");
                  if (("billboard" === K || "plane" === K) && !V._billboardInView(K))
                      return !0;
                  var d = V.gv
                    , L = V.data
                    , U = d._cube
                    , H = Vj.for(j)
                    , a = H.directAttribs();
                  Fb(d, V.mat),
                  V.s("shape3d.reflector") && !j._picking || (w ? wc(d, L, w, V, V.getBodyColor(), b) : (a.aPosition = vo(j, U.vs, E, E),
                  a.aNormal = vo(j, U.ns, E, E),
                  pq(j, U.is),
                  V._18O(j, S, "left", 0, b),
                  V._18O(j, S, "front", 6, b),
                  V._18O(j, S, "right", 12, b),
                  V._18O(j, S, "back", 18, b),
                  V._18O(j, S, "top", 24, b),
                  V._18O(j, S, "bottom", 30, b))),
                  uo(d),
                  V.faceMat && (V._18O(j, S, "left", 0, b, !0),
                  V._18O(j, S, "front", 6, b, !0),
                  V._18O(j, S, "right", 12, b, !0),
                  V._18O(j, S, "back", 18, b, !0),
                  V._18O(j, S, "top", 24, b, !0),
                  V._18O(j, S, "bottom", 30, b, !0))
              }
          },
          _18O: function(i, h, B, q, o, a) {
              var m = this[B];
              if (m) {
                  if (!o(m.transparent))
                      return;
                  if (a && !m.mat || !a && m.mat)
                      return;
                  var C = this.data.s("polygonOffset");
                  C && Hg(i, C),
                  a && Fb(this.gv, m.mat);
                  var w = this
                    , l = w.data
                    , V = Vj.for(i)
                    , J = V.directUniforms();
                  l._currentCubeElementId = q;
                  var S = w.gv
                    , s = S.getTexture(m.texture, l, B)
                    , G = m.uv
                    , _ = m.uvScale
                    , H = m.uvOffset
                    , R = m.discardSelectable;
                  s ? G ? nb(i, h, s, R, S._buffer.uv, w._cubeUvs, H, _) : nb(i, h, s, R, S._cube.uv, E, H, _) : nb(i),
                  Xb(i, h, m.blend, m.light, m.opacity, m.reverseFlip, m.reverseColor, m.reverseCull),
                  J.uDiffuse = m.color || U["color.empty"],
                  Hh(i, q, 6),
                  he(i, h),
                  am(i, h, s),
                  a && uo(S),
                  C && ac(i),
                  l._currentCubeElementId = null
              }
          },
          drawReflector: function() {
              var Z = new Rh
                , a = new Rh
                , H = new Ml
                , x = new Sc
                , s = new Rh
                , M = new Rh
                , c = new Rh
                , B = new Rh
                , L = new Sc
                , Y = new Sc
                , m = new Yi
                , J = new Sl
                , S = new Sl
                , p = function(a, K, k) {
                  a[k] = K[0],
                  a[k + 1] = K[1],
                  a[k + 2] = K[2]
              }
                , A = function(T, V) {
                  p(T, V.getEye(), 0),
                  p(T, V.getCenter(), 3),
                  p(T, V.getUp(), 6)
              }
                , U = function(Z, S) {
                  S._eye = [Z[0], Z[1], Z[2]],
                  S._center = [Z[3], Z[4], Z[5]],
                  S._up = [Z[6], Z[7], Z[8]],
                  S._18Q = E;
                  var r = S._skybox;
                  r && (r.p3([Z[0], Z[1], Z[2]]),
                  S.getData3dUI(r).iv())
              };
              return function(X) {
                  var u = this;
                  u._reflectorInfo = null;
                  var P = u.data;
                  if (P._reflecting)
                      return !1;
                  var T = u.gv;
                  if (T._picking)
                      return !1;
                  var q = u._reflectorRenderTarget
                    , t = T.getDevicePixelRatio()
                    , g = T.getWidth() * t
                    , _ = T.getHeight() * t;
                  q ? q.setSize(X, g, _) : q = u._reflectorRenderTarget = new rn.RenderTarget(T,X,g,_),
                  Z.copy(P.p3()),
                  a.copy(T.getEye()),
                  x.makeRotationFromEuler(H.set(P.r3(), P.getRotationMode(), !0));
                  var h;
                  if (!u._reflectNormal) {
                      var h = hc(u, u.s("shape3d"));
                      if (!h)
                          return !1;
                      if (!h.ns && h.length && (h = h[0]),
                      !h.ns || !h.vs)
                          return !1;
                      u._reflectNormal = [h.ns[0], h.ns[1], h.ns[2]],
                      u._reflectorVbuffer = _p.Buffer.createVertexBuffer(X, new Float32Array(h.vs))
                  }
                  if (s.copy(u._reflectNormal),
                  s.applyMatrix4(x),
                  M.subVectors(Z, a),
                  M.dot(s) > 0)
                      return !1;
                  M.reflect(s).negate(),
                  M.add(Z),
                  c.copy(T.getCenter()).negate().add(Z),
                  c.reflect(s).negate(),
                  c.add(Z),
                  B.copy(T.getUp()),
                  B.reflect(s);
                  var r = [0, 0, 0, 0, 0, 0, 0, 0, 0];
                  A(r, T),
                  T._eye = M.toArray(),
                  T._center = c.toArray(),
                  T._up = B.toArray(),
                  T._18Q = E;
                  var Q = T._skybox;
                  Q && (Q.p3(T._eye),
                  T.getData3dUI(Q).iv()),
                  fq(X, q.frame),
                  X.viewport(0, 0, q.width, q.height);
                  var D = P.s("shape3d.reflector.background");
                  if (D) {
                      var y = X.getParameter(X.COLOR_CLEAR_VALUE);
                      yf(X, D)
                  } else
                      X.clearColor(0, 0, 0, 1);
                  Vj.for(X).glState.depth.mask = !0,
                  X.clear(X.COLOR_BUFFER_BIT | X.DEPTH_BUFFER_BIT);
                  var e = Yl(T)
                    , C = Lq(T);
                  m.setFromNormalAndCoplanarPoint(s, Z),
                  m.applyMatrix4(Y.fromArray(C)),
                  J.set(m.normal.x, m.normal.y, m.normal.z, m.constant),
                  S.x = (Math.sign(J.x) + e[8]) / e[0],
                  S.y = (Math.sign(J.y) + e[9]) / e[5],
                  S.z = -1,
                  S.w = (1 + e[10]) / e[14],
                  J.multiplyScalar(2 / J.dot(S));
                  var I = P.s("shape3d.reflector.clip")
                    , w = I === V ? .003 : I;
                  e[2] = J.x,
                  e[6] = J.y,
                  e[10] = J.z + 1 - w,
                  e[14] = J.w;
                  var R = T._computedProjectMatrix;
                  T._computedProjectMatrix = e,
                  P._reflecting = !0,
                  T.renderScene(),
                  T._computedProjectMatrix = R,
                  L.set(.5, 0, 0, .5, 0, .5, 0, .5, 0, 0, .5, .5, 0, 0, 0, 1),
                  L.multiply(Y.fromArray(T._projectMatrix)),
                  L.multiply(Y.fromArray(T._viewMatrix)),
                  D && yf(X, y),
                  Zp(X),
                  U(r, T);
                  var W = P.s("shape3d.reflector.blur");
                  if (W) {
                      var f = T.getPostProcessingModule("Blur");
                      f && f.drawImpl(X, q, W, P.s("shape3d.reflector.blur.ratio"))
                  }
                  var k = X._compiledShader.reflector;
                  k || (k = X._compiledShader.reflector = new _p.Shader(X,qd.Reflector.vs,qd.Reflector.fs)),
                  k.bind(),
                  X.activeTexture(X.TEXTURE0),
                  cr(X, q.texture),
                  k.uniforms.tDiffuse = 0,
                  k.uniforms.color = bd(P.s("shape3d.reflector.color") || "rgb(128,128,128)"),
                  k.uniforms.textureMatrix = L.toArray(),
                  k.uniforms.modelMatrix = Dp(P),
                  k.uniforms.viewMatrix = Lq(T),
                  k.uniforms.projectionMatrix = Yl(T),
                  u._reflectorVbuffer.upload(),
                  k.attributes.pos.pointer(u._reflectorVbuffer);
                  var l = this.s("shape3d.transparent");
                  if (l) {
                      var d = Vj.for(X).glState
                        , O = d.depth.mask;
                      d.depth.mask = !1
                  }
                  return X.drawArrays(X.TRIANGLES, 0, 6),
                  l && (d.depth.mask = O),
                  P._reflecting = !1,
                  X.useProgram(T._prg),
                  cr(X, E),
                  !0
              }
          }()
      }),
      qd.Reflector = {
          vs: ["attribute vec3 pos;", "uniform mat4 textureMatrix;", "uniform mat4 modelMatrix;", "uniform mat4 viewMatrix;", "uniform mat4 projectionMatrix;", "varying vec4 vUv;", "void main() {", "	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );", "	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );", "}"].join("\n"),
          fs: ["precision highp float;", "uniform vec3 color;", "uniform sampler2D tDiffuse;", "varying vec4 vUv;", "float blendOverlay( float base, float blend ) {", "	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );", "}", "vec3 blendOverlay( vec3 base, vec3 blend ) {", "	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );", "}", "void main() {", "	vec4 base = texture2DProj( tDiffuse, vUv );", "   vec2 tUv = vUv.xy / vUv.w;", "   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;", "	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );", "}"].join("\n")
      };
      var Vk = function(X, k) {
          Jg(Vk, this, [X, k])
      };
      Ik(Vk, Uo, {
          _80o: function() {}
      });
      var Zq = function(x, B) {
          Jg(Zq, this, [x, B])
      };
      Ik(Zq, wf, {
          _25Q: 1,
          validate: function(B) {
              var G = this;
              if (!G.s("geometry.cache") || !G.info) {
                  var c = G.gv
                    , L = G.data
                    , N = G.s
                    , D = N("edge.width")
                    , I = L._40I
                    , v = L._41I;
                  if (G.shapeModel = G.info = E,
                  I && v) {
                      var Q, W, p, X, x, C, _, d, J, u, T = L.isLooped(), o = N(vj), O = M.getEdgeType(o);
                      if (O) {
                          var m = O(L, xp(G, c, L, T, o), c, G._19Q);
                          if (!m.points || m.points.isEmpty())
                              return;
                          C = G.info = {},
                          _ = m.segments,
                          x = m.points,
                          d = x.size();
                          for (var U = I.getElevation(), $ = v.getElevation(), H = 0; d > H; H++) {
                              var z = x.get(H);
                              z.e == E && (z.e = U + ($ - U) * H / (d - 1))
                          }
                          J = $r(x.get(0)),
                          u = $r(x.get(d - 1));
                          var k = d % 2;
                          0 === k ? (C.c1 = $r(x.get(d / 2 - 1)),
                          C.c2 = $r(x.get(d / 2))) : C.p3 = $r(x.get((d - k) / 2)),
                          C.s1 = J,
                          C.s2 = $r(x.get(1)),
                          C.t1 = $r(x.get(d - 2)),
                          C.t2 = u
                      } else {
                          x = new Mh,
                          C = G.info = {};
                          var w = N("edge.offset")
                            , s = N("edge.center")
                            , g = N("edge.source.t3")
                            , R = N("edge.target.t3")
                            , b = Dl(c, L, "source")
                            , F = Dl(c, L, "target");
                          if (!b || !F)
                              return c.invalidateData(L),
                              delete G.info,
                              !1;
                          if (g && (b[0] += g[0],
                          b[1] += g[1],
                          b[2] += g[2]),
                          R && (F[0] += R[0],
                          F[1] += R[1],
                          F[2] += R[2]),
                          o === $h) {
                              _ = N("edge.segments");
                              var n = C.points = N(ri) || $b;
                              if (d = n.size()) {
                                  J = $r(n.get(0)),
                                  u = $r(n.get(d - 1)),
                                  !s && w && (p = Bb(J, b, !0),
                                  w = K(w, Qf(b, J)),
                                  b = [b[0] + p[0] * w, b[1] + p[1] * w, b[2] + p[2] * w],
                                  p = Bb(F, u, !0),
                                  w = K(w, Qf(u, F)),
                                  F = [F[0] - p[0] * w, F[1] - p[1] * w, F[2] - p[2] * w]);
                                  var k = d % 2;
                                  0 === k ? (Q = $r(n.get(d / 2 - 1)),
                                  W = $r(n.get(d / 2))) : C.p3 = $r(n.get((d - k) / 2)),
                                  C.s1 = b,
                                  C.s2 = J,
                                  C.t1 = u,
                                  C.t2 = F
                              } else
                                  !s && w && (p = Bb(F, b, !0),
                                  X = Qf(b, F),
                                  w = Zl(w, X),
                                  b = [b[0] + p[0] * w, b[1] + p[1] * w, b[2] + p[2] * w],
                                  F = [F[0] - p[0] * w, F[1] - p[1] * w, F[2] - p[2] * w]),
                                  Q = b,
                                  W = F;
                              x.add({
                                  x: b[0],
                                  y: b[2],
                                  e: b[1]
                              }),
                              x.addAll(n),
                              x.add({
                                  x: F[0],
                                  y: F[2],
                                  e: F[1]
                              })
                          } else {
                              var l = xp(G, c, L, T, o);
                              if (G._19Q || (l = -l),
                              T) {
                                  var h = b[0]
                                    , A = b[1]
                                    , t = b[2]
                                    , S = I.getTall() / 2 + l;
                                  Q = [h - l, A + S, t],
                                  W = [h + l, A + S, t],
                                  x.add({
                                      x: h - l,
                                      y: t,
                                      e: A
                                  }),
                                  x.add({
                                      x: h - l,
                                      y: t,
                                      e: A + S
                                  }),
                                  x.add({
                                      x: h + l,
                                      y: t,
                                      e: A + S
                                  }),
                                  x.add({
                                      x: h + l,
                                      y: t,
                                      e: A
                                  })
                              } else {
                                  p = Bb(F, b, !0),
                                  X = Qf(b, F);
                                  var y = {
                                      x: b[0],
                                      y: b[2]
                                  }
                                    , f = {
                                      x: F[0],
                                      y: F[2]
                                  }
                                    , j = Bi(E, y, f, l)
                                    , V = j.x - y.x
                                    , Y = j.y - y.y;
                                  w = Zl(w, X),
                                  p[0] *= w,
                                  p[1] *= w,
                                  p[2] *= w,
                                  Q = [b[0] + p[0] + V, b[1] + p[1], b[2] + p[2] + Y],
                                  W = [F[0] - p[0] + V, F[1] - p[1], F[2] - p[2] + Y],
                                  s ? (x.add({
                                      x: b[0],
                                      y: b[2],
                                      e: b[1]
                                  }),
                                  x.add({
                                      x: Q[0],
                                      y: Q[2],
                                      e: Q[1]
                                  }),
                                  x.add({
                                      x: W[0],
                                      y: W[2],
                                      e: W[1]
                                  }),
                                  x.add({
                                      x: F[0],
                                      y: F[2],
                                      e: F[1]
                                  })) : (x.add({
                                      x: Q[0],
                                      y: Q[2],
                                      e: Q[1]
                                  }),
                                  x.add({
                                      x: W[0],
                                      y: W[2],
                                      e: W[1]
                                  }))
                              }
                          }
                          C.c1 = Q,
                          C.c2 = W
                      }
                      C._lastPointsSegments = {
                          points: x,
                          segments: _
                      },
                      C.list = N(_o) === jl ? G.createTubeModel(x, _, D / 2, B) : G.createLineModel(x, _, D, "edge", "edge.dash")
                  }
              }
          },
          invalidateCachedGeometry: function() {
              this.info = E
          }
      });
      var lh = function(z, p) {
          Jg(lh, this, [z, p]),
          this._needRecoverPosition = !0
      };
      Ik(lh, Uo, {
          _80o: function(O, e, V) {
              var o = this
                , _ = o.gv
                , l = o.shapeModel;
              Fb(_, o.mat),
              l ? wc(_, o.data, l, o, o.getBodyColor(), V) : (np(o, O, e, "left", V),
              np(o, O, e, "front", V),
              np(o, O, e, "right", V),
              np(o, O, e, "back", V),
              np(o, O, e, "top", V),
              np(o, O, e, "bottom", V)),
              uo(_)
          },
          validate: function(g, Q) {
              var q, $, B = this, o = B.s, S = B.data, G = (S.p3(),
              S._thickness / 2), e = S.isClosePath(), O = S.getPoints(), D = S.getSegments(), _ = o(Xn), C = g && g.uv;
              if (B.clear(),
              B.dispatchBoundingBoxChanged(),
              0 > G) {
                  try {
                      $ = B.shapeModel = Sm(O, D, o(xb), o(Ge), _, o(kg), S.getTall(), S.getShapeElevation(), e)
                  } catch (F) {
                      $ = B.shapeModel = {}
                  }
                  o(Qk) ? o("shape3d.image") || delete $.uv : (delete $.vs,
                  delete $.ns,
                  delete $.uv),
                  o("shape3d.top.image") || delete $.top_uv,
                  o("shape3d.bottom.image") || delete $.bottom_uv
              } else if (o(_o) === jl)
                  q = _q(O, D, _, e),
                  $ = B.shapeModel = {
                      vs: []
                  },
                  o("shape3d.image") && ($.uv = [],
                  $.sum = o(kg) || oo(q) || 1,
                  $.len = 0),
                  o(xb) && !e && ($.top_vs = [],
                  o("shape3d.top.image") && ($.top_uv = [])),
                  o(Ge) && !e && ($.bottom_vs = [],
                  o("shape3d.bottom.image") && ($.bottom_uv = [])),
                  B._12O(q, G);
              else {
                  var j, x, c, Z, t, H, U, b, n, h;
                  if (q = _q(O, D, _, e),
                  t = B.vf(bn, C, !1, Q),
                  G && (H = B.vf(zs, C, !1, Q),
                  U = e ? E : B.vf(Mb, C, !1, Q),
                  b = e ? E : B.vf(Gq, C, !1, Q),
                  n = B.vf(Dj, C, !1, Q),
                  h = B.vf(zg, C, !1, Q)),
                  G) {
                      for (var P = 0, I = q.length; I > P; P++)
                          q[P] = B._tryRemoveBezierPoints(q[P], G);
                      B._12O(q, G)
                  } else
                      t && q.forEach(function(D) {
                          if (Z = D.length,
                          Z > 0)
                              for (j = D[0],
                              c = 1; Z > c; c++)
                                  x = D[c],
                                  B.addV(t.vs, j, x),
                                  j = x
                      });
                  B._20Q(q),
                  g || (t && (t.ns = Yc(t.vs),
                  ee(t, "vs"),
                  ee(t, tf)),
                  G && (H && (H.ns = Yc(H.vs),
                  ee(H, "vs"),
                  ee(H, tf)),
                  U && (U.ns = Yc(U.vs),
                  ee(U, "vs"),
                  ee(U, tf)),
                  b && (b.ns = Yc(b.vs),
                  ee(b, "vs"),
                  ee(b, tf)),
                  n && (n.ns = Yc(n.vs),
                  ee(n, "vs"),
                  ee(n, tf)),
                  h && (h.ns = Yc(h.vs),
                  ee(h, "vs"),
                  ee(h, tf))))
              }
              var f = B.mat = S.getPointsMatrix3d().getElements();
              g && (jc(B, f, g, $),
              B.clear())
          },
          _20Q: function(W) {
              var r, p, s, T, o, O, e, v = this, y = v.front, V = v.back, c = v.top, $ = v.bottom, n = y ? y.tuv : E, U = V ? V.tuv : E, A = c ? c.tuv : E, k = $ ? $.tuv : E, Z = 0;
              (n || U || A || k) && (r = v.s(kg) || oo(W) || 1,
              W.forEach(function(a) {
                  if (p = a.length,
                  p > 0)
                      for (O = a[0],
                      s = 1; p > s; s++)
                          e = a[s],
                          T = Z / r,
                          Z += Qf(O, e),
                          o = Z / r,
                          v._14O(y, T, o),
                          v._14O(V, 1 - o, 1 - T),
                          v._14O(c, T, o),
                          v._14O($, T, o),
                          O = e
              }))
          },
          _14O: function(O, K, x) {
              if (O) {
                  var r = O.uv
                    , H = O.tuv;
                  if (H) {
                      if (r)
                          var v = r[0] + (r[6] - r[0]) * K
                            , C = r[1] + (r[7] - r[1]) * K
                            , a = r[2] + (r[4] - r[2]) * K
                            , q = r[3] + (r[5] - r[3]) * K
                            , e = r[2] + (r[4] - r[2]) * x
                            , o = r[3] + (r[5] - r[3]) * x
                            , i = r[0] + (r[6] - r[0]) * x
                            , d = r[1] + (r[7] - r[1]) * x;
                      else
                          v = K,
                          C = 0,
                          a = K,
                          q = 1,
                          e = x,
                          o = 1,
                          i = x,
                          d = 0;
                      H.push(a, q, e, o, i, d, i, d, v, C, a, q)
                  }
              }
          },
          _13O: function(T) {
              var F = T.uv
                , d = T.tuv;
              d && (F ? d.push(F[2], F[3], F[4], F[5], F[6], F[7], F[6], F[7], F[0], F[1], F[2], F[3]) : d.push(0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1))
          },
          _tryRemoveBezierPoints: function(r, D) {
              var K = r.length;
              if (4 > K)
                  return r;
              var o, I, B, X, T, W, u = !1, j = function(F) {
                  return r[F]
              }, g = function(W) {
                  return r[K - 1 - W]
              };
              for (T = 0; 1 >= T; T++)
                  for (W = T ? g : j,
                  I = W(0),
                  B = W(1),
                  o = 2; K - 1 > o; o++)
                      if (X = W(o),
                      !X.remove)
                          if (X.b) {
                              var s = Bi(I, B, X, D);
                              s.adjust ? (X.remove = !0,
                              u = !0) : (I = B,
                              B = X)
                          } else
                              I = B,
                              B = X;
              if (!u)
                  return r;
              var Y = [];
              for (o = 0; K > o; o++)
                  r[o].remove || Y.push(r[o]);
              return Y
          },
          _12O: function(t, d) {
              var O, a, W, w, s, L = this.s("shape3d.point.epsilon"), K = this;
              t.forEach(function(m) {
                  if (s = m.length,
                  s > 0)
                      for (O = {
                          p: m[0],
                          n: !0
                      },
                      w = 1; s > w; w++)
                          a = m[w],
                          W = s - 1 > w ? m[w + 1] : E,
                          W && Math.abs(a.x - W.x) < L && Math.abs(a.y - W.y) < L || K.addPoint(O, a, W, d, m)
              })
          },
          addPoint: function(V, F, x, y, j) {
              var r, k, b, f, v, m, p, M, O, n = this, c = V.p, P = V.f, A = V.b, h = n.s("shape3d.side") || Zj, l = n.s("shape3d.start.angle"), d = n.s("shape3d.sweep.angle"), L = n.shapeModel, U = n.data.isClosePath();
              if (V.n && (V.n = !1,
              P = U && j.length > 2 ? Bi(j[j.length - 2], c, F, y) : Bi(E, c, F, y),
              A = El(c, P),
              L ? L.top_vs && n._10O(A, P, h, l, d, L.top_vs, L.top_uv) : (r = n.left) && (n.addV(r.vs, A, P),
              n._13O(r))),
              k = x ? Bi(c, F, x, y) : U && j.length > 2 ? Bi(c, F, j[1], y) : Bi(c, F, E, y),
              b = El(F, k),
              L) {
                  var T, z, _ = L.vs, u = L.uv, w = L.sum;
                  for (u && (T = L.len / w,
                  L.len += Qf(c, F),
                  z = L.len / w),
                  m = n._9O(A, P, h, l, d),
                  p = n._9O(b, k, h, l, d),
                  M = 0; h > M; M++)
                      O = M + 1,
                      ph(_, m[O]),
                      ph(_, p[M]),
                      ph(_, m[M]),
                      ph(_, p[M]),
                      ph(_, m[O]),
                      ph(_, p[O]),
                      u && (f = M / h,
                      v = O / h,
                      u.push(T, v, z, f, T, f, z, f, T, v, z, v));
                  !x && L.bottom_vs && n._10O(b, k, h, l, d, L.bottom_vs, L.bottom_uv, !0)
              } else
                  !x && (r = n.right) && (n.addV(r.vs, k, b),
                  n._13O(r)),
                  (r = n.front) && n.addV(r.vs, P, k),
                  (r = n.back) && n.addV(r.vs, b, A),
                  (r = n.top) && n.addH(r.vs, P, k, b, A, !0),
                  (r = n.bottom) && n.addH(r.vs, A, b, k, P);
              V.p = F,
              V.f = k,
              V.b = b
          },
          _10O: function(A, H, F, v, u, U, w, Y) {
              var r, l, C = this, D = C.data, K = C._9O(A, H, F, v, u), n = (A.x + H.x) / 2, k = (A.y + H.y) / 2, $ = D.getShapeElevation(), m = 0;
              for (m = 0; F > m; m++)
                  Y ? (ph(U, K[m]),
                  ph(U, K[m + 1])) : (ph(U, K[m + 1]),
                  ph(U, K[m])),
                  ph(U, [n, $, k]),
                  w && (Y ? (r = y * (m + 1) / F + v,
                  l = y * m / F + v) : (r = y * m / F + v,
                  l = y * (m + 1) / F + v),
                  w.push(.5 - .5 * P(l), .5 - .5 * o(l), .5 - .5 * P(r), .5 - .5 * o(r), .5, .5))
          },
          _9O: function(w, U, d, R, J) {
              var r, u, b = this, q = b.data, h = [], L = (w.x + U.x) / 2, B = (w.y + U.y) / 2, F = q.getTall() / 2, v = q.getShapeElevation(), m = 0;
              for (J == E && (J = y); d >= m; m++)
                  r = J * m / d + R,
                  u = P(r),
                  h.push([L + (w.x - L) * u, v + F * o(r), B + (w.y - B) * u]);
              return h
          },
          addV: function(x, H, g) {
              var r = H.x
                , A = H.y
                , G = g.x
                , Z = g.y
                , W = this.data
                , i = W.getShapeElevation()
                , V = W.getTall() / 2;
              x.push(r, i - V, A, G, i - V, Z, G, i + V, Z, G, i + V, Z, r, i + V, A, r, i - V, A)
          },
          addH: function(g, r, w, x, T, C) {
              var u = this.data
                , i = u.getTall() / 2
                , v = u.getShapeElevation() + (C ? i : -i);
              g.push(r.x, v, r.y, w.x, v, w.y, x.x, v, x.y, x.x, v, x.y, T.x, v, T.y, r.x, v, r.y)
          },
          vf: function(Z, a, Q, T) {
              var w, X = this, o = X.gv.getFaceVisible(X.data, Z);
              return (Q || o) && (w = Dq(X, Z, T),
              w.vs = [],
              w.tuv = o && (w.texture || a) ? [] : E,
              w.visible = o),
              w
          }
      });
      var ms, kc, Aq = function(Q, y) {
          Jg(Aq, this, [Q, y])
      };
      Ik(Aq, Uo, {
          validate: function() {
              var T = this
                , m = T.gv
                , P = T.data
                , X = T.s
                , f = bd(X("points.color"));
              f = [f[0], f[1], f[2]];
              var Y = X("points.size")
                , q = X("points.image") || "rect";
              ("rect" === q || "circle" === q) && ("rect" === q ? (ms || (ms = T._createCachedImage(q)),
              q = ms) : (kc || (kc = T._createCachedImage(q)),
              q = kc));
              var v = X("points.model");
              if (v) {
                  if (T._lastShapeModel !== v || !T.shapeModel) {
                      var O = hc(T, v);
                      if (!O)
                          return;
                      var F = []
                        , u = {};
                      T.eachShapeModel(function(c) {
                          for (var E = 0, s = c.length; s > E; E += 3) {
                              var N = c[E]
                                , e = c[E + 1]
                                , f = c[E + 2]
                                , H = "" + N + "_" + e + "_" + f;
                              u[H] || (u[H] = !0,
                              F.push(N, e, f))
                          }
                      }, O),
                      T.shapeModel = {
                          vs: new ld(F)
                      },
                      P._pointsDirty = !0,
                      T._lastShapeModel = v
                  }
              } else {
                  var g = P.points
                    , l = g.length
                    , Z = l / 3;
                  if (P._pointsDirty || !T.shapeModel) {
                      var W = new ld(g);
                      T.shapeModel = {
                          vs: W
                      },
                      P._pointsDirty = !1,
                      T._lastShapeModel = null
                  }
              }
              if (T.info = {
                  mat: Dp(P),
                  size: Y,
                  diffuse: f,
                  opacity: X("points.opacity"),
                  texture: q,
                  alphaTest: X("points.transparent") ? 0 : X("alphaTest")
              },
              P._colorsDirty) {
                  for (var i, _, C, S = [], w = !1, t = P.colors, R = 0; l > R; R += 3)
                      i = t[R],
                      _ = t[R + 1],
                      C = t[R + 2],
                      i === V || _ === V || C === V ? S.push(f[0], f[1], f[2]) : (w = !0,
                      S.push(i, _, C));
                  T.shapeModel.cs = w ? new ld(S) : null,
                  P._colorsDirty = !1
              }
              if (P._sizesDirty) {
                  for (var a = [], H = !1, n = P.sizes, R = 0; Z > R; R++)
                      n[R] ? (a.push(n[R]),
                      H = !0) : a.push(Y);
                  T.shapeModel.ss = H ? new ld(a) : null,
                  P._sizesDirty = !1
              }
              if (T._lastPointNumber !== Z) {
                  var d = m.pickColorMap
                    , Q = d._pickIdUsed;
                  d._pickIdUsed = Q + Z;
                  for (var k = [], R = 0; Z > R; R++) {
                      var s = Q + R
                        , x = Xp(s);
                      k.push(x[0], x[1], x[2], x[3]),
                      d[s] || (d[s] = {
                          data: P,
                          part: R
                      })
                  }
                  T.shapeModel.ps = new ld(k),
                  T._lastPointNumber = Z
              }
              this.dispatchBoundingBoxChanged()
          },
          _createCachedImage: function(d) {
              var q = 128
                , g = Jl()
                , I = g.getContext("2d");
              Uj(g, q, q, 1),
              Gm(I, {
                  width: q,
                  height: q,
                  comps: [{
                      type: d,
                      background: "white",
                      borderWidth: 0,
                      rect: [0, 0, q, q]
                  }]
              }, 0, 0, q, q);
              var j = n.Math.generateUUID();
              return wm[j] = g,
              j
          },
          _80o: function(l, y) {
              var Y = this
                , D = Y.gv
                , i = Y.shapeModel
                , S = Y.info;
              if (i && i.vs && i.vs.length) {
                  var e = Vj.for(l);
                  e.useProgram(Y._asureProgram(l)),
                  e.directState();
                  var g = e.directUniforms()
                    , R = e.directAttribs();
                  g.modelMatrix = S.mat,
                  g.modelViewMatrix = Fo([], D._viewMatrix, S.mat),
                  g.projectionMatrix = D._projectMatrix,
                  g.viewMatrix = D._viewMatrix,
                  g.scale = D.getHeight() / 2,
                  g.size = S.size,
                  g.diffuse = S.diffuse,
                  g.opacity = S.opacity,
                  g.map = D.getTexture(S.texture, Y.data),
                  g.alphaTest = S.alphaTest,
                  g.resolution = D.getDevicePixelRatio(),
                  R.position = Bm(l, D._buffer.vs, i.vs, E),
                  D._picking ? (g.picking = !0,
                  R.pickColor = Bm(l, D._buffer.ps, i.ps, E),
                  g.useColor = !1,
                  R.color = null) : (g.picking = !1,
                  R.pickColor = null,
                  i.cs ? (g.useColor = !0,
                  R.color = Bm(l, D._buffer.cs, i.cs, E)) : (g.useColor = !1,
                  R.color = null)),
                  i.ss ? (g.useSizeArray = !0,
                  R.sizeArray = Bm(l, D._buffer.ss, i.ss, E)) : (g.useSizeArray = !1,
                  R.sizeArray = null),
                  rp(l, 0, i.vs.length / 3, l.POINTS),
                  e.useProgram(y)
              }
          },
          _asureProgram: function(N) {
              return N._pointsShader || (N._pointsShader = this.gv._postProcessing.createShader(N, Aq.shaderSrc)),
              N._pointsShader.program
          }
      }),
      Aq.shaderSrc = "!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj4t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vv)o!jggjp!sn<!ocppjpumj!tqpjQdwlnj!o+h!<yj!sbuubuNsojpcjvuudff!kwpfsdq5!!>q!jodpljDupjmtppsQ<`mh!!vo<jogppjsunj!tgpmQpwbnu!!+t!jy{jfs<ub!NvxofjjgWpmsfne!pgnm!p>b!uo!psjfutjptmpvQuwjnp!o<<*!!v1o/j2g!p-senf!ncspppgmt!ovbtsfuT!j){5fdBfsws!b>z!<op!jbuujutspjQcwvnu!f5!dgfmwp!bu<!*t!jo{pfjBusjstbpzq<!)4!dcfpwp!m>!!jetfQnfssptgqtfodbusjuw!f4Ndbfuws!jy~)!!n<b*u15/!2n!!-*s!p|mp!ds)f5udvfswo!!>n!]s!p3m!p^D]w!!4!|^!!*>s>p!m.p!D2f/t1v<)!!g~j!f!twmpfj!e!~n!bj<os)p*m!p|Dl!djjgq!!)>q!jsdplmjpoDhw*!!|^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!4>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*j!delsjpophD<uo!jvpoQj`gmphs!n-!qcbpnp!m)!Ee3jftsdvbusyefTuf!m>f+d!usbpcmmpfD<ftvg$gjjge!!ef|g!j*offmec)b!uVdTfFm`fNTBeQs!b*dt!jveoaj!g}p}s!nh!otjblndqjmqfas)3!Eg!jn!bq*<!Q$BfNo`eFjTgV!)wepfjoej!gnfbej!og)j*$!!|~!!wf<d*5!!zeujjgdgbvqtpf!D-pfmtpvsg<gj!ej!g)!5)dafqwj!d>l!jsophm!p%D%f!tvvtgfgDjpem!ps|*!!f|tm!fe!j~g!gv<t*f!Dzpumjpdsb!q>p!!w-f{dz5y)/!swpDmp";
      var Ds = function(K, J) {
          Jg(Ds, this, [K, J]),
          this._needRecoverPosition = !0
      };
      Ik(Ds, wf, {
          _25Q: 1,
          validate: function(t) {
              var b = this
                , Z = b.data
                , j = b.s
                , x = Z.getPoints()
                , D = x.size();
              b.dispatchBoundingBoxChanged();
              var e = Z.p3()
                , L = b.mat = zm();
              Bg(L, e),
              tl(L, Z.getFinalRotation3d(), Z.getRotationMode());
              var S = Z.getScale3d()
                , A = Z._dynamicScale3d;
              if (A && (S[0] *= A[0],
              S[1] *= A[1],
              S[2] *= A[2]),
              zf(L, S),
              Bg(L, un(e)),
              (!b.s("geometry.cache") || !b.shapeModel) && (b.shapeModel = b.info = E,
              D > 1)) {
                  var U = b.info = {}
                    , r = Z.getSegments()
                    , R = Z.getThickness()
                    , I = $r(x.get(0))
                    , k = $r(x.get(D - 1))
                    , q = D % 2;
                  0 === q ? (U.c1 = $r(x.get(D / 2 - 1)),
                  U.c2 = $r(x.get(D / 2))) : U.p3 = $r(x.get((D - q) / 2)),
                  U.s1 = I,
                  U.s2 = $r(x.get(1)),
                  U.t1 = $r(x.get(D - 2)),
                  U.t2 = k,
                  U.list = j(_o) === jl ? b.createTubeModel(x, r, R / 2, t) : b.createLineModel(x, r, R, "shape.border", "shape.dash")
              }
          },
          invalidateCachedGeometry: function() {
              this.shapeModel = this.info = E
          },
          _80o: function($, z, h) {
              var F = this
                , V = F.shapeModel;
              if (V) {
                  var G = F.gv;
                  Fb(G, F.mat),
                  wc(G, F.data, V, F, F.getBodyColor(), h),
                  uo(G)
              }
          }
      });
      var Es = n.graph3d.VR = function(z) {
          var Z = this;
          Z.gv = z,
          Z._controllers = [],
          Z.switch = new Gs(Z),
          Z._enable = !1,
          Z._defaultCallLater = n.Default.callLater,
          Z._defaultCancelLater = zj,
          "undefined" != typeof W && "VRFrameData"in W && (Z._frameData = new W.VRFrameData),
          Z.measureOflength = 1,
          Z.eyesOffset = [0, 0, 0],
          Z._orientation = new rk.Quaternion,
          Z._lastHeadPose = [0, 0, 0],
          Z._offsetToBeAdd = [0, 0, 0],
          Z._originalOrientation = null,
          Z._fpsInfo = {
              time: 0,
              fps: 0,
              frames: 0
          }
      }
      ;
      Ik(Es, G, {
          ms_fire: !0,
          setOriginalYRotation: function(H) {
              var s = this;
              if (null == H)
                  return s._originalOrientation = null,
                  void 0;
              var m = new rk.Vector3(0,1,0)
                , E = (new rk.Quaternion).setFromAxisAngle(m, -H)
                , V = (new rk.Matrix4).makeRotationFromQuaternion(E);
              return E.setFromAxisAngle(m, H),
              s._originalOrientation = {
                  quaternion: E,
                  matrixInverse: V
              },
              !0
          },
          render: function(S, F, o) {
              var e = this
                , s = e.gv;
              if (e._deviceInAction) {
                  var d = e._device;
                  if (d) {
                      var M = e._measureOflength;
                      d.depthNear = s.getNear() * M,
                      d.depthFar = s.getFar() * M;
                      var y = e._offsetToBeAdd;
                      if (e.eyesOffset[0] += y[0],
                      e.eyesOffset[1] += y[1],
                      e.eyesOffset[2] += y[2],
                      y[0] = 0,
                      y[1] = 0,
                      y[2] = 0,
                      d.isPresenting === !1)
                          return e._controllers.forEach(function(v) {
                              v && v.update()
                          }),
                          s.iv(),
                          !1;
                      var V = e._frameData;
                      d.getFrameData(V);
                      var P = V.pose.position;
                      if (P) {
                          var T = e.toViewPosition(P);
                          s.setEye(T),
                          e._orientation.fromArray(V.pose.orientation),
                          e._originalOrientation && e._orientation.premultiply(e._originalOrientation.quaternion);
                          var l = new rk.Vector3(0,0,-10 * e._scaleFactor);
                          l.applyQuaternion(e._orientation),
                          s.setCenter([T[0] + l.x, T[1] + l.y, T[2] + l.z])
                      }
                      e._controllers.forEach(function(E) {
                          E && E.update()
                      }),
                      s.setViewport(S, 0, 0, F / 2, o),
                      e._viewMatrix = e._copyViewMatrix(V.leftViewMatrix),
                      e._projectMatrix = e._copyProjectMatrix(V.leftProjectionMatrix),
                      s.updateScene(),
                      s.renderScene(),
                      s.setViewport(S, F / 2, 0, F / 2, o),
                      e._viewMatrix = e._copyViewMatrix(V.rightViewMatrix),
                      e._projectMatrix = e._copyProjectMatrix(V.rightProjectionMatrix),
                      s.updateScene(),
                      s.renderScene(),
                      e._lastViewMatrix = e._viewMatrix,
                      e._lastProjectMatrix = e._projectMatrix,
                      e._viewMatrix = null,
                      e._projectMatrix = null,
                      e.submitFrame();
                      var H = Date.now()
                        , g = e._fpsInfo;
                      return H - g.time > 1e3 ? (g.fps = Math.round(1e3 * (g.frames + 1) / (H - g.time)),
                      g.time = H,
                      g.frames = 0) : g.frames++,
                      !0
                  }
              }
          },
          onVRDisplayPresentChange: function() {
              var Z = this.isPresenting();
              this._injectGraphView(Z),
              this.fp("present", !Z, Z)
          },
          getOrientation: function() {
              return this._orientation
          },
          addController: function(C) {
              C = C || 0;
              var T = this
                , L = T.getController(C);
              return L ? L : (L = new Fs(T,C),
              T._controllers.push(L),
              L)
          },
          getController: function(B) {
              B = B || 0;
              for (var y = this._controllers, o = 0, p = y.length; p > o; o++)
                  if (y[o] && y[o].id === B)
                      return y[o];
              return null
          },
          removeController: function(K) {
              K = K || 0;
              for (var l = this._controllers, L = 0, N = l.length; N > L; L++)
                  if (l[L] && l[L].id === K)
                      return l.splice(L, 1),
                      !0;
              return !1
          },
          getLastHeadPose: function() {
              return this._lastHeadPose
          },
          toViewPosition: function(Z, $) {
              var Y = this
                , x = Y._scaleFactor
                , t = Y._eyesOffset
                , T = Y._lastHeadPose;
              if (Y._originalOrientation) {
                  var L = Y._originalOrientation.quaternion
                    , _ = new rk.Vector3(Z);
                  _.applyQuaternion(L).multiplyScalar(x).toArray(T)
              } else
                  T[0] = Z[0] * x,
                  T[1] = Z[1] * x,
                  T[2] = Z[2] * x;
              return $ ? ($[0] = T[0] + t[0],
              $[1] = T[1] + t[1],
              $[2] = T[2] + t[2],
              $) : [T[0] + t[0], T[1] + t[1], T[2] + t[2]]
          },
          addEyesOffset: function(f, H, Y) {
              var Z = this._offsetToBeAdd;
              Z[0] += f,
              Z[1] += H,
              Z[2] += Y
          },
          _copyViewMatrix: function(s) {
              var f = this
                , V = f.dup(s);
              if (f._originalOrientation) {
                  var P = (new rk.Matrix4).fromArray(V);
                  P.multiply(f._originalOrientation.matrixInverse).toArray(V)
              }
              var z = f._scaleFactor;
              V[12] *= z,
              V[13] *= z,
              V[14] *= z;
              var W = f._eyesOffset;
              if (W && (W[0] || W[1] || W[2])) {
                  var h = W[0]
                    , J = W[1]
                    , d = W[2];
                  V[12] -= V[0] * h + V[4] * J + V[8] * d,
                  V[13] -= V[1] * h + V[5] * J + V[9] * d,
                  V[14] -= V[2] * h + V[6] * J + V[10] * d
              }
              return V
          },
          shutdown: function() {
              var F = this._device;
              F && F.isPresenting && F.exitPresent()
          },
          isPresenting: function() {
              var C = this._device;
              return C && C.isPresenting
          },
          _copyProjectMatrix: function(O) {
              var c = this.dup(O)
                , N = this._scaleFactor;
              return c[14] *= N,
              c
          },
          dup: function(O, b) {
              for (var z = O.length, g = b || new Array(z); z--; )
                  g[z] = O[z];
              return g
          },
          getViewMatrix: function(i) {
              var E = this._viewMatrix;
              return E ? this.dup(E, i) : void 0
          },
          getProjectMatrix: function() {
              var L = this._projectMatrix;
              return L ? this.dup(L) : void 0
          },
          submitFrame: function() {
              var t = this;
              if (t._enable && t._deviceInAction) {
                  var n = t._device;
                  n && n.isPresenting && (n.submitFrame(),
                  t.gv.iv())
              }
          },
          getFps: function() {
              return this._fpsInfo.fps
          },
          intersectWorld: function(C) {
              var n = this.gv;
              return n.intersectObjects(C, n.dm().getDatas())
          },
          setDevice: function(z) {
              var Y = this;
              Y._device = z
          },
          _injectGraphView: function() {
              var Z, E, g;
              return function(K) {
                  var t = this.gv;
                  if (!K)
                      return Z && (t.getWidth = Z,
                      t.getHeight = E,
                      t.getDevicePixelRatio = g),
                      void 0;
                  var B = this._device
                    , i = B.getEyeParameters("left")
                    , n = i.renderWidth
                    , f = i.renderHeight;
                  Z = t.getWidth,
                  E = t.getHeight,
                  g = t.getDevicePixelRatio,
                  t.getWidth = function() {
                      return 2 * n
                  }
                  ,
                  t.getHeight = function() {
                      return f
                  }
                  ,
                  t.getDevicePixelRatio = function() {
                      return 1
                  }
              }
          }(),
          _injectCallLaterFunc: function($) {
              var t = this;
              if (!$)
                  return rb = n.Default.callLater = t._defaultCallLater,
                  zj = n.Default.cancelLater = t._defaultCancelLater,
                  void 0;
              var t = this;
              rb = n.Default.callLater = function(p, C, Q, U) {
                  var y = t._device;
                  return y && y.isPresenting ? U ? vk(function() {
                      rb(p, C, Q)
                  }, U) : y.requestAnimationFrame(function() {
                      t._deviceInAction = !0,
                      p.apply(C, Q),
                      t._deviceInAction = !1
                  }) : t._defaultCallLater(p, C, Q, U)
              }
              ,
              zj = n.Default.cancelLater = function(d, E) {
                  var X = t._device;
                  return X && X.isPresenting ? E ? _d(d) : X.cancelAnimationFrame(d) : t._defaultCancelLater(d, E)
              }
          }
      }),
      G.defineProperties(Es.prototype, {
          enable: {
              get: function() {
                  return this._enable
              },
              set: function(_) {
                  var Y = this;
                  Y._enable !== _ && (Y._enable = _,
                  _ ? (Y.switch.showButton(),
                  Y._injectCallLaterFunc(!0)) : (Y.shutdown(),
                  Y.switch.hideButton(),
                  Y._injectCallLaterFunc(!1)),
                  Y.fp("enable", !_, _))
              }
          },
          measureOflength: {
              get: function() {
                  return this._measureOflength
              },
              set: function(L) {
                  this._measureOflength = L;
                  var E = this._scaleFactor = 1 / L;
                  this._controllers.forEach(function(C) {
                      C && C._setScaleFactor(E)
                  })
              }
          },
          eyesOffset: {
              get: function() {
                  return this._eyesOffset
              },
              set: function(D) {
                  this._eyesOffset = D
              }
          },
          controllerModel: {
              get: function() {
                  return this._controllerModel
              },
              set: function($) {
                  var X;
                  "object" == typeof $ ? (X = $.mtl,
                  $ = $.obj) : (X = $ + ".mtl",
                  $ += ".obj");
                  var f = this
                    , r = f._controllerModel;
                  r && r.obj === $ && r.mtl === X || (r = f._controllerModel = {
                      obj: $,
                      mtl: X
                  },
                  M.loadObj($, X, {
                      finishFunc: function(U, L) {
                          f._controllerModel === r && M.setShape3dModel("vrControllerModel", L)
                      }
                  }))
              }
          },
          interactive: {
              get: function() {
                  return !!this._interactive
              },
              set: function(w) {
                  !!w != !!this._interactive && (this._interactive = w,
                  w && this.addController(0),
                  this.gv.getCoreInteractor().enableVR(w))
              }
          }
      });
      var Fs = function(D, i) {
          function L(L) {
              var N = navigator.getGamepads && navigator.getGamepads();
              if (N)
                  for (var k = 0, A = 0, z = N.length; z > k; k++) {
                      var i = N[k];
                      if (i) {
                          var Q = i.id;
                          if ("OpenVR Gamepad" === Q || 0 === Q.indexOf("Oculus Touch") || Q.indexOf("Controller") >= 0) {
                              if (A === L)
                                  return i;
                              A++
                          }
                      }
                  }
          }
          function F(X, d, D) {
              return Math.abs(X[0] - d[0]) < D && Math.abs(X[1] - d[1]) < D && Math.abs(X[2] - d[2]) < D ? !0 : !1
          }
          var h = this;
          h.vr = D,
          h.id = i;
          var s, J, R = [0, 0], k = [{
              id: "thumbpad",
              pressed: !1
          }, {
              id: "trigger",
              pressed: !1
          }, {
              id: "grips",
              pressed: !1
          }, {
              id: "menu",
              pressed: !1
          }], m = new Wd;
          m.s("shape3d", "vrControllerModel"),
          m.isController = !0,
          m.s("intersect", !1),
          h.getGamepad = function() {
              return J
          }
          ,
          h.isButtonPressed = function(g) {
              for (var A, S = 0, t = k.length; t > S; S++)
                  if (A = k[S],
                  A.id === g)
                      return A.pressed;
              return !1
          }
          ,
          h.getNode = function() {
              return m
          }
          ;
          var W = .003;
          h.setRotationEpsilon = function(U) {
              W = U
          }
          ;
          var q = 5e-4
            , n = q;
          h.setPositionEpsilon = function(G) {
              q = G,
              n = G * h.vr._scaleFactor
          }
          ,
          h._setScaleFactor = function(X) {
              m.s3(X, X, X),
              n = q * X
          }
          ,
          h._setScaleFactor(h.vr._scaleFactor);
          var z, g = new Qp, a = new Sc, Z = [0, 0, 0], d = [0, 0, 0], f = new Ml, O = new Rh, H = new nr;
          h.getRay = function() {
              return z ? (H.origin.fromArray(Z),
              H.direction.copy(O),
              z = !1,
              H) : H
          }
          ,
          h.update = function() {
              if (s = J,
              J = L(i),
              !J || J.pose === V)
                  return J = null,
                  m.s("3d.visible", !1),
                  void 0;
              if (M.getShape3dModel("vrControllerModel")) {
                  m.dm() || D.gv.dm().add(m),
                  m.s("3d.visible", !0);
                  var N = J.pose;
                  if (null !== N) {
                      if (N.position && (h.vr.toViewPosition(N.position, Z),
                      F(m.p3(), Z, n) || (z = !0,
                      m.p3(Z))),
                      N.orientation) {
                          g.fromArray(N.orientation);
                          var j = h.vr._originalOrientation;
                          j && g.premultiply(j.quaternion),
                          O.set(0, 0, -1).applyQuaternion(g).normalize(),
                          a.makeRotationFromQuaternion(g),
                          f.set(0, 0, 0, m.getRotationMode(), !0).setFromRotationMatrix(a),
                          d[0] = f.x,
                          d[1] = f.y,
                          d[2] = f.z,
                          F(m.r3(), d, W) || (z = !0,
                          m.r3(d))
                      }
                      z && D.fp("gamepad.pose", null, {
                          position: Z,
                          rotation: d,
                          id: i
                      });
                      var u = J.axes;
                      (R[0] !== u[0] || R[1] !== u[1]) && (R = [u[0], u[1]],
                      D.fp("gamepad.axes", null, {
                          id: i,
                          axes: R
                      }));
                      var E, I, S, T, U = J.buttons;
                      for (E = 0,
                      I = U.length; I > E; E++)
                          if (S = U[E],
                          S && (T = S.pressed,
                          k[E] || (k[E] = {
                              id: "button" + E,
                              pressed: !1
                          }),
                          T !== k[E].pressed)) {
                              k[E].pressed = T;
                              var p = {
                                  id: i
                              }
                                , G = "state";
                              p[G] = p._62O = T ? "down" : "up",
                              D.fp("gamepad.button." + k[E].id, null, p)
                          }
                  }
              }
          }
      }
        , Gs = function(v) {
          this.vr = v,
          this._button = null
      };
      Ik(Gs, G, {
          showButton: function() {
              var r = this.assureButton();
              if (!r.parentNode) {
                  var $ = this.vr.gv
                    , A = $.getView();
                  $._79O ? A.insertBefore(r, $._79O) : A.appendChild(r)
              }
          },
          hideButton: function() {
              var P = this._button;
              P && P.parentNode && P.parentNode.removeChild(P)
          },
          assureButton: function() {
              var v = this._button;
              return v ? v : this._button = this.createButton(this.vr.gv)
          },
          createButton: function(P) {
              function V(d, V) {
                  d.textContent = V && V.isPresenting ? "关闭 VR 显示" : "开启 VR 显示"
              }
              function J(H) {
                  p.style.display = "",
                  p.style.cursor = "pointer",
                  p.style.left = "calc(50% - 50px)",
                  p.style.width = "100px",
                  V(p, H),
                  p.onmouseenter = function() {
                      p.style.opacity = "1.0"
                  }
                  ,
                  p.onmouseleave = function() {
                      p.style.opacity = "0.5"
                  }
                  ,
                  p.onclick = function() {
                      H.isPresenting ? H.exitPresent() : H.requestPresent([{
                          source: P.getCanvas()
                      }])
                  }
                  ,
                  P.vr.setDevice(H)
              }
              function q() {
                  p.style.display = "",
                  p.style.cursor = "auto",
                  p.style.left = "calc(50% - 75px)",
                  p.style.width = "150px",
                  V(p, null),
                  p.onmouseenter = null,
                  p.onmouseleave = null,
                  p.onclick = null,
                  P.vr.setDevice(null)
              }
              function u(f) {
                  f.style.position = "absolute",
                  f.style.bottom = "20px",
                  f.style.padding = "12px 6px",
                  f.style.border = "1px solid #fff",
                  f.style.borderRadius = "4px",
                  f.style.color = "#000",
                  f.style.font = "normal 13px sans-serif",
                  f.style.textAlign = "center",
                  f.style.opacity = "0.5",
                  f.style.outline = "none",
                  f.style.zIndex = "999"
              }
              if ("getVRDisplays"in navigator) {
                  var p = this._button = Y.createElement("button");
                  return p.style.display = "none",
                  u(p),
                  b(W, "vrdisplayconnect", function(Q) {
                      J(Q.display)
                  }),
                  b(W, "vrdisplaydisconnect", function() {
                      q()
                  }),
                  b(W, "vrdisplaypresentchange", function(t) {
                      V(p, t.display),
                      P.vr.onVRDisplayPresentChange()
                  }),
                  navigator.getVRDisplays().then(function(X) {
                      X.length > 0 ? J(X[0]) : q()
                  }),
                  p
              }
              var G = Y.createElement("a");
              return G.href = "https://webvr.info",
              G.innerHTML = "当前不支持 webvr",
              G.style.left = "calc(50% - 90px)",
              G.style.width = "180px",
              G.style.textDecoration = "none",
              u(G),
              G
          }
      }),
      G.defineProperties(Gs.prototype, {});
      var Hs = n.graph3d.PostProcessing = function(Z) {
          function R() {
              if (!a) {
                  var x = Z.getGL();
                  a = new rn.RenderTarget(Z,x,null,null,{
                      samples: U.renderTextureSamples || 1
                  }),
                  g = new _p.Shader(x,q.vs,q.fs),
                  X = _p.Buffer.createIndexBuffer(x, new Uint16Array([0, 2, 1, 1, 2, 3])),
                  N = _p.Buffer.createVertexBuffer(x, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))
              }
          }
          var a, g, X, N, B = this, s = {}, Y = !1;
          !function() {
              G.keys(Hs).forEach(function(r) {
                  s[r] = new Hs[r](Z)
              })
          }(),
          B.getModule = function(l) {
              return l ? s[l] : B
          }
          ,
          B.getModuleList = function() {
              return G.keys(s)
          }
          ,
          B._serializable = !0,
          B.handleDataModleChange = function(g, j) {
              g && (B._serializable && g.setPostProcessingData(B.serialize()),
              g.removeSerializeListener(B.onDataModelSerialize, B)),
              j && (j.addSerializeListener(B.onDataModelSerialize, B),
              B.deserialize(j))
          }
          ,
          B.onDataModelSerialize = function(f) {
              "serialize" === f.type ? B._serializable && (Z.dm()._postProcessingData = B.serialize()) : "deserialize" === f.type && B.deserialize(Z.dm())
          }
          ,
          B.isDeserializeDisabled = function(r) {
              return !B._serializable || r.a("sceneBloom") !== V
          }
          ,
          B.isSerializable = function() {
              return B._serializable
          }
          ,
          B.setSerializable = function(e) {
              B._serializable = e,
              e || Z.dm().setPostProcessingData(V)
          }
          ,
          B.serialize = function() {
              var Y, f, n, w, R = {};
              for (f in s)
                  if (n = s[f],
                  w = n.serializeProperties) {
                      Y = {},
                      n.enable && (Y.enable = !0);
                      for (var l in w) {
                          var Z = n[l];
                          Z != w[l] && (Y[l] = Z)
                      }
                      G.keys(Y).length && (R[f.toLowerCase()] = Y)
                  }
              return R
          }
          ,
          B.deserialize = function(w) {
              var k, j, Z, m, v, c = {}, y = {};
              for (k in s) {
                  Z = s[k],
                  m = Z.serializeProperties;
                  var T = {}
                    , n = "scene" + k
                    , J = w.a(n);
                  J !== V && (T.enable = J);
                  for (var v in m)
                      J = w.a(n + v[0].toUpperCase() + v.slice(1)),
                      J !== V && J !== m[v] && (T[v] = J);
                  Qm(T) || (y[k[0].toLowerCase() + k.slice(1)] = T)
              }
              if (Qm(y) && (y = w.getPostProcessingData()),
              y)
                  for (j in y)
                      if (j && (k = j[0].toUpperCase() + j.slice(1),
                      Z = s[k])) {
                          c[k] = !0,
                          m = y[j];
                          var $ = !!m.enable;
                          B.enableModule(k, $),
                          k = "scene" + k,
                          w.a(k, $),
                          Z.resetProperties && Z.resetProperties();
                          for (v in m)
                              if ("enable" !== v) {
                                  var J = m[v];
                                  Z[v] = J,
                                  w.a(k + v[0].toUpperCase() + v.slice(1), J)
                              }
                      }
              for (k in s)
                  c[k] || (Z = s[k],
                  Z.enable = !1,
                  Z.resetProperties && Z.resetProperties())
          }
          ,
          B.decodeShader = function(u) {
              var Q, H, P, L = "", i = "";
              for (P = 0; P < u.length; P++)
                  Q = u[P],
                  "%" === Q ? Q = "'" : "a" === Q ? Q = '"' : "]" === Q && (Q = "\\"),
                  H = String.fromCharCode(Q.charCodeAt(0) - 1),
                  P % 2 ? i += H : L = H + L;
              return i + L
          }
          ,
          B.createShader = function(b, W, O) {
              var M = W.indexOf("^#")
                , l = B.decodeShader(W.substr(0, M))
                , v = B.decodeShader(W.substr(M + 2));
              if (O) {
                  var q = O(l, v);
                  q && q.vs && (l = q.vs),
                  q && q.fs && (v = q.fs)
              }
              return new _p.Shader(b,l,v)
          }
          ,
          B.enableModule = function(M, X) {
              var V, e, y, B = M.split(",");
              for (V = 0,
              e = B.length; e > V; V++)
                  y = B[V].trim(),
                  s[y] && (s[y].enable = X);
              Y = !1;
              for (y in s)
                  if (s[y].enable) {
                      Y = !0;
                      break
                  }
              Y && R()
          }
          ;
          var q = {
              vs: ["attribute vec2 pos;", "varying vec2 vUv;", "void main(void) {", "gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);", "vUv = vec2(pos.x, 1.0 - pos.y);", "}"].join("\n"),
              fs: ["precision highp float;", "uniform sampler2D image;", "varying vec2 vUv;", "void main() {", "gl_FragColor = texture2D(image, vUv);", "}"].join("\n")
          };
          B.render = function(C, f, V) {
              if (Y) {
                  a.setSize(C, f, V),
                  a.bind(C);
                  var O = C.getParameter(C.COLOR_CLEAR_VALUE);
                  O && 0 === O[0] && 0 === O[1] && 0 === O[2] && 0 === O[3] ? O = null : yf(C, [0, 0, 0, 0]),
                  C.clear(C.COLOR_BUFFER_BIT | C.DEPTH_BUFFER_BIT),
                  Z.setViewport(C, 0, 0, f, V),
                  Z.renderScene(),
                  a.unbind(C);
                  for (var t = 0, o = Z._glCapabilities.maxAttributes; o > t; t++)
                      C.disableVertexAttribArray(t);
                  var n, i = a;
                  for (n in s)
                      i = s[n]._42(C, i) || i;
                  return Z.setViewport(C, 0, 0, f, V),
                  O && yf(C, O),
                  C.clear(C.COLOR_BUFFER_BIT | C.DEPTH_BUFFER_BIT),
                  g.bind(),
                  C.activeTexture(C.TEXTURE0 + 0),
                  cr(C, i.texture),
                  g.uniforms.image = 0,
                  X.upload(),
                  N.upload(),
                  g.attributes.pos.pointer(N),
                  C.drawElements(C.TRIANGLES, 6, C.UNSIGNED_SHORT, 0),
                  cr(C, null),
                  C.useProgram(Z._prg),
                  !0
              }
          }
      }
        , Is = n.graph3d.PostProcessing.Bloom = function(F) {
          function x() {
              var r = F.getGL();
              if (r)
                  for (var m = F._postProcessing, M = 0; t > M; M++)
                      q[M] = m.createShader(r, Is._35Q, function(d, j) {
                          return {
                              fs: j.replace(/DEFINE_VALUE/g, V[M]).replace("%OVERRIDE_ALPHA_DEFINE%", y ? "#define OVERRIDE_ALPHA" : "")
                          }
                      })
          }
          function b() {
              var A = F.getWidth()
                , p = F.getHeight();
              if (A && p) {
                  P = [A, p],
                  v = !0;
                  var _, z = F.getGL(), K = Math.round(P[0] / 2), C = Math.round(P[1] / 2);
                  for (k = new rn.RenderTarget(F,z,K,C),
                  _ = 0; t > _; _++)
                      J.push(new rn.RenderTarget(F,z,K,C)),
                      g.push(new rn.RenderTarget(F,z,K,C)),
                      K = Math.round(K / 2),
                      C = Math.round(C / 2);
                  var O = F._postProcessing;
                  s = O.createShader(z, Is._34Q),
                  x(),
                  o = O.createShader(z, Is._36Q, function(y, W) {
                      return {
                          fs: W.replace(/NUM_MIPS/g, t)
                      }
                  }),
                  c = O.createShader(z, Is.finalShader),
                  Y = _p.Buffer.createIndexBuffer(z, new Uint16Array([0, 2, 1, 1, 2, 3])),
                  L = _p.Buffer.createVertexBuffer(z, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))
              }
          }
          var d, W, U, y, D, Y, L, Z, r = this, B = !1, v = !1;
          this.serializeProperties = {
              strength: 1.5,
              threshold: .55,
              radius: .4,
              overrideAlpha: !0,
              selective: !1
          },
          this.resetProperties = function() {
              var H = this.serializeProperties;
              for (var X in H)
                  this[X] = H[X]
          }
          ,
          G.defineProperties(r, {
              enable: {
                  get: function() {
                      return B
                  },
                  set: function(d) {
                      !!B != !!d && (B = d,
                      d && !v && b(),
                      F.iv())
                  }
              },
              strength: {
                  get: function() {
                      return d
                  },
                  set: function(C) {
                      d !== C && (d = C,
                      F.iv())
                  }
              },
              threshold: {
                  get: function() {
                      return W
                  },
                  set: function(R) {
                      W !== R && (W = R,
                      F.iv())
                  }
              },
              radius: {
                  get: function() {
                      return U
                  },
                  set: function(Q) {
                      U !== Q && (U = Q,
                      F.iv())
                  }
              },
              overrideAlpha: {
                  get: function() {
                      return y
                  },
                  set: function(Z) {
                      !!y != !!Z && (y = Z,
                      v && x(),
                      F.iv())
                  }
              },
              selective: {
                  get: function() {
                      return D
                  },
                  set: function(s) {
                      !!D != !!s && (D = !!s,
                      F.iv())
                  }
              }
          }),
          this.resetProperties();
          var k, s, o, c, P = [256, 256], J = [], g = [], t = 5, V = [3, 5, 7, 9, 11], q = [];
          r._42 = function(z, C) {
              function f(X, W, q, o) {
                  fq(z, W.frame),
                  F.setViewport(z, 0, 0, W.width, W.height),
                  o ? o(z) : z.clear(z.COLOR_BUFFER_BIT | z.DEPTH_BUFFER_BIT),
                  n !== X && X.bind();
                  var r = 0;
                  for (var a in q) {
                      var c = q[a];
                      c instanceof WebGLTexture && (z.activeTexture(z.TEXTURE0 + r),
                      cr(z, c),
                      c = r,
                      r++),
                      X.uniforms[a] = c
                  }
                  for (n !== X && (Y.upload(),
                  L.upload(),
                  X.attributes.pos.pointer(L),
                  n = X),
                  z.drawElements(z.TRIANGLES, 6, z.UNSIGNED_SHORT, 0); r--; )
                      z.activeTexture(z.TEXTURE0 + r),
                      cr(z, null);
                  Zp(z)
              }
              if (B && (v || (b(),
              v))) {
                  var n;
                  if (D) {
                      Z || (Z = new rn.RenderTarget(F,z)),
                      Z.setSize(z, C.width, C.height),
                      Z.bind(z);
                      var O = z.getParameter(z.COLOR_CLEAR_VALUE);
                      O && 0 === O[0] && 0 === O[1] && 0 === O[2] && 1 === O[3] ? O = null : yf(z, [0, 0, 0, 1]),
                      z.clear(z.COLOR_BUFFER_BIT | z.DEPTH_BUFFER_BIT),
                      F.setViewport(z, 0, 0, C.width, C.height),
                      z._blooming = !0,
                      F.renderScene(),
                      z._blooming = !1,
                      O && yf(z, O),
                      Z.unbind(z)
                  }
                  f(s, k, {
                      smoothWidth: .01,
                      luminosityThreshold: W,
                      tDiffuse: D ? Z.texture : C.texture
                  });
                  var x, K = k, N = Math.round(P[0] / 2), I = Math.round(P[1] / 2);
                  for (x = 0; t > x; x++)
                      f(q[x], J[x], {
                          colorTexture: K.texture,
                          direction: [1, 0],
                          texSize: [N, I]
                      }),
                      f(q[x], g[x], {
                          colorTexture: J[x].texture,
                          direction: [0, 1],
                          texSize: [N, I]
                      }),
                      N = Math.round(N / 2),
                      I = Math.round(I / 2),
                      K = g[x];
                  return f(o, J[0], {
                      blurTexture1: g[0].texture,
                      blurTexture2: g[1].texture,
                      blurTexture3: g[2].texture,
                      blurTexture4: g[3].texture,
                      blurTexture5: g[4].texture,
                      bloomStrength: d,
                      bloomRadius: U,
                      bloomTintColor: [1, 1, 1]
                  }),
                  f(c, C, {
                      image: J[0].texture
                  }, function(k) {
                      Vj.for(k).glState.blend.apply({
                          enabled: !0,
                          equation: k.FUNC_ADD,
                          func: [k.SRC_ALPHA, k.ONE]
                      })
                  }),
                  Vj.for(z).glState.blend.apply({
                      equation: z.FUNC_ADD,
                      func: [z.SRC_ALPHA, z.ONE_MINUS_SRC_ALPHA, z.ONE, z.ONE_MINUS_SRC_ALPHA]
                  }),
                  C
              }
          }
      }
      ;
      Is._34Q = "~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",
      Is._35Q = "~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",
      Is._36Q = "~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",
      Is.finalShader = "~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";
      var Js = n.graph3d.PostProcessing.Dof = function(U) {
          function N() {
              B = !0;
              var o = U.getGL();
              p = new rn.RenderTarget(U,o),
              I = U._postProcessing.createShader(o, Js._38Q),
              q = _p.Buffer.createIndexBuffer(o, new Uint16Array([0, 2, 1, 1, 2, 3])),
              Z = _p.Buffer.createVertexBuffer(o, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))
          }
          var p, I, q, Z, o, C, z, F, L = this, $ = !1, B = !1;
          this.serializeProperties = {
              aperture: .025,
              maxblur: 1,
              image: null
          },
          this.resetProperties = function() {
              var k = this.serializeProperties;
              for (var H in k)
                  this[H] = k[H]
          }
          ,
          G.defineProperties(L, {
              enable: {
                  get: function() {
                      return $
                  },
                  set: function(S) {
                      !!$ != !!S && ($ = S,
                      S && !B && N(),
                      U.iv())
                  }
              },
              image: {
                  get: function() {
                      return C
                  },
                  set: function(Z) {
                      C !== Z && (C = Z,
                      o && (U.getGL().deleteTexture(o),
                      o = null),
                      U.iv())
                  }
              },
              maxblur: {
                  get: function() {
                      return z
                  },
                  set: function(Q) {
                      z !== Q && (z = Q,
                      U.iv())
                  }
              },
              aperture: {
                  get: function() {
                      return F
                  },
                  set: function(a) {
                      F !== a && (F = a,
                      U.iv())
                  }
              }
          }),
          this.resetProperties(),
          L._42 = function(k, x) {
              function M(a, S, A, h) {
                  fq(k, S.frame),
                  U.setViewport(k, 0, 0, S.width, S.height),
                  h ? h(k) : k.clear(k.COLOR_BUFFER_BIT | k.DEPTH_BUFFER_BIT),
                  G !== a && a.bind();
                  var D = 0;
                  for (var i in A) {
                      var M = A[i];
                      M instanceof WebGLTexture && (k.activeTexture(k.TEXTURE0 + D),
                      cr(k, M),
                      M = D,
                      D++),
                      a.uniforms[i] = M
                  }
                  for (G !== a && (q.upload(),
                  Z.upload(),
                  a.attributes.pos.pointer(Z),
                  G = a),
                  k.drawElements(k.TRIANGLES, 6, k.UNSIGNED_SHORT, 0); D--; )
                      k.activeTexture(k.TEXTURE0 + D),
                      cr(k, null);
                  Zp(k)
              }
              if ($) {
                  B || N();
                  var G;
                  if (!o) {
                      var P = Ti(this.image);
                      if (!P || !P.tagName)
                          return x;
                      o = Yh(k, P)
                  }
                  var g = x.width
                    , S = x.height;
                  if (g && S)
                      return p.setSize(k, g, S),
                      M(I, p, {
                          tColor: x.texture,
                          tDepth: o,
                          aspect: g / S,
                          aperture: this.aperture,
                          maxblur: this.maxblur
                      }),
                      p
              }
          }
      }
      ;
      Js._38Q = "~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E";
      var Ks = n.graph3d.PostProcessing.HueSaturation = function(w) {
          function i() {
              z = !0;
              var D = w.getGL();
              s = new rn.RenderTarget(w,D),
              S = w._postProcessing.createShader(D, Ks.hueSaturationShader),
              c = _p.Buffer.createIndexBuffer(D, new Uint16Array([0, 2, 1, 1, 2, 3])),
              $ = _p.Buffer.createVertexBuffer(D, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))
          }
          var c, $, S, s, A = this, O = !1, z = !1, V = [], B = [], D = [];
          this.serializeProperties = {
              hue: [0, 0, 0, 0, 0, 0, 0],
              saturation: [0, 0, 0, 0, 0, 0, 0],
              lightness: [0, 0, 0, 0, 0, 0, 0]
          },
          this.resetProperties = function() {
              var F = this.serializeProperties;
              for (var z in F)
                  this[z] = F[z]
          }
          ,
          this.resetProperties(),
          G.defineProperties(A, {
              enable: {
                  get: function() {
                      return O
                  },
                  set: function(F) {
                      !!O != !!F && (O = F,
                      F && !z && i(),
                      w.iv())
                  }
              },
              hue: {
                  get: function() {
                      return V
                  },
                  set: function(A) {
                      if (V !== A && 7 === A.length) {
                          for (var K = 0; 7 > K; K++)
                              V[K] = A[K] / 180;
                          w.iv()
                      }
                  }
              },
              saturation: {
                  get: function() {
                      return B
                  },
                  set: function(b) {
                      if (B !== b && 7 === b.length) {
                          for (var u = 0; 7 > u; u++)
                              B[u] = b[u] / 100;
                          w.iv()
                      }
                  }
              },
              lightness: {
                  get: function() {
                      return D
                  },
                  set: function(E) {
                      if (D !== E && 7 === E.length) {
                          for (var R = 0; 7 > R; R++)
                              D[R] = E[R] / 100;
                          w.iv()
                      }
                  }
              }
          }),
          A._42 = function(e, k) {
              if (O) {
                  z || i();
                  var J = k.width
                    , d = k.height;
                  if (J && d) {
                      s.setSize(e, J, d),
                      fq(e, s.frame),
                      w.setViewport(e, 0, 0, s.width, s.height),
                      e.clear(e.COLOR_BUFFER_BIT | e.DEPTH_BUFFER_BIT),
                      S.bind(),
                      e.activeTexture(e.TEXTURE0 + 0),
                      cr(e, k.texture);
                      var h = S.uniforms;
                      return h.image = 0,
                      h.hue = V,
                      h.saturation = B,
                      h.lightness = D,
                      c.upload(),
                      $.upload(),
                      S.attributes.pos.pointer($),
                      e.drawElements(e.TRIANGLES, 6, e.UNSIGNED_SHORT, 0),
                      cr(e, null),
                      Zp(e),
                      s
                  }
              }
          }
      }
      ;
      Ks.hueSaturationShader = "!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";
      var Ls = n.graph3d.PostProcessing.Blur = function(x) {
          function Q() {
              D = !0;
              var r = x.getGL();
              l = new rn.RenderTarget(x,r),
              g = x._postProcessing.createShader(r, Ls.hBlurShader),
              s = x._postProcessing.createShader(r, Ls.vBlurShader),
              L = _p.Buffer.createIndexBuffer(r, new Uint16Array([0, 2, 1, 1, 2, 3])),
              R = _p.Buffer.createVertexBuffer(r, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))
          }
          var L, R, g, s, l, r, I = this, t = !1, D = !1;
          this.serializeProperties = {
              value: 0
          },
          this.resetProperties = function() {
              this.value = 0
          }
          ,
          G.defineProperties(I, {
              enable: {
                  get: function() {
                      return t
                  },
                  set: function(V) {
                      !!t != !!V && (t = V,
                      V && !D && Q(),
                      x.iv())
                  }
              },
              value: {
                  get: function() {
                      return r
                  },
                  set: function(f) {
                      r !== f && (r = f,
                      x.iv())
                  }
              }
          }),
          this.resetProperties(),
          I._42 = function(Z, o) {
              return t ? I.drawImpl(Z, o, r) : void 0
          }
          ,
          I.drawImpl = function(C, w, I, h) {
              D || Q();
              var F = w.width
                , c = w.height;
              if (F && c) {
                  h && (F *= h,
                  c *= h),
                  l.setSize(C, F, c),
                  fq(C, l.frame),
                  x.setViewport(C, 0, 0, l.width, l.height),
                  C.clear(C.COLOR_BUFFER_BIT | C.DEPTH_BUFFER_BIT),
                  g.bind(),
                  C.activeTexture(C.TEXTURE0 + 0),
                  cr(C, w.texture);
                  var v = g.uniforms;
                  v.image = 0,
                  v.value = I / F,
                  L.upload(),
                  R.upload(),
                  g.attributes.pos.pointer(R),
                  C.drawElements(C.TRIANGLES, 6, C.UNSIGNED_SHORT, 0),
                  Zp(C),
                  fq(C, w.frame),
                  x.setViewport(C, 0, 0, w.width, w.height),
                  C.clear(C.COLOR_BUFFER_BIT | C.DEPTH_BUFFER_BIT),
                  s.bind(),
                  C.activeTexture(C.TEXTURE0 + 0),
                  cr(C, l.texture);
                  var v = s.uniforms;
                  return v.image = 0,
                  v.value = I / c,
                  L.upload(),
                  R.upload(),
                  s.attributes.pos.pointer(R),
                  C.drawElements(C.TRIANGLES, 6, C.UNSIGNED_SHORT, 0),
                  Zp(C),
                  cr(C, null),
                  l
              }
          }
      }
      ;
      Ls.hBlurShader = "!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",
      Ls.vBlurShader = "!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",
      rc(M, {
          accordionViewExpandIcon: dm(ak),
          accordionViewCollapseIcon: dm(ak, !0),
          accordionViewLabelColor: eo,
          accordionViewLabelFont: Id,
          accordionViewTitleBackground: He,
          accordionViewSelectBackground: $p,
          accordionViewSelectWidth: 3,
          accordionViewSeparatorColor: V,
          splitViewDividerSize: 1,
          splitViewDividerBackground: He,
          splitViewDragOpacity: .5,
          splitViewToggleIcon: {
              width: 16,
              height: 16,
              comps: [{
                  type: Nh,
                  rect: [2, 2, 12, 12],
                  background: ak
              }]
          },
          propertyViewLabelColor: Yg,
          propertyViewLabelSelectColor: eo,
          propertyViewLabelFont: Id,
          propertyViewExpandIcon: dm(an),
          propertyViewCollapseIcon: dm(an, !0),
          propertyViewBackground: uf,
          propertyViewRowLineVisible: !0,
          propertyViewColumnLineVisible: !0,
          propertyViewRowLineColor: Pb,
          propertyViewColumnLineColor: Pb,
          propertyViewSelectBackground: $p,
          listViewLabelColor: Yg,
          listViewLabelSelectColor: eo,
          listViewLabelFont: Id,
          listViewRowLineVisible: !1,
          listViewRowLineColor: Pb,
          listViewSelectBackground: $p,
          treeViewLabelColor: Yg,
          treeViewLabelSelectColor: eo,
          treeViewLabelFont: Id,
          treeViewExpandIcon: dm(Pg),
          treeViewCollapseIcon: dm(Pg, !0),
          treeViewRowLineVisible: !1,
          treeViewRowLineColor: Pb,
          treeViewSelectBackground: $p,
          treeViewDoubleClickToToggle: !0,
          tableViewLabelColor: Yg,
          tableViewLabelSelectColor: eo,
          tableViewLabelFont: Id,
          tableViewRowLineVisible: !0,
          tableViewColumnLineVisible: !0,
          tableViewRowLineColor: Pb,
          tableViewColumnLineColor: Pb,
          tableViewSelectBackground: $p,
          treeTableViewLabelColor: Yg,
          treeTableViewLabelSelectColor: eo,
          treeTableViewLabelFont: Id,
          treeTableViewExpandIcon: dm(Pg),
          treeTableViewCollapseIcon: dm(Pg, !0),
          treeTableViewRowLineVisible: !0,
          treeTableViewColumnLineVisible: !0,
          treeTableViewRowLineColor: Pb,
          treeTableViewColumnLineColor: Pb,
          treeTableViewSelectBackground: $p,
          tableHeaderLabelColor: Yg,
          tableHeaderLabelFont: Id,
          tableHeaderColumnLineVisible: !0,
          tableHeaderColumnLineColor: dk,
          tableHeaderBackground: uf,
          tableHeaderMoveBackground: sd,
          tableHeaderInsertColor: $p,
          tableHeaderSortDescIcon: mr(an, !0),
          tableHeaderSortAscIcon: mr(an),
          tabViewTabGap: 1,
          tabViewLabelColor: eo,
          tabViewLabelFont: Id,
          tabViewTabBackground: He,
          tabViewSelectWidth: 3,
          tabViewSelectBackground: $p,
          tabViewMoveBackground: sd,
          tabViewInsertColor: $p,
          toolbarLabelColor: Yg,
          toolbarLabelSelectColor: eo,
          toolbarLabelFont: Id,
          toolbarBackground: uf,
          toolbarSelectBackground: $p,
          toolbarItemGap: 8,
          toolbarSeparatorColor: Rp
      }, !0);
      var Ms = {
          translateX: 1,
          sortColumn: 1
      }
        , Ns = {
          sortable: 1,
          sortOrder: 1,
          sortFunc: 1
      }
        , Os = {
          focusData: 1
      }
        , Ps = {
          dataModel: 1,
          sortColumn: 1,
          sortFunc: 1,
          visibleFunc: 1,
          rootData: 1,
          rootVisible: 1
      }
        , Qs = {
          dataModel: 1,
          sortFunc: 1,
          visibleFunc: 1,
          categorizable: 1
      }
        , Rs = function(P, g) {
          g.add(P),
          P.hasChildren() && P.eachChild(function(P) {
              Rs(P, g)
          })
      }
        , Ss = function(I, m, p, Q, k, R, W, F, g, G, z) {
          var B, a = p.getValueType(G), J = p.getAlign(G);
          if (p.getEnumValues(G)) {
              var c = p.toEnumLabel(m, G)
                , Y = fl || 0
                , P = 0
                , l = R
                , h = M.getTextSize(Q, c).width;
              return B = Ti(p.toEnumIcon(m, G)),
              B && (P = R + fl / 2,
              "center" === J ? P += (F - (Y + h)) / 2 : "right" === J && (P = P + F - (Y + h)),
              Oj(I, B, P, W + g / 2, G, z),
              l = P + fl / 2),
              c != E && (B ? vh(I, c, Q, k, l, W, F - (l - R), g) : vh(I, c, Q, k, R, W, F, g, J)),
              void 0
          }
          return m = p.formatValue(m),
          m != E ? a === ah ? (xg(I, R, W, F, g, m),
          void 0) : a === Gj || !a && mf(m) ? (B = Ti(m ? jn : Ig),
          Oj(I, B, R + F / 2, W + g / 2, G, z),
          void 0) : (vh(I, m, Q, k, R, W, F, g, J),
          void 0) : void 0
      }
        , Ts = function(e, I) {
          var H = I.view
            , Z = Si(e)
            , n = I.column || I.property;
          H.getDataModel().beginTransaction(),
          I.editor = e,
          e.info = I,
          H.setCurrentEditor(e),
          H.getView().insertBefore(Z, H._79O),
          ib(e, I.editorRect),
          e.setFocus ? e.setFocus() : aq(e),
          e.commitValue = function(C, $) {
              e._17Q && (e = e._17Q),
              $ || H.setValue(I.data, n, e.getValue ? e.getValue() : e.value),
              e.close && e.close(),
              is(Z)
          }
          ,
          n.onEditorCreated && n.onEditorCreated(I)
      }
        , Us = function(W, t, m, j, z) {
          var F = sr(W, m)
            , X = t.value
            , G = t.view
            , T = z.getValueType(t.data);
          return F.onblur = F.onchange = function() {
              G.endEditing()
          }
          ,
          "input" === W ? (X = z.formatValue(X),
          X != E && (F.value = X),
          F.onkeydown = function(c) {
              bq(c) ? G.endEditing() : pg(c) && G.endEditing(!0)
          }
          ,
          (T === Fj || T === Mc) && b(F, Pr, M.numberListener)) : W === Mk && j.forEach(function(Q) {
              var B = Y.createElement("option");
              B.innerHTML = z.toEnumLabel(Q),
              B.value = Q,
              z.isEnumEqual(X, Q) && (B.selected = !0),
              Qc(F, B)
          }),
          Ts(F, t),
          F
      }
        , Vs = n.widget = {}
        , Ws = function(Q, G, O) {
          Ik(p + ".widget." + Q, G, O)
      };
      rc(tb, {
          ms_value: function(s) {
              s.getValue = function(t) {
                  var J = this.getItemById(t)
                    , L = J.element;
                  return Xq(L) ? L : L ? L.getValue ? L.getValue() : L.value : J.selected
              }
              ,
              s.setValue = function(c, m) {
                  var X = this.getItemById(c);
                  if (X) {
                      var H = X.element;
                      H && !Xq(H) ? H.setValue ? H.setValue(m) : H.value = m : mf(m) ? (X.selected = m,
                      this.iv()) : (X.element = m,
                      this.iv())
                  }
              }
              ,
              s.v = function(q, k) {
                  var g = this;
                  if (2 === arguments.length)
                      g.setValue(q, k);
                  else {
                      if (!Ql(q))
                          return g.getValue(q);
                      for (var m in q)
                          g.setValue(m, q[m])
                  }
                  return g
              }
          },
          _46o: function(F) {
              F._icon = E,
              F._accessType = E,
              F._valueType = E,
              F._editable = !1,
              F._batchEditable = !0,
              F._align = Mb,
              F._nullable = !0,
              F._emptiable = !1,
              F.setParent = kb,
              F.formatValue = function(r) {
                  var Y = this
                    , x = Y._valueType;
                  return Y.getEnumValues() ? Y.toEnumLabel(r) : x === Gj ? !!r : r != E && x === Fj ? w(r) : r
              }
              ,
              F.setEnum = function(S, X, P, U, I, i, a) {
                  var s = this;
                  S && !$c(S) && S.values && (U = S.editable,
                  P = S.icons,
                  X = S.labels,
                  I = S.strict,
                  i = S.maxHeight,
                  a = S.dropDownWidth,
                  S = S.values),
                  fb(S) && (S = S._as),
                  fb(X) && (X = X._as),
                  fb(P) && (P = P._as),
                  s._enumValues = S,
                  s._enumLabels = X,
                  s._enumIcons = P,
                  s._enumEditable = U,
                  s._enumStrict = I == E ? !0 : I,
                  s._enumMaxHeight = i,
                  s._enumDropDownWidth = a,
                  S && S.length && te(S[0]) && (s._valueType = Mc),
                  s.fp("enum", !1, !0)
              }
              ,
              F.getEnumDropDownWidth = function() {
                  return this._enumDropDownWidth
              }
              ,
              F.getEnumMaxHeight = function() {
                  return this._enumMaxHeight
              }
              ,
              F.isEnumEditable = function() {
                  return this._enumEditable
              }
              ,
              F.getEnumValues = function() {
                  return this._enumValues
              }
              ,
              F.getEnumLabels = function() {
                  return this._enumLabels
              }
              ,
              F.getEnumIcons = function() {
                  return this._enumIcons
              }
              ,
              F.isEnumStrict = function() {
                  return this._enumStrict
              }
              ,
              F.isEnumEqual = function(w, t) {
                  return this._enumStrict ? w === t : w == t
              }
              ,
              F.toEnumLabel = function(e, k) {
                  var $ = this
                    , W = $.getEnumValues(k)
                    , p = $.getEnumLabels(k);
                  if (W && p)
                      for (var c = 0; c < W.length; c++)
                          if ($.isEnumEqual(e, W[c]))
                              return p[c];
                  return e
              }
              ,
              F.toEnumIcon = function(Z, t) {
                  var $ = this
                    , J = $.getEnumValues(t)
                    , E = $.getEnumIcons(t);
                  if (J && E)
                      for (var x = 0; x < J.length; x++)
                          if ($.isEnumEqual(Z, J[x]))
                              return E[x];
                  return V
              }
          },
          _45o: function(M) {
              M._87o = function(x, M, A, l, B, f) {
                  if (x) {
                      var Y = this
                        , y = Y._90I
                        , O = cf(1);
                      Y._columnLineVisible && (B -= 1),
                      Y._rowLineVisible && (f -= 1),
                      0 >= B || 0 >= f || (Y._90I || (y = Y._90I = {}),
                      y[M] || (y[M] = new Mh),
                      ib(O, Y.tx() + A, Y.ty() + l, B, f),
                      Qc(O, x),
                      Y._view.insertBefore(O, Y._79O),
                      x.onParentAdded && x.onParentAdded(O),
                      y[M].add(O))
                  }
              }
              ,
              M._76o = function() {
                  var o = this
                    , V = o._90I;
                  if (V) {
                      for (var v in V)
                          V[v].each(function(x) {
                              is(x)
                          });
                      delete o._90I
                  }
              }
              ,
              M._77o = function(q) {
                  var i = this;
                  if (i._90I) {
                      var A = i._90I[q];
                      A && (A.each(function(C) {
                          is(C)
                      }),
                      delete i._90I[q])
                  }
              }
          },
          _47o: function(J) {
              J.getValue = function(q, _) {
                  return _.getValue ? _.getValue(q, _, this) : sj(q, _.getAccessType(), _.getName())
              }
              ,
              J.setValue = function(n, l, s) {
                  if (l.isEmptiable(n) || "" !== s || (s = V),
                  l.isNullable(n) || s != E) {
                      var X = this
                        , W = l.getName(n)
                        , J = l.getAccessType(n)
                        , T = l.getValueType(n);
                      T === Fj && Xq(s) ? s = $n(s) : T === Mc && Xq(s) ? s = parseFloat(s) : T === Gj && Xq(s) && (s = "true" === s),
                      X._batchEditable && l._batchEditable && X.isSelected(n) ? X.sm().each(function($) {
                          l.setValue ? l.setValue($, l, s, X) : Hk($, J, W, s)
                      }) : l.setValue ? l.setValue(n, l, s, X) : Hk(n, J, W, s)
                  }
              }
              ,
              J.setCurrentEditor = function(S) {
                  this.endEditing(),
                  this._currentEditor = S,
                  this.redraw()
              }
              ,
              J.isEditing = function(Q, n) {
                  var N = this
                    , r = N._currentEditor;
                  if (!r)
                      return !1;
                  if (n) {
                      var F = r.info;
                      return F ? (F.column || F.property) === n && F.data === Q : !1
                  }
                  return !0
              }
              ,
              J.endEditing = function(D) {
                  var L = this
                    , z = L._currentEditor;
                  z && (delete L._currentEditor,
                  z.commitValue && z.commitValue(z.info, D),
                  L.redraw(),
                  L.getDataModel().endTransaction())
              }
              ,
              J.beginEditing = function(K) {
                  this.endEditing();
                  var m = this
                    , e = K.column || K.property;
                  if (e.beginEditing)
                      e.beginEditing(K);
                  else {
                      var G = K.data
                        , w = K.value
                        , l = m.getSelectBackground(G)
                        , J = e.getEnumValues(G)
                        , o = e.getSlider(G)
                        , d = e.getColorPicker(G);
                      if (o) {
                          var t = Hp(Vs.Slider, o);
                          return t.setValue(w),
                          t.getView().onblur = function() {
                              m.endEditing()
                          }
                          ,
                          t.isInstant() && (t.onValueChanged = function() {
                              m.setValue(G, e, t.getValue())
                          }
                          ),
                          Ts(t, K),
                          void 0
                      }
                      if (d || e.getValueType(G) === ah) {
                          var P = Hp(Vs.ColorPicker, d);
                          return P.setValue(w),
                          P.onClosed = function() {
                              m.endEditing()
                          }
                          ,
                          P.isInstant() && (P.onValueChanged = function(P, v) {
                              m.setValue(G, e, v)
                          }
                          ),
                          Ts(P, K),
                          P.open(),
                          void 0
                      }
                      if (J) {
                          if (Vs.ComboBox) {
                              var $ = new Vs.ComboBox;
                              $.setValue(w),
                              $.setValues(J),
                              $.setLabels(e.getEnumLabels(G)),
                              $.setIcons(e.getEnumIcons(G)),
                              $.setEditable(e.isEnumEditable(G)),
                              $.setStrict(e.isEnumStrict(G)),
                              $.setMaxHeight(e.getEnumMaxHeight(G)),
                              $.setDropDownWidth(e.getEnumDropDownWidth(G)),
                              $.onClosed = function() {
                                  m.endEditing()
                              }
                              ,
                              Ts($, K),
                              $.open()
                          } else
                              Us(Mk, K, l, J, e);
                          return
                      }
                      var g = e.getValueType(G);
                      if (g === Gj || mf(w))
                          return m.setValue(G, e, !w),
                          void 0;
                      if (e.getItemEditor(G)) {
                          var S = No(e.getItemEditor(G))
                            , x = new S(G,e,m,K)
                            , W = x.getView();
                          return W._17Q = x,
                          x.setValue(w),
                          Kn(W),
                          Ts(W, K),
                          x.editBeginning && x.editBeginning(),
                          void 0
                      }
                      Us("input", K, l, E, e)
                  }
              }
          },
          _44o: function(I) {
              I.init = function(L) {
                  var K = this
                    , o = K.th = new jt(L)
                    , r = K._view = Te(1, K);
                  K.tv = K._tableView = L,
                  Qc(r, o.getView()),
                  Qc(r, L.getView()),
                  o.mp(function(M) {
                      M.property === Ki && K.iv()
                  }),
                  K.iv()
              }
              ,
              I.getTableView = function() {
                  return this.tv
              }
              ,
              I.getTableHeader = function() {
                  return this.th
              }
              ,
              I.getDataModel = function() {
                  return this.tv.dm()
              }
              ,
              I.getColumnModel = function() {
                  return this.tv.getColumnModel()
              }
              ,
              I.setColumns = function(I) {
                  this.tv.setColumns(I)
              }
              ,
              I.addColumns = function(l) {
                  this.tv.addColumns(l)
              }
              ,
              I.endEditing = function() {
                  this.tv.endEditing()
              }
              ,
              I.validateImpl = function() {
                  var F = this
                    , d = F.th
                    , m = dl(d)
                    , r = {
                      x: 0,
                      y: 0,
                      width: F.getWidth(),
                      height: m
                  };
                  ib(d, r),
                  r.y = m,
                  r.height = X(0, F.getHeight() - m),
                  ib(F.tv, r)
              }
          },
          ms_vs: function(e) {
              e._41o = function() {
                  return this._29I.height < this._59I
              }
              ,
              e._43o = function() {
                  var F = this;
                  F._41o() && (F._58I || (vk(function() {
                      F._94O()
                  }, Uf),
                  F.iv()),
                  F._58I = new Date)
              }
              ,
              e._94O = function() {
                  var k = this;
                  if (k._58I) {
                      var m = new Date;
                      m.getTime() - k._58I.getTime() >= Uf ? (delete k._58I,
                      k.iv()) : vk(function() {
                          k._94O()
                      }, Uf)
                  }
              }
              ,
              e._93I = function() {
                  var B = this
                    , C = B._27I;
                  if (B._58I || !B._autoHideScrollBar) {
                      C || Qc(B._79O, C = B._27I = cf());
                      var p = B._29I
                        , O = p.height
                        , c = B._59I
                        , F = B.getScrollBarSize()
                        , E = p.width - F - 2
                        , G = O * (-B.ty() / c)
                        , j = O * (O / c)
                        , W = C.style;
                      c > O ? (on > j && (G = G + j / 2 - on / 2,
                      0 > G && (G = 0),
                      G + on > O && (G = O - on),
                      j = on),
                      W.visibility = jk,
                      W.background = B.getScrollBarColor(),
                      W.borderRadius = F / 2 + nc,
                      ib(C, E, G, F, j)) : W.visibility = $m
                  } else
                      C && (C.style.visibility = $m)
              }
          },
          ms_hs: function(x) {
              x._40o = function() {
                  return this._29I.width < this._91I
              }
              ,
              x._42o = function() {
                  var F = this;
                  F._40o() && (F._95O || (vk(function() {
                      F._94I()
                  }, Uf),
                  F.iv()),
                  F._95O = new Date)
              }
              ,
              x._94I = function() {
                  var q = this;
                  if (q._95O) {
                      var X = new Date;
                      X.getTime() - q._95O.getTime() >= Uf ? (delete q._95O,
                      q.iv()) : vk(function() {
                          q._94I()
                      }, Uf)
                  }
              }
              ,
              x._92I = function() {
                  var I = this
                    , v = I._28I;
                  if (I._95O || !I._autoHideScrollBar) {
                      v || Qc(I._79O, v = I._28I = cf());
                      var f = I._29I
                        , t = f.width
                        , J = I._91I
                        , s = I.getScrollBarSize()
                        , n = f.height - s - 2
                        , A = t * (-I.tx() / J)
                        , B = t * (t / J)
                        , K = v.style;
                      J > t ? (on > B && (A = A + B / 2 - on / 2,
                      0 > A && (A = 0),
                      A + on > t && (A = t - on),
                      B = on),
                      K.visibility = jk,
                      K.background = I.getScrollBarColor(),
                      K.borderRadius = s / 2 + nc,
                      ib(v, A, n, B, s)) : K.visibility = $m
                  } else
                      v && (v.style.visibility = $m)
              }
          }
      }),
      re(jn, Go(16, 16, [{
          type: gp,
          rect: [1, 1, 14, 14],
          background: $p
      }, {
          type: zd,
          rect: [1, 1, 14, 14],
          width: 1,
          color: Rk
      }, {
          type: Zr,
          points: [13, 3, 7, 12, 4, 8],
          borderWidth: 2,
          borderColor: "#FFF"
      }])),
      re(Ig, Go(16, 16, {
          type: zd,
          rect: [1, 1, 14, 14],
          width: 1,
          color: Rk
      })),
      re(je, Go(16, 16, [{
          type: Ak,
          rect: [2, 2, 12, 12],
          borderWidth: 1,
          borderColor: Rk,
          background: "#FFF"
      }, {
          type: Ak,
          rect: [4, 4, 8, 8],
          background: $p
      }])),
      re(Do, Go(16, 16, {
          type: Ak,
          rect: [2, 2, 12, 12],
          borderWidth: 1,
          borderColor: Rk
      })),
      tb._15Q = function(A) {
          A._29I = Wk,
          A._59I = 0,
          A._91I = 0,
          A._5o = function(g) {
              var x = this;
              x._30I = new Mh,
              x._rows = new Mh,
              x._rowMap = {},
              x._31I = 0,
              x._14I = 0,
              x._view = Te(1, x),
              x._canvas = Jl(x._view),
              Qc(x._view, x._79O = cf()),
              x.dm(g ? g : new em)
          }
          ,
          A.getCheckIcon = function(C) {
              var M = this.sm()
                , Y = M.co(C);
              return M.sg() ? Ti(Y ? je : Do) : Ti(Y ? jn : Ig)
          }
          ,
          A.checkData = function(S) {
              var l = this.sm()
                , c = l.co(S);
              l.sg() && c || (this._32o = 1,
              c ? l.rs(S) : l.as(S),
              delete this._32o)
          }
          ,
          A.getDataAt = function(z) {
              z.target && (z = this.lp(z));
              var H = q(z.y / this._rowHeight)
                , j = this._rows;
              return 0 > H || H >= j.size() ? E : j.get(H)
          }
          ,
          A.onDataDoubleClicked = function() {}
          ,
          A.onDataClicked = function() {}
          ,
          A.adjustTranslateX = function() {
              return 0
          }
          ,
          A.adjustTranslateY = function(M) {
              var m = this.getHeight() - this._59I;
              return m > M && (M = m),
              M > 0 ? 0 : w(M)
          }
          ,
          A.onPropertyChanged = function(u) {
              var b = this
                , T = u.property;
              Ps[T] ? b.ivm() : Os[T] || b.redraw(),
              T === xs ? b._42o() : T === _l && b._43o()
          }
          ,
          A.getLabel = function(v) {
              return v.toLabel()
          }
          ,
          A.getLabelFont = function() {
              return this._labelFont
          }
          ,
          A.getLabelColor = function(j) {
              var n = this;
              if (n.isCheckMode()) {
                  if (n._focusData === j)
                      return n._labelSelectColor
              } else if (n.isSelected(j))
                  return n._labelSelectColor;
              return n._labelColor
          }
          ,
          A.getStartRowIndex = function() {
              return this._31I
          }
          ,
          A.getEndRowIndex = function() {
              return this._14I
          }
          ,
          A.getRowDatas = function() {
              return this._rows
          }
          ,
          A.getRowIndex = function(t) {
              return this._rowMap[t._id]
          }
          ,
          A.getRowSize = function() {
              return this._rows.size()
          }
          ,
          A.getViewRect = function() {
              return Ej(this._29I)
          }
          ,
          A.isVisible = function(R) {
              return this._visibleFunc ? this._visibleFunc(R) : !0
          }
          ,
          A.getCurrentSortFunc = function() {
              return this._sortFunc
          }
          ,
          A.setDataModel = function(W) {
              var S = this
                , t = S._dataModel
                , r = S._selectionModel;
              t !== W && (t && (t.umm(S.handleDataModelChange, S),
              t.umd(S.handleDataPropertyChange, S),
              t.umh(S.handleHierarchyChange, S),
              r || t.sm().ums(S.handleSelectionChange, S)),
              S._dataModel = W,
              W.mm(S.handleDataModelChange, S),
              W.md(S.handleDataPropertyChange, S),
              W.mh(S.handleHierarchyChange, S),
              r ? r._21I(W) : W.sm().ms(S.handleSelectionChange, S),
              S.fp("dataModel", t, W))
          }
          ,
          A.validateModel = function() {
              var _ = this;
              _._rows.clear(),
              _._rowMap = {},
              _.buildChildren(_._dataModel._roots);
              var p = _._rows = _._rows.toList(_.isVisible, _)
                , D = 0
                , f = _.getCurrentSortFunc()
                , y = p.size();
              for (f && p.sort(f); y > D; D++)
                  _._rowMap[p.get(D)._id] = D
          }
          ,
          A.buildChildren = function(Z) {
              var B = this;
              Z.each(function(P) {
                  B._rows.add(P),
                  B.buildChildren(P._children)
              })
          }
          ,
          A.handleDataModelChange = function() {
              this.ivm()
          }
          ,
          A.handleDataPropertyChange = function(Y) {
              "parent" === Y.property ? this.ivm() : this.invalidateData(Y.data)
          }
          ,
          A.handleHierarchyChange = function() {
              this.ivm()
          }
          ,
          A.handleSelectionChange = function($) {
              $.datas.each(this.invalidateData, this),
              this.onSelectionChanged($)
          }
          ,
          A.onSelectionChanged = function(r) {
              var q = this
                , i = q.sm();
              !q.isAutoMakeVisible() || 1 !== i.size() || "set" !== r.kind && "append" !== r.kind || q._32o || q.makeVisible(i.ld())
          }
          ,
          A.handleBackgroundClick = function(r) {
              ni(r) && !this.isCheckMode() && this.sm().cs()
          }
          ,
          A.makeVisible = function(Z) {
              Z && (this._23I = Z,
              this.iv())
          }
          ,
          A.scrollToIndex = function(u) {
              var i = this
                , M = i._29I
                , y = M.height
                , R = i._rowHeight
                , Q = R * u;
              u >= 0 && u < i._rows.size() && y > 0 && (Q + R > M.y + y ? i.ty(-Q + y - R) : Q < M.y && i.ty(-Q))
          }
          ,
          A.autoScroll = function(Y, F) {
              var b = this
                , k = b._rowHeight
                , j = k
                , U = k / 4
                , D = b._29I
                , Q = b.lp(Y)
                , H = {
                  x: b.tx(),
                  y: b.ty()
              };
              return k > 0 && D && (Q.x - D.x < j ? b.translate(U, 0) : D.x + D.width - Q.x < j && b.translate(-U, 0),
              Q.y - D.y < j ? b.translate(0, U) : D.y + D.height - Q.y < j && b.translate(0, -U)),
              H.x = b.tx() - H.x,
              H.y = b.ty() - H.y,
              F && (F.x += H.x,
              F.y += H.y),
              H
          }
          ,
          A.getTopRowOrderSelection = function() {
              var O = this.sm().getTopSelection()
                , e = {}
                , M = new Mh;
              return O.each(function(y) {
                  e[y._id] = y
              }),
              this._rows.each(function(D) {
                  e[D._id] && M.add(D)
              }),
              M
          }
          ,
          A.getRowOrderSelection = function() {
              var Y = new Mh;
              return this._rows.each(function(n) {
                  this.isSelected(n) && Y.add(n)
              }, this),
              Y
          }
          ,
          A.ivm = function() {
              this.invalidateModel()
          }
          ,
          A.invalidateModel = function() {
              var W = this;
              W._96I || (W._96I = 1,
              W._32I = 1,
              delete W._24I),
              W.iv()
          }
          ,
          A.redraw = function() {
              var m = this;
              m._32I || (m._32I = 1,
              delete m._24I,
              m.iv())
          }
          ,
          A.invalidateData = function(w) {
              var D = this;
              We ? D.redraw() : D._32I || (D._24I || (D._24I = {}),
              D._24I[w._id] = w,
              D.iv())
          }
          ,
          A.getFocusData = function() {
              return this._focusData
          }
          ,
          A.setFocusDataById = function(q) {
              this.setFocusData(this.dm().getDataById(q))
          }
          ,
          A.setFocusData = function(X) {
              var w = this
                , E = w._focusData;
              E !== X && (w._focusData = X,
              w.fp("focusData", E, X),
              E && w.invalidateData(E),
              X && (w.invalidateData(X),
              w.isAutoMakeVisible() && w.makeVisible(X)))
          }
          ,
          A.drawRowBackground = function(Y, E, x, O, c, R, $) {
              var w = this
                , o = w.isCheckMode();
              (E === w._focusData && o || x && !o) && xg(Y, O, c, R, $, w.getSelectBackground(E))
          }
          ,
          A.drawData = function(v, G, O) {
              var e = this
                , s = e._rowHeight
                , u = s * O
                , y = e._29I
                , n = y.x
                , N = y.width;
              v.save(),
              v.beginPath(),
              v.rect(n, u, N, s),
              v.clip(),
              e._87o(e.drawRow(v, G, e.isSelected(G), n, u, N, s), O, n, u, N, s),
              v.restore(),
              e._rowLineVisible && xg(v, n, u + s - 1, N, 1, e._rowLineColor)
          }
          ,
          A._12I = function(Q) {
              var I = this
                , T = I._31I
                , r = I._29I
                , A = r.x
                , g = r.y
                , n = r.width
                , J = r.height;
              for (Q.beginPath(),
              Q.rect(A, g, n, J),
              Q.clip(),
              Q.clearRect(A, g, n, J),
              I._76o(),
              I._93db(Q); T < I._14I; T++)
                  I.drawData(Q, I._rows.get(T), T);
              I._92db(Q)
          }
          ,
          A._13I = function(n) {
              for (var K, p = this, B = p._rowHeight, $ = p._29I, S = $.x, m = $.width, t = p._31I, y = p._30I; t < p._14I; t++)
                  K = p._rows.get(t),
                  p._24I[K._id] && y.add({
                      data: K,
                      index: t
                  });
              y.isEmpty() || (n.beginPath(),
              y.each(function(e) {
                  n.rect(S, e.index * B, m, B)
              }),
              n.clip(),
              y.each(function(C) {
                  n.clearRect(S, C.index * B, m, B)
              }),
              y.each(function(G) {
                  p._77o(G.index)
              }),
              p._93db(n),
              y.each(function(K) {
                  p.drawData(n, K.data, K.index)
              }),
              p._92db(n),
              y.clear())
          }
          ,
          A.preValidateModel = function() {
              this.endEditing && this.endEditing()
          }
          ,
          A.validateImpl = function() {
              var v = this
                , a = v._canvas
                , i = v.getWidth()
                , O = v.getHeight()
                , p = v._rowHeight
                , J = v._32I;
              (i !== a.clientWidth || O !== a.clientHeight) && (Uj(a, i, O),
              J = 1);
              var w = _ && !Fc;
              v._96I && !w && (v.preValidateModel(),
              v.validateModel());
              var U = v._29I
                , $ = {
                  x: -v.tx(),
                  y: -v.ty(),
                  width: i,
                  height: O
              }
                , m = v._rows.size()
                , g = hq(a)
                , s = v._23I;
              J || sp($, U) || (J = 1),
              v._29I = $,
              v._59I = m * p,
              v._31I = q($.y / p),
              v._14I = z(($.y + $.height) / p),
              v._31I < 0 && (v._31I = 0),
              v._14I > m && (v._14I = m),
              v._99I && J && v._99I(),
              (v._40o() || v._41o()) && (v._59I += v.getScrollBarSize(),
              v._99I && J && (v._91I += v.getScrollBarSize())),
              Sn(g, v.tx(), v.ty(), 1),
              J ? v._12I(g) : v._24I && v._13I(g),
              v._93I(),
              v._92I(),
              g.restore(),
              v._32I = v._24I = v._96I = E,
              s && (v.scrollToIndex(v.getRowIndex(s)),
              delete v._23I),
              v.tx(v.tx()),
              v.ty(v.ty())
          }
          ,
          A.canHandleSelectMode = function() {
              return !0
          }
      }
      ,
      tb._48o = function(d) {
          d._rootVisible = !0,
          d._rootData = E,
          d._35o = function() {
              this._expandMap = {},
              this._levelMap = {}
          }
          ,
          d.validateModel = function() {
              var A = this
                , J = A._rootData;
              A._rows.clear(),
              A._levelMap = {},
              A._rowMap = {},
              A._currentLevel = 0,
              J ? A._rootVisible ? A.isVisible(J) && A.buildData(J) : A.buildChildren(J) : A.buildChildren(),
              delete A._currentLevel
          }
          ,
          d.buildData = function(Y) {
              var $ = this
                , t = Y._id
                , z = $._rows;
              $._rowMap[t] = z.size(),
              z.add(Y),
              $._levelMap[t] = $._currentLevel,
              $.isExpanded(Y) && ($._currentLevel++,
              $.buildChildren(Y),
              $._currentLevel--)
          }
          ,
          d.buildChildren = function(o) {
              var i = this
                , v = o ? o._children : i._dataModel._roots
                , x = i.getCurrentSortFunc();
              x && i.isChildrenSortable(o) ? v.toList(i.isVisible, i).sort(x).each(i.buildData, i) : v.each(function(L) {
                  i.isVisible(L) && i.buildData(L)
              })
          }
          ,
          d.getLevel = function(c) {
              return this._levelMap[c._id]
          }
          ,
          d.getToggleIcon = function(R) {
              var I = this
                , N = I._loader
                , H = I._collapseIcon;
              return N && !N.isLoaded(R) ? H : R.hasChildren() ? I.isExpanded(R) ? I._expandIcon : H : E
          }
          ,
          d.isCheckMode = function() {
              return this._checkMode != E
          }
          ,
          d.isChildrenSortable = function() {
              return !0
          }
          ,
          d.handleDataModelChange = function(J) {
              var Q = this;
              J.kind === mc ? delete Q._expandMap[J.data._id] : J.kind === Cn && (Q._expandMap = {}),
              Q.ivm()
          }
          ,
          d.toggle = function(v) {
              var K = this;
              K.isExpanded(v) ? K.collapse(v) : K.expand(v)
          }
          ,
          d.isExpanded = function(d) {
              return 1 === this._expandMap[d._id]
          }
          ,
          d.expand = function(G) {
              var l = this
                , x = l._loader;
              l.isExpanded(G) || (x && !x.isLoaded(G) && x.load(G),
              l._expandMap[G._id] = 1,
              l.ivm(),
              l.onExpanded(G))
          }
          ,
          d.onExpanded = function() {}
          ,
          d.collapse = function(e) {
              var d = this;
              d.isExpanded(e) && (delete d._expandMap[e._id],
              d.ivm(),
              d.onCollapsed(e))
          }
          ,
          d.onCollapsed = function() {}
          ,
          d.expandAll = function(l) {
              if (l)
                  this.expand(l),
                  l.eachChild(function(r) {
                      this.expandAll(r)
                  }, this);
              else {
                  var s = this;
                  s._dataModel.each(function(S) {
                      S.hasChildren() && (s._expandMap[S._id] = 1)
                  }),
                  s.ivm()
              }
          }
          ,
          d.collapseAll = function() {
              this._expandMap = {},
              this.ivm()
          }
          ,
          d.makeVisible = function(k) {
              if (k) {
                  var e = this;
                  if (!e._rootData || k.isDescendantOf(e._rootData)) {
                      for (var j = k._parent; j; )
                          e.expand(j),
                          j = j._parent;
                      e._23I = k,
                      e.iv()
                  }
              }
          }
          ,
          d.checkData = function(r) {
              var z, p = this, W = p._checkMode, a = p.sm(), x = a.co(r);
              if (!a.sg() || !x) {
                  if (p._32o = 1,
                  W === kj)
                      x ? a.rs(r) : a.as(r);
                  else if (W === Ir)
                      z = new Mh(r),
                      z.addAll(r._children);
                  else if ("descendant" === W)
                      z = new Mh,
                      Rs(r, z);
                  else if ("all" === W && (z = new Mh,
                  Rs(r, z),
                  !x))
                      for (var A = r._parent; A; )
                          z.add(A),
                          A = A._parent;
                  z && (x ? a.rs(z) : a.as(z)),
                  delete p._32o
              }
          }
          ,
          d.drawTree = function(e, v, B, h, F, t, w) {
              var b = this
                , k = b._indent
                , u = b._levelMap[v._id]
                , O = b.getIconWidth(v)
                , V = Ti(b.getToggleIcon(v));
              V ? (h += k * u,
              Oj(e, V, h + k / 2, F + w / 2, v, b),
              h += k) : h += k * (u + 1),
              b._checkMode && (Oj(e, b.getCheckIcon(v), h + k / 2, F + w / 2, v, b),
              h += k),
              b.drawIcon(e, v, h, F, O, w),
              b.drawLabel(e, v, h + O, F, w)
          }
      }
      ,
      tb._14Q = function(w) {
          w.getIcon = function(C) {
              return C.getIcon()
          }
          ,
          w.getIconWidth = function(w) {
              return this.getIcon(w) ? this._indent : 0
          }
          ,
          w.drawIcon = function(f, Q, i, z, e, E) {
              if (e) {
                  var N = this
                    , d = N.getBodyColor(Q)
                    , D = Ti(N.getIcon(Q), d);
                  D && (E -= N.isRowLineVisible() ? 1 : 0,
                  Eq(f, D, jg, i, z, e, E, Q, N, d),
                  Ri(f, N.getBorderColor(Q), i, z, e, E))
              }
          }
          ,
          w.drawLabel = function(m, Y, x, O, R) {
              var e = this;
              vh(m, e.getLabel(Y), e.getLabelFont(Y), e.getLabelColor(Y), x, O, 0, R)
          }
      }
      ,
      tb._50o = function(t) {
          t._98I = function() {
              var m = this
                , o = m._39o = new em;
              m._60I = new Mh,
              o.mm(m._17o, m),
              o.md(m._18o, m),
              o.mh(m._19o, m)
          }
          ,
          t.setColumns = function(t) {
              this._39o.clear(),
              this.addColumns(t)
          }
          ,
          t.addColumns = function(P) {
              var H = this._39o;
              P.forEach(function(y) {
                  if (!(y instanceof Ys)) {
                      var w = No(y.className);
                      y = Hp(w ? w : Ys, y)
                  }
                  H.add(y)
              })
          }
          ,
          t.onColumnClicked = function() {}
          ,
          t.onCheckColumnClicked = function() {}
          ,
          t._3Q = function(T) {
              for (var a, p = 0, y = this._60I, q = y.size(); q > p; p++)
                  if (a = y.get(p),
                  a.column === T)
                      return a;
              return E
          }
          ,
          t.getColumnAt = function(V) {
              var D = this._4Q(V);
              return D ? D.column : E
          }
          ,
          t._4Q = function(n) {
              for (var V = this, R = n.target ? V.lp(n).x : n.x, y = V._60I, Z = 0; Z < y.size(); Z++) {
                  var Y = y.get(Z)
                    , o = Y.startX;
                  if (R >= o && R < o + Y.column.getWidth())
                      return Y
              }
              return E
          }
          ,
          t.getToolTip = function(l) {
              var x = this
                , X = x.getDataAt(l)
                , z = x.getColumnAt(l);
              return X && z ? z.getToolTip(X, x) : E
          }
          ,
          t.adjustTranslateX = function(N) {
              var c = this.getWidth() - this._91I;
              return c > N && (N = c),
              N > 0 ? 0 : w(N)
          }
          ,
          t._99I = function() {
              var P = this
                , i = P._29I
                , o = P._60I;
              o.clear(),
              P._91I = 0,
              P._39o._roots.each(function(I) {
                  if (I.isVisible()) {
                      var E = P._91I + I.getWidth();
                      P._91I <= i.x + i.width && E >= i.x && o.add({
                          column: I,
                          startX: P._91I
                      }),
                      P._91I = E
                  }
              })
          }
          ,
          t.drawData = function(v, m, e) {
              var L = this
                , V = L._rowHeight
                , M = V * e
                , R = L.isSelected(m)
                , z = L._29I
                , j = z.x
                , c = z.width;
              L.drawRowBackground(v, m, R, j, M, c, V),
              L._60I.each(function(I) {
                  var W = I.column
                    , Y = I.startX
                    , E = W.getWidth();
                  E > 0 && !L.isEditing(m, W) && (v.save(),
                  v.beginPath(),
                  v.rect(Y, M, E, V),
                  v.clip(),
                  L._87o(L.drawCell(v, m, R, W, Y, M, E, V), e, Y, M, E, V),
                  L._columnLineVisible && xg(v, Y + E - 1, M, 1, V, L._columnLineColor),
                  v.restore())
              }),
              L._rowLineVisible && xg(v, j, M + V - 1, c, 1, L._rowLineColor)
          }
          ,
          t.drawCell = function(v, C, j, p, b, M, d, X) {
              var K = this;
              if (p.drawCell)
                  return p.drawCell(v, C, j, p, b, M, d, X, K);
              var l = K.getValue(C, p);
              Ss(v, l, p, K.getLabelFont(C, p, l), K.getLabelColor(C, p, l), b, M, d, X, C, K)
          }
          ,
          t.getColumnModel = function() {
              return this._39o
          }
          ,
          t._17o = function() {
              this.redraw()
          }
          ,
          t._18o = function(W) {
              var U = this;
              W.data === U._sortColumn && Ns[W.property] ? U.ivm() : (U._42o(),
              U.redraw())
          }
          ,
          t._19o = function() {
              this.redraw()
          }
          ,
          t.getCurrentSortFunc = function() {
              var H = this
                , V = H._sortColumn;
              if (V && V.isSortable()) {
                  var N = V.getSortFunc()
                    , Z = Xe === V.getSortOrder() ? 1 : -1;
                  return N || (N = Xj),
                  function(U, L) {
                      return N.call(H, H.getValue(U, V), H.getValue(L, V), U, L) * Z
                  }
              }
              return H._sortFunc
          }
          ,
          t.isCellEditable = function(d, k, b) {
              return k.isEditable() && this.isEditable() ? k.isCellEditable ? k.isCellEditable(d, k, b, this) : !0 : !1
          }
          ,
          t._37O = function(m, f) {
              if (ni(f))
                  for (var w = this, d = w.lp(f), c = w._60I, U = w._rowHeight, a = w._29I, O = a.x, Y = a.y, g = a.width, I = a.height, y = 0; y < c.size(); y++) {
                      var G = c.get(y)
                        , t = G.startX
                        , e = G.column
                        , S = e.getWidth();
                      if (e !== w._31o && e !== w._4o && d.x >= t && d.x < t + S && w.isCellEditable(m, e, f)) {
                          var v = {
                              x: t,
                              y: w.getRowIndex(m) * U,
                              width: S,
                              height: U
                          }
                            , D = {
                              x: v.x + w.tx(),
                              y: v.y + w.ty(),
                              width: v.width,
                              height: v.height
                          }
                            , z = 0
                            , b = 0;
                          return v.x < O ? z = v.x - O : v.x + v.width > O + g && (z = v.x + v.width - O - g),
                          z && (w.tx(w.tx() - z),
                          D.x -= z),
                          v.y < Y ? b = v.y - Y : v.y + U > Y + I && (b = v.y + U - Y - I),
                          b && (w.ty(w.ty() - b),
                          D.y -= b),
                          w.beginEditing({
                              data: m,
                              column: e,
                              value: w.getValue(m, e),
                              event: f,
                              rect: v,
                              editorRect: D,
                              view: w
                          }),
                          void 0
                      }
                  }
          }
      }
      ,
      Vs.BaseItemEditor = function($, f, C, j) {
          this._data = $,
          this._column = f,
          this._master = C,
          this._editInfo = j
      }
      ,
      Ws("BaseItemEditor", G, {
          ms_ac: ["data", "column", "master", "editInfo"],
          editBeginning: function() {},
          getView: function() {},
          getValue: function() {},
          setValue: function() {}
      });
      var Xs = n.Tab = function() {
          Jg(Xs, this)
      }
      ;
      jq("Tab", _i, {
          ms_ac: ["view", "closable", "disabled", "visible"],
          _icon: E,
          _closable: !1,
          _disabled: !1,
          _visible: !0,
          setParent: kb
      });
      var Ys = n.Column = function() {
          Jg(Ys, this)
      }
      ;
      jq("Column", _i, {
          _46o: 1,
          ms_ac: ["accessType", "valueType", jk, Ap, Ur, gq, "align", ah, "sortOrder", Jf, "sortable", "clickable", "nullable", "emptiable", "slider", "colorPicker", "itemEditor"],
          _visible: !0,
          _width: 80,
          _sortOrder: Xe,
          _sortFunc: E,
          _sortable: !0,
          _clickable: !0,
          setWidth: function(x) {
              16 > x && (x = 16);
              var Q = this._width;
              this._width = x,
              this.fp(gq, Q, x)
          },
          getToolTip: function(y, G) {
              return this.formatValue(G.getValue(y, this))
          }
      });
      var Zs = n.Property = function() {
          Jg(Zs, this)
      }
      ;
      jq("Property", _i, {
          _46o: 1,
          ms_ac: ["accessType", "valueType", Ap, Ur, "categoryName", ah, "align", "nullable", "emptiable", "slider", "itemEditor", "colorPicker"],
          _categoryName: E,
          getToolTip: function(L, w, S) {
              var O = this;
              return w ? O.formatValue(S.getValue(L, O)) : S.getPropertyName(O)
          }
      }),
      Vs.AccordionView = function() {
          var O = this;
          O._20o = {},
          O._21o = new Mh,
          O._10o = E,
          O._9o = E,
          O._11o = E,
          O._view = Te(0, O),
          O.iv()
      }
      ,
      Ws("AccordionView", G, {
          ms_v: 1,
          ms_fire: 1,
          ms_ac: [qq, jo, "titleHeight", om, Be, "titleBackground", "selectWidth", og, "orientation", "separatorColor"],
          _expandIcon: M.accordionViewExpandIcon,
          _collapseIcon: M.accordionViewCollapseIcon,
          _titleHeight: Yj,
          _labelColor: M.accordionViewLabelColor,
          _labelFont: M.accordionViewLabelFont,
          _titleBackground: M.accordionViewTitleBackground,
          _selectBackground: M.accordionViewSelectBackground,
          _selectWidth: M.accordionViewSelectWidth,
          _orientation: "v",
          _separatorColor: M.accordionViewSeparatorColor,
          onPropertyChanged: function() {
              this.iv()
          },
          getView: function() {
              return this._view
          },
          getTitles: function() {
              return this._21o
          },
          getCurrentTitle: function() {
              return this._10o
          },
          add: function(k, q, m, L) {
              var o = this
                , j = cf()
                , R = {
                  content: q,
                  div: j,
                  canvas: Jl(j),
                  icon: L
              };
              if (o._20o[k])
                  throw k + " already exists";
              var M = R.downEventFunc = function(L) {
                  ad(L)
              }
                , x = R.upEventFunc = function(G) {
                  ad(G),
                  ni(G) && (o._10o === k ? o.collapse() : o.expand(k))
              }
              ;
              [ki, Bq].forEach(function(v) {
                  b(j, v, M)
              }),
              [Ci, ge].forEach(function(V) {
                  b(j, V, x)
              }),
              j.style.cursor = yp,
              Qc(o._view, j),
              o._20o[k] = R,
              o._21o.add(k),
              m && o.expand(k),
              o.iv()
          },
          remove: function(v) {
              var O = this
                , L = O._20o[v];
              if (L) {
                  var G = L.div;
                  is(G),
                  [ki, Bq].forEach(function(l) {
                      D(G, l, L.downEventFunc)
                  }),
                  [Ci, ge].forEach(function(l) {
                      D(G, l, L.upEventFunc)
                  }),
                  delete O._20o[v],
                  O._21o.remove(v),
                  O.iv()
              }
          },
          clear: function() {
              var r = this;
              r._21o.toArray().forEach(r.remove, r),
              r._20o = {},
              r._21o.clear(),
              r.iv()
          },
          isExpanded: function(g) {
              return this._10o === g
          },
          expand: function(z) {
              var g = this;
              g._20o[z] && g._10o !== z && (g._10o = z,
              g.onExpanded(z),
              g.iv())
          },
          onExpanded: function() {},
          collapse: function() {
              var a = this;
              a._10o && (a.onCollapsed(a._10o),
              delete a._10o,
              a.iv())
          },
          onCollapsed: function() {},
          initCanvas: function(a, W, h) {
              Uj(a, W, h);
              var x = hq(a);
              return Sn(x, 0, 0, 1),
              x.clearRect(0, 0, W, h),
              x
          },
          drawTitle: function(x, f, E, S, G) {
              var m = this
                , j = Ti(G.icon)
                , n = m.isExpanded(f)
                , o = m._titleHeight
                , $ = m._titleBackground
                , _ = m._selectWidth
                , C = m._separatorColor
                , s = Ti(n ? m._expandIcon : m._collapseIcon)
                , D = _ + 4;
              xg(x, 0, 0, E, S, $),
              n && _ && xg(x, 0, 0, _, S, m._selectBackground),
              (n || m._21o.get(m._21o.size() - 1) !== f) && xg(x, 0, S - 1, E, 1, C ? C : Dd($)),
              j && (Oj(x, j, D + Aj(j) / 2, o / 2),
              D += Aj(j) + 2),
              vh(x, f, m.getLabelFont(f), m.getLabelColor(f), D, 0, 0, o),
              s && Oj(x, s, E - Aj(s) / 2 - 4, o / 2)
          },
          validateImpl: function() {
              var o = this
                , z = o._view
                , k = 0
                , H = 0
                , B = o.getWidth()
                , s = o.getHeight()
                , G = o._titleHeight
                , u = o._21o.size() * G
                , e = o._11o
                , R = o._9o;
              delete o._11o,
              delete o._9o,
              o._21o.each(function(_) {
                  var q, t, g = o._20o[_], V = g.content, f = o._10o === _;
                  nj(o) ? (ib(g.div, k, 0, G, s),
                  q = o.initCanvas(g.canvas, G, s),
                  od(q, 0, s),
                  Iq(q, -A),
                  o.drawTitle(q, _, s, G, g),
                  q.restore(),
                  f ? (t = X(0, B - u),
                  V && (o._11o = V,
                  o._9o = Si(V),
                  ib(V, k + G, 0, t, s)),
                  k += G + t) : k += G) : (ib(g.div, 0, H, B, G),
                  q = o.initCanvas(g.canvas, B, G),
                  o.drawTitle(q, _, B, G, g),
                  q.restore(),
                  f ? (t = X(0, s - u),
                  V && (o._11o = V,
                  o._9o = Si(V),
                  ib(V, 0, H + G, B, t)),
                  H += G + t) : H += G)
              });
              var $ = o._9o;
              e && e !== o._11o && e.endEditing && e.endEditing(),
              $ && $ !== R && Qc(z, $),
              R && R !== $ && is(R)
          }
      }),
      Vs.SplitView = function(u, P, q, K) {
          var f = this
            , R = f._dividerDiv = cf()
            , y = f._60O = Jl()
            , i = f._61O = Jl()
            , o = y.style
            , S = i.style;
          f._view = Te(1, f),
          Qc(f._view, R),
          o.msTouchAction = Kj,
          o.pointerEvents = Kj,
          o.cursor = yp,
          S.msTouchAction = Kj,
          S.pointerEvents = Kj,
          S.cursor = yp,
          u && f.setLeftView(u),
          P && f.setRightView(P),
          q && f.setOrientation(q),
          K != E && f.setPosition(K),
          f.setStatus(Tp),
          new $s(f)
      }
      ,
      Ws("SplitView", G, {
          ms_v: 1,
          ms_fire: 1,
          ms_ac: ["continuousLayout", "dividerSize", "dividerBackground", "toggleIcon", "togglable", "dragOpacity", "orientation", "draggable", "status"],
          _continuousLayout: !1,
          _position: .5,
          _togglable: !0,
          _orientation: "h",
          _draggable: !0,
          _dividerSize: M.splitViewDividerSize,
          _dividerBackground: M.splitViewDividerBackground,
          _dragOpacity: M.splitViewDragOpacity,
          _toggleIcon: M.splitViewToggleIcon,
          onPropertyChanged: function() {
              this.iv()
          },
          getDividerDiv: function() {
              return this._dividerDiv
          },
          getPosition: function() {
              return this._position
          },
          setPosition: function(J, i) {
              var O = this
                , V = O._position;
              isNaN(J) || (i || (O._82O = 0 > J ? -1 : J > 1 ? 1 : 0),
              O._position = J,
              O.fp(Op, V, J))
          },
          getLeftView: function() {
              return this._leftView
          },
          setLeftView: function(Q) {
              var N = this
                , R = N._leftView
                , l = N._view;
              if (N._leftView !== Q) {
                  if (R && R !== N._rightView) {
                      var f = Si(R);
                      f.parentNode === l && is(f)
                  }
                  if (N._leftView = Q,
                  Q) {
                      var b = Si(Q);
                      b.parentNode !== l && l.insertBefore(b, N._dividerDiv)
                  }
                  N.fp("leftView", R, Q)
              }
          },
          getRightView: function() {
              return this._rightView
          },
          setRightView: function(Q) {
              var D = this
                , M = D._rightView
                , A = D._view;
              if (D._rightView !== Q) {
                  if (M && M !== D._leftView) {
                      var t = Si(M);
                      t.parentNode === A && is(t)
                  }
                  if (D._rightView = Q,
                  Q) {
                      var R = Si(Q);
                      R.parentNode !== A && A.insertBefore(R, D._dividerDiv)
                  }
                  D.fp("rightView", M, Q)
              }
          },
          validateImpl: function() {
              var H = this
                , x = H._draggable
                , D = H._position
                , i = H.getWidth()
                , Q = H.getHeight()
                , S = H._dividerSize
                , W = H._dividerBackground
                , J = Ul ? 18 : 8
                , f = H._dividerDiv
                , F = H._82O
                , n = H._60O
                , b = H._61O
                , Y = H._toggleIcon
                , B = H._status
                , z = f.style
                , O = null
                , y = Ul ? 20 : 4
                , g = Y.comps[0];
              S >= J || 0 === S ? H._coverDiv && (is(H._coverDiv),
              delete H._coverDiv) : H._coverDiv || (H._coverDiv = cf(),
              Di && (H._coverDiv.style.background = Pe),
              Qc(f, H._coverDiv)),
              H._togglable ? n.parentNode || (Qc(f, n),
              Qc(f, b)) : (is(n),
              is(b));
              var $ = H._coverDiv
                , _ = H._leftView
                , I = H._rightView;
              if (nj(H)) {
                  if (S > i && (S = i),
                  B === Tp)
                      if (1 === F)
                          var t = K(D, i)
                            , G = X(0, i - S - t);
                      else
                          -1 === F ? (G = K(-D, i),
                          t = X(0, i - S - G)) : (t = w((i - S) * D),
                          G = X(0, i - S - t));
                  else
                      "cl" === B ? (t = 0,
                      G = X(0, i - S)) : "cr" === B && (G = 0,
                      t = X(0, i - S));
                  _ && ib(_, 0, 0, t, Q),
                  I && ib(I, t + S, 0, G, Q),
                  ib(f, t, 0, S, Q),
                  H._22o = t,
                  $ && (ib($, S / 2 - J / 2, 0, J, Q),
                  $.style.cursor = x ? So : ""),
                  f.style.cursor = x ? So : "";
                  var T = f.clientHeight / 2
                    , h = f.clientWidth;
                  Uj(n, h, h),
                  ib(n, 0, T - h - y, h, h),
                  O = hq(n),
                  Sn(O, 0, 0, 1),
                  g.rotation = -A,
                  Gm(O, Y, 0, 0, h, h),
                  O.restore(),
                  Uj(b, h, h),
                  ib(b, 0, T + y, h, h),
                  O = hq(b),
                  Sn(O, 0, 0, 1),
                  g.rotation = A,
                  Gm(O, Y, 0, 0, h, h),
                  O.restore()
              } else {
                  if (S > Q && (S = Q),
                  B === Tp)
                      if (1 === F)
                          var u = K(D, Q)
                            , e = X(0, Q - S - u);
                      else
                          -1 === F ? (e = K(-D, Q),
                          u = X(0, Q - S - e)) : (u = w((Q - S) * D),
                          e = X(0, Q - S - u));
                  else
                      "cl" === B ? (u = 0,
                      e = X(0, Q - S)) : "cr" === B && (e = 0,
                      u = X(0, Q - S));
                  _ && ib(_, 0, 0, i, u),
                  I && ib(I, 0, u + S, i, e),
                  ib(f, 0, u, i, S),
                  H._22o = u,
                  $ && (ib($, 0, S / 2 - J / 2, i, J),
                  $.style.cursor = x ? Jk : ""),
                  z.cursor = x ? Jk : "";
                  var m = f.clientWidth / 2
                    , h = f.clientHeight;
                  Uj(n, h, h),
                  ib(n, m - h - y, 0, h, h),
                  O = hq(n),
                  Sn(O, 0, 0, 1),
                  g.rotation = 0,
                  Gm(O, Y, 0, 0, h, h),
                  O.restore(),
                  Uj(b, h, h),
                  ib(b, m + y, 0, h, h),
                  O = hq(b),
                  Sn(O, 0, 0, 1),
                  g.rotation = s,
                  Gm(O, Y, 0, 0, h, h),
                  O.restore()
              }
              z.background = W
          }
      });
      var $s = function(W) {
          this.sv = W,
          this.addListeners()
      };
      Ik($s, G, {
          ms_listener: 1,
          getView: function() {
              return this.sv.getView()
          },
          handle_touchstart: function(N) {
              var g = this
                , Y = g.sv
                , r = Y._dividerDiv
                , m = Y._60O
                , R = Y._61O
                , h = Y._status
                , o = N.target;
              if (o === m)
                  h === Tp ? Y.setStatus("cl") : "cr" === h && Y.setStatus(Tp);
              else if (o === R)
                  h === Tp ? Y.setStatus("cr") : "cl" === h && Y.setStatus(Tp);
              else if (Re(N) && (o === r || o === Y._coverDiv) && (ad(N),
              Y.isDraggable())) {
                  Y.getLeftView(),
                  Y.getRightView();
                  var p = g.maskDiv = cf();
                  if (p.style.left = 0,
                  p.style.top = 0,
                  p.style.width = Y.getWidth() + "px",
                  p.style.height = Y.getHeight() + "px",
                  Y.getView().appendChild(p),
                  !Y.isContinuousLayout()) {
                      var w = g.resizeDiv = cf();
                      w.style.left = r.style.left,
                      w.style.top = r.style.top,
                      w.style.width = r.style.width,
                      w.style.height = r.style.height,
                      w.style.opacity = Y.getDragOpacity(),
                      w.style.background = Y.getDividerBackground(),
                      Qc(g.getView(), w)
                  }
                  g._lastAbsPosition = Y._22o,
                  g._86o = nj(Y) ? Gp(N).x : Gp(N).y,
                  dq(g, N)
              }
          },
          handleWindowTouchMove: function(k) {
              Re(k) && this.update(k, this.sv.isContinuousLayout())
          },
          handleWindowTouchEnd: function(d) {
              var D = this;
              D.update(d, !0),
              D.sv.setStatus(Tp),
              D.maskDiv && is(D.maskDiv),
              D.resizeDiv && is(D.resizeDiv),
              D.maskDiv = D.resizeDiv = E
          },
          handle_mousedown: function(m) {
              ni(m) && this.handle_touchstart(m)
          },
          handleWindowMouseMove: function(U) {
              this.handleWindowTouchMove(U)
          },
          handleWindowMouseUp: function(n) {
              this.handleWindowTouchEnd(n)
          },
          update: function(k, H) {
              var j = this
                , x = j.sv
                , o = nj(x) ? x.getWidth() : x.getHeight()
                , K = x._dividerSize
                , O = j._lastAbsPosition - j._86o;
              nj(x) ? (O += Gp(k).x,
              O > o - K && (O = o - K),
              0 > O && (O = 0),
              j.resizeDiv && (j.resizeDiv.style.left = O + nc)) : (O += Gp(k).y,
              O > o - K && (O = o - K),
              0 > O && (O = 0),
              j.resizeDiv && (j.resizeDiv.style.top = O + nc)),
              H && o !== K && (1 === x._82O ? x.setPosition(O, 1) : -1 === x._82O ? x.setPosition(O - o + K, 1) : x.setPosition(O / (o - K), 1))
          }
      }),
      Vs.TabView = function() {
          var m = this
            , s = m._view = Te(1, m)
            , T = m._91O = cf(1)
            , f = m._tabModel = new em
            , u = f.sm()
            , F = m.invalidate;
          m._7o = new Mh,
          m._canvas = Jl(T),
          Qc(s, T),
          Qc(s, m._92O = cf(1)),
          u.setSelectionMode(nh),
          u.ms(m.handleSelectionChange, m),
          f.mm(F, m),
          f.mh(F, m),
          f.md(F, m),
          m._interactor = new _s(m),
          m.iv()
      }
      ,
      Ws("TabView", G, {
          ms_v: 1,
          ms_fire: 1,
          ms_tx: 1,
          ms_ty: 1,
          ms_lp: 1,
          ms_ac: ["movable", "tabGap", "tabHeight", "tabPosition", om, Be, "tabHPadding", "tabBackground", "selectWidth", og, "moveBackground", "insertColor"],
          _tabHPadding: 0,
          _tabPosition: Dj,
          _tabHeight: Yj,
          _tabGap: M.tabViewTabGap,
          _labelColor: M.tabViewLabelColor,
          _labelFont: M.tabViewLabelFont,
          _tabBackground: M.tabViewTabBackground,
          _selectWidth: M.tabViewSelectWidth,
          _selectBackground: M.tabViewSelectBackground,
          _moveBackground: M.tabViewMoveBackground,
          _insertColor: M.tabViewInsertColor,
          _movable: !0,
          handleSelectionChange: function() {
              this._selectionChanged = !0,
              this.invalidate()
          },
          getContentDiv: function() {
              return this._92O
          },
          getTitleDiv: function() {
              return this._91O
          },
          getTabModel: function() {
              return this._tabModel
          },
          add: function(Y, N, z) {
              var w, j = this._tabModel;
              return Y instanceof Xs ? (w = Y,
              N && w.setView(N)) : (w = new Xs,
              w.setName(Y),
              w.setView(N)),
              j.add(w),
              z && j.sm().ss(w),
              w
          },
          getLabel: function(h) {
              return h.toLabel()
          },
          onPropertyChanged: function() {
              this.iv()
          },
          _7Q: function(y) {
              this._23o = y,
              this.iv()
          },
          get: function(H) {
              var C = this
                , V = C._tabModel;
              if (te(H))
                  return V._roots.get(H);
              if (Xq(H)) {
                  var v;
                  return V.each(function(n) {
                      H === C.getLabel(n) && (v = n)
                  }),
                  v
              }
              return H instanceof Xs ? H : E
          },
          select: function(L) {
              this._tabModel.sm().ss(this.get(L))
          },
          remove: function(t) {
              var T = this;
              if (t = T.get(t)) {
                  var v = T._tabModel
                    , L = v._roots.indexOf(t);
                  T._tabModel.remove(t),
                  T.selectByIndex(--L)
              }
          },
          getCurrentTab: function() {
              return this._8o
          },
          hideTabView: function(y, J) {
              J.parentNode === this._92O && (ti(J) ? (J.style.display = pk,
              J._tab_ = y) : is(J),
              Ab())
          },
          showTabView: function(z, B) {
              ti(B) && (B.style.display = "block",
              B._tab_ = z),
              B.parentNode !== this._92O && (Qc(this._92O, B),
              Ab())
          },
          _24o: function() {
              var O, B = this, z = B._8o, v = B._9o, C = B._tabModel.sm().ld();
              C && (O = Si(C.getView())),
              O !== v && (v && (z.getView() && z.getView().endEditing && z.getView().endEditing(),
              B.hideTabView(z, v)),
              O && B.showTabView(C, O)),
              B._8o = C,
              B._9o = O,
              z !== C && B.onTabChanged(z, C)
          },
          onTabClosing: function() {
              return !0
          },
          onTabChanged: function() {},
          onTabClosed: function(Y, U) {
              this.selectByIndex(--U)
          },
          selectByIndex: function(C) {
              var O = this
                , h = O._tabModel
                , P = h.size();
              if (P && !h.sm().ld()) {
                  C == E && (C = 0),
                  C >= P && (C = P - 1),
                  0 > C && (C = 0);
                  for (var N = C; N >= 0; N--) {
                      var G = O.get(N);
                      if (!G.isDisabled())
                          return O.select(G),
                          G
                  }
                  for (N = C + 1; P > N; N++)
                      if (G = O.get(N),
                      !G.isDisabled())
                          return O.select(G),
                          G
              }
          },
          getTabWidth: function(g) {
              var N = this.getTabHPadding()
                , t = 4 + 2 * N
                , $ = Ti(g.getIcon());
              $ && (t += Aj($, g) + 4);
              var e = this.getLabel(g);
              return e && (t += eh(this.getLabelFont(g), e).width + 4),
              g.isClosable() && (t += 10),
              t
          },
          drawTab: function(L, z, X, $, c, p, v) {
              var g, M = this, G = M._tabPosition, e = this.getTabHPadding(), h = X + 4 + e, D = M._selectWidth, C = Ti(z.getIcon()), Q = z.isDisabled(), y = M.getLabelColor(z), P = M.getLabelFont(z), l = M.getLabel(z), Z = M._selectBackground, F = G === Mb + "-vertical", B = G === Gq + "-vertical";
              (F || B) && (h = $ + 4 + e),
              Q && (L.globalAlpha = Un),
              xg(L, X, $, c, p, v),
              z === M._8o && D && (G === Dj ? xg(L, X, $ + p - D, c, D, Z) : G === Mb ? xg(L, X + c - D, $, D, p, Z) : G === Gq ? xg(L, X, $, D, p, Z) : F ? xg(L, X + c - D, $, D, p, Z) : B ? xg(L, X, $, D, p, Z) : xg(L, X, $, c, D, Z));
              var i = c / 2;
              if (F && (od(L, i, $ + p / 2),
              Iq(L, s),
              od(L, -i, -$ - p / 2)),
              C) {
                  var R = Xc(C, z)
                    , n = Aj(C, z);
                  if (F || B) {
                      var k = X + c / 2
                        , o = h + R / 2;
                      od(L, k, o),
                      Iq(L, A),
                      od(L, -k, -o),
                      Oj(L, C, X + c / 2, h + R / 2, z, M),
                      od(L, k, o),
                      Iq(L, -A),
                      od(L, -k, -o),
                      h += R + 4
                  } else
                      Oj(L, C, h + n / 2, $ + p / 2, z, M),
                      h += n + 4
              }
              return F || B ? (od(L, c / 2, h + c / 2),
              Iq(L, A),
              od(L, -c / 2, -h - c / 2),
              vh(L, l, P, y, X, h, p, c),
              od(L, c / 2, h + c / 2),
              Iq(L, -A),
              od(L, -c / 2, -h - c / 2)) : vh(L, l, P, y, h, $, c, p),
              F && (od(L, i, $ + p / 2),
              Iq(L, -s),
              od(L, -i, -$ - p / 2)),
              z.isClosable() && (g = B ? {
                  x: X + c - 12,
                  y: $ + p - 12,
                  width: 12,
                  height: 12
              } : {
                  x: X + c - 12,
                  y: $ + 2,
                  width: 12,
                  height: 12
              },
              this.drawCloseIcon(z, L, y, g)),
              Q && (L.globalAlpha = 1),
              g
          },
          drawCloseIcon: function(S, L, K, M) {
              var b = M.x
                , f = M.y;
              L.strokeStyle = K,
              L.lineWidth = 1,
              L.beginPath(),
              L.moveTo(b + 2, f + 8),
              L.lineTo(b + 8, f + 2),
              L.moveTo(b + 8, f + 8),
              L.lineTo(b + 2, f + 2),
              L.stroke()
          },
          getTabAt: function(g) {
              var y = this._interactor._8Q(g);
              return y ? y.tab : null
          },
          validateImpl: function() {
              var I = this;
              I._24o();
              var E, i = I._canvas, x = I._tabPosition, A = I._91O, n = I._92O, d = I._tabModel, L = I.getWidth(), z = I.getHeight(), f = I._tabHeight, N = I._7o, p = I._tabGap, h = x === Dj, C = x === Mb, s = x === Gq, q = x === Mb + "-vertical", r = x === Gq + "-vertical", $ = I._23o, W = 0;
              if ((C || s) && d._roots.each(function(k) {
                  W = X(I.getTabWidth(k), W)
              }),
              h ? (ib(A, 0, 0, L, f),
              E = {
                  x: 0,
                  y: f,
                  width: L,
                  height: X(0, z - f)
              }) : C ? (ib(A, 0, 0, W, z),
              E = {
                  x: W,
                  y: 0,
                  width: X(0, L - W),
                  height: z
              }) : s ? (ib(A, L - W, 0, W, z),
              E = {
                  x: 0,
                  y: 0,
                  width: X(0, L - W),
                  height: z
              }) : q ? (ib(A, 0, 0, f, z),
              E = {
                  x: f,
                  y: 0,
                  width: X(0, L - f),
                  height: z
              }) : r ? (ib(A, L - f, 0, f, z),
              E = {
                  x: 0,
                  y: 0,
                  width: X(0, L - f),
                  height: z
              }) : (ib(A, 0, z - f, L, f),
              E = {
                  x: 0,
                  y: 0,
                  width: L,
                  height: X(0, z - f)
              }),
              ib(n, E),
              q || r) {
                  I._9o && (E.x = 0,
                  ib(I._8o.getView(), E)),
                  Uj(i, f, z);
                  var j = hq(i)
                    , o = 0;
                  if (Sn(j, 0, I.ty(), 1),
                  j.clearRect(0, 0, f, z),
                  N.clear(),
                  d._roots.each(function(J) {
                      if (J.isVisible()) {
                          var n, M = I.getTabWidth(J);
                          $ && $.tab === J || (n = I.drawTab(j, J, 0, o, f, M, I._tabBackground)),
                          N.add({
                              _75o: n,
                              tab: J,
                              startY: o,
                              endY: o + M,
                              height: M
                          }),
                          o += M + p
                      }
                  }),
                  I._23Q = X(0, o - p),
                  $) {
                      var Z = $.position;
                      I.drawTab(j, $.tab, 0, $.startY, f, $.height, I._moveBackground),
                      xg(j, 0, Z, f, 1, I._insertColor)
                  }
                  if (j.restore(),
                  I._selectionChanged) {
                      I._selectionChanged = !1;
                      for (var V = I.ty(), M = 0; M < N.size(); M++) {
                          var O = N.get(M);
                          if (O.tab === I._8o) {
                              if (O.endY + V < 0) {
                                  I.ty(-O.startY);
                                  break
                              }
                              if (O.startY + V > z) {
                                  I.ty(z - O.endY);
                                  break
                              }
                          }
                      }
                  }
                  I.ty(I.ty())
              } else if (C || s) {
                  I._9o && (E.x = 0,
                  ib(I._8o.getView(), E)),
                  Uj(i, W, z);
                  var j = hq(i)
                    , o = 0;
                  if (Sn(j, 0, I.ty(), 1),
                  j.clearRect(0, 0, W, z),
                  N.clear(),
                  d._roots.each(function(k) {
                      if (k.isVisible()) {
                          var X;
                          $ && $.tab === k || (X = I.drawTab(j, k, 0, o, W, f, I._tabBackground)),
                          N.add({
                              _75o: X,
                              tab: k,
                              startY: o,
                              endY: o + f,
                              height: f
                          }),
                          o += f + p
                      }
                  }),
                  I._23Q = X(0, o - p),
                  $) {
                      var Z = $.position;
                      I.drawTab(j, $.tab, 0, $.startY, W, $.height, I._moveBackground),
                      xg(j, 0, Z, W, 1, I._insertColor)
                  }
                  if (j.restore(),
                  I._selectionChanged) {
                      I._selectionChanged = !1;
                      for (var V = I.ty(), M = 0; M < N.size(); M++) {
                          var O = N.get(M);
                          if (O.tab === I._8o) {
                              if (O.endY + V < 0) {
                                  I.ty(-O.startY);
                                  break
                              }
                              if (O.startY + V > z) {
                                  I.ty(z - O.endY);
                                  break
                              }
                          }
                      }
                  }
                  I.ty(I.ty())
              } else {
                  I._9o && (E.y = 0,
                  ib(I._8o.getView(), E)),
                  Uj(i, L, f);
                  var j = hq(i)
                    , B = 0;
                  if (Sn(j, I.tx(), 0, 1),
                  j.clearRect(0, 0, L, f),
                  N.clear(),
                  d._roots.each(function(n) {
                      if (n.isVisible()) {
                          var Z, e = I.getTabWidth(n);
                          $ && $.tab === n || (Z = I.drawTab(j, n, B, 0, e, f, I._tabBackground)),
                          N.add({
                              _75o: Z,
                              tab: n,
                              startX: B,
                              endX: B + e,
                              width: e
                          }),
                          B += e + p
                      }
                  }),
                  I._64I = X(0, B - p),
                  $) {
                      var Z = $.position;
                      I.drawTab(j, $.tab, $.startX, 0, $.width, f, I._moveBackground),
                      Ne(j, I._insertColor, Z, 0, f)
                  }
                  if (j.restore(),
                  I._selectionChanged) {
                      I._selectionChanged = !1;
                      for (var t = I.tx(), M = 0; M < N.size(); M++) {
                          var O = N.get(M);
                          if (O.tab === I._8o) {
                              if (O.endX + t < 0) {
                                  I.tx(-O.startX);
                                  break
                              }
                              if (O.startX + t > L) {
                                  I.tx(L - O.endX);
                                  break
                              }
                          }
                      }
                  }
                  I.tx(I.tx())
              }
              for (var S = [], K = n.children, M = 0; M < K.length; M++) {
                  var k = K[M]
                    , H = k._tab_;
                  H && !d.contains(H) && S.push(k)
              }
              S.forEach(function(l) {
                  n.removeChild(l)
              })
          }
      });
      var _s = function(e) {
          this.tv = e,
          this.addListeners()
      };
      Ik(_s, G, {
          ms_listener: 1,
          getView: function() {
              return this.tv._91O
          },
          handle_mousewheel: function(i) {
              this.handleScroll(i, 10 * (i.wheelDelta / 40))
          },
          handle_DOMMouseScroll: function(A) {
              this.handleScroll(A, 10 * -A.detail)
          },
          handleScroll: function(a, K) {
              ad(a);
              var l = this.tv
                , A = l._tabPosition;
              !l._40o() || A !== Dj && A !== zg || l.tx(this.tv.tx() + K),
              !l._41o() || A !== Mb && A !== Gq && A !== Mb + "-vertical" && A !== Gq + "-vertical" || l.ty(this.tv.ty() + K)
          },
          _8Q: function(Z) {
              var U, r, K = this.tv, C = K._tabPosition, L = K._7o;
              if (C === Dj || C === zg) {
                  var t = K.lp(Z).x;
                  for (U = 0; U < L.size(); U++)
                      if (r = L.get(U),
                      r.startX <= t && t <= r.endX)
                          return r
              } else if (C === Mb || C === Gq || C === Mb + "-vertical" || C === Gq + "-vertical") {
                  var l = K.lp(Z).y;
                  for (U = 0; U < L.size(); U++)
                      if (r = L.get(U),
                      r.startY <= l && l <= r.endY)
                          return r
              }
              return E
          },
          isClickable: function(M) {
              var s = this.tv
                , j = s._tabPosition
                , u = this._73o = this._8Q(M);
              return !s._40o() || j !== Dj && j !== zg ? !s._41o() || j !== Mb && j !== Gq && j !== Mb + "-vertical" && j !== Gq + "-vertical" ? u && (!u.tab.isDisabled() || s.isMovable()) : !0 : !0
          },
          handle_mousemove: function(l) {
              var r = this;
              gd ? r._74o = r._8Q(l) : r.getView().style.cursor = r.isClickable(l) ? yp : ""
          },
          handle_mousedown: function($) {
              this.handle_mousemove($),
              this.handle_touchstart($)
          },
          handle_touchstart: function(_) {
              var Q = this
                , $ = Q.tv
                , R = $._tabPosition;
              ad(_),
              ni(_) && Q.isClickable(_) && (R === Dj || R === zg ? (Q.x = Gp(_).x,
              Q.lp = $.lp(_),
              Q.tx = $.tx()) : (Q.y = Gp(_).y,
              Q.lp = $.lp(_),
              Q.ty = $.ty()),
              dq(Q, _))
          },
          handleWindowMouseMove: function(L) {
              this.handleWindowTouchMove(L)
          },
          handleWindowTouchMove: function(N) {
              var F, R = this, D = R.tv, $ = D._tabPosition, b = R._73o;
              if ($ === Dj || $ === zg) {
                  if (F = Gp(N).x - R.x,
                  !R._25o && !R.moving && u(F) > 2 && (D._40o() && !Tr(N) ? R._25o = 1 : b && D.isMovable() && (R.moving = 1)),
                  R._25o)
                      D.tx(R.tx + F);
                  else if (R.moving) {
                      var G = R.lp.x + F
                        , B = D._tabGap / 2;
                      D._7o.each(function(N) {
                          var p = N.endX
                            , g = G - N.startX < p - G;
                          G >= N.startX && p >= G && D._7Q({
                              tab: b.tab,
                              startX: b.startX + F,
                              width: b.width,
                              front: g,
                              insertTab: N.tab,
                              position: g ? X(0, N.startX - B) : K(D._64I, p + B)
                          })
                      })
                  }
              } else if (F = Gp(N).y - R.y,
              !R._25o && !R.moving && u(F) > 2 && (D._41o() && !Tr(N) ? R._25o = 1 : b && D.isMovable() && (R.moving = 1)),
              R._25o)
                  D.ty(R.ty + F);
              else if (R.moving) {
                  var p = R.lp.y + F
                    , B = D._tabGap / 2;
                  D._7o.each(function(f) {
                      var Z = f.endY
                        , w = p - f.startY < Z - p;
                      p >= f.startY && Z >= p && D._7Q({
                          tab: b.tab,
                          startY: b.startY + F,
                          height: b.height,
                          front: w,
                          insertTab: f.tab,
                          position: w ? X(0, f.startY - B) : K(D._23Q, Z + B)
                      })
                  })
              }
          },
          handleWindowMouseUp: function(A) {
              this.handleWindowTouchEnd(A)
          },
          handleWindowTouchEnd: function() {
              var U = this
                , P = U.tv
                , H = P._tabPosition
                , q = P.getTabModel()
                , s = q._roots
                , V = U._73o;
              if (U.moving) {
                  var G = P._23o;
                  if (G && G.insertTab !== G.tab) {
                      var u = G.tab
                        , t = s.remove(u)
                        , k = s.indexOf(G.insertTab);
                      k >= 0 && (G.front || k++,
                      k <= s.size() && (s.add(u, k),
                      q._38I(u, t, k)))
                  }
                  P._7Q(E),
                  delete U.moving
              } else if (!U._25o && V) {
                  u = V.tab;
                  var $ = U._74o;
                  if (!$ || $.tab === u)
                      if (!u.isDisabled() && tp(V._75o, U.lp)) {
                          var h = function() {
                              var b = s.indexOf(u);
                              q.remove(u),
                              P.onTabClosed(u, b)
                          };
                          P.onTabClosing(u, h) && h()
                      } else
                          u.isDisabled() || P._8o === u || q.sm().ss(u)
              }
              U._25o = U._73o = U._74o = H === Dj || H === zg ? U.x = U.lp = U.tx = E : U.y = U.lp = U.ty = E
          }
      }),
      Vs.PropertyView = function(p) {
          var u = this;
          u._view = Te(1, u),
          u._canvas = Jl(u._view),
          Qc(u._view, u._79O = cf()),
          u._rows = new Mh,
          u._28o = new Mh,
          u._26o = {},
          u._26Q = {};
          var z = u._propertyModel = new em
            , q = u.ivm;
          z.mm(q, u),
          z.md(q, u),
          z.mh(q, u),
          u.dm(p ? p : new em),
          new at(u)
      }
      ,
      Ws("PropertyView", G, {
          ms_ac: [om, sh, Be, Ap, Ur, "categorizable", im, Jf, sq, qq, jo, yq, yl, bi, "selectRowIndex", og, "background", Vl, ic, Lb, vq, gh],
          ms_v: 1,
          ms_dm: 1,
          ms_fire: 1,
          ms_sm: 1,
          _49o: 1,
          ms_txy: 1,
          ms_lp: 1,
          ms_vs: 1,
          _45o: 1,
          _47o: 1,
          ms_tip: 1,
          _29I: Wk,
          _59I: 0,
          _9I: 0,
          _selectRowIndex: -1,
          _editable: !0,
          _batchEditable: !0,
          _categorizable: !0,
          _indent: fl,
          _background: M.propertyViewBackground,
          _expandIcon: M.propertyViewExpandIcon,
          _collapseIcon: M.propertyViewCollapseIcon,
          _scrollBarColor: ej,
          _scrollBarSize: _n,
          _autoHideScrollBar: Ch,
          _selectBackground: M.propertyViewSelectBackground,
          _rowHeight: Ye,
          _rowLineVisible: M.propertyViewRowLineVisible,
          _rowLineColor: M.propertyViewRowLineColor,
          _10I: .5,
          _columnLineVisible: M.propertyViewColumnLineVisible,
          _columnLineColor: M.propertyViewColumnLineColor,
          _labelColor: M.propertyViewLabelColor,
          _labelSelectColor: M.propertyViewLabelSelectColor,
          _labelFont: M.propertyViewLabelFont,
          getRows: function() {
              return this._rows
          },
          getColumnPosition: function() {
              return this._10I
          },
          setColumnPosition: function(r) {
              0 > r && (r = 0),
              r > 1 && (r = 1);
              var o = this
                , I = o._10I;
              o._10I = r,
              o.fp("columnPosition", I, r)
          },
          getPropertyName: function(Q) {
              return Q.toLabel()
          },
          getLabelFont: function() {
              return this._labelFont
          },
          getLabelColor: function(h, n, Z) {
              return Z === this._selectRowIndex ? this._labelSelectColor : this._labelColor
          },
          getPropertyFont: function() {
              return this._labelFont
          },
          getPropertyColor: function(w, X) {
              return X === this._selectRowIndex ? this._labelSelectColor : w.getColor() || this._labelColor
          },
          getCategoryFont: function() {
              return this._labelFont
          },
          getCategoryColor: function() {
              return this._labelColor
          },
          adjustTranslateX: function() {
              return 0
          },
          adjustTranslateY: function(I) {
              var W = this.getHeight() - this._59I;
              return W > I && (I = W),
              I > 0 ? 0 : w(I)
          },
          isExpanded: function(z) {
              if (!z)
                  return !0;
              var O = this._26o[z];
              return O ? O.isExpanded : !(this._26Q[z] === !1)
          },
          toggle: function(X) {
              var O = this;
              O.isExpanded(X) ? O.collapse(X) : O.expand(X)
          },
          expandAll: function() {
              this.validate();
              for (var r in this._26o)
                  this.expand(r)
          },
          expand: function(m) {
              if (m && m !== pk) {
                  var p = this
                    , c = p._26o[m];
                  c && !c.isExpanded && (c.isExpanded = !0,
                  p.onExpanded(m),
                  p.ivm())
              }
          },
          onExpanded: function() {},
          collapseAll: function() {
              this.validate();
              for (var j in this._26o)
                  this.collapse(j)
          },
          collapse: function(w) {
              if (w && w !== pk) {
                  var N = this
                    , T = N._26o[w];
                  T && T.isExpanded && (T.isExpanded = !1,
                  N.onCollapsed(w),
                  N.ivm())
              }
          },
          onCollapsed: function() {},
          getCategoryName: function(k) {
              if (!this.isCategorizable())
                  return pk;
              var U = k.getCategoryName();
              return U ? U : pk
          },
          getPropertyModel: function() {
              return this._propertyModel
          },
          handleSelectionChange: function() {
              this.ivm()
          },
          setDataModel: function(h) {
              var s = this
                , x = s._dataModel;
              x !== h && (x && (x.umd(s.handlePropertyChange, s),
              s._selectionModel || x.sm().ums(s.handleSelectionChange, s)),
              s._dataModel = h,
              h.md(s.handlePropertyChange, s),
              s._selectionModel ? s._selectionModel._21I(h) : h.sm().ms(s.handleSelectionChange, s),
              s.fp(jh, x, h))
          },
          isVisible: function(u) {
              return this._visibleFunc ? this._visibleFunc(u) : !0
          },
          onPropertyChanged: function(V) {
              var e = this
                , u = V.property;
              Qs[u] ? e.ivm() : e.iv(),
              u === _l && e._43o()
          },
          getCurrentData: function() {
              return this._27o
          },
          updateCurrentData: function() {
              this._27o = this.sm().ld()
          },
          getRawProperties: function() {
              return this._27o ? this._propertyModel._roots : $b
          },
          handlePropertyChange: function(i) {
              this._27o === i.data && this.iv()
          },
          ivm: function() {
              this.invalidateModel()
          },
          invalidateModel: function() {
              var F = this;
              F._96I || (F.setSelectRowIndex(-1),
              F._96I = 1,
              F.iv())
          },
          redraw: function() {
              this.iv()
          },
          validateModel: function() {
              var x = this
                , Y = x._rows
                , h = x._28o
                , r = {}
                , R = new Mh
                , w = x._27o;
              x.updateCurrentData(),
              w !== x._27o && x.endEditing(),
              Y.clear(),
              h.clear(),
              x.getRawProperties().each(function(J) {
                  if (x.isVisible(J)) {
                      R.add(J);
                      var E = x.getCategoryName(J);
                      r[E] || (h.add(E, E === pk ? 0 : V),
                      r[E] = {
                          isExpanded: x.isExpanded(E),
                          properties: new Mh
                      })
                  }
              }),
              x._sortFunc && R.sort(x._sortFunc);
              for (var N in x._26o)
                  x._26Q[N] = x.isExpanded(N);
              x._26o = r,
              h.each(function(s) {
                  s !== pk && Y.add(s);
                  var f = r[s];
                  f.isExpanded && R.each(function(F) {
                      x.getCategoryName(F) === s && (f.properties.add(F),
                      Y.add({
                          property: F,
                          data: x._27o
                      }))
                  }, x)
              })
          },
          validateImpl: function() {
              var W = this;
              W._76o(),
              W._96I && (W.validateModel(),
              delete W._96I);
              var v = W._canvas
                , F = W.getWidth()
                , L = W.getHeight()
                , t = -W.ty()
                , J = W._rowHeight
                , p = W._indent
                , A = F - p
                , U = W._rows
                , V = U.size()
                , r = W._9I = p + A * W._10I
                , N = W._59I = V * J;
              Uj(v, F, L),
              W._29I = {
                  x: 0,
                  y: t,
                  width: F,
                  height: L
              },
              W._31I = q(t / J),
              W._14I = z((t + L) / J),
              W._31I < 0 && (W._31I = 0),
              W._14I > V && (W._14I = V);
              var s, w = hq(v), $ = W._background;
              Sn(w, 0, -t, 1),
              w.beginPath(),
              w.rect(0, t, F, L),
              w.clip(),
              w.clearRect(0, t, F, L),
              W._93db(w),
              $ && xg(w, 0, 0, p, N, $);
              for (var j = W._31I; j < W._14I; j++) {
                  var H = U.get(j)
                    , t = J * j;
                  if (Xq(H))
                      $ && xg(w, p, t, A, J, $),
                      s = Ti(W.isExpanded(H) ? W._expandIcon : W._collapseIcon),
                      s && Eq(w, s, jg, 0, t, p, J),
                      w.save(),
                      w.beginPath(),
                      w.rect(p, t, A, J),
                      w.clip(),
                      W.drawCategoryName(w, H, j, p, t, A, J),
                      w.restore();
                  else {
                      var T = H.property
                        , k = H.data
                        , s = Ti(T.getIcon())
                        , d = W._selectRowIndex === j ? W.getSelectBackground() : E;
                      if (s && Eq(w, s, jg, 0, t, p, J),
                      d && xg(w, p, t, A, J, d),
                      w.save(),
                      w.beginPath(),
                      w.rect(p, t, r - p, J),
                      w.clip(),
                      W.drawPropertyName(w, T, j, p, t, r - p, J),
                      w.restore(),
                      !W.isEditing(k, T)) {
                          var e = r + 1
                            , c = F - r - 1;
                          w.save(),
                          w.beginPath(),
                          w.rect(e, t, c, J),
                          w.clip(),
                          W._87o(W.drawPropertyValue(w, T, W.getValue(k, T), j, e, t, c, J, k), j, e, t, c, J),
                          w.restore()
                      }
                  }
                  W._rowLineVisible && xg(w, p, t + J - 1, A, 1, W._rowLineColor)
              }
              W._columnLineVisible && (xg(w, r, 0, 1, N, W._columnLineColor),
              xg(w, F - 1, 0, 1, N)),
              W._92db(w),
              W._93I(),
              w.restore(),
              W.ty(W.ty())
          },
          drawCategoryName: function(M, o, Z, K, w, U, u) {
              vh(M, o, this.getCategoryFont(o), this.getCategoryColor(o), K, w, U, u)
          },
          drawPropertyName: function(f, s, l, Z, v, X, r) {
              return s.drawPropertyName ? (s.drawPropertyName(f, s, l, Z, v, X, r, this),
              void 0) : (vh(f, this.getPropertyName(s), this.getPropertyFont(s, l), this.getPropertyColor(s, l), Z, v, X, r),
              void 0)
          },
          drawPropertyValue: function(w, q, Y, Z, i, U, o, j, M) {
              return q.drawPropertyValue ? q.drawPropertyValue(w, q, Y, Z, i, U, o, j, M, this) : (Ss(w, Y, q, this.getLabelFont(q, Y, Z), this.getLabelColor(q, Y, Z), i, U, o, j, M, this),
              void 0)
          },
          isPropertyEditable: function(I) {
              return I.isEditable() && this.isEditable()
          },
          setProperties: function(i) {
              this._propertyModel.clear(),
              this.addProperties(i)
          },
          addProperties: function(E) {
              if (E) {
                  var R = this._propertyModel;
                  E.forEach(function(e) {
                      if (!(e instanceof Zs)) {
                          var u = No(e.className);
                          e = Hp(u ? u : Zs, e)
                      }
                      R.add(e)
                  })
              }
          },
          getRowIndexAt: function(r) {
              var b = this
                , A = q(b.lp(r).y / b._rowHeight);
              return A >= 0 && A < b._rows.size() ? A : -1
          },
          getPropertyAt: function(g) {
              var J = this
                , G = J.getRowIndexAt(g);
              return G >= 0 ? J._rows.get(G).property : E
          },
          getToolTip: function(V) {
              var s = this
                , P = s.getPropertyAt(V)
                , m = s._27o;
              return P && m ? P.getToolTip(m, s._9I < s.lp(V).x, s) : E
          }
      });
      var at = function(d) {
          this.pv = d,
          this.addListeners()
      };
      Ik(at, G, {
          ms_listener: 1,
          getView: function() {
              return this.pv._view
          },
          setCursor: function(G) {
              this.getView().style.cursor = G
          },
          clear: function() {
              var A = this;
              A._62O = A.cp = A.ty = A.p = E,
              A.setCursor(kj)
          },
          handle_mousedown: function(R) {
              this.handle_touchstart(R)
          },
          handle_touchstart: function(f) {
              var k = this
                , $ = k.pv;
              ad(f),
              $.setFocus(f) && (ni(f) ? (k.cp = Gp(f),
              k.ty = $.ty(),
              k.p = $.getColumnPosition(),
              k.handle_touchmove(f)) : $.setSelectRowIndex($.getRowIndexAt(f)))
          },
          handleWindowMouseUp: function() {
              this.clear()
          },
          handleWindowTouchEnd: function() {
              this.clear()
          },
          handle_mouseup: function(U) {
              this.handle_touchend(U)
          },
          handle_touchend: function(V) {
              var q = this;
              if (q.cp && !q._62O) {
                  var F = q.pv
                    , x = F.lp(V)
                    , z = x.x
                    , t = x.y
                    , G = F._indent
                    , P = F.getRowIndexAt(V)
                    , D = F._9I;
                  if (P >= 0) {
                      var f = F._rowHeight
                        , R = f * P
                        , e = F._rows.get(P)
                        , E = e.property;
                      if (Xq(e))
                          Ti(F.isExpanded(e) ? F._expandIcon : F._collapseIcon) && z >= 0 && G >= z && t >= R && R + f >= t ? F.toggle(e) : Xk(V) && F.toggle(e);
                      else if (z > D && F.isPropertyEditable(E, V)) {
                          var W = {
                              x: D + 1,
                              y: R,
                              width: F.getWidth() - D - 1,
                              height: f
                          }
                            , n = {
                              x: W.x + F.tx(),
                              y: W.y + F.ty(),
                              width: W.width,
                              height: W.height
                          }
                            , _ = 0
                            , p = F._29I;
                          W.y < p.y ? _ = W.y - p.y : W.y + f > p.y + p.height && (_ = W.y + f - p.y - p.height),
                          _ && (F.ty(F.ty() - _),
                          n.y -= _),
                          F.beginEditing({
                              data: e.data,
                              property: E,
                              value: F.getValue(e.data, E),
                              event: V,
                              rect: W,
                              editorRect: n,
                              view: F
                          })
                      }
                  }
                  F.setSelectRowIndex(P)
              }
              q.clear()
          },
          handleWindowMouseMove: function(F) {
              this.handleWindowTouchMove(F)
          },
          handleWindowTouchMove: function(s) {
              var n = this
                , Q = n.pv
                , t = n.ty
                , K = n.cp
                , $ = Gp(s)
                , J = n._62O;
              if ("p" === J)
                  Q.setTranslateY(t + $.y - K.y);
              else if ("c" === J) {
                  var m = Q.getWidth() - Q._indent;
                  if (m > 16) {
                      var U = n.p - (K.x - $.x) / m
                        , B = 16 / m;
                      B > U && (U = B),
                      U > 1 - B && (U = 1 - B),
                      Q.setColumnPosition(U)
                  }
              } else
                  "s" === J && Q.setTranslateY(t + (K.y - $.y) * Q._59I / Q._29I.height)
          },
          handle_mousemove: function(M) {
              this.handle_touchmove(M)
          },
          handle_touchmove: function(U) {
              if (!gd && ni(U)) {
                  var w = this
                    , K = w.pv
                    , X = u(K.lp(U).x - K._9I) <= (Ul ? 8 : 3);
                  w.cp ? w._62O || (X ? (w._62O = "c",
                  dq(w, U)) : u(Gp(U).y - w.cp.y) >= 2 && (w._62O = w.isV(U) ? "s" : "p",
                  dq(w, U))) : (X ? w.setCursor(So) : w.setCursor(kj),
                  w.isV(U) && K._43o())
              }
          },
          isV: function(N) {
              var h = this.pv
                , q = h._29I;
              return h._41o() && q.x + q.width - h.lp(N).x < co
          },
          handle_mousewheel: function(c) {
              this.handleScroll(c, c.wheelDelta / 40)
          },
          handle_DOMMouseScroll: function(D) {
              2 === D.axis && this.handleScroll(D, -D.detail)
          },
          handleScroll: function(z, y) {
              var e = this.pv;
              ad(z),
              e.endEditing(),
              e.translate(0, y * e.getRowHeight())
          },
          handle_keydown: function(Y) {
              var I = this.pv
                , G = I._rows.size()
                , F = I._selectRowIndex + (yo(Y) ? -1 : 1);
              (yo(Y) || Cf(Y)) && (0 > F && (F = 0),
              F >= G && (F = G - 1),
              I.setSelectRowIndex(F))
          }
      }),
      Vs.ListView = function(q) {
          this._5o(q),
          new bt(this)
      }
      ,
      Ws("ListView", G, {
          ms_ac: [om, sh, Be, Vl, im, ic, Lb, Jf, sq, yq, yl, bi, Yr, og],
          ms_v: 1,
          ms_bnb: 1,
          ms_tip: 1,
          ms_fire: 1,
          ms_sm: 1,
          _49o: 1,
          ms_txy: 1,
          ms_lp: 1,
          ms_vs: 1,
          ms_hs: 1,
          _15Q: 1,
          _14Q: 1,
          ms_dm: 1,
          _45o: 1,
          _checkMode: !1,
          _indent: fl,
          _rowHeight: Ye,
          _rowLineVisible: M.listViewRowLineVisible,
          _rowLineColor: M.listViewRowLineColor,
          _scrollBarColor: ej,
          _scrollBarSize: _n,
          _autoMakeVisible: Bc,
          _autoHideScrollBar: Ch,
          _selectBackground: M.listViewSelectBackground,
          _labelColor: M.listViewLabelColor,
          _labelSelectColor: M.listViewLabelSelectColor,
          _labelFont: M.listViewLabelFont,
          isCheckMode: function() {
              return this._checkMode
          },
          setCheckMode: function(J) {
              var _ = this
                , x = _._checkMode;
              _._checkMode = J,
              _.fp(rh, x, J)
          },
          drawRow: function(G, m, s, p, x, X, F) {
              var r = this
                , N = 0
                , k = r._indent
                , v = r.getIconWidth(m);
              r.drawRowBackground(G, m, s, p, x, X, F),
              r._checkMode && (Oj(G, Ti(r.getCheckIcon(m)), N + k / 2, x + F / 2, m, r),
              N += k),
              r.drawIcon(G, m, N, x, v, F),
              r.drawLabel(G, m, N + v, x, F)
          }
      });
      var bt = function(j) {
          this.list = j,
          this.addListeners()
      };
      Ik(bt, G, {
          ms_listener: 1,
          getView: function() {
              return this.list._view
          },
          clear: function(G) {
              var $ = this
                , r = $.list;
              G && "d" === $._62O && !$.dragCancel && r.handleDragAndDrop(G, "end"),
              r.draggingData && (r.draggingData = null,
              r.redraw()),
              $.dragCancel = $._62O = $._isV = $._isH = $.cp = $.tx = $.ty = E
          },
          handle_mousedown: function(M) {
              this.handle_touchstart(M)
          },
          handle_touchstart: function(z) {
              var K = this
                , H = K.list;
              if (ad(z),
              H.setFocus(z)) {
                  var v = H.getDataAt(z);
                  K.cp = Gp(z),
                  K.tx = H.tx(),
                  K.ty = H.ty(),
                  ni(z) ? v && H.handleDragAndDrop && !K.isV(z) && !K.isH(z) && (H.draggingData = v,
                  H.redraw(),
                  H.handleDragAndDrop(z, "prepare")) : (v ? K._33o(z, v) : this._cancelDataDoubleSelect(),
                  K.clear(z))
              }
          },
          handleWindowMouseUp: function(c) {
              this.clear(c)
          },
          handleWindowTouchEnd: function(S) {
              this.clear(S)
          },
          handle_mouseup: function(w) {
              this.handle_touchend(w)
          },
          handle_touchend: function(N) {
              var f = this
                , Y = f.list;
              if (!f._isV && !f._isH && f.cp && !f._62O) {
                  var C = Y.getDataAt(N);
                  C ? (Y.isCheckMode() ? f._34o(N, C) : f._33o(N, C),
                  Xk(N) ? Y.onDataDoubleClicked(C, N) : Y.onDataClicked(C, N)) : (f._cancelDataDoubleSelect(),
                  Y.handleBackgroundClick(N))
              }
              f.clear(N)
          },
          handleWindowMouseMove: function(i) {
              this.handleWindowTouchMove(i)
          },
          handleWindowTouchMove: function(Z) {
              var M = this
                , P = M.list
                , W = M._62O
                , g = M.tx
                , b = M.ty
                , i = M.cp
                , q = Gp(Z)
                , r = P._29I;
              "p" === W ? P.setTranslate(g + q.x - i.x, b + q.y - i.y) : "v" === W ? P.ty(b + (i.y - q.y) * P._59I / r.height) : "h" === W ? P.tx(g + (i.x - q.x) * P._91I / r.width) : "d" === W && (M.dragCancel || P.handleDragAndDrop(Z, "between"))
          },
          handle_mousemove: function(h) {
              this.handle_touchmove(h)
          },
          handle_touchmove: function(P) {
              if (!gd && ni(P)) {
                  var A = this
                    , H = A.list;
                  if (A._isV = A.isV(P),
                  A._isH = A.isH(P),
                  A.cp) {
                      if (!A._62O) {
                          if (Qf(Gp(P), A.cp) < 2)
                              return;
                          A._isV ? A._62O = "v" : A._isH ? A._62O = "h" : H.draggingData && !this.dragCancel ? (A._62O = "d",
                          H.handleDragAndDrop(P, "begin")) : A._62O = "p",
                          A._62O && "d" !== A._62O && H.draggingData && (H.draggingData = null,
                          H.redraw()),
                          dq(A, P)
                      }
                  } else
                      A._isV && H._43o(),
                      A._isH && H._42o()
              }
          },
          isV: function(i) {
              var y = this.list
                , F = y._29I;
              return y._41o() && F.x + F.width - y.lp(i).x < co
          },
          isH: function(W) {
              var R = this.list
                , S = R._29I;
              return R._40o() && S.y + S.height - R.lp(W).y < co
          },
          handle_mousewheel: function(I) {
              this.handleScroll(I, I.wheelDelta / 40, I.wheelDelta !== I.wheelDeltaX)
          },
          handle_DOMMouseScroll: function(o) {
              this.handleScroll(o, -o.detail, 1)
          },
          handleScroll: function(X, $, B) {
              var Y = this.list;
              ad(X),
              Y.endEditing && Y.endEditing(),
              B && Y._41o() ? Y.translate(0, $ * Y.getRowHeight()) : Y._40o() && Y.translate(10 * $, 0)
          },
          handle_keydown: function(x) {
              if (!M.isInput(x.target)) {
                  var R, Y = this.list, V = Y.sm(), J = Y._rows, r = J.size();
                  if (td(x))
                      Y.selectAll();
                  else if (Xr(x))
                      Y.handleDelete && Y.handleDelete(x);
                  else if (pg(x))
                      "d" !== this._62O || this.dragCancel || (Y.handleDragAndDrop(x, "cancel"),
                      this.dragCancel = !0);
                  else if (ec(x))
                      Y.isCheckMode() && (R = Y.getFocusData(),
                      R && Y.checkData(R));
                  else if (yo(x) || Cf(x)) {
                      var w = Y.isCheckMode();
                      if (R = w ? Y.getFocusData() : V.ld()) {
                          var o = Y.getRowIndex(R);
                          o >= 0 && (yo(x) ? 0 !== o && (R = J.get(o - 1),
                          w ? Y.setFocusData(R) : V.ss(R)) : o !== r - 1 && (R = J.get(o + 1),
                          w ? Y.setFocusData(R) : V.ss(R)))
                      } else
                          r > 0 && (R = J.get(0),
                          w ? Y.setFocusData(R) : V.ss(R))
                  }
              }
          },
          _34o: function(v, l) {
              var E = this.list
                , b = E.lp(v).x;
              return b >= 0 && b <= E._indent ? (E.checkData(l),
              void 0) : (E.setFocusData(l),
              void 0)
          },
          _33o: function(T, j) {
              var k = this.list
                , D = k.sm()
                , b = D.ld();
              if (!k.canHandleSelectMode(T, j))
                  return this._cancelDataDoubleSelect(),
                  void 0;
              if (Tr(T))
                  k.isSelected(j) ? D.rs(j) : D.as(j);
              else if (Oh(T))
                  if (b)
                      for (var W = k.getRowIndex(b), z = k.getRowIndex(j); W !== z; )
                          W += z > W ? 1 : -1,
                          D.as(k._rows.get(W));
                  else
                      D.ss(j);
              else
                  ni(T) ? (D.contains(j) ? k.handleDataDoubleSelect && (this._handleDataDoubleSelect(T, j),
                  Xk(T) && this._cancelDataDoubleSelect()) : this._cancelDataDoubleSelect(),
                  D.ss(j)) : D.contains(j) || D.ss(j)
          },
          _handleDataDoubleSelect: function(K, Q) {
              this._cancelDataDoubleSelect(),
              this._doubleSelectTimer = vk(function() {
                  this.list.handleDataDoubleSelect(K, Q),
                  this._doubleSelectTimer = V
              }
              .bind(this), M.doubleClickSpeed)
          },
          _cancelDataDoubleSelect: function() {
              this._doubleSelectTimer && (_d(this._doubleSelectTimer),
              this._doubleSelectTimer = V)
          }
      }),
      Vs.TreeView = function(I) {
          var V = this;
          V._35o(),
          V._5o(I),
          new ct(V)
      }
      ,
      Ws("TreeView", G, {
          ms_ac: [om, sh, Be, "rootVisible", rh, "rootData", Jf, sq, yq, yl, bi, im, Vl, ic, Lb, qq, jo, Yr, og, "loader", "doubleClickToToggle"],
          ms_v: 1,
          ms_bnb: 1,
          ms_tip: 1,
          ms_fire: 1,
          ms_sm: 1,
          _49o: 1,
          ms_txy: 1,
          ms_lp: 1,
          ms_vs: 1,
          ms_hs: 1,
          _15Q: 1,
          ms_dm: 1,
          _48o: 1,
          _14Q: 1,
          _45o: 1,
          _checkMode: E,
          _indent: fl,
          _rowHeight: Ye,
          _rowLineVisible: M.treeViewRowLineVisible,
          _rowLineColor: M.treeViewRowLineColor,
          _scrollBarColor: ej,
          _scrollBarSize: _n,
          _autoHideScrollBar: Ch,
          _expandIcon: M.treeViewExpandIcon,
          _collapseIcon: M.treeViewCollapseIcon,
          _autoMakeVisible: Bc,
          _selectBackground: M.treeViewSelectBackground,
          _labelColor: M.treeViewLabelColor,
          _labelSelectColor: M.treeViewLabelSelectColor,
          _labelFont: M.treeViewLabelFont,
          _doubleClickToToggle: M.treeViewDoubleClickToToggle,
          drawRow: function(y, f, L, j, X, r, e) {
              var H = this;
              H.drawRowBackground(y, f, L, j, X, r, e),
              H.drawTree(y, f, L, 0, X, r, e)
          },
          isOnToggleIcon: function(Q) {
              var M = this.getDataAt(Q);
              if (M) {
                  var k = this.getIndent()
                    , R = this.lp(Q).x;
                  if (Ti(this.getToggleIcon(M))) {
                      var U = k * this.getLevel(M);
                      if (R >= U && U + k >= R)
                          return !0
                  }
              }
              return !1
          }
      });
      var ct = function(_) {
          Jg(ct, this, [_])
      };
      Ik(ct, bt, {
          toggle: function(A, I, K, L) {
              var V = this.list
                , X = V.lp(A).x;
              if (Ti(V.getToggleIcon(I))) {
                  var w = K * L;
                  if (X >= w && w + K >= X)
                      return V.toggle(I),
                      !0
              }
              return V.isDoubleClickToToggle() && Xk(A) ? (V.toggle(I),
              !0) : !1
          },
          _34o: function(d, J) {
              var B = this.list
                , e = B.lp(d).x
                , W = B._levelMap[J._id]
                , K = B._indent
                , x = K * (W + 1);
              return e >= x && x + K >= e ? (B.checkData(J),
              void 0) : (this.toggle(d, J, K, W) || B.setFocusData(J),
              void 0)
          },
          _33o: function(u, g) {
              var p = this
                , F = p.list;
              if (!p.toggle(u, g, F._indent, F.getLevel(g)))
                  if (Oh(u)) {
                      var Z = F.sm();
                      if (Z.size() > 0) {
                          for (var R = F._rows, S = null, D = 0, w = R.size(); w > D; D++)
                              if (F.isSelected(R.get(D))) {
                                  S = D;
                                  break
                              }
                          for (var q = null, D = R.size() - 1; D >= 0; D--)
                              if (F.isSelected(R.get(D))) {
                                  q = D;
                                  break
                              }
                          var e, O, H = F.getRowIndex(g);
                          for (S > H ? (e = H - 1,
                          O = S) : H > q ? (e = q,
                          O = H) : (e = S,
                          O = q); e !== O; )
                              e++,
                              Z.as(F._rows.get(e))
                      } else
                          Z.ss(g)
                  } else
                      ct.superClass._33o.call(p, u, g)
          },
          handle_keydown: function(l) {
              if (Ll(l) || zp(l)) {
                  var g = this.list
                    , O = g._rows
                    , H = g.isCheckMode()
                    , W = g.sm()
                    , s = H ? g.getFocusData() : W.ld();
                  s ? s.hasChildren() && (Ll(l) ? g.collapse(s) : g.expand(s)) : O.size() > 0 && (s = O.get(0),
                  H ? g.setFocusData(s) : W.ss(s))
              } else
                  ct.superClass.handle_keydown.call(this, l)
          }
      });
      var dt = Vs.TableView = function(k) {
          this._98I(),
          this._5o(k),
          new et(this)
      }
      ;
      Ws("TableView", G, {
          ms_ac: [om, sh, Be, "sortMode", Ap, Ur, Vl, ic, Lb, vq, gh, "sortColumn", Jf, sq, yq, yl, bi, Yr, og],
          ms_v: 1,
          ms_fire: 1,
          ms_sm: 1,
          _49o: 1,
          ms_txy: 1,
          ms_lp: 1,
          ms_vs: 1,
          ms_hs: 1,
          _15Q: 1,
          ms_dm: 1,
          ms_tip: 1,
          _50o: 1,
          _45o: 1,
          _47o: 1,
          _sortMode: _e,
          _editable: !0,
          _batchEditable: !1,
          _rowHeight: Ye,
          _rowLineVisible: M.tableViewRowLineVisible,
          _rowLineColor: M.tableViewRowLineColor,
          _columnLineVisible: M.tableViewColumnLineVisible,
          _columnLineColor: M.tableViewColumnLineColor,
          _scrollBarColor: ej,
          _scrollBarSize: _n,
          _autoHideScrollBar: Ch,
          _autoMakeVisible: Bc,
          _selectBackground: M.tableViewSelectBackground,
          _labelColor: M.tableViewLabelColor,
          _labelSelectColor: M.tableViewLabelSelectColor,
          _labelFont: M.tableViewLabelFont,
          getCheckColumn: function() {
              var L = this;
              if (!L._31o) {
                  var b = L._31o = new Ys;
                  b.setEditable(!0),
                  b.setWidth(40),
                  b.getValue = L.getCheckColumValue,
                  b.drawCell = L.drawCheckColumnCell
              }
              return L._31o
          },
          isCheckMode: function() {
              return this._39o.contains(this._31o)
          },
          setCheckMode: function(Y) {
              var O = this
                , G = O._39o
                , l = O.getCheckColumn();
              Y !== O.isCheckMode() && (Y ? G.add(l, 0) : G.remove(l),
              O.fp(rh, !Y, Y))
          },
          getCheckColumValue: function(c, W, t) {
              return t.isSelected(c)
          },
          drawCheckColumnCell: function(D, t, y, M, z, W, i, P, o) {
              Oj(D, o.getCheckIcon(t), z + i / 2, W + P / 2, t, o)
          }
      });
      var et = function(g) {
          Jg(et, this, [g])
      };
      Ik(et, bt, {
          _34o: function(p, d) {
              var H = this.list
                , n = H._31o;
              if (H.isCellEditable(d, n, p)) {
                  var Z = H._3Q(n)
                    , r = H.lp(p).x;
                  if (Z && r >= Z.startX && r < Z.startX + n.getWidth())
                      return H.checkData(d),
                      void 0
              }
              H._37O(d, p),
              H.setFocusData(d)
          },
          _33o: function(h, H) {
              this.list._37O(H, h),
              et.superClass._33o.apply(this, arguments)
          }
      });
      var ft = Vs.TreeTableView = function(J) {
          var l = this
            , N = l._4o = new Ys;
          l._35o(),
          l._98I(),
          l._5o(J),
          N.setDisplayName("Name"),
          N.setEditable(!0),
          N.setWidth(180),
          N.drawCell = gt,
          N.getValue = ht,
          l._39o.add(N),
          new it(l)
      }
        , gt = function(d, q, o, w, S, T, v, l, f) {
          f.drawTree(d, q, o, S, T, v, l)
      }
        , ht = function(C, V, L) {
          return L.getLabel(C)
      };
      Ws("TreeTableView", G, {
          ms_ac: [om, sh, Be, "sortMode", Ap, Ur, im, rh, "rootData", "rootVisible", Jf, sq, "sortColumn", qq, jo, yq, yl, bi, Yr, Lb, Vl, ic, vq, gh, og, "loader"],
          ms_v: 1,
          ms_bnb: 1,
          ms_fire: 1,
          ms_sm: 1,
          _49o: 1,
          ms_txy: 1,
          ms_lp: 1,
          ms_vs: 1,
          ms_hs: 1,
          _15Q: 1,
          ms_dm: 1,
          ms_tip: 1,
          _50o: 1,
          _48o: 1,
          _14Q: 1,
          _45o: 1,
          _47o: 1,
          _sortMode: _e,
          _checkMode: E,
          _editable: !0,
          _batchEditable: !1,
          _indent: fl,
          _rowHeight: Ye,
          _rowLineVisible: M.treeTableViewRowLineVisible,
          _rowLineColor: M.treeTableViewRowLineColor,
          _columnLineVisible: M.treeTableViewColumnLineVisible,
          _columnLineColor: M.treeTableViewColumnLineColor,
          _expandIcon: M.treeTableViewExpandIcon,
          _collapseIcon: M.treeTableViewCollapseIcon,
          _scrollBarColor: ej,
          _scrollBarSize: _n,
          _autoHideScrollBar: Ch,
          _autoMakeVisible: Bc,
          _selectBackground: M.treeTableViewSelectBackground,
          _labelColor: M.treeTableViewLabelColor,
          _labelSelectColor: M.treeTableViewLabelSelectColor,
          _labelFont: M.treeTableViewLabelFont,
          getTreeColumn: function() {
              return this._4o
          }
      });
      var it = function(l) {
          Jg(it, this, [l])
      };
      Ik(it, bt, {
          _34o: function(o, T) {
              var G = this.list
                , W = G._4o
                , h = G._3Q(W)
                , p = G.lp(o).x;
              if (h) {
                  var P = G._indent
                    , m = h.startX + P * G.getLevel(T);
                  if (Ti(G.getToggleIcon(T)) && p >= m && m + P >= p)
                      return G.toggle(T),
                      void 0;
                  if (G.isCellEditable(T, W) && (m += P,
                  p >= m && m + P >= p))
                      return G.checkData(T),
                      void 0
              }
              G._37O(T, o),
              G.setFocusData(T)
          },
          _33o: function(q, x) {
              var $ = this.list
                , j = $.lp(q).x;
              if (Ti($.getToggleIcon(x))) {
                  var E = $._3Q($._4o);
                  if (E) {
                      var e = $._indent
                        , z = E.startX + e * $.getLevel(x);
                      if (j >= z && z + e >= j)
                          return $.toggle(x),
                          void 0
                  }
              }
              $._37O(x, q),
              it.superClass._33o.apply(this, arguments)
          }
      });
      var jt = Vs.TableHeader = function(V) {
          var P = this
            , F = P._view = Te(1, P)
            , j = P._39o = V.getColumnModel()
            , w = P.iv;
          P.tv = P._tableView = V,
          P._60I = new Mh,
          P._canvas = Jl(F),
          F.style.background = M.tableHeaderBackground || "",
          F.style.height = Lj + nc,
          j.mm(w, P),
          j.md(w, P),
          j.mh(w, P),
          V.mp(function(s) {
              Ms[s.property] && P.iv()
          }, P),
          new kt(P),
          P.iv()
      }
      ;
      Ws("TableHeader", G, {
          ms_v: 1,
          ms_lp: 1,
          ms_fire: 1,
          ms_ac: ["checkIcon", "sortDescIcon", "sortAscIcon", om, Be, im, "moveBackground", "insertColor", vq, gh, "resizable", "movable"],
          _checkIcon: Ig,
          _movable: !0,
          _resizable: !0,
          _labelColor: M.tableHeaderLabelColor,
          _labelFont: M.tableHeaderLabelFont,
          _columnLineColor: M.tableHeaderColumnLineColor,
          _columnLineVisible: M.tableHeaderColumnLineVisible,
          _sortDescIcon: M.tableHeaderSortDescIcon,
          _sortAscIcon: M.tableHeaderSortAscIcon,
          _moveBackground: M.tableHeaderMoveBackground,
          _insertColor: M.tableHeaderInsertColor,
          _indent: fl,
          getCheckIcon: function() {
              return this._checkIcon
          },
          getTableView: function() {
              return this.tv
          },
          getLabel: function(M) {
              return M.toLabel()
          },
          getLabelFont: function() {
              return this._labelFont
          },
          getLabelColor: function(e) {
              return e.getColor() || this._labelColor
          },
          getLabelAlign: function(u) {
              return u._align
          },
          onPropertyChanged: function() {
              this.iv()
          },
          _5Q: function(u) {
              this._61I = u,
              this.iv()
          },
          getLogicalPoint: function(V) {
              return Pf(V, this._canvas, this.tv.tx())
          },
          validateImpl: function() {
              var K = this
                , k = K._canvas
                , p = K.getWidth()
                , Z = K.getHeight()
                , W = K.tv
                , E = K._60I
                , n = K._61I
                , c = -W.tx()
                , Q = 0;
              (p !== k.clientWidth || Z !== k.clientHeight) && Uj(k, p, Z),
              E.clear(),
              K._39o._roots.each(function(v) {
                  if (v.isVisible()) {
                      var h = Q + v.getWidth();
                      c + p >= Q && h >= c && E.add({
                          column: v,
                          startX: Q
                      }),
                      Q = h
                  }
              });
              var R = hq(k);
              if (Sn(R, -c, 0, 1),
              R.beginPath(),
              R.rect(c, 0, p, Z),
              R.clip(),
              R.clearRect(c, 0, p, Z),
              E.each(function(Q) {
                  var F = Q.column
                    , H = Q.startX
                    , $ = F.getWidth();
                  $ > 0 && (R.save(),
                  R.beginPath(),
                  R.rect(H, 0, $, Z),
                  R.clip(),
                  n && n.column === F || K.drawColumn(R, F, H, 0, $, Z),
                  K._columnLineVisible && xg(R, H + $ - 1, 0, 1, Z, K._columnLineColor),
                  R.restore())
              }),
              n) {
                  var S = n.column
                    , Q = n.startX
                    , g = n.position
                    , b = S.getWidth();
                  R.save(),
                  R.beginPath(),
                  R.rect(Q, 0, b, Z),
                  R.clip(),
                  R.fillStyle = K._moveBackground,
                  R.fill(),
                  K.drawColumn(R, S, Q, 0, b, Z),
                  R.restore(),
                  Ne(R, K._insertColor, g, 0, Z)
              }
              R.restore()
          },
          _6Q: function(j) {
              var A = this.tv;
              return A._31o === j && A.sm().getSelectionMode() === wr
          },
          drawColumn: function(p, d, e, _, o, F) {
              var g = this
                , r = g.tv
                , w = Ti(d.getIcon())
                , D = g.getLabelAlign(d);
              if (g._6Q(d)) {
                  var X = Ti(g._checkIcon);
                  Oj(p, X, e + o / 2, _ + F / 2, d, g)
              } else {
                  var E = g.getLabel(d)
                    , N = g.getLabelFont(d)
                    , t = g.getLabelColor(d)
                    , P = eh(N, E).width
                    , m = w ? g._indent : 0;
                  D === Mb ? (w && Eq(p, w, jg, e, _, m, F),
                  vh(p, E, N, t, e + m, _, o, F, Mb)) : D === Gq ? (w && Eq(p, w, jg, e + o - P - m, _, m, F),
                  vh(p, E, N, t, e, _, o, F, Gq)) : (w && Eq(p, w, jg, e + (o - P - m) / 2, _, m, F),
                  vh(p, E, N, t, e + (o - P + m) / 2, _, 0, F, Mb))
              }
              if (d.isSortable() && r.getSortColumn() === d && (w = Ti(d.getSortOrder() === Xe ? g._sortAscIcon : g._sortDescIcon))) {
                  var A = Aj(w, d) / 2 + 2;
                  Oj(p, w, D === Gq ? e + A : e + o - A, _ + F / 2, d, r)
              }
          }
      });
      var kt = function(c) {
          var r = this;
          r.th = c,
          r.tv = c._tableView,
          r.addListeners()
      };
      Ik(kt, G, {
          ms_listener: 1,
          getView: function() {
              return this.th.getView()
          },
          setCursor: function(C) {
              this.getView().style.cursor = C
          },
          handle_mousemove: function(C) {
              if (!gd) {
                  var Q = this;
                  delete Q._29o,
                  Q.setCursor(kj);
                  for (var S = Q.th, l = S._60I, L = S.lp(C).x, o = l.size() - 1; o >= 0; o--) {
                      var g = l.get(o)
                        , B = g.column
                        , t = g.startX + B.getWidth();
                      if (S.isResizable() && u(t - L) <= (Ul ? 10 : 3))
                          return Q._29o = g,
                          Q.setCursor(So),
                          void 0;
                      L > g.startX && t > L && (Q._29o = g),
                      (B.isClickable() || B.isSortable() || S.isMovable() || Q.tv.getCheckColumn && B === Q.tv.getCheckColumn()) && L > g.startX && t > L && Q.setCursor(yp)
                  }
              }
          },
          handle_mousedown: function(L) {
              this.handle_touchstart(L)
          },
          handle_touchstart: function(j) {
              var D = this;
              ad(j),
              D.tv.endEditing(),
              D.handle_mousemove(j),
              D._29o && (D.x = Gp(j).x,
              D.lx = D.th.lp(j).x,
              D.w = D._29o.column.getWidth(),
              dq(D, j))
          },
          handleWindowMouseMove: function(t) {
              this.handleWindowTouchMove(t)
          },
          handleWindowTouchMove: function(B) {
              var a = this
                , q = a.th
                , r = a.getView().style.cursor
                , l = a._29o
                , _ = Gp(B).x - a.x;
              if (a.resizing || a.moving || (r === So ? a.resizing = 1 : q.isMovable() && r === yp && u(_) > 2 && (a.moving = 1)),
              a.resizing)
                  l.column.setWidth(a.w + _);
              else if (a.moving) {
                  var v = a.lx + _;
                  q._60I.each(function(K) {
                      var e = K.startX
                        , W = e + K.column.getWidth();
                      if (v >= e && W >= v) {
                          var x = {
                              column: l.column,
                              startX: l.startX + _,
                              front: W - v > v - e,
                              insertColumn: K.column
                          };
                          x.position = x.front ? e : W,
                          q._5Q(x)
                      }
                  })
              }
          },
          _16Q: function(r, K) {
              var U = this
                , n = U.tv
                , g = U.th
                , x = g._checkIcon;
              if (g._6Q(r)) {
                  var f = Ti(x)
                    , v = U.lx
                    , l = r.getWidth()
                    , I = Aj(f, r);
                  if (v >= K + l / 2 - I && K + l / 2 + I >= v) {
                      g.setCheckIcon(x === jn ? Ig : jn);
                      var W = n.sm()
                        , p = n._rows;
                      return x === jn ? W.rs(p) : W.ss(p),
                      n.onCheckColumnClicked(r),
                      !0
                  }
              }
              return !1
          },
          handleWindowMouseUp: function(N) {
              this.handleWindowTouchEnd(N)
          },
          handleWindowTouchEnd: function(w) {
              var D = this
                , T = D.tv
                , d = D.th
                , Q = D._29o;
              if (D.moving) {
                  var N = d._61I;
                  if (N && N.insertColumn !== N.column) {
                      var S = N.column
                        , n = T.getColumnModel()._roots
                        , _ = n.remove(S)
                        , r = n.indexOf(N.insertColumn);
                      r >= 0 && (N.front || r++,
                      r <= n.size() && (n.add(S, r),
                      T.getColumnModel()._38I(S, _, r)))
                  }
                  d._5Q(E),
                  delete D.moving
              } else if (!D.resizing && Q) {
                  S = Q.column;
                  var R = d.lp(w).x
                    , k = Q.startX
                    , U = !0;
                  if (d.onColumnClicked) {
                      var f = d.onColumnClicked(S, w, k);
                      f === !1 && (U = !1)
                  }
                  if (U && R >= k && R <= k + S.getWidth() && !D._16Q(S, k)) {
                      if (S.isSortable()) {
                          var q = T.getSortMode()
                            , P = S.getSortOrder();
                          q === _e ? T.getSortColumn() === S ? (P === Fd && T.setSortColumn(E),
                          S.setSortOrder(P === Xe ? Fd : Xe)) : T.setSortColumn(S) : "bistate" === q && (T.getSortColumn() === S ? S.setSortOrder(P === Xe ? Fd : Xe) : T.setSortColumn(S))
                      }
                      T.onColumnClicked(S, w, k)
                  }
              }
              D._29o = D.resizing = D.x = D.lx = D.w = E
          }
      }),
      Vs.TablePane = function(a) {
          this.init(new dt(a))
      }
      ,
      Ws("TablePane", G, {
          ms_v: 1,
          _44o: 1
      }),
      Vs.TreeTablePane = function(M) {
          this.init(new ft(M))
      }
      ,
      Ws("TreeTablePane", G, {
          ms_v: 1,
          _44o: 1
      }),
      Vs.Toolbar = function(o) {
          var b = this
            , j = b._view = Te(1, b)
            , u = j.style;
          u.background = M.toolbarBackground || "",
          u.height = Yj + nc,
          b._canvas = Jl(j),
          b._30o = new Mh,
          b._90I = new Mh,
          b.setItems(o || []),
          j.handleGroupSelectedChanged = function(i) {
              if (i.isSelected()) {
                  var a = i.getGroupId();
                  null != a && b._items.forEach(function(h) {
                      var S = h.element;
                      S && S !== i && S.setSelected && S.getGroupId && S.getGroupId() === a && S.setSelected(!1)
                  })
              }
          }
          ,
          new lt(b)
      }
      ,
      Ws("Toolbar", G, {
          ms_v: 1,
          ms_fire: 1,
          ms_tx: 1,
          ms_lp: 1,
          ms_tip: 1,
          ms_value: 1,
          ms_ac: [ng, om, Be, sh, og, "itemGap", "separatorColor", "currentItem", "stickToRight"],
          _labelColor: M.toolbarLabelColor,
          _labelSelectColor: M.toolbarLabelSelectColor,
          _labelFont: M.toolbarLabelFont,
          _selectBackground: M.toolbarSelectBackground,
          _itemGap: M.toolbarItemGap,
          _separatorColor: M.toolbarSeparatorColor,
          _stickToRight: !1,
          getSumWidth: function() {
              return this._64I
          },
          getToolTip: function(k) {
              var I = this.getItemInfoAt(k);
              return I ? I.item.toolTip : E
          },
          getLabelColor: function(Y) {
              return Y && Y.selected && Y.type !== jn && Y.type !== ei ? this._labelSelectColor : this._labelColor
          },
          onPropertyChanged: function(X) {
              this.iv(),
              X.property === ng && this._items.forEach(function(U) {
                  ho(U)
              })
          },
          redraw: function() {
              this.iv()
          },
          addItem: function(C, Q) {
              var y = this._items;
              Q == E ? y.push(C) : y.splice(Q, 0, C),
              this.fp(ng, E, y)
          },
          removeItem: function(r) {
              if (r)
                  for (var i = this._items, m = 0; m < i.length; m++)
                      r === i[m] && (i.splice(m, 1),
                      this.fp(ng, E, i))
          },
          removeItemById: function(x) {
              if (x != E)
                  for (var Z = this._items, W = 0; W < Z.length; W++)
                      if (x === Z[W].id) {
                          var M = Z.splice(W, 1)[0];
                          return this.fp(ng, E, Z),
                          M
                      }
          },
          getItemById: function(Z) {
              if (Z != E)
                  for (var G = this._items, r = 0; r < G.length; r++) {
                      var d = G[r];
                      if (Z === d.id)
                          return d
                  }
          },
          setItemVisible: function(f, g) {
              var D = this.getItemById(f);
              D && (D.visible = g)
          },
          getItemInfos: function() {
              return this._30o
          },
          getItemInfoAt: function(q) {
              var D = this
                , o = 0
                , V = D._30o
                , n = D.lp(q)
                , j = n.x
                , T = n.y;
              if (T >= 0 && T <= D.getHeight())
                  for (; o < V.size(); o++) {
                      var A = V.get(o);
                      if (A.startX <= j && j <= A.endX)
                          return A
                  }
              return E
          },
          drawItem: function(G, l, X, m, A) {
              if (l.visible === !1)
                  return 0;
              if (Oi(l.visible) && !l.visible())
                  return 0;
              var h = this
                , N = l.disabled;
              N && (G.globalAlpha = Un);
              var t = h.drawItemImpl(G, l, X, m, A)
                , j = h._itemGap;
              return N && (G.globalAlpha = 1),
              this._currentItem !== l || "separator" === l || l.separator === !0 || l.unfocusable || Ri(G, h._separatorColor, X - j / 2, 0, t + j, m),
              t
          },
          drawItemImpl: function(M, F, q, D, C) {
              var j = this
                , R = j._view
                , $ = j._itemGap
                , e = D / 2
                , x = F.type
                , H = F.element
                , T = F.label;
              Xq(H) && (T = H,
              H = E);
              var Z, l = j.getLabelFont(F), J = j.getLabelColor(F), b = F.selected, y = Ti(F.icon), P = Aj(y, F), X = 0, c = P + (T ? eh(l, T).width : 0);
              if ("separator" === F || F.separator === !0)
                  return Ne(M, j._separatorColor, q, D / 4, e),
                  1;
              if (H) {
                  y && Oj(M, y, q + P / 2, e, F, j),
                  vh(M, T, l, J, q + P, 0, 0, D);
                  var f = Si(H);
                  C || j._90I.add(f),
                  f.parentNode !== R && Qc(R, f),
                  H.iv && H.iv(),
                  H.validate && H.validate();
                  var h = f.getBoundingClientRect()
                    , V = h.width
                    , u = f.style;
                  return Kn(f),
                  u.left = j.tx() + q + c + nc,
                  u.top = (D - h.height) / 2 + nc,
                  c + V
              }
              return x === ei ? Z = Ti(b ? je : Do) : x === jn && (Z = Ti(b ? jn : Ig)),
              Z ? (X = Aj(Z, F),
              Oj(M, Z, q + X / 2, e, F, j),
              q += X,
              c += X) : b && xg(M, q - $ / 2, 0, c + $, D, j.getSelectBackground(F)),
              y && Oj(M, y, q + P / 2, e, F, j),
              vh(M, T, l, J, q + P, 0, 0, D),
              c
          },
          validateImpl: function() {
              var x = this
                , R = x._canvas
                , K = x.getWidth()
                , h = x.getHeight()
                , n = x._30o
                , U = x._items;
              Uj(R, K, h);
              var o = hq(R)
                , Q = x._itemGap
                , $ = Q / 2;
              Sn(o, x.tx(), 0, 1),
              o.clearRect(0, 0, K, h);
              var k = x._90I;
              x._90I = new Mh,
              n.clear(),
              U.forEach(function(Z) {
                  var X = x.drawItem(o, Z, $, h);
                  n.add({
                      item: Z,
                      startX: $,
                      endX: $ + X,
                      width: X
                  }),
                  X && ($ += X + Q)
              }),
              k.each(function(b) {
                  x._90I.contains(b) || is(b)
              });
              var f = x._64I;
              x._64I = X(0, $),
              o.restore(),
              x._stickToRight ? (x._65O = 0,
              o = hq(R),
              $ = K - x._64I + Q,
              Sn(o, 0, 0, 1),
              o.clearRect(0, 0, K, h),
              n.clear(),
              U.forEach(function(D) {
                  var L = x.drawItem(o, D, $, h, !0);
                  n.add({
                      item: D,
                      startX: $,
                      endX: $ + L,
                      width: L
                  }),
                  L && ($ += L + Q)
              }),
              o.restore()) : x.tx(x.tx()),
              f !== x._64I && x.onSumWidthChanged(f, x._64I)
          },
          onSumWidthChanged: function() {},
          handleClick: function(q, c) {
              var W = this
                , w = q.type
                , e = q.action
                , N = q.groupId
                , S = q.selected;
              q.disabled || (N != E ? S || (q.selected = !0,
              this._items.forEach(function(a) {
                  a.groupId === N && q !== a && (a.selected = !1)
              }),
              e && q.action(q, W, c)) : w === jn || "toggle" === w ? (q.selected = !S,
              e && q.action(q, W, c)) : e && q.action(q, W, c)),
              Ab(),
              W.iv()
          }
      });
      var lt = function(M) {
          this.tb = M,
          this.addListeners()
      };
      Ik(lt, G, {
          ms_listener: 1,
          getView: function() {
              return this.tb._view
          },
          handle_mousewheel: function(e) {
              this.handleScroll(e, 10 * (e.wheelDelta / 40))
          },
          handle_DOMMouseScroll: function(t) {
              this.handleScroll(t, 10 * -t.detail)
          },
          handleScroll: function(p, C) {
              ad(p);
              var u = this.tb;
              u.isScrollable() && !u._stickToRight && (u.tx(u.tx() + C),
              fc())
          },
          handle_mousemove: function(O) {
              var W = this;
              gd || W.setItem(O)
          },
          handle_mouseout: function(q) {
              var a = this;
              q.target === a.getView() ? a.tb.setCurrentItem(E) : a.handle_mousemove(q)
          },
          handle_mousedown: function(E) {
              this.handle_mousemove(E),
              this.handle_touchstart(E)
          },
          handle_touchstart: function(C) {
              var l = this
                , F = l.tb
                , f = C.target;
              ni(C) && (f === l.getView() || f === F._canvas) && (ad(C),
              F.setFocus(C) && (this.setItem(C, !0),
              (F.isScrollable() || l.info && !l.info.item.disabled) && (l.x = Gp(C).x,
              l.tx = F.tx(),
              dq(l, C))))
          },
          handleWindowMouseMove: function(d) {
              this.handleWindowTouchMove(d)
          },
          handleWindowTouchMove: function(k) {
              var X = this
                , i = X.tb;
              if (!i._stickToRight) {
                  var C = Gp(k).x - X.x;
                  !X._25o && u(C) > 2 && i.isScrollable() && (X._25o = 1),
                  X._25o && i.tx(X.tx + C)
              }
          },
          handleWindowMouseUp: function(r) {
              this.handleWindowTouchEnd(r)
          },
          handleWindowTouchEnd: function(e) {
              var S = this
                , K = S.tb
                , v = S.info
                , h = S.tb.getItemInfoAt(e);
              if (!S._25o && v) {
                  var k = v.item;
                  h && h.item === k && K.handleClick(k, e)
              }
              S._25o = S.x = S.tx = E,
              S.setItem()
          },
          setItem: function(N, x) {
              var y = this
                , c = y.tb
                , S = y.info = N ? c.getItemInfoAt(N) : E
                , l = S ? S.item : E;
              c.setCurrentItem(l),
              x && l && Oi(l.onDown) && l.onDown(N)
          }
      }),
      Vs.BorderPane = function() {
          this._view = Te(1, this),
          this.iv()
      }
      ,
      Ws("BorderPane", G, {
          ms_v: 1,
          ms_ac: ["topHeight", "bottomHeight", "leftWidth", "rightWidth"],
          ms_fire: 1,
          getLeftView: function() {
              return this._leftView
          },
          setLeftView: function(T, e) {
              this._12o("leftView", T),
              e != E && this.setLeftWidth(e)
          },
          getRightView: function() {
              return this._rightView
          },
          setRightView: function(R, r) {
              this._12o("rightView", R),
              r != E && this.setRightWidth(r)
          },
          getTopView: function() {
              return this._topView
          },
          setTopView: function(J, M) {
              this._12o("topView", J),
              M != E && this.setTopHeight(M)
          },
          getBottomView: function() {
              return this._bottomView
          },
          setBottomView: function(L, J) {
              this._12o("bottomView", L),
              J != E && this.setBottomHeight(J)
          },
          getCenterView: function() {
              return this._centerView
          },
          setCenterView: function(H) {
              this._12o("centerView", H)
          },
          _12o: function(i, q) {
              var c = this
                , r = "_" + i
                , D = c._view
                , u = c[r];
              u !== q && (u && (u.getView ? is(u.getView()) : is(u)),
              c[r] = q,
              q && (q.getView ? Qc(D, q.getView(), 1) : Qc(D, q, 1)),
              c.fp(i, u, q))
          },
          onPropertyChanged: function() {
              this.iv()
          },
          validateImpl: function() {
              var c = this
                , V = c._topView
                , k = c._bottomView
                , F = c._leftView
                , l = c._rightView
                , y = c._centerView
                , L = c.getWidth()
                , m = c.getHeight()
                , p = 0
                , u = 0
                , D = L
                , z = m
                , h = 0
                , w = 0
                , O = 0
                , o = 0;
              V && (h = c._topHeight == E ? dl(V) : c._topHeight,
              u = h),
              k && (w = c._bottomHeight == E ? dl(k) : c._bottomHeight,
              z = m - w),
              F && (O = c._leftWidth == E ? fg(F) : c._leftWidth,
              p = O),
              l && (o = c._rightWidth == E ? fg(l) : c._rightWidth,
              D = L - o);
              var v = X(0, D - p)
                , s = X(0, z - u);
              V && ib(V, 0, 0, L, h),
              k && ib(k, 0, z, L, w),
              F && ib(F, 0, u, O, s),
              l && ib(l, D, u, o, s),
              y && ib(y, p, u, v, s)
          }
      })
  }
}("undefined" != typeof global ? global : "undefined" != typeof self ? self : "undefined" != typeof window ? window : (0,
eval)("this"), Object);
