<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>
    // 对闭包的看法, 为什么要用闭包, 说说闭包的原理及引用场景

    /*
      1. 闭包: 
        函数执行后返回的是一个内部函数, 且被外部变量所引用。如果内部函数持有被执行函数作用域的变量, 就形成了闭包。
        可以在内部函数访问到外部函数作用域。
        作用一. 读取外部函数变量
        作用二. 将函数的变量存储在内存中, 保护变量不被污染。
        闭包会把函数中的变量存储在内存中, 有一定的内存消耗, 因此不能滥用, 否则可能影响硬性导致内存泄露。当不使用闭包时要及时释放内存。(变量赋值null)
      2. 原理:
        函数执行两个阶段: 预编译 + 执行。
        预编译阶段, 如果内部函数使用外部函数变量, 会在内存中创建一个闭包对象并保存对应的变量值, 如果已存在闭包, 这只需要增加对应属性值即可；
        执行完成后，函数执行上下文会被销毁，函数对闭包对象的引用也会被销毁，但其内部函数还持有对该闭包的引用，所以内部函数可以继续使用外部函数的变量。
        利用函数作用域链的特性，一个函数内部定义的函数会将包含外部函数活动对象添加到它的作用域链中，函数执行完毕其执行作用域链销毁。但因内部函数的作用域链仍然在引用这个活动对象，所以其活动对象不会被销毁，知道内部函数被销毁后才会被销毁
      3. 优点:
        可以从函数内部访问外部函数作用域中的变量，且访问的对象长期驻扎在内存中可供之后使用
        避免全局变量污染
        将变量存到独立的作用域，作为私有成员存在；
      4. 缺点
        对内存消耗有负面影响，内部函数保存对外部变量的引用，导致无法被垃圾回收，增加内存使用量，可能导致内存泄漏
        对处理速度有负面影响，闭包的层级决定引用的外部变量在查找时经过的作用域链的长度
        可能获取到意外的值；
    */
  </script>
</body>
</html>