<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>script中async和defer区别</title>
</head>
<body>
  <script>
    /*
      基本: 浏览器在执行html是如果遇到script会停止页面渲染去下载和执行js文件直到/script。
      为了解决这个问题, 定义了defer和async两个属性用于控制js的下载和执行
    */

    /*
      defer: 
        红宝书: 
          脚本执行不影响页面构造, 即脚本延迟到整个页面解析完毕后运行(浏览器立即下载但延迟执行);
          脚本按照他们出现的先后顺序执行, 因此第一个延迟脚本会先于第二个延迟脚本执行, 他们均先于DOMContentLoaded事件执行;
          现实中, 延迟脚本不一定按照顺序执行, 也不一定会在DOMContentLoaded事件触发前执行, 因此最好包含一个延迟脚本
        MDN: 
          该属性被设定用来通知浏览器该脚本将在文档完成解析后，触发DOMContentLoaded事件前执行, 如果缺少src属性, 该属性不应被使用
    */

    /*
      async:
        红宝书:
          async只适用于外部脚本文件, 告诉浏览器立即下载文件, 但标记为async的脚本并不保证他们的先后顺序; 脚本之间的互不依赖非常重要;
          指定async的目的是不让页面等待两个脚本下载和执行, 从而异步加载页面其他内容;
        MDN:
          指示浏览器是否在允许的情况下异步执行该脚本, 改属性对于内联脚本无作用
    */

    /*
      相同点: 
        加载文件不阻塞页面渲染;
        对于inline的script无效(script内有代码, 两个属性无效)
        使用这两个属性的脚本中, 不能使用document.write方法
        有脚本的onload事件回调
    */

    /*
      不同点:
        html4定义defer, html5定义async, 
        每个async属性的脚本都在他下载结束后立即执行, 同事会在window的load事件之前执行.
        每个defer属性的脚本都是在页面解析完毕后, 按照原本顺序执行, 同时会在document.DOMContentLoaded之前执行。
    */
  </script>
</body>
</html>